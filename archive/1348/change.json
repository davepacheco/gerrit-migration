{"project":"joyent/sdc-imgapi","branch":"master","id":"I0cfc60b4d3775607f697452cf4c08761f95876b0","number":"1348","subject":"DOCKER-929 Support the docker v2.2 manifest format Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/1348","commitMessage":"DOCKER-929 Support the docker v2.2 manifest format\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1485464748,"lastUpdated":1500919417,"open":false,"status":"MERGED","comments":[{"timestamp":1485464748,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1485464749,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 35b8afa9ee69f64f0f853466182aca330f386935\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit b96e8efe16df52b7e028729ac773f4bd695dd358\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1485464785,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486169074,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1486169107,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1489120379,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3."},{"timestamp":1489120380,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 6a21d597ccab1e21b5bb5b1c87dbb349255b36d3\n    \n    merge in docker retries code\n    \n    commit f1f171032ee562f58a654f116c3479d239bf4d7b\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit f8a5ada7ca6d48879773ece3b2582ca6fffb025b\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1489120417,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489120898,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 4."},{"timestamp":1489120899,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit b01407764b0f6a216443166695697badf9093641\n    \n    merge in docker retries code\n    \n    commit c7470595904cbd8ea3fe35f98c891b50a35bd28a\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit 6aa0900bcfaa65da8464cdc4e52e1b1abd27b65c\n    \n    DOCKER-929 Support the docker v2.2 manifest format\n    \n    commit 7afff7d601d2f40e0abd150caa0d885a0521978c\n    \n    IMGAPI-621 handling of query params with \u0027.\u0027 broken since IMGAPI-587\n    Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n    Approved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e"},{"timestamp":1489120931,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489121547,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5."},{"timestamp":1489121548,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 931aa2fbc00aa9a93a5f65ec53d9f9e63175f6ff\n    \n    Update copyright dates"},{"timestamp":1489121601,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492117210,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\n(34 comments)\n\n- We are using \u0027sha256\u0027 in var/data names. Should we make that more general\n  and include the method in the value? I.e. files.0.digest \u003d \u0027sha256:...\u0027?\n\n- Should have IMGAPI doc updates for the internal files.*.sha256 and\n  uncompressedSha256 fields.\n\n- Should there be a node-imgmanifest update for the new optional files.*.sha256\n  and uncompressedSha256 fields?"},{"timestamp":1492623110,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1492623111,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 987c505e06d4550f22a92d1159851da88f4fdbfe\n    \n    Update copyright dates\n    \n    commit 10a9353d7f3263582d77dc11d91d9351c1c3cc3d\n    \n    merge in docker retries code\n    \n    commit 2cc7c0b66ad79ebcb79ff6e40879877591915e86\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit 0876abbc9ac5d5727b377a01322eec6c54b76fb0\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1492623139,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1492623361,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 7."},{"timestamp":1492623362,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit d64375eb6ded9e11f778f8079e7df40fa5d13156\n    \n    update imgmanifest git reference"},{"timestamp":1492623415,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493759140,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\n(33 comments)"},{"timestamp":1493759151,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 8."},{"timestamp":1493759152,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 3fb4b17e0547ac81a7bf9f06a876dd851cbf6f95\n    \n    use assert.uuid rather than assert.string\n    \n    commit 3046ebbf03d1e329b2af4393f0abc101917a73eb\n    \n    use magic.maxMagicLen for exported name\n    \n    commit 3c9227c03cfa401e497e03806e7636e343725e71\n    \n    rename importImage function to importLayer\n    \n    commit d05aa6a1eee3ba9664b0d1563d5a04be3f17c969\n    \n    error on unexpected docker manifest.schemaVersion\n    \n    commit 35a502a45af12744ff792fb56f301d49306092bb\n    \n    update variable names, comments and drop unused loopErr code\n    \n    commit 151bec7c5e6388dfb04258d971cc20d72cddd266\n    \n    update function doc comments, add comment for faking layers\n    \n    commit 89401cde3c9df2987276736fc90710a3ba313fd8\n    \n    update variable scoping and error messaging\n    \n    commit 784eb94fb0cef8eba0695cc08cdedcab525edd27\n    \n    use ImageFileTooBigError for large image files\n    \n    commit 6a58f3fc745ee19947709cd2be54a6b6f34170e5\n    \n    update comments, variable names and function names, limit variable scoping\n    \n    commit 84606088cd32ff87f2aee4a40db74b8be2851ea3\n    \n    replace ctx.upconvertV21Manifest with ctx.dockerImageVersion\n    \n    commit edd9b06932e83c16c243999401fb395a6d290279\n    \n    fix assert being triggered on no stream.connection, as v2.1 streams use\n    a buffer peek stream, which did not have a connection object. Fixed by\n    setting the assert/timeout on the resp.connection instead.\n    \n    commit 34f21e87ac8c037ea6bc1f1ed31c918bbfa3b586\n    \n    add stub (empty) migration files, as needed for `sdcadm update`\n    \n    commit eea5c67e02d8dbb346f3a23f2993bef411485784\n    \n    drop old migration scripts"},{"timestamp":1493759189,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494298008,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 9."},{"timestamp":1494298010,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit 127c324a22d41037e31c0a4b51d75bf309da755d\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027"},{"timestamp":1494298036,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494389484,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 10."},{"timestamp":1494389485,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit f4480f1bd8635e6475c6044a3ec4fb0716e9f9fa\n    \n    move imgapi docker pieces into separate docker.js file"},{"timestamp":1494389527,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494457508,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 10:\n\n(2 comments)"},{"timestamp":1494531147,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1494531154,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 11."},{"timestamp":1494531155,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 0f7980b81c6830bf0668a960351908eb814c49a0\n    \n    correct ImageFileTooBigError constructor naming"},{"timestamp":1494531187,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1494531202,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 12."},{"timestamp":1494531203,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit 3f0b20681e1ed18aac94af90c585640e5fe3d5c8\n    \n    correct ImageFileTooBigError constructor naming\n    \n    commit f4480f1bd8635e6475c6044a3ec4fb0716e9f9fa\n    \n    move imgapi docker pieces into separate docker.js file\n    \n    commit 127c324a22d41037e31c0a4b51d75bf309da755d\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit 3fb4b17e0547ac81a7bf9f06a876dd851cbf6f95\n    \n    use assert.uuid rather than assert.string\n    \n    commit 3046ebbf03d1e329b2af4393f0abc101917a73eb\n    \n    use magic.maxMagicLen for exported name\n    \n    commit 3c9227c03cfa401e497e03806e7636e343725e71\n    \n    rename importImage function to importLayer\n    \n    commit d05aa6a1eee3ba9664b0d1563d5a04be3f17c969\n    \n    error on unexpected docker manifest.schemaVersion\n    \n    commit 35a502a45af12744ff792fb56f301d49306092bb\n    \n    update variable names, comments and drop unused loopErr code\n    \n    commit 151bec7c5e6388dfb04258d971cc20d72cddd266\n    \n    update function doc comments, add comment for faking layers\n    \n    commit 89401cde3c9df2987276736fc90710a3ba313fd8\n    \n    update variable scoping and error messaging\n    \n    commit 784eb94fb0cef8eba0695cc08cdedcab525edd27\n    \n    use ImageFileTooBigError for large image files\n    \n    commit 6a58f3fc745ee19947709cd2be54a6b6f34170e5\n    \n    update comments, variable names and function names, limit variable scoping\n    \n    commit 84606088cd32ff87f2aee4a40db74b8be2851ea3\n    \n    replace ctx.upconvertV21Manifest with ctx.dockerImageVersion\n    \n    commit edd9b06932e83c16c243999401fb395a6d290279\n    \n    fix assert being triggered on no stream.connection, as v2.1 streams use\n    a buffer peek stream, which did not have a connection object. Fixed by\n    setting the assert/timeout on the resp.connection instead.\n    \n    commit 34f21e87ac8c037ea6bc1f1ed31c918bbfa3b586\n    \n    add stub (empty) migration files, as needed for `sdcadm update`\n    \n    commit eea5c67e02d8dbb346f3a23f2993bef411485784\n    \n    drop old migration scripts\n    \n    commit d64375eb6ded9e11f778f8079e7df40fa5d13156\n    \n    update imgmanifest git reference\n    \n    commit 987c505e06d4550f22a92d1159851da88f4fdbfe\n    \n    Update copyright dates\n    \n    commit 10a9353d7f3263582d77dc11d91d9351c1c3cc3d\n    \n    merge in docker retries code\n    \n    commit 2cc7c0b66ad79ebcb79ff6e40879877591915e86\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit 0876abbc9ac5d5727b377a01322eec6c54b76fb0\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1494531239,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494628271,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 12: Code-Review+1"},{"timestamp":1499276270,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 13."},{"timestamp":1499276272,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit 4f3fee42e6a02d1d9b0dc84b777ba3399670e392\n    \n    only copy across files[0].digest and files[0].uncompressedDigest to the new\n    image, to avoid overwriting the files[0] object\n    \n    commit 5873f2d00cc462abfd77f1c69bb7b87c4535c8c1\n    \n    docs: describe JSON event messages for docker create image\n    \n    commit 98e78edf7060e74549b5b359ddf3c5375c0e86a9\n    \n    only allow file.digest and file.uncompressedDigest in updateImage calls\n    \n    commit 6afdd333a6bf4e30d891bbf439e5b520ad3c83ec\n    \n    docs: document new files.0.digest and files.0.uncompressedDigest fields\n    \n    commit beb87d30468e0c90bb6294e16c886f2530ad9446\n    \n    rename \u0027sha256\u0027 to \u0027fileDigest\u0027\n    \n    commit d17a434b5a1d658f8023122b5aab3a1c4fe1dbac\n    \n    rename \u0027uncompressedSha256\u0027 to \u0027uncompressedDigest\u0027\n    \n    commit 9ed4689e0fb9a4ce4ed9086613f19a06348556a7\n    \n    add change entry for docker images v2 work\n    \n    commit 3e3f0a8c75cb59cb18e8e86e1a95a982aeb5a23b\n    \n    correct ImageFileTooBigError constructor naming\n    \n    commit cdec5e80ead93b98d13b2b4ae5c02cae1bf3262a\n    \n    move imgapi docker pieces into separate docker.js file\n    \n    commit c329f150a7c8b2d0c367724786e40d53cd8b7c76\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit d7fc4cd8fb714e0109c7e8a935602cf5aca2e56c\n    \n    use assert.uuid rather than assert.string\n    \n    commit cd20791a01e6a45014c9785611cfc5189746bb23\n    \n    use magic.maxMagicLen for exported name\n    \n    commit 50fa9cca1e17ac0b49579adb858d3b6bd377ba15\n    \n    rename importImage function to importLayer\n    \n    commit 88159a2f1134b8d39a1e7812df53ce308db67dce\n    \n    error on unexpected docker manifest.schemaVersion\n    \n    commit fa92c7a6fbab95010895dd92e181a42145f73ed9\n    \n    update variable names, comments and drop unused loopErr code\n    \n    commit bb3422545efa49515967f2495a93612e78465262\n    \n    update function doc comments, add comment for faking layers\n    \n    commit 6caa0461e565697528836b36d717f0011f14532c\n    \n    update variable scoping and error messaging\n    \n    commit 98f020428c8216d6003a62c4a7ccc227d26b4146\n    \n    use ImageFileTooBigError for large image files\n    \n    commit ddeb56bf99639862460d4d20cd19a9e709786421\n    \n    update comments, variable names and function names, limit variable scoping\n    \n    commit 44d4bf19a78b5ebd77e0301993437ac6a1fd91e3\n    \n    replace ctx.upconvertV21Manifest with ctx.dockerImageVersion\n    \n    commit 6ed1e5ea36a734ddd5f3c0b9b3fc217127641612\n    \n    fix assert being triggered on no stream.connection, as v2.1 streams use\n    a buffer peek stream, which did not have a connection object. Fixed by\n    setting the assert/timeout on the resp.connection instead.\n    \n    commit 60b463fc9deeaf3642ac476f491019c3a485331e\n    \n    add stub (empty) migration files, as needed for `sdcadm update`\n    \n    commit a988804b4a476066d8e673d66ef146e951bdfdbb\n    \n    drop old migration scripts\n    \n    commit ef151d1454a29e612276a2501111833a35cbfbc1\n    \n    update imgmanifest git reference\n    \n    commit c4ea1c99b49849278db8071f257ca9c8c5bae1f4\n    \n    Update copyright dates\n    \n    commit 59ef7bc4f8aa84d3d6e62a8b07d779663c3e7de6\n    \n    merge in docker retries code\n    \n    commit 1ab302eb28ced0daa70d02532bcc2a5578089a3c\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit 0b5b938d10a0e84391bc560da00bcc33da8b7846\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1499276296,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500075589,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 13: Code-Review+1"},{"timestamp":1500079046,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 14: Patch Set 13 was rebased."},{"timestamp":1500079048,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 14:\n\nNew commits:\n    \n    commit 8af47b760377e00d565e6bd6745b060921f6aac1\n    \n    only copy across files[0].digest and files[0].uncompressedDigest to the new\n    image, to avoid overwriting the files[0] object\n    \n    commit 80291aaee789692f93c89c5add6a6cabb8a3ed19\n    \n    docs: describe JSON event messages for docker create image\n    \n    commit d252877e365dad3f3d29435c249db1fcbae0bed4\n    \n    only allow file.digest and file.uncompressedDigest in updateImage calls\n    \n    commit b73179f4703551e0fed48398277d4ff55bbd4351\n    \n    docs: document new files.0.digest and files.0.uncompressedDigest fields\n    \n    commit a961c6710240a76a954fdbbfd4ec2963ec0adffc\n    \n    rename \u0027sha256\u0027 to \u0027fileDigest\u0027\n    \n    commit 6045fbdace885585f0fa889e07755b79a70dbc12\n    \n    rename \u0027uncompressedSha256\u0027 to \u0027uncompressedDigest\u0027\n    \n    commit e535896872b1122771e011bd5ee9420b123a2b95\n    \n    add change entry for docker images v2 work\n    \n    commit 2a338ba213c1668b37a6bfdcb917f84d69534653\n    \n    correct ImageFileTooBigError constructor naming\n    \n    commit dd2d99cbfd5876270beaebb460b331e1a2836da7\n    \n    move imgapi docker pieces into separate docker.js file\n    \n    commit e36d425259379e125362df904b680249afd3764d\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit 81614ea79329257b0b7c7bc668bb5ef24614d06c\n    \n    use assert.uuid rather than assert.string\n    \n    commit 83c623e4cef3bd4799c300905028b6e3efd5b1c9\n    \n    use magic.maxMagicLen for exported name\n    \n    commit 4b7feceed56d3afec72d3d068f5aef782927fd51\n    \n    rename importImage function to importLayer\n    \n    commit 0ff568b1b383d5203f9d5d6db556923e8354f573\n    \n    error on unexpected docker manifest.schemaVersion\n    \n    commit 58d848c024421187b5a2b7cfceb5e4dfdf2e7abc\n    \n    update variable names, comments and drop unused loopErr code\n    \n    commit afa483229c3079bc1dc0000c6ab40366b3774737\n    \n    update function doc comments, add comment for faking layers\n    \n    commit 11d66b5b5a9b8cb8bb7cb54257b6f3fcc7ed28fe\n    \n    update variable scoping and error messaging\n    \n    commit 18f8fcdabed5f76aebb8f7be0b810145e88ea0ae\n    \n    use ImageFileTooBigError for large image files\n    \n    commit 2370af5f5dddfd9628d2897c557c6249495a349d\n    \n    update comments, variable names and function names, limit variable scoping\n    \n    commit 890efa3565c32d39bf746fff43c4c5dcc21df65e\n    \n    replace ctx.upconvertV21Manifest with ctx.dockerImageVersion\n    \n    commit dee1b4eb504487d2710346e06756f92142ef1be9\n    \n    fix assert being triggered on no stream.connection, as v2.1 streams use\n    a buffer peek stream, which did not have a connection object. Fixed by\n    setting the assert/timeout on the resp.connection instead.\n    \n    commit 9117a1b55a5c02c0a84ebf33b2baa89f9eb4eff6\n    \n    add stub (empty) migration files, as needed for `sdcadm update`\n    \n    commit dcb0af77886bd6898ca09d6393259c954fab8f52\n    \n    drop old migration scripts\n    \n    commit 7041b05cb57331e61867dc8405512df7a02fd469\n    \n    update imgmanifest git reference\n    \n    commit 6e597a52a3af45f934bb0032eaccb6aabfa14aff\n    \n    Update copyright dates\n    \n    commit f8c2401f405a8c20f25f5d5700eeda4743855b8b\n    \n    merge in docker retries code\n    \n    commit dcac94171caba6473009e10a5517dcf75eb11430\n    \n    DOCKER-929 Don\u0027t JSON serialize the config in pretty mode\n    \n    commit 86bd1e57fef86ad015dd0e5b0d84fc297071ad37\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1500079088,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14:\n\n\"make check\" passed ok"},{"timestamp":1500655186,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 15."},{"timestamp":1500655187,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 15:\n\nNew commits:\n    \n    commit c99677f997868fa0614a5958ee64ed2b8912f9f0\n    \n    update node-imgmanifest package to 3.0.0"},{"timestamp":1500655214,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500918152,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 15: Code-Review+1 Integration-Approval+1"},{"timestamp":1500918600,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 16: Commit message was updated."},{"timestamp":1500919417,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"16","revision":"0cfc60b4d3775607f697452cf4c08761f95876b0","parents":["3119a0b7c8b479faec78a8a46644f8b509fc5f86"],"ref":"refs/changes/48/1348/16","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500918600,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500655214,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1500919417,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":36,"deletions":-13},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1679,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":161,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":2000,"sizeDeletions":-2930},"patchSets":[{"number":"1","revision":"ecfd4b8c3a0ebaf52736f37d9ff24ad7ce3e9a5a","parents":["f6c069cfb438086206ef34206e322e8dab18973a"],"ref":"refs/changes/48/1348/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1485464748,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485464785,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":971,"deletions":-555},{"file":"lib/magic.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/storage.js","type":"MODIFIED","insertions":73,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1049,"sizeDeletions":-557},{"number":"2","revision":"ea0f730d0318eeb1d67db6cd6a9f9fd3602a91cf","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/48/1348/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1486169074,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485464785,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":971,"deletions":-555},{"file":"lib/magic.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/storage.js","type":"MODIFIED","insertions":73,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1049,"sizeDeletions":-557},{"number":"3","revision":"44b9f6a5ad7d08307e9b6101fdd30881fd6e97bf","parents":["36d59a79372fc57a0e15841b4acb47995bfa9df0"],"ref":"refs/changes/48/1348/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489120379,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489120417,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1079,"deletions":-679},{"file":"lib/magic.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/storage.js","type":"MODIFIED","insertions":73,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1157,"sizeDeletions":-681},{"number":"4","revision":"363bc53f3d4d72e66fcd234e1eec0fbf88d326a1","parents":["36d59a79372fc57a0e15841b4acb47995bfa9df0"],"ref":"refs/changes/48/1348/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489120898,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489120931,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/images.js","type":"MODIFIED","insertions":1079,"deletions":-679},{"file":"lib/magic.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/storage.js","type":"MODIFIED","insertions":73,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":5,"deletions":-4}],"sizeInsertions":1164,"sizeDeletions":-684},{"number":"5","revision":"b8a1f5debf681298e21f7868cf0bec6ee05cabc7","parents":["7afff7d601d2f40e0abd150caa0d885a0521978c"],"ref":"refs/changes/48/1348/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489121547,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489121601,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/images.js","line":310,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I dont\u0027 understand. Perhaps reword this?"},{"file":"lib/images.js","line":310,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":318,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Missing mention of `file.stor`"},{"file":"lib/images.js","line":318,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":323,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: Perhaps \u0027moveFileToImage\u0027?"},{"file":"lib/images.js","line":323,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2544,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This was already done above at line 2515, right?"},{"file":"lib/images.js","line":2544,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2570,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"XXX is there a resMessage about the error downloading this layer?"},{"file":"lib/images.js","line":2570,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"There is, but it\u0027s done by sdc-docker. Errors are passed back to sdc-docker (via the workflow). Sdc-docker converts the error and sends an \u0027error\u0027 resMessage."},{"file":"lib/images.js","line":2575,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"XXX the dropped \u0027data\u0027 resMessage here: is that below? or was is cruft?"},{"file":"lib/images.js","line":2575,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It\u0027s replaced by the \u0027create-docker-image\u0027 resMessage, but that is only sent after all the layers have been downloaded successfully.\n\nNote that there is only one docker_images_v2 entry, compared to docker_images(_v1) which had one entry for each layer."},{"file":"lib/images.js","line":2740,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps update var to \"progLastUpdate\"."},{"file":"lib/images.js","line":2740,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2744,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"These 3 could be scoped to inside the `finish_` function, right?"},{"file":"lib/images.js","line":2744,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, sha1 and sha256 can be moved in the finish_ function. Size is needed outside that scope, as it\u0027s updated in the on(\u0027data\u0027) listener."},{"file":"lib/images.js","line":2749,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps update var to \"progUpdateEvery\". Then it and \"projLastUpdate\" are defined together and more obviously related.\n\nBasically I\u0027m going to have a few nits about var names, to try to help grok all that is going on. There are LOTS of vars in here, and lots of \"configs\" and \"manifests\" and \"images\". I\u0027m hoping some tweaking of var names can help clarify."},{"file":"lib/images.js","line":2749,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2759,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Yes, a new error class sounds reasonable to me, say \"ImageFileTooBigError\". Having a comment here stating that \"DownloadError\" is intentionally not used to have it NOT retry would be good."},{"file":"lib/images.js","line":2759,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2764,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"s/size/fileSize/, right?"},{"file":"lib/images.js","line":2764,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2822,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"IIUC, this will just leave a temp file around, rig\nht? We have another ticket to periodically clean up those files. I.e. leaving this is fine."},{"file":"lib/images.js","line":2822,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"OK."},{"file":"lib/images.js","line":2827,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps reword this to use \"digest\" instead of hash? \n\nSomething like: \n\"layer digest does not match: got %s, expected %s\","},{"file":"lib/images.js","line":2827,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":2857,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Move defining these to the top-of-function block of var\u0027s?"},{"file":"lib/images.js","line":2857,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3133,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Func should have \"Docker\" in the name. Or move to a \"docker.js\" file (see next comment as well)."},{"file":"lib/images.js","line":3167,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Or perhaps start moving docker-specific functiosn to a separate docker.js file. We know images.js is already way too big."},{"file":"lib/images.js","line":3167,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Will do - after reviewing other changes."},{"file":"lib/images.js","line":3242,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"cruft to remove"},{"file":"lib/images.js","line":3242,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3243,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"doc comment for this function please"},{"file":"lib/images.js","line":3243,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3268,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Why checking layer.imgManifest if not using it in this function? Perhaps I\u0027m getting lost in the data structures."},{"file":"lib/images.js","line":3268,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I\u0027ll add a comment - it\u0027s in the case the image file/layer has already been downloaded (i.e. we have the information we need even though this is a v2.1 docker image)."},{"file":"lib/images.js","line":3346,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is \"imgJson\" equiv to the docker image \"config\" v2.2? I think it is, but want to make sure. If so I wonder about renaming the var to \"config\", or \"dimgConfig\" or something (where \"dimg\" would be for \"Docker image\", to differentiate with \"img\" for \"IMGAPI image\" variables). I know we\u0027ve used imgJson in the past, so this doesn\u0027t need to be added as work for this change."},{"file":"lib/images.js","line":3346,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Agree - I was using imgJson as that was previously used - but it\u0027s sure confusing, so changing to dockerImageConfig (or abbrev) would be better.\n\nI think should occur later as a separate commit/change (across docker-build, sdc-docker and imgapi)."},{"file":"lib/images.js","line":3353,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could layerDigests\u0027 definition be moved to determineLayers()?"},{"file":"lib/images.js","line":3353,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, done."},{"file":"lib/images.js","line":3459,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This is vestigial? The var isn\u0027t set anywhere."},{"file":"lib/images.js","line":3459,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, removed."},{"file":"lib/images.js","line":3462,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"What is the \"barebones imgJson\"? Oh I recall. Perhaps link to https://github.com/docker/distribution/blob/master/docs/spec/manifest-v2-2.md#backward-compatibility and use the term \"synthetic layer config\" as they do there."},{"file":"lib/images.js","line":3462,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3523,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps rename to \"nextLayer\""},{"file":"lib/images.js","line":3523,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3598,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"We should double-check that \u0027binary\u0027 is correct there if/when non-ascii chars are in play. E.g. see TOOLS-1592 snafu."},{"file":"lib/images.js","line":3598,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, it has to be binary, otherwise our sha256 will not equal docker\u0027s when the manifest contains non-ascii (already hit that issue earlier with docker build)."},{"file":"lib/images.js","line":4026,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Does it have manifestV2.schemaVersion\u003d\u003d\u003d1 for V2.1? Or is there just no schemaVersion value? I\u0027m wondering if we should explicitly error out here if there is an unexpected value here (e.g. for a theoretical future schemaVersion\u003d\u003d\u003d3 or whatever)."},{"file":"lib/images.js","line":4026,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, it does have schemaVersion \u003d\u003d 1, and yes it would be better to error out when an unexpected version arrives."},{"file":"lib/images.js","line":5149,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"It would be preferable to encode this \"image must be unactivated\" in a const above."},{"file":"lib/images.js","line":5149,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Not sure what you mean here?"},{"file":"lib/images.js","line":5149,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Me neither. :)"},{"file":"lib/images.js","line":5158,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could sha256 and uncompressedSha256 be added when AddImageFile is called?  I\u0027m curious if/how/when the old \"sha1\" field is added."},{"file":"lib/images.js","line":5158,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"The sha256 could be done inside of apiAddImageFile (like sha1 currently is).\n\nThe uncompressedSha256 doesn\u0027t make as much sense (in terms of performance), as docker build is the one doing the compression (so it can easily calculate the uncompressed sha prior to doing the compression), whereas IMGAPI would need to uncompress the contents again in order to calculate it.\n\nMy XXX was to *restrict* updates on _image.files[0] to only be the sha256 and uncompressedSha256 fields, i.e. not sha1, size and friends."},{"file":"lib/images.js","line":5194,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Change var name to \"isUuidChange\" or \"isUuidUpdate\". \"Rename\" is potentially confusing with the \"name\" field being updated."},{"file":"lib/images.js","line":5194,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/magic.js","line":90,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: I\u0027d call the export and the internal var the same thing. Pick one name."},{"file":"lib/magic.js","line":90,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":455,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"assert.uuid perhaps?"},{"file":"lib/storage.js","line":455,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":457,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"ditto"},{"file":"lib/storage.js","line":457,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":761,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"assert.uuid"},{"file":"lib/storage.js","line":761,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":763,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"assert.uuid"},{"file":"lib/storage.js","line":763,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1080,"deletions":-680},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1160,"sizeDeletions":-684},{"number":"6","revision":"00c2afd783475b33d5fed2772f764108d7b007cf","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1492623110,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489121601,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1080,"deletions":-680},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1160,"sizeDeletions":-684},{"number":"7","revision":"8cf1818e8415ce17fcb80eed85528119b9b106ba","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/7","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1492623361,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492623415,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1080,"deletions":-680},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1160,"sizeDeletions":-684},{"number":"8","revision":"f1354a5c5c85b64816d0d97c94fe55f8a09e2fd4","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/8","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1493759151,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493759189,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1091,"deletions":-682},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1195,"sizeDeletions":-2247},{"number":"9","revision":"72af6afd0151170f966d969f7197d38654d132b0","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/9","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1494298008,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494298036,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1091,"deletions":-682},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1195,"sizeDeletions":-2247},{"number":"10","revision":"ebb83e81990920d572de104c521a0191721f4486","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/10","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1494389484,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494389527,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":260,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"5x  s/DownloadError/ImageFileTooBigError/"},{"file":"lib/errors.js","line":260,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1685,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":132,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1933,"sizeDeletions":-2917},{"number":"11","revision":"4a257e7f3bd29b741de6c5cb483971508cc3b2a7","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/11","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1494531154,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1494531187,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":260,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"line \u003e 80 characters"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1685,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":132,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1933,"sizeDeletions":-2917},{"number":"12","revision":"be7f2a876c1942224581ea1d16c681f9a528469e","parents":["cd38df37e8a03efd044e21b40c648a69b8e525ee"],"ref":"refs/changes/48/1348/12","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1494531202,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494531239,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1494628271,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1685,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":132,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":1934,"sizeDeletions":-2917},{"number":"13","revision":"e075c4c7f6ad5d02e3e42b6165e6838f3cb127f7","parents":["169bba6231ee2a816898b0a6d3c082d555f8d1be"],"ref":"refs/changes/48/1348/13","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1499276270,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1499276296,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500075589,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":36,"deletions":-13},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1679,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":161,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":2000,"sizeDeletions":-2930},{"number":"14","revision":"a6a94e812ff87d7674f600b93d4dd6de86743713","parents":["3119a0b7c8b479faec78a8a46644f8b509fc5f86"],"ref":"refs/changes/48/1348/14","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500079046,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1499276296,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500075589,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":36,"deletions":-13},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1679,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":161,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":2000,"sizeDeletions":-2930},{"number":"15","revision":"613e1f91f43b4fe0d60cbbf0e4a1e82d1a8245ca","parents":["3119a0b7c8b479faec78a8a46644f8b509fc5f86"],"ref":"refs/changes/48/1348/15","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500655186,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500655214,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":36,"deletions":-13},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1679,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":161,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":2000,"sizeDeletions":-2930},{"number":"16","revision":"0cfc60b4d3775607f697452cf4c08761f95876b0","parents":["3119a0b7c8b479faec78a8a46644f8b509fc5f86"],"ref":"refs/changes/48/1348/16","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500918600,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500655214,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500918152,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1500919417,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":36,"deletions":-13},{"file":"lib/constants.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/docker.js","type":"ADDED","insertions":1679,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":161,"deletions":-1352},{"file":"lib/magic.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/migrations/migration-008-new-storage-layout.js","type":"MODIFIED","insertions":1,"deletions":-335},{"file":"lib/migrations/migration-009-backfill-archive.js","type":"MODIFIED","insertions":1,"deletions":-312},{"file":"lib/migrations/migration-010-backfill-billing_tags.js","type":"MODIFIED","insertions":1,"deletions":-229},{"file":"lib/migrations/migration-011-backfill-published_at.js","type":"MODIFIED","insertions":1,"deletions":-241},{"file":"lib/migrations/migration-012-update-docker-image-uuids.js","type":"MODIFIED","insertions":1,"deletions":-444},{"file":"lib/storage.js","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":2000,"sizeDeletions":-2930}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}