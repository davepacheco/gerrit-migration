commit 68e5479a70fcf7f243e114333142b61232d9b6e5 (refs/changes/64/4764/2)
Author: Mike Gerdts <mike.gerdts@joyent.com>
Date:   2018-08-29T19:53:29+00:00 (1 year, 1 month ago)
    
    OS-7145 lx audit misses bounds check

diff --git a/usr/src/uts/common/brand/lx/os/lx_audit.c b/usr/src/uts/common/brand/lx/os/lx_audit.c
index 65b8d35e41..6f82c079c2 100644
--- a/usr/src/uts/common/brand/lx/os/lx_audit.c
+++ b/usr/src/uts/common/brand/lx/os/lx_audit.c
@@ -862,6 +862,9 @@ lx_audit_syscall_exit(int sysnum, long ret)
 	if (lxzd->lxzd_audit_enabled == LXAE_DISABLED)
 		return;
 
+	if (sysnum >= LX_NSYSCALLS)
+		return;
+
 	asp = lxzd->lxzd_audit_state;
 	ASSERT(asp != NULL);
 
