{"project":"joyent/sdcadm","branch":"master","id":"I3a87f3d6270cd478d9bd492c6ba698992d4f8ff9","number":"3972","subject":"TRITON-391 Get rid of sdcadm history Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Approved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/3972","commitMessage":"TRITON-391 Get rid of sdcadm history\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nApproved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1526654164,"lastUpdated":1526828099,"open":false,"status":"MERGED","comments":[{"timestamp":1526654164,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1526654170,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 55ea4849db5d9d36d8fafdf809d9fc8c859ed415\n    \n    TRITON-391 Get rid of sdcadm history"},{"timestamp":1526654199,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526663122,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1526663128,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 6a28093ff59cbf74c8ee3a9a705694d3d2ae0829\n    \n    TRITON-391 Get rid of sdcadm history"},{"timestamp":1526663160,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1526805513,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1526809888,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1526809893,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit c04dc59251f2c4c0cbe27e6cb2c79465d25ec7b3\n    \n    TRITON-391 Get rid of sdcadm history"},{"timestamp":1526809900,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(2 comments)\n\nDone with some minor changes."},{"timestamp":1526809925,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526810410,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1526828079,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1526828099,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"3a87f3d6270cd478d9bd492c6ba698992d4f8ff9","parents":["65db9afe341b272c1aa7098502cccfecbaa10cd6"],"ref":"refs/changes/72/3972/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1526828079,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526809925,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1526828099,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/cli/do_history.js","type":"DELETED","insertions":0,"deletions":-204},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":3,"deletions":-39},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":3,"deletions":-42},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":1,"deletions":-43},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/history.js","type":"DELETED","insertions":0,"deletions":-546},{"file":"lib/platform.js","type":"MODIFIED","insertions":13,"deletions":-147},{"file":"lib/post-setup/cloudapi.js","type":"MODIFIED","insertions":5,"deletions":-62},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":7,"deletions":-41},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":3,"deletions":-36},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":2,"deletions":-45},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":6,"deletions":-158},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":1,"deletions":-59},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/history.test.js","type":"DELETED","insertions":0,"deletions":-266}],"sizeInsertions":50,"sizeDeletions":-1692},"patchSets":[{"number":"1","revision":"52417a8e74f113ed9e620ecaeda37835e6414d15","parents":["a968cbeede4bff9f4c2b3f3603d029f2db13b929"],"ref":"refs/changes/72/3972/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1526654164,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526654199,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/cli/do_history.js","type":"DELETED","insertions":0,"deletions":-204},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":3,"deletions":-39},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":3,"deletions":-42},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":1,"deletions":-43},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/history.js","type":"DELETED","insertions":0,"deletions":-546},{"file":"lib/platform.js","type":"MODIFIED","insertions":11,"deletions":-148},{"file":"lib/post-setup/cloudapi.js","type":"MODIFIED","insertions":5,"deletions":-62},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":5,"deletions":-41},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":3,"deletions":-36},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":2,"deletions":-45},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":6,"deletions":-158},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":1,"deletions":-59},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/history.test.js","type":"DELETED","insertions":0,"deletions":-266}],"sizeInsertions":46,"sizeDeletions":-1693},{"number":"2","revision":"38721f63c52c3866b95ba424e1bf160c793c7622","parents":["65db9afe341b272c1aa7098502cccfecbaa10cd6"],"ref":"refs/changes/72/3972/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1526663122,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526654199,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/platform.js","line":1279,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This was filled in the removed saveChangesToHistory()."},{"file":"lib/platform.js","line":1279,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Good catch!"},{"file":"lib/post-setup/ha-binder.js","line":701,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Several of these files have the reverse pattern from usual. I suggest they be changed to the typical if (err) check at the top of the func."},{"file":"lib/post-setup/ha-binder.js","line":701,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Honestly, I\u0027d pretty much get rid of the progress messages. Anyway, I don\u0027t think we should move to the err check at the top of the funcs on these cases. While the pattern is not the most widely used, it\u0027s in use in several places like NFS Volumes, manatee setup, volapi ... I\u0027d go for what it\u0027s needed even if it\u0027s not the most common pattern."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/cli/do_history.js","type":"DELETED","insertions":0,"deletions":-204},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":3,"deletions":-39},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":3,"deletions":-42},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":1,"deletions":-43},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/history.js","type":"DELETED","insertions":0,"deletions":-546},{"file":"lib/platform.js","type":"MODIFIED","insertions":11,"deletions":-148},{"file":"lib/post-setup/cloudapi.js","type":"MODIFIED","insertions":5,"deletions":-62},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":5,"deletions":-41},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":3,"deletions":-36},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":2,"deletions":-45},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":6,"deletions":-158},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":1,"deletions":-59},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/history.test.js","type":"DELETED","insertions":0,"deletions":-266}],"sizeInsertions":46,"sizeDeletions":-1693},{"number":"3","revision":"c67f7b457e954cc337fa78cc48c281ac03b74b9b","parents":["65db9afe341b272c1aa7098502cccfecbaa10cd6"],"ref":"refs/changes/72/3972/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1526809888,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526809925,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/cli/do_history.js","type":"DELETED","insertions":0,"deletions":-204},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":3,"deletions":-39},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":3,"deletions":-42},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":1,"deletions":-43},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/history.js","type":"DELETED","insertions":0,"deletions":-546},{"file":"lib/platform.js","type":"MODIFIED","insertions":13,"deletions":-147},{"file":"lib/post-setup/cloudapi.js","type":"MODIFIED","insertions":5,"deletions":-62},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":7,"deletions":-41},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":3,"deletions":-36},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":2,"deletions":-45},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":6,"deletions":-158},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":1,"deletions":-59},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/history.test.js","type":"DELETED","insertions":0,"deletions":-266}],"sizeInsertions":50,"sizeDeletions":-1692},{"number":"4","revision":"3a87f3d6270cd478d9bd492c6ba698992d4f8ff9","parents":["65db9afe341b272c1aa7098502cccfecbaa10cd6"],"ref":"refs/changes/72/3972/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1526828079,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526809925,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1526828099,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526810410,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/cli/do_history.js","type":"DELETED","insertions":0,"deletions":-204},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":3,"deletions":-39},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":3,"deletions":-42},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":1,"deletions":-43},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/history.js","type":"DELETED","insertions":0,"deletions":-546},{"file":"lib/platform.js","type":"MODIFIED","insertions":13,"deletions":-147},{"file":"lib/post-setup/cloudapi.js","type":"MODIFIED","insertions":5,"deletions":-62},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":7,"deletions":-41},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":3,"deletions":-36},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":2,"deletions":-45},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":6,"deletions":-158},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":1,"deletions":-59},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/history.test.js","type":"DELETED","insertions":0,"deletions":-266}],"sizeInsertions":50,"sizeDeletions":-1692}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}