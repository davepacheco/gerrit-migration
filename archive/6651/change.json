{"project":"joyent/illumos-joyent","branch":"master","id":"Id9a5c916025d7e371ecdf44ba0357404ffa47f24","number":"6651","subject":"OS-7904 simnet has bogus mi_tx_cksum_flags OS-7905 mac_tx() is too eager to emulate hardware offloads Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Robert Mustacchi \u003crm@joyent.com\u003e","owner":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"url":"https://cr.joyent.us/6651","commitMessage":"OS-7904 simnet has bogus mi_tx_cksum_flags\nOS-7905 mac_tx() is too eager to emulate hardware offloads\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1564078045,"lastUpdated":1565321343,"open":false,"status":"MERGED","comments":[{"timestamp":1564078045,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 1."},{"timestamp":1564080356,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1565302367,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 2."},{"timestamp":1565302429,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 3."},{"timestamp":1565302595,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1565311656,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1565312531,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 3:\n\nTesting notes added to ticket."},{"timestamp":1565312836,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1565321222,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1565321330,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1565321343,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Ryan Zezeski"}],"currentPatchSet":{"number":"5","revision":"d9a5c916025d7e371ecdf44ba0357404ffa47f24","parents":["c39031a3421e673ff9e264ef429b207fcde1896c"],"ref":"refs/changes/51/6651/5","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1565321330,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565311656,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1565312836,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1565321343,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":48,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"4db8b614926ebee81a785cb070669c437cad3201","parents":["3d280bd5aa877a68b01b0b5dc7cb0f92843e8b41"],"ref":"refs/changes/51/6651/1","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1564078045,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/mac/mac_provider.c","line":1017,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we note somewhere that we\u0027re assuming that the caller has entered the mac perimeter and update the comment uts/common/sys/mac_impl.h about the locking appropriately?"},{"file":"usr/src/uts/common/io/mac/mac_provider.c","line":1017,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I had failed to consider the perimeter at all. As I thought about it more I realize this was the wrong function/context to update the field in since I\u0027m not sure all consumers are going to call it wit the perimeter held. Instead, based on some comments in the mac.c big theory statement, it seemed best to move this update into the notification thread where we can appropriately grab the perimeter."},{"file":"usr/src/uts/common/io/mac/mac_provider.c","line":1017,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, thanks for thinking through this and updating this."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":23,"sizeDeletions":-4},{"number":"2","revision":"983dd40a447298107280ea3ff47cff05af6a1a11","parents":["3d280bd5aa877a68b01b0b5dc7cb0f92843e8b41"],"ref":"refs/changes/51/6651/2","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1565302367,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":47,"sizeDeletions":-5},{"number":"3","revision":"e71d62a107fc6a8f2da66e81d4b2b662911802ac","parents":["3d280bd5aa877a68b01b0b5dc7cb0f92843e8b41"],"ref":"refs/changes/51/6651/3","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1565302429,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565311656,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1565312836,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":48,"sizeDeletions":-6},{"number":"4","revision":"cb1174069aef5dcf8220e92d5b48bd5a5e50f4e7","parents":["c39031a3421e673ff9e264ef429b207fcde1896c"],"ref":"refs/changes/51/6651/4","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1565321222,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565311656,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1565312836,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":48,"sizeDeletions":-6},{"number":"5","revision":"d9a5c916025d7e371ecdf44ba0357404ffa47f24","parents":["c39031a3421e673ff9e264ef429b207fcde1896c"],"ref":"refs/changes/51/6651/5","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1565321330,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565311656,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1565312836,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1565321343,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/pattr.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":48,"sizeDeletions":-6}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}]}