{"project":"joyent/sdc-volapi","branch":"master","id":"I66f733b1695af6bbaaf5dd8c1bfe924abcdfb239","number":"2412","subject":"VOLAPI-72 creating volume with unsupported size should result in error, not in volume being created with closest matching size Reviewed by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e Approved by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e","owner":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"url":"https://cr.joyent.us/2412","commitMessage":"VOLAPI-72 creating volume with unsupported size should result in error, not in volume being created with closest matching size\nReviewed by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e\nApproved by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e\n","createdOn":1502845736,"lastUpdated":1503362821,"open":false,"status":"MERGED","comments":[{"timestamp":1502845736,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 1."},{"timestamp":1502845782,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1502908284,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 2."},{"timestamp":1502908311,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503000789,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\n(9 comments)"},{"timestamp":1503010290,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(7 comments)"},{"timestamp":1503010336,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 3."},{"timestamp":1503010363,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503013201,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\n(1 comment)\n\neverything except 2016 in  test/integration/nfs-shared-volumes-creation-size.test.js is awesome. :)"},{"timestamp":1503013244,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\nGerrit: demerit"},{"timestamp":1503017746,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 4."},{"timestamp":1503017777,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503353384,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1\n\nüëçüëçüëç"},{"timestamp":1503362814,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1503362821,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Julien Gilli"}],"currentPatchSet":{"number":"5","revision":"14f9474f8117606c93059136b05b341684d8ed84","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/5","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1503362814,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503017777,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1503362821,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":62,"deletions":-120},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":-2},{"file":"test/integration/invalid-parameters.test.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0},{"file":"test/integration/nfs-shared-volumes-list-volume-sizes.test.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":297,"sizeDeletions":-220},"patchSets":[{"number":"1","revision":"5ae62a107a7852f132481eb2f3d398d20ce035d8","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/1","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1502845736,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502845782,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":53,"deletions":-113},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0}],"sizeInsertions":262,"sizeDeletions":-208},{"number":"2","revision":"2ed994f3ddf8fa2bde6c961535ef8fcc7a13395f","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/2","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1502908284,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502908311,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503000789,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503000789,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"lib/endpoints/volumes.js","line":433,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"double indent? Or just Gerrit being Gerrit?"},{"file":"lib/endpoints/volumes.js","line":433,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"You\u0027re right, I don\u0027t know why I\u0027ve started double-indenting things randomly recdently :( Good catch!"},{"file":"lib/endpoints/volumes.js","line":442,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"again the indentation here looks like it gained a level."},{"file":"lib/endpoints/volumes.js","line":442,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I have the best indentation."},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","line":1,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"good riddance 2016 file!"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":8,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Oh no! The year... It\u0027s wrong! Like Salmon Mousse."},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":66,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"should we include a positive integer that we know is not one of the actual sizes, like 17? Or something like that?"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":66,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"\"invalid\" here means \"invalid format\". The next test about \"unavailable\" sizes takes care of the use case you\u0027re mentioning. If that\u0027s not clear enough, do you have any feedback on what changes I could make to make that clearer?"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":66,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"nope. that\u0027s fine. Sorry."},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":113,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"I don\u0027t know what\u0027s going on with indentation in this CR. Is it just my browser hating Gerrit?"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":113,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":177,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"so confused! Maybe this is because of tabs? Who\u0027d know? Tabs are invisible."},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":177,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":180,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"\""},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":180,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":183,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"\""},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","line":183,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":59,"deletions":-117},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"test/integration/invalid-parameters.test.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0}],"sizeInsertions":276,"sizeDeletions":-215},{"number":"3","revision":"b9b41052c464082fd6d90ff649010a27d4940d16","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/3","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1503010336,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503010363,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503013244,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503013244,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":61,"deletions":-118},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":-2},{"file":"test/integration/invalid-parameters.test.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0}],"sizeInsertions":293,"sizeDeletions":-216},{"number":"4","revision":"66f733b1695af6bbaaf5dd8c1bfe924abcdfb239","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/4","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1503017746,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503017777,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":62,"deletions":-120},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":-2},{"file":"test/integration/invalid-parameters.test.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0},{"file":"test/integration/nfs-shared-volumes-list-volume-sizes.test.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":297,"sizeDeletions":-220},{"number":"5","revision":"14f9474f8117606c93059136b05b341684d8ed84","parents":["45043547800ed3662321b5341aafdac2e384f860"],"ref":"refs/changes/12/2412/5","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1503362814,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503017777,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503353384,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1503362821,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":62,"deletions":-120},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":-2},{"file":"test/integration/invalid-parameters.test.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"test/integration/nfs-shared-volumes-creation-invalid-size.test.js","type":"DELETED","insertions":0,"deletions":-93},{"file":"test/integration/nfs-shared-volumes-creation-size.test.js","type":"ADDED","insertions":192,"deletions":0},{"file":"test/integration/nfs-shared-volumes-list-volume-sizes.test.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":297,"sizeDeletions":-220}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}]}