commit 78524e47a13dd68a6db1201859023f16338c3995 (refs/changes/54/1354/1)
Author: David Pacheco <dap@joyent.com>
Date:   2017-01-26T16:42:59-08:00 (2 years, 8 months ago)
    
    MANTA-3128 update electric-moray to Moray v3

diff --git a/lib/server.js b/lib/server.js
index 7975cf5..bff3b77 100644
--- a/lib/server.js
+++ b/lib/server.js
@@ -5,7 +5,7 @@
  */
 
 /*
- * Copyright (c) 2016, Joyent, Inc.
+ * Copyright (c) 2017, Joyent, Inc.
  */
 
 var assert = require('assert-plus');
@@ -743,8 +743,10 @@ function createClient(options, callback) {
                 log: options.log.child({
                     component: 'moray-client-' + pnodeUrl.hostname
                 }),
-                host: pnodeUrl.hostname,
-                port: parseInt(pnodeUrl.port, 10)
+                srvDomain: pnodeUrl.hostname,
+                cueballOptions: {
+                    defaultPort: parseInt(pnodeUrl.port, 10)
+                }
             });
 
             clientMap[pnode] = client;
diff --git a/package.json b/package.json
index 85792fb..03f618d 100644
--- a/package.json
+++ b/package.json
@@ -18,7 +18,7 @@
         "fast": "0.3.8",
         "ldapjs": "0.6.3",
         "imgapi-cli": "git+https://github.com/joyent/sdc-imgapi-cli.git#db3efc1",
-        "moray": "^2.0.0",
+        "moray": "^3.0.0",
         "node-uuid": "1.4.0",
         "posix-getopt": "^1.0.0",
         "vasync": "^1.4.3",
