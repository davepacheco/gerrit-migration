From 9c94df08b0fc09d1fd778c1e4810a5129276dda6 Mon Sep 17 00:00:00 2001
From: Tim Foster <tim.foster@joyent.com>
Date: Fri, 25 Oct 2019 17:07:05 +0100
Subject: [PATCH] OS-8034 smartos-live ucodecheck should allow hardlinks

---
 tools/ucodecheck/ucodecheck.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/tools/ucodecheck/ucodecheck.c b/tools/ucodecheck/ucodecheck.c
index 98bf4cc4..6b9be3b7 100644
--- a/tools/ucodecheck/ucodecheck.c
+++ b/tools/ucodecheck/ucodecheck.c
@@ -10,7 +10,7 @@
  */
 
 /*
- * Copyright (c) 2018, Joyent, Inc.
+ * Copyright 2019 Joyent, Inc.
  */
 
 /*
@@ -97,11 +97,11 @@ ucc_manifest_cb(manifest_ent_t *me, void *arg)
 	}
 
 	/*
-	 * The only entries we expect in here are files and the directory entry
+	 * The only entries we expect in here are files and links and the directory entry
 	 * themselves. If for some reason they exist, then we need to error and
 	 * figure out what happened.
 	 */
-	if (me->me_type != ME_TYPE_FILE) {
+	if (me->me_type != ME_TYPE_FILE && me->me_type != ME_TYPE_HARDLINK) {
 		if (me->me_type == ME_TYPE_DIRECTORY)
 			return (MECB_NEXT);
 
-- 
2.17.2 (Apple Git-113)

