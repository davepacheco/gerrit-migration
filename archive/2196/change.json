{"project":"joyent/node-manta","branch":"master","id":"Ia4c4ee8fa03b789fca6cd2cf555ad5eda426f718","number":"2196","subject":"joyent/node-manta#312 Custom header input should tolerate \u0027:\u0027 characters Reviewed by: Kody A Kantor \u003ckody.kantor@gmail.com\u003e Approved by: Kody A Kantor \u003ckody.kantor@gmail.com\u003e","owner":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"url":"https://cr.joyent.us/2196","commitMessage":"joyent/node-manta#312 Custom header input should tolerate \u0027:\u0027 characters\nReviewed by: Kody A Kantor \u003ckody.kantor@gmail.com\u003e\nApproved by: Kody A Kantor \u003ckody.kantor@gmail.com\u003e\n","createdOn":1499708432,"lastUpdated":1500329443,"open":false,"status":"MERGED","comments":[{"timestamp":1499708432,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 1."},{"timestamp":1499708434,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 1832da09c14431a8ac09278f57098034b75e74c7\n    \n    joyent/node-manta#312 Custom header input should tolerate \u0027:\u0027 characters\n    Also:\n    - Use strsplit in mget, muntar, and mmkdir in addition to mput\n    - Consolidate shared argument parsing code for mput, mget, muntar, and mmkdir\n    - Elminate the use of global variables for command name and logger instance in\n      mput, mget, muntar, and mmkdir\n    - Add mput test module"},{"timestamp":1499708457,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1499897913,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\n(7 comments)\n\nThanks for taking this! Looks good! Thanks for adding a test for this.\n\nWe will also want to update the package.json file to publish a new version. I would double check with others on versioning... I think this may constitute a major version, since we\u0027re changing the API by fixing a bug. I\u0027m not sure about the repercussions of doing such a thing, though, or if this is a single- or double-dot version bump."},{"timestamp":1499963751,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1499985429,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 2."},{"timestamp":1499985430,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 6cf96473a3664ee85f333dcb0c05604ee2aee68e\n    \n    Address review feedback\n    - Remove some unnecessary require statements in the options module\n    - Change parseOptions function to take a single object as input rather than\n      multiple parameters"},{"timestamp":1499985455,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500063278,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 3."},{"timestamp":1500063279,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 3af20adaceef0ae74ab5eb2e65a59bc779696c53\n    \n    Bump version to 4.4.2"},{"timestamp":1500063302,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500323887,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3: Code-Review+1\n\nLooks good!\n\nBefore I give integration approval, can you explain a little bit about how you tested this change? Thanks!"},{"timestamp":1500325890,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 3:\n\nThe primary method of testing was running the automated test suites including the new test for mput that I added using my JPC account. I wrote the test and ensured that it failed without the strsplit change and then ensured it passed with the change in place. I did get test failures for the tests involving mmpu, but that is due to mpu not being supported in JPC yet and I feel comfortable that I did not make any changes to affect the mmpu command that would play a part in those failures.\n\nI also did some manual testing with each of the four affected commands to ensure the options parsing still functioned for each one.\n\nIf you have any other suggestions for testing this I\u0027ll be happy to try them out or augment the test suite as needed."},{"timestamp":1500327254,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3: Integration-Approval+1\n\nThanks, Kelly. That sounds good to me. Thanks!"},{"timestamp":1500328019,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1500329443,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kelly McLaughlin"}],"currentPatchSet":{"number":"4","revision":"a4c4ee8fa03b789fca6cd2cf555ad5eda426f718","parents":["f06f6e6d84855d631f9a53cc88c4b2add81c0cd1"],"ref":"refs/changes/96/2196/4","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1500328019,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500063302,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500323887,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500327254,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"SUBM","value":"1","grantedOn":1500329442,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/mget","type":"MODIFIED","insertions":81,"deletions":-87},{"file":"bin/mmkdir","type":"MODIFIED","insertions":63,"deletions":-69},{"file":"bin/mput","type":"MODIFIED","insertions":92,"deletions":-102},{"file":"bin/muntar","type":"MODIFIED","insertions":91,"deletions":-94},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/options.js","type":"ADDED","insertions":82,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/mput.test.js","type":"ADDED","insertions":190,"deletions":0}],"sizeInsertions":607,"sizeDeletions":-354},"patchSets":[{"number":"1","revision":"ba95201bd49a3e5d413e87553e7b2b32e9c42f53","parents":["f06f6e6d84855d631f9a53cc88c4b2add81c0cd1"],"ref":"refs/changes/96/2196/1","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1499708432,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1499708457,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/mmkdir","line":4,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Let\u0027s update the copyright year in the edited files. I see you got some already."},{"file":"bin/mput","line":40,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I think we can forgo the single quotes around this key. Same goes for \u0027muntar\u0027"},{"file":"lib/options.js","line":9,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Double check the usage of these imports. I think strsplit may be the only one we\u0027re using."},{"file":"lib/options.js","line":9,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Great catch, will clean that up."},{"file":"lib/options.js","line":39,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Generally I see a lot of functions that take many arguments consolidate them into an object. I see it\u0027s being done both ways in this repo."},{"file":"lib/options.js","line":39,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"That seems like a good idea. I\u0027ll give that a shot."},{"file":"lib/options.js","line":66,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I think we can bump this up a line (if it fits within 80 columns)"},{"file":"lib/options.js","line":69,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"rather than \u0027tmp\u0027, can we call this \u0027tokens\u0027 or something similar?"},{"file":"lib/options.js","line":70,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"It looks like users can specify headers without values, and we will allow it (and it is successful). For example: -H \u0027m-header:\u0027\n\nThat is also true for the previous version of this code. I\u0027m curious what your thoughts are on this. Should we throw an error, or allow it?"},{"file":"lib/options.js","line":70,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"It doesn\u0027t seem overly useful, but allowing empty values doesn\u0027t seem to violate the rules in RFC 2616 so I\u0027m fine with continuing to allow it."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mget","type":"MODIFIED","insertions":75,"deletions":-87},{"file":"bin/mmkdir","type":"MODIFIED","insertions":56,"deletions":-68},{"file":"bin/mput","type":"MODIFIED","insertions":87,"deletions":-102},{"file":"bin/muntar","type":"MODIFIED","insertions":85,"deletions":-94},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/options.js","type":"ADDED","insertions":76,"deletions":0},{"file":"test/mput.test.js","type":"ADDED","insertions":190,"deletions":0}],"sizeInsertions":572,"sizeDeletions":-352},{"number":"2","revision":"8aa951c6ebfe89d98d49cd5e0fa71ab58fa3c30a","parents":["f06f6e6d84855d631f9a53cc88c4b2add81c0cd1"],"ref":"refs/changes/96/2196/2","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1499985429,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1499985455,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mget","type":"MODIFIED","insertions":81,"deletions":-87},{"file":"bin/mmkdir","type":"MODIFIED","insertions":63,"deletions":-69},{"file":"bin/mput","type":"MODIFIED","insertions":92,"deletions":-102},{"file":"bin/muntar","type":"MODIFIED","insertions":91,"deletions":-94},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/options.js","type":"ADDED","insertions":82,"deletions":0},{"file":"test/mput.test.js","type":"ADDED","insertions":190,"deletions":0}],"sizeInsertions":602,"sizeDeletions":-353},{"number":"3","revision":"8859531b19aa6f40f48ff3aefe5102eacb5228da","parents":["f06f6e6d84855d631f9a53cc88c4b2add81c0cd1"],"ref":"refs/changes/96/2196/3","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1500063278,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500063302,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500323887,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500327254,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/mget","type":"MODIFIED","insertions":81,"deletions":-87},{"file":"bin/mmkdir","type":"MODIFIED","insertions":63,"deletions":-69},{"file":"bin/mput","type":"MODIFIED","insertions":92,"deletions":-102},{"file":"bin/muntar","type":"MODIFIED","insertions":91,"deletions":-94},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/options.js","type":"ADDED","insertions":82,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/mput.test.js","type":"ADDED","insertions":190,"deletions":0}],"sizeInsertions":607,"sizeDeletions":-354},{"number":"4","revision":"a4c4ee8fa03b789fca6cd2cf555ad5eda426f718","parents":["f06f6e6d84855d631f9a53cc88c4b2add81c0cd1"],"ref":"refs/changes/96/2196/4","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1500328019,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500063302,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500323887,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500327254,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"SUBM","value":"1","grantedOn":1500329442,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/mget","type":"MODIFIED","insertions":81,"deletions":-87},{"file":"bin/mmkdir","type":"MODIFIED","insertions":63,"deletions":-69},{"file":"bin/mput","type":"MODIFIED","insertions":92,"deletions":-102},{"file":"bin/muntar","type":"MODIFIED","insertions":91,"deletions":-94},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/options.js","type":"ADDED","insertions":82,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/mput.test.js","type":"ADDED","insertions":190,"deletions":0}],"sizeInsertions":607,"sizeDeletions":-354}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}]}