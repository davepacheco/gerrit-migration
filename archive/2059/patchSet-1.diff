From 34fecb92ca493b31699902e098fc64942bc93b56 Mon Sep 17 00:00:00 2001
From: Josh Wilsdon <jwilsdon@joyent.com>
Date: Thu, 8 Jun 2017 12:39:47 -0700
Subject: [PATCH] OS-6171 when using rsync in vmadm we should workaround
 hostile GZ setups

---
 src/vm/node_modules/VM.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/vm/node_modules/VM.js b/src/vm/node_modules/VM.js
index 3ce23319..d4c023f4 100644
--- a/src/vm/node_modules/VM.js
+++ b/src/vm/node_modules/VM.js
@@ -2441,7 +2441,7 @@ function copyFilesystemData(payload, filesystem, log, callback)
 
         // Need to add the trailing '/' in so we copy only the *contents* of the
         // dir instead of the dir itself.
-        args = ['-aq', existing + '/', filesystem.source];
+        args = ['--numeric-ids', '-aq', existing + '/', filesystem.source];
         log.info({
             cmd: cmd,
             args: args,
-- 
2.21.0

