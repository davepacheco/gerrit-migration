{"project":"joyent/boray","branch":"master","id":"I961a391a9a570d322e405e82be66a8e6be5ce6e5","number":"6152","subject":"MANTA-4239 Return proper errors from boray when buckets or objects are not found or already exist Reviewed by: Dave Eddy \u003cdave.eddy@joyent.com\u003e","owner":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"url":"https://cr.joyent.us/6152","commitMessage":"MANTA-4239 Return proper errors from boray when buckets or objects are not found or already exist\nReviewed by: Dave Eddy \u003cdave.eddy@joyent.com\u003e\n","createdOn":1556056017,"lastUpdated":1556571381,"open":false,"status":"MERGED","comments":[{"timestamp":1556056017,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 1."},{"timestamp":1556056019,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 15d0a86e584493f1c752a9b6f03de8da82034321\n    \n    MANTA-4239 Return proper errors from boray when buckets or objects are not found or already exist"},{"timestamp":1556123977,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1556124866,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1556125060,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1: Code-Review+1\n\n(1 comment)"},{"timestamp":1556317567,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1556317637,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 3."},{"timestamp":1556317639,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 96a2488545fe73dce59bf9a048a0530931db8bad\n    \n    MANTA-4239 Return proper errors from boray when buckets or objects are not found or already exist"},{"timestamp":1556317687,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(1 comment)\n\nI rebased this after the sorting and pagination changes so it should be good to go."},{"timestamp":1556555498,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\npulled and tested on my own machine - works as expected!"},{"timestamp":1556571381,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kelly McLaughlin"}],"currentPatchSet":{"number":"3","revision":"961a391a9a570d322e405e82be66a8e6be5ce6e5","parents":["d85d67264eea634a72e346777eabe8d805338d0f"],"ref":"refs/changes/52/6152/3","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556317637,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556555498,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556555498,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1556571381,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/bucket.rs","type":"MODIFIED","insertions":43,"deletions":-21},{"file":"src/object.rs","type":"MODIFIED","insertions":34,"deletions":-9}],"sizeInsertions":77,"sizeDeletions":-30},"patchSets":[{"number":"1","revision":"31fa3767c78f81ed3197f90c66bd3165ca547a49","parents":["622c0b9272292c1e05b32d19cad8e657355be9cc"],"ref":"refs/changes/52/6152/1","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556056017,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556125060,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"src/bucket.rs","line":22,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: doesn\u0027t need to be here"},{"file":"src/bucket.rs","line":22,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"src/bucket.rs","line":182,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Will the None case always mean the bucket already exists? or is it possible for this to fail for other reasons?"},{"file":"src/bucket.rs","line":182,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"The `None` case here always means that zero rows were affected by the query and in this context that does mean the bucket already exists. There could be other errors, but they will be handled by the `map_err` below (and handled better in the nearish future)."},{"file":"src/bucket.rs","line":182,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"ah yes, i see that now.  i\u0027ve been doing node callbacks for so long i didn\u0027t even think of the .and_then and .map_err."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/bucket.rs","type":"MODIFIED","insertions":44,"deletions":-21},{"file":"src/object.rs","type":"MODIFIED","insertions":34,"deletions":-9}],"sizeInsertions":78,"sizeDeletions":-30},{"number":"2","revision":"63583ff8561b583420cc9590bcbe256418b8cf35","parents":["d85d67264eea634a72e346777eabe8d805338d0f"],"ref":"refs/changes/52/6152/2","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556317567,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556125060,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/bucket.rs","type":"MODIFIED","insertions":44,"deletions":-21},{"file":"src/object.rs","type":"MODIFIED","insertions":34,"deletions":-9}],"sizeInsertions":78,"sizeDeletions":-30},{"number":"3","revision":"961a391a9a570d322e405e82be66a8e6be5ce6e5","parents":["d85d67264eea634a72e346777eabe8d805338d0f"],"ref":"refs/changes/52/6152/3","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556317637,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556555498,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556555498,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1556571381,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/bucket.rs","type":"MODIFIED","insertions":43,"deletions":-21},{"file":"src/object.rs","type":"MODIFIED","insertions":34,"deletions":-9}],"sizeInsertions":77,"sizeDeletions":-30}],"allReviewers":[{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}]}