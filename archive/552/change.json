{"project":"joyent/sdc-cnapi","branch":"master","id":"Ibca662a69a50a3d95a698c749e069b373c4f61ac","number":"552","subject":"CNAPI-671: Load servers to dapi in batches. CNAPI-672: Update dapi to support queries to vmapi. Reviewed by: Pedro P. Candel \u003cpedro@joyent.com\u003e","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/552","commitMessage":"CNAPI-671: Load servers to dapi in batches.\nCNAPI-672: Update dapi to support queries to vmapi.\nReviewed by: Pedro P. Candel \u003cpedro@joyent.com\u003e\n","createdOn":1475234064,"lastUpdated":1482389559,"open":false,"status":"MERGED","comments":[{"timestamp":1475234064,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1475234110,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1475234726,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1475234782,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477304519,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 3."},{"timestamp":1477304563,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477309553,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nsdcadm up cnapi@1c9f50f0-99d6-11e6-baac-bb72c2eaa284"},{"timestamp":1479372985,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 4."},{"timestamp":1479373018,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1479373044,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4:\n\nsdcadm up cnapi@f4874102-aca1-11e6-8109-bbcdc6e7cce4"},{"timestamp":1480596608,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 5."},{"timestamp":1480596641,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480596666,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 5:\n\nsdcadm up cnapi@6298ae4a-b7c1-11e6-9c66-a722a5a911e8"},{"timestamp":1481907032,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\n(1 comment)\n\nJust a minor comment and, as usually, scared by the lack of tests for this stuff. How\u0027re you testing this?"},{"timestamp":1482238476,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 5:\n\n\u003e Just a minor comment and, as usually, scared by the lack of tests\n \u003e for this stuff. How\u0027re you testing this?\n\nFirst, test/test-allocator.js\n\nSecond, run cloudapi\u0027s test suite on top."},{"timestamp":1482238866,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 6."},{"timestamp":1482238905,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1482240659,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6:\n\nsdcadm up cnapi@a2acbf0a-c6b5-11e6-a2fa-470729c8375a"},{"timestamp":1482337264,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1482389559,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Marsell Kukuljevic"}],"currentPatchSet":{"number":"6","revision":"bca662a69a50a3d95a698c749e069b373c4f61ac","parents":["148a959729c250a2a0c2a0da06423a7e1702becd"],"ref":"refs/changes/52/552/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1482238866,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1482238905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1482337264,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1482337264,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1482389559,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":126,"deletions":-93},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":57,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-139},"patchSets":[{"number":"1","revision":"4017e19fc0a8c0529fbc227c249cf40573ee7eb3","parents":["b487bbfeb2ecdf766b634ac907281fbd8559a2bd"],"ref":"refs/changes/52/552/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1475234064,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1475234110,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/allocator.js","line":419,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: trailing_comma"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":123,"deletions":-92},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":55,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":204,"sizeDeletions":-139},{"number":"2","revision":"a85d50cd48ea83762e19e8a7aa3ed3e7d84078a3","parents":["b487bbfeb2ecdf766b634ac907281fbd8559a2bd"],"ref":"refs/changes/52/552/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1475234726,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1475234782,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":123,"deletions":-92},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":55,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":204,"sizeDeletions":-139},{"number":"3","revision":"1c66e385dd2ab9f8e7b1d1263b17ff7209834a26","parents":["e1d49bb4eae1d6c8060a16bf7d7bd6ba8937b747"],"ref":"refs/changes/52/552/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1477304519,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477304563,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":123,"deletions":-92},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":55,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":204,"sizeDeletions":-139},{"number":"4","revision":"d798588e7836cd3209432dd07cd6e14294d5e57e","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/52/552/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1479372985,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1479373018,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":123,"deletions":-92},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":57,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":206,"sizeDeletions":-139},{"number":"5","revision":"5b6aa9a339fa113ee8366c6cc2781cfdc5477af1","parents":["148a959729c250a2a0c2a0da06423a7e1702becd"],"ref":"refs/changes/52/552/5","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1480596608,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480596641,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/allocator.js","line":413,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"If we\u0027re returning the error message only, shouldn\u0027t we at least log the complete error here for later debugging?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":123,"deletions":-92},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":57,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":205,"sizeDeletions":-138},{"number":"6","revision":"bca662a69a50a3d95a698c749e069b373c4f61ac","parents":["148a959729c250a2a0c2a0da06423a7e1702becd"],"ref":"refs/changes/52/552/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1482238866,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1482238905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1482337264,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1482337264,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1482389559,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/endpoints/allocator.js","type":"MODIFIED","insertions":126,"deletions":-93},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":57,"deletions":-37},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"sapi_manifests/cnapi/template","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"test/test-allocator.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-139}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}