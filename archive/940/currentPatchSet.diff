commit fd05b77b28753e1f466e0649a3fd271ceba2e17c (refs/changes/40/940/2)
Author: David Pacheco <dap@joyent.com>
Date:   2016-11-23T13:37:51-08:00 (2 years, 10 months ago)
    
    joyent/node-manta#288 mfind of file blows assertion: "ent (object) is required"

diff --git a/CHANGES.md b/CHANGES.md
index 49c0e2b..7ad48c6 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -2,7 +2,7 @@
 
 ## not yet released
 
-(nothing yet)
+- joyent/node-manta#288 mfind of file blows assertion: "ent (object) is required"
 
 ## 4.0.0
 
diff --git a/lib/client.js b/lib/client.js
index 4fe45e2..c13be29 100644
--- a/lib/client.js
+++ b/lib/client.js
@@ -88,7 +88,7 @@ function InvalidDirectoryError(dir, ent) {
     Error.call(this);
 
     assert.string(dir, 'dir');
-    assert.object(ent, 'ent');
+    assert.optionalObject(ent, 'ent');
 
     this.name = 'InvalidDirectoryError';
     this.message = dir + ' is an invalid manta directory';
diff --git a/test/mfind.test.js b/test/mfind.test.js
index c54fbb9..f5e2f4c 100644
--- a/test/mfind.test.js
+++ b/test/mfind.test.js
@@ -135,6 +135,15 @@ test('mfind -j TESTDIR', function (t) {
     });
 });
 
+test('mfind TESTDIR/afile.txt', function (t) {
+    forkExecWait({
+        argv: [MFIND, TESTDIR + '/afile.txt']
+    }, function (err, info) {
+        t.ifError(err, err);
+        t.ok(/afile.txt$/m.test(info.stdout), 'afile.txt in stdout');
+        t.done();
+    });
+});
 
 test('cleanup: rm test tree ' + TESTDIR, function (t) {
     // Sanity checks that we don't `mrm -r` a non-test dir.
