From 4c358e2f83922323269ca38743ded3711ceaf9cf Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Fri, 31 Mar 2017 11:35:04 -0700
Subject: [PATCH] CNS-199 cnapi can return non-null, non-string
 "last_heartbeat" values

---
 lib/cn-filter.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/cn-filter.js b/lib/cn-filter.js
index 3791d14..88f4258 100644
--- a/lib/cn-filter.js
+++ b/lib/cn-filter.js
@@ -142,7 +142,7 @@ function cutServerObj(obj) {
 	 * Don't bother looking for a heartbeat from a server that isn't
 	 * set up yet. These are always "down".
 	 */
-	if (obj.setup === false || obj.last_heartbeat === null) {
+	if (obj.setup === false || typeof (obj.last_heartbeat) !== 'string') {
 		cutObj.down = true;
 		return (cutObj);
 	}
-- 
2.21.0

