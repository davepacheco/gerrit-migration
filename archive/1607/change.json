{"project":"joyent/sdc-vmapi","branch":"master","id":"Ied2db0b072ceb064d285b90cbbd5fc38ac967f4e","number":"1607","subject":"joyent/node-triton#128 triton ls state\u003dprovisioning` doesn\u0027t filter on state","owner":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"url":"https://cr.joyent.us/1607","commitMessage":"joyent/node-triton#128 triton ls state\u003dprovisioning` doesn\u0027t filter on state\n","createdOn":1488530089,"lastUpdated":1509426077,"open":false,"status":"ABANDONED","comments":[{"timestamp":1488530089,"reviewer":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"message":"Uploaded patch set 1."},{"timestamp":1488530127,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489716401,"reviewer":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1489716431,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1491180896,"reviewer":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1491180929,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1491427317,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nI think this change is sane, but I request a test covering this to be added to test/vms.full.test.js (either add it to the create_vm test, or add it as a new test between the create_vm and get_job tests), and the ListVms endpoint in docs/index.md should have the `provisioning` state added."},{"timestamp":1491435400,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3:\n\nI would advocate for adding a new test instead of modifying the existing test/vms.full.test.js file. It makes it easier to run individual tests without having to run through a long running test.\n\nThe VALID_VM_STATES in test/vms.list.test.js will also need to be updated at https://github.com/joyent/sdc-vmapi/blob/master/test/vms.list.test.js#L194-L199."},{"timestamp":1491436066,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nA separate file seem like a good idea, but in this case that\u0027d require an additional VM creation cycle, adding another 30s+ to a make test-coal... not sure it\u0027s worth it."},{"timestamp":1491436706,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3:\n\nRegarding test VM creation, that\u0027s a good point, I\u0027m fine either way."},{"timestamp":1491493886,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3:\n\nAn alternative to creating actual VMs is to do something similar to what test/vms.list.test.js does: creating VM objects in moray without going through the provisioning workflow.\n\nIn other words, the tests suite associated to this change could use the createTestVm function defined at https://github.com/joyent/sdc-vmapi/blob/master/test/lib/vm.js#L30-L69 to create a \"fake\" VM object with a state \u003d\u003d\u003d \"provisioning\", and use the deleteTestVMs function defined in the same module to clean that fake VM up when the test completes."},{"timestamp":1509426077,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Abandoned\n\nAbandoning because there hasn\u0027t been any feedback for months now, but please feel free to reopen this if you\u0027d like to pursue it."}],"currentPatchSet":{"number":"3","revision":"ed2db0b072ceb064d285b90cbbd5fc38ac967f4e","parents":["e4cfd962384a45038ad823ab197ca9b375d7d94b"],"ref":"refs/changes/07/1607/3","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1491180896,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488530127,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"3fff5c88b273072e3657d37faed1618ac9bf48e8","parents":["39ee324064c651c529785740aba4342e593db818"],"ref":"refs/changes/07/1607/1","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1488530089,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488530127,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-1},{"number":"2","revision":"f1f98b7ac1db1fb6362ec446bb374c3f32c09a7e","parents":["c3e3474838c9f76c035ec8bc960a8a68a1309f4b"],"ref":"refs/changes/07/1607/2","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1489716401,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488530127,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-1},{"number":"3","revision":"ed2db0b072ceb064d285b90cbbd5fc38ac967f4e","parents":["e4cfd962384a45038ad823ab197ca9b375d7d94b"],"ref":"refs/changes/07/1607/3","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1491180896,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488530127,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}