{"project":"joyent/node-cueball","branch":"master","id":"I3b1b3eaa36a409377fc34fa6497526b51a5d378e","number":"394","subject":"joyent/node-cueball#15 Backends appear without IP addresses when using CNAMEs","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/394","commitMessage":"joyent/node-cueball#15 Backends appear without IP addresses when using CNAMEs\n","createdOn":1472764963,"lastUpdated":1472844612,"open":false,"status":"MERGED","comments":[{"timestamp":1472764963,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1472764992,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(2 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1472765093,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1472765226,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1472842704,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2: Code-Review+1\n\nThe code looks good, but I\u0027m not sure I understand the problem and how it fixes it.  I\u0027m assuming that what\u0027s going on here is that the user asked us to look up a hostname \"foo\", and we got back a CNAME record for \"foo\" plus an A record for whatever name the CNAME referred to.  Before the change, we would produce two backends: one for the CNAME record, which had no IP (the bug), and one for the A record.  This change skips the CNAME.  The fact that it produces a correct backend relies on the fact that the DNS server should have sent us the A record for whatever the CNAME referred to.  Is that right?"},{"timestamp":1472843796,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n\u003e The fact that it produces a\n \u003e correct backend relies on the fact that the DNS server should have\n \u003e sent us the A record for whatever the CNAME referred to.  Is that\n \u003e right?\n\nYes. We\u0027re talking to a recursive nameserver here, which by the spec will either resolve the CNAME for us and return the proper A/AAAA records (in addition to the CNAME), or will give up and return an error."},{"timestamp":1472844102,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1472844612,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"2","revision":"3b1b3eaa36a409377fc34fa6497526b51a5d378e","parents":["2ec1a3180569cb89f06a4fe3330aba4bee634e1f"],"ref":"refs/changes/94/394/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1472765093,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1472765226,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1472842704,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1472844102,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1472844612,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":30,"deletions":-4}],"sizeInsertions":30,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"bd7b03999c097df4468dcc31acab7cf5e6fa2056","parents":["2ec1a3180569cb89f06a4fe3330aba4bee634e1f"],"ref":"refs/changes/94/394/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1472764963,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1472764992,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/resolver.js","line":777,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: redeclaration of ans"},{"file":"lib/resolver.js","line":823,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: anonymous function does not always return value"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":27,"deletions":-2}],"sizeInsertions":27,"sizeDeletions":-2},{"number":"2","revision":"3b1b3eaa36a409377fc34fa6497526b51a5d378e","parents":["2ec1a3180569cb89f06a4fe3330aba4bee634e1f"],"ref":"refs/changes/94/394/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1472765093,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1472842704,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1472844102,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1472844612,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1472765226,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":30,"deletions":-4}],"sizeInsertions":30,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}