{"project":"joyent/node-cueball","branch":"master","id":"I2236b4586a1e6a503ed542b1a460d296719cb41d","number":"1087","subject":"joyent/node-cueball#60 require responses from all bootstrap nameservers before returning error joyent/node-cueball#58 drop excess nameservers from bootstrap Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/1087","commitMessage":"joyent/node-cueball#60 require responses from all bootstrap nameservers before returning error\njoyent/node-cueball#58 drop excess nameservers from bootstrap\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1481154253,"lastUpdated":1481240071,"open":false,"status":"MERGED","comments":[{"timestamp":1481154253,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1481154288,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1481154337,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1481154369,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1481223271,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2: Code-Review+1\n\n(2 comments)"},{"timestamp":1481239755,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1481239773,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1481239821,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1481239843,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1481239895,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1481240042,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1481240070,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1481240071,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"4","revision":"2236b4586a1e6a503ed542b1a460d296719cb41d","parents":["7de363ee3ca21a45f039b2628200258ab5941fc9"],"ref":"refs/changes/87/1087/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1481239821,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1481239895,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481240042,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481240070,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"SUBM","value":"1","grantedOn":1481240071,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":31,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":33,"sizeDeletions":-11},"patchSets":[{"number":"1","revision":"060c739de7971246d4784dfda5b166b1a5791798","parents":["7de363ee3ca21a45f039b2628200258ab5941fc9"],"ref":"refs/changes/87/1087/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1481154253,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1481154337,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":32,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":34,"sizeDeletions":-11},{"number":"2","revision":"a32b4b6fe5b2333e8d8ea7c5bea783c3659595a4","parents":["7de363ee3ca21a45f039b2628200258ab5941fc9"],"ref":"refs/changes/87/1087/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1481154288,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481223271,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1481154369,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/resolver.js","line":762,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Perhaps pass an object as the first argument with the removed resolver? Something like { removed: gone }? This would make it easier to find removed resolvers via json(1) if needed. Bootstrap also only happens in the beginning, right? Perhaps make this log at .info() instead of .debug()?"},{"file":"lib/resolver.js","line":762,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/resolver.js","line":865,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027m not sure I understand why you\u0027re taking the min here. If there\u0027s a larger set of initial resolvers during bootstrapping than the specified maxDNSConcurrency, don\u0027t you want the error threshold to be the number of resolvers?"},{"file":"lib/resolver.js","line":865,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"No. When we give this resolvers list to mname-client, it\u0027s going to select a random r_maxres sized subset of them to actually use. Our errorThreshold has to be the number of resolvers that we will actually attempt to use -- which is either r_maxres, or if the resolvers list is shorter than r_maxres, the length of the list. This is a min()."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":32,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":34,"sizeDeletions":-11},{"number":"3","revision":"031e942967cb5b9a9a9f04be6b186d6d75f91a51","parents":["7de363ee3ca21a45f039b2628200258ab5941fc9"],"ref":"refs/changes/87/1087/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1481239773,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1481239843,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":31,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":33,"sizeDeletions":-11},{"number":"4","revision":"2236b4586a1e6a503ed542b1a460d296719cb41d","parents":["7de363ee3ca21a45f039b2628200258ab5941fc9"],"ref":"refs/changes/87/1087/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1481239821,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481240042,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481240070,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"SUBM","value":"1","grantedOn":1481240071,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1481239895,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":31,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":33,"sizeDeletions":-11}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}]}