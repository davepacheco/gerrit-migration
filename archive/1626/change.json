{"project":"joyent/sdcadm","branch":"master","id":"I2dc7922619de6c7138b1f8839036463220d09281","number":"1626","subject":"TOOLS-1717 sdcadm should not load SDC Application from SAPI when not required","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/1626","commitMessage":"TOOLS-1717 sdcadm should not load SDC Application from SAPI when not required\n","createdOn":1488975064,"lastUpdated":1526288168,"open":false,"status":"ABANDONED","comments":[{"timestamp":1488975064,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1488975070,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 92d594ee212153f5faca14c7959d0821937ba1c3\n    \n    TOOLS-1717 sdcadm should not load SDC Application from SAPI when not required"},{"timestamp":1488975095,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1488975145,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nOk Trent, this is the refactoring of sdc application preloading in sdcadm. Once we\u0027re done with this I\u0027ll add changes required for TOOLS-1699 to https://cr.joyent.us/#/c/1552/"},{"timestamp":1488998621,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Code-Review-1\n\n(1 comment)\n\nI haven\u0027t worked through all this. Early feedback:\n\n\n[root@headnode (nightly-2) ~]# time sdcadm up ca@b6ac840c-fd12-11e6-9ade-6b3bfc63f210 -y\n\nreal    0m56.473s\nuser    0m0.896s\nsys     0m0.279s\n[root@headnode (nightly-2) ~]#\n10:42\nthat just ... fails\n10:42\nthat\u0027s using the sdcApp changes\n10:42\n[root@headnode (nightly-2) ~]# echo $?\n0\n\n\n\nAlso, missing on sdcadm.sdc ref for \u0027sdcadm post-setup cmon\u0027:\n\n```\ndiff --git a/lib/post-setup/cmon.js b/lib/post-setup/cmon.js\nindex b519802..28b5511 100644\n--- a/lib/post-setup/cmon.js\n+++ b/lib/post-setup/cmon.js\n@@ -97,7 +97,7 @@ function do_cmon(subcmd, opts, args, cb) {\n         function ensureCnsSvc(ctx, next) {\n             self.sdcadm.sapi.listServices({\n                 name: \u0027cns\u0027,\n-                application_uuid: self.sdcadm.sdc.uuid\n+                application_uuid: self.sdcadm.sdcApp.uuid\n             }, function (svcErr, svcs) {\n                 if (svcErr) {\n                     next(svcErr);\n```"},{"timestamp":1488999379,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1489000633,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1489000638,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit b5810fe8301e4a1e0f32a842c348d535050bcf27\n    \n    TOOLS-1717 sdcadm should not load SDC Application from SAPI when not required"},{"timestamp":1489000671,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489017887,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\n(10 comments)\n\nStill missing the post-setup/cmon.js patch mentioned in an earlier comment."},{"timestamp":1489072203,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1489072234,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489089802,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1489090291,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1489484712,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 5."},{"timestamp":1489484749,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489484799,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1489484836,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6:\n\n(15 comments)\n\nAll done Trent"},{"timestamp":1502791499,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 7."},{"timestamp":1502791505,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 4184939be9d9f905b260dc81a1bf411fdb846656\n    \n    TOOLS-1717 sdcadm should not load SDC Application from SAPI when not required\n    Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e"},{"timestamp":1502791533,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1526288168,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Abandoned\n\nApplied all these changes to a new branch created on the most recent master. See https://cr.joyent.us/#/c/3945/"}],"currentPatchSet":{"number":"7","revision":"2dc7922619de6c7138b1f8839036463220d09281","parents":["003277077f0006fa698189f39c7f7d48ce4ea049"],"ref":"refs/changes/26/1626/7","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1502791499,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1502791533,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/sdcadm.js","line":966,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: paren_after_args"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":927,"deletions":-114},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":1343,"sizeDeletions":-383},"patchSets":[{"number":"1","revision":"eb024823db5c28e555d1c923527c64ed3ebaaa74","parents":["ba1d12f43e38eaa14c555fe48e8361a9e958f4d7"],"ref":"refs/changes/26/1626/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1488975064,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488975095,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/sdcadm.js","line":353,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I don\u0027t like supporting two call signatures. I think we should just require \u0027arg\u0027 everytime. However you already have a lot of code calling it without the \u0027arg\u0027 argument."},{"file":"lib/sdcadm.js","line":353,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Shouldn\u0027t be hard to add \u0027{}\u0027 to the callers. Easy to grep/ack for \"ensureSdcApp\" than for \"sdc\" now"},{"file":"lib/sdcadm.js","line":375,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"That\u0027s subtle. At least have to doc the import \u0027arg\u0027 options to this function."},{"file":"lib/sdcadm.js","line":375,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":1011,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"this doesn\u0027t call next(). This is perhaps why \u0027sdcadm up\u0027 is hanging."},{"file":"lib/sdcadm.js","line":1011,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/steps/no-rabbit.js","line":49,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This should go into the pipeline, just after \"ensureSdcApp\", right?"},{"file":"lib/steps/no-rabbit.js","line":49,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Use an assertion for arg.sdcadm.sdcApp at the beginning of the function and move forward instead."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":8,"deletions":-5},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":186,"deletions":-116},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":7,"deletions":-4}],"sizeInsertions":593,"sizeDeletions":-384},{"number":"2","revision":"9c73d5d14fac352c7f9eb26a31a8873f9109680d","parents":["ba1d12f43e38eaa14c555fe48e8361a9e958f4d7"],"ref":"refs/changes/26/1626/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1489000633,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489000671,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/default-fabric.js","line":66,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I don\u0027t see where ensureSdcApp is called for this code path. Perhaps it could be done in the pipeline in do_default_fabric in this file?"},{"file":"lib/default-fabric.js","line":66,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/post-setup/underlay-nics.js","line":189,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"It took digging (i.e. it is subtle) to see that \u0027sdcadm.getImgsForSvcVms\u0027 encures sdcadm.sdcApp is set. This should have either a assert.object(sdcadm.sdcApp) here or a preceding func that calls ensureSdcApp."},{"file":"lib/post-setup/underlay-nics.js","line":189,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-dockerlogger.js","line":115,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"No need to have this procedure rely on someone having called ensureSdcApp. It should call it itself before this func, or assert.object(opts.sdcadm.sdcApp, ...)."},{"file":"lib/procedures/update-dockerlogger.js","line":115,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":347,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: `/* ... */`-style block comments please."},{"file":"lib/sdcadm.js","line":347,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":356,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"assert.optionalBool for the \u0027arg.json/arg.quiet\u0027 option."},{"file":"lib/sdcadm.js","line":356,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":376,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps change this to arg.quiet?"},{"file":"lib/sdcadm.js","line":376,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":3796,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Why this change?"},{"file":"lib/sdcadm.js","line":3796,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Probably due to some incorrect rebase?"},{"file":"lib/sdcadm.js","line":5582,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"same complaint as opts.json usage below."},{"file":"lib/sdcadm.js","line":5582,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/sdcadm.js","line":5627,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I don\u0027t like this subtlety here. If I understand, the *intention* is to pass that through listInsts, to *its* call to \"ensureSdcApp\". Instead, this pipeline should just call ensureSdcApp itself, passing the quiet:true option."},{"file":"lib/sdcadm.js","line":5627,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/steps/agent-services.js","line":44,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This should have a assert.object(arg.sdcadm.sdcApp, ...)."},{"file":"lib/steps/agent-services.js","line":44,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":8,"deletions":-5},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":190,"deletions":-116},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4}],"sizeInsertions":595,"sizeDeletions":-384},{"number":"3","revision":"b474290753c1c9dcd5a47d4fc5665e032ac327f8","parents":["ba1d12f43e38eaa14c555fe48e8361a9e958f4d7"],"ref":"refs/changes/26/1626/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1489072203,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489072234,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":60,"deletions":-39},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":212,"deletions":-130},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/ur.js","type":"MODIFIED","insertions":7,"deletions":-13}],"sizeInsertions":642,"sizeDeletions":-417},{"number":"4","revision":"d1ab3f4d8e1205febd1fc1ecb537c8b4e9c7982f","parents":["58d4acb4ed7381b220f11836e13ac5e883f41196"],"ref":"refs/changes/26/1626/4","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1489089802,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489072234,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/sdcadm.js","line":378,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This needs to be \u0027quiet\u0027 now.\n\nActually better would be to just have `if (appErr.message \u0026\u0026 !opts.quiet) {` above"},{"file":"lib/sdcadm.js","line":378,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":212,"deletions":-130},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4}],"sizeInsertions":628,"sizeDeletions":-399},{"number":"5","revision":"aef49f089e3461028df35b4bdb45e8f2ef2e1dae","parents":["ba1d12f43e38eaa14c555fe48e8361a9e958f4d7"],"ref":"refs/changes/26/1626/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1489484712,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489484749,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":60,"deletions":-39},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":210,"deletions":-130},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/ur.js","type":"MODIFIED","insertions":7,"deletions":-13}],"sizeInsertions":640,"sizeDeletions":-417},{"number":"6","revision":"ffb40f05e5babf8c725c93914c5acff8758c9673","parents":["58d4acb4ed7381b220f11836e13ac5e883f41196"],"ref":"refs/changes/26/1626/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1489484799,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489484749,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":210,"deletions":-130},{"file":"lib/steps/agent-services.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4}],"sizeInsertions":626,"sizeDeletions":-399},{"number":"7","revision":"2dc7922619de6c7138b1f8839036463220d09281","parents":["003277077f0006fa698189f39c7f7d48ce4ea049"],"ref":"refs/changes/26/1626/7","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1502791499,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1502791533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1488998621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/sdcadm.js","line":966,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: paren_after_args"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/channel.js","type":"MODIFIED","insertions":125,"deletions":-87},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/cli/do_update_gz_tools.js","type":"MODIFIED","insertions":20,"deletions":-14},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/dc-maint.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/default-fabric.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/platform.js","type":"MODIFIED","insertions":54,"deletions":-35},{"file":"lib/post-setup/cmon.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"lib/post-setup/cns.js","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"lib/post-setup/dev-sample-data.js","type":"MODIFIED","insertions":25,"deletions":-18},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/post-setup/fabrics.js","type":"MODIFIED","insertions":108,"deletions":-73},{"file":"lib/post-setup/ha-binder.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/post-setup/ha-manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/post-setup/underlay-nics.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":927,"deletions":-114},{"file":"lib/steps/no-rabbit.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/steps/sapi.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":1343,"sizeDeletions":-383}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}