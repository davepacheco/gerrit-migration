commit 19bb12432fd769b5c810b7fd732d530090c0fad0 (refs/changes/08/5608/2)
Author: Todd Whiteman <todd.whiteman@joyent.com>
Date:   2019-02-19T16:22:44-08:00 (8 months ago)
    
    TRITON-1242 Create DAPI filter to allow filtering out virtual servers
    Reviewed by: Trent Mick <trentm@gmail.com>
    Approved by: Trent Mick <trentm@gmail.com>

diff --git a/CHANGES.md b/CHANGES.md
index 065788a..8f9207c 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -4,6 +4,11 @@
 
 (nothing yet)
 
+## 1.3.0
+
+- TRITON-1242: Add `triton.placement.exclude_virtual_servers` boolean tag. This
+  is used to tell DAPI to filter out virtual servers (e.g. mockcloud).
+
 ## 1.2.2
 
 - TRITON-755 Fix the release process (`make cutarelease`) to ensure pegjs files
diff --git a/lib/index.js b/lib/index.js
index 439b462..7520097 100644
--- a/lib/index.js
+++ b/lib/index.js
@@ -5,7 +5,7 @@
  */
 
 /*
- * Copyright 2018, Joyent, Inc.
+ * Copyright 2019, Joyent, Inc.
  */
 
 /*
@@ -26,6 +26,8 @@
  *   by the CNS service.
  * - `triton.network.public` (string): Set on a VM, used to specify the external
  *   network name a VM will use.
+ * - `triton.placement.exclude_virtual_servers` (boolean): Set on a VM, used to
+ *   tell DAPI to ignore virtual servers when provisioning (e.g. mockcloud).
  */
 
 var assert = require('assert-plus');
@@ -57,6 +59,7 @@ var typeFromKey = {
     'triton.cns.disable': 'boolean',
     'triton.cns.reverse_ptr': 'string',
     'triton.network.public': 'string',
+    'triton.placement.exclude_virtual_servers': 'boolean',
 
     // Internal testing Triton tags
     'triton._test.string': 'string',
@@ -207,6 +210,12 @@ var validatorFromKey = {
         return null;
     },
 
+    'triton.placement.exclude_virtual_servers':
+            function validateTritonExcludeVirtualServersBoolean(val) {
+        assert.bool(val, 'val');
+        return null;
+    },
+
     /*
      * Triton tags used for internal testing.
      */
diff --git a/package.json b/package.json
index 54e0104..7629432 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "triton-tags",
   "description": "Triton tags parsing and validation",
-  "version": "1.2.2",
+  "version": "1.3.0",
   "author": "Joyent (joyent.com)",
   "dependencies": {
     "assert-plus": "^1.0.0"
