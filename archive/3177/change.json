{"project":"joyent/sdc-cn-agent","branch":"master","id":"Ib9fa8d4e2a0e73b050e49e0e0173d58413c2eec6","number":"3177","subject":"AGENT-1036 cn-agent should use \u0027zlogin -S\u0027 instead of chroot-gtar if available Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e Approved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e","owner":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"url":"https://cr.joyent.us/3177","commitMessage":"AGENT-1036 cn-agent should use \u0027zlogin -S\u0027 instead of chroot-gtar if available\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\nApproved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n","createdOn":1515485407,"lastUpdated":1517445463,"open":false,"status":"MERGED","comments":[{"timestamp":1515485407,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 1."},{"timestamp":1515485408,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit bbaee364bca4e21677b01d9305bc2f5fff940287\n    \n    first cut"},{"timestamp":1515485434,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515789028,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 2."},{"timestamp":1515789029,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 32bed4108e617b55aacf60bccfb7f5de88c78bf8\n    \n    use error code\n    \n    commit 12a6a6cda72891ab9cf2ea17e6f3799f3f224967\n    \n    only unmount once"},{"timestamp":1515789054,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515791924,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 3."},{"timestamp":1515791925,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 96fd02935c60709d548a37af93bee6880a794c27\n    \n    remove unused function"},{"timestamp":1515791950,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515792062,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 4."},{"timestamp":1515792064,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit a6381f57e07853f9efd0dbdeed333cd1d92ba508\n    \n    remove line"},{"timestamp":1515792089,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515792161,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 5."},{"timestamp":1515792162,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit cfb5bd82c416978e340840e10e961489e27428af\n    \n    bump version"},{"timestamp":1515792188,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516139048,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 5:\n\n(16 comments)"},{"timestamp":1516239950,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 6."},{"timestamp":1516239951,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 4c03dcb6968db2059dfeec8719426675023e4d42\n    \n    apply feedback\n    \n    commit 1ca6dda2c494acd94d384bc1695117fd6767fe6f\n    \n    Attempt unmount before booting or destroying a zone"},{"timestamp":1516239994,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516257925,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 7."},{"timestamp":1516257927,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 108eb54fc1c9cf21a41f847baa9f1c0c9fa69f98\n    \n    apply feedback\n    \n    commit 1ca6dda2c494acd94d384bc1695117fd6767fe6f\n    \n    Attempt unmount before booting or destroying a zone\n    \n    commit cfb5bd82c416978e340840e10e961489e27428af\n    \n    bump version\n    \n    commit a6381f57e07853f9efd0dbdeed333cd1d92ba508\n    \n    remove line\n    \n    commit 96fd02935c60709d548a37af93bee6880a794c27\n    \n    remove unused function\n    \n    commit 32bed4108e617b55aacf60bccfb7f5de88c78bf8\n    \n    use error code\n    \n    commit 12a6a6cda72891ab9cf2ea17e6f3799f3f224967\n    \n    only unmount once\n    \n    commit bbaee364bca4e21677b01d9305bc2f5fff940287\n    \n    first cut"},{"timestamp":1516257952,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516305618,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7:\n\n(20 comments)"},{"timestamp":1516646351,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 8."},{"timestamp":1516646352,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 1fd4773db89858476a5406bbb31c7cc529a9983b\n    \n    moar feedback"},{"timestamp":1516646378,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516657309,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 7:\n\n(27 comments)"},{"timestamp":1516657363,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 9."},{"timestamp":1516657364,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit 1df02ecf76829a07af2ad2fa9f05e64abf1020be\n    \n    remove duplicate code\n    \n    commit 86641f0d0abd6b0705f75ee51437b38107fb133f\n    \n    more feedback"},{"timestamp":1516657390,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516657537,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 9:\n\n(5 comments)"},{"timestamp":1516657843,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7:\n\n(1 comment)"},{"timestamp":1516754984,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 10."},{"timestamp":1516754985,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit b26690d2a5918d3ae713b41a0309630155415a36\n    \n    tryUnmount should take an optional callback\n    \n    commit 3d9bd23c9cccf4c25033e8c63346ba03847f2bf9\n    \n    bump package.json"},{"timestamp":1516755009,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing-1\n\n(2 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1516764240,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 11."},{"timestamp":1516764241,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 744e086a38b1e6a0df66d26d5ba33ee14ea296ab\n    \n    fix make check failure"},{"timestamp":1516764267,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516787740,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 12."},{"timestamp":1516787741,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit 6482395151b036db9ed9d422b4c903f0e238e30f\n    \n    if we get an unmount error during boot/start, log it as \u0027info\u0027 level"},{"timestamp":1516787767,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516789162,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 13."},{"timestamp":1516789163,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit 37d9bfeed72d5977e65ca96459265484b964470f\n    \n    use SIGKILL rather than SIGTERM"},{"timestamp":1516789190,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516825274,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 8:\n\n(5 comments)"},{"timestamp":1516829381,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 13:\n\n(3 comments)"},{"timestamp":1516829396,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 13: Code-Review+1"},{"timestamp":1516841628,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 14."},{"timestamp":1516841629,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 14:\n\nNew commits:\n    \n    commit 690cb98c5a8551400c366c9c82e3fe62b2f18058\n    \n    refactor out tryUnmount duplicaiton"},{"timestamp":1516841656,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517222024,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 15: Patch Set 14 was rebased"},{"timestamp":1517222051,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15:\n\n\"make check\" passed ok"},{"timestamp":1517389798,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 16."},{"timestamp":1517389802,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 16:\n\nNew commits:\n    \n    commit e75097f4bacb897f21e423bd6e6f493f8b41f31a\n    \n    Rebase master"},{"timestamp":1517389826,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 16: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1517390683,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 17."},{"timestamp":1517390687,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 17:\n\nNew commits:\n    \n    commit 75b47b1be8e976eb6d4a59087c4bb72f99722d8e\n    \n    remove logging"},{"timestamp":1517390710,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 17: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517419456,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 18."},{"timestamp":1517419458,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 18:\n\nNew commits:\n    \n    commit 8fae0d11c15c21fe40017aa04d72cba8024af798\n    \n    remove logging"},{"timestamp":1517419497,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 18: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517419505,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 19."},{"timestamp":1517419507,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 19:\n\nNew commits:\n    \n    commit 2bb0feb830c3f034b9b30288242aae085daa149f\n    \n    remove logging"},{"timestamp":1517419558,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 19: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517435188,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 19: Code-Review+1 Integration-Approval+1\n\n(3 comments)"},{"timestamp":1517442697,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 19: Code-Review+1 Integration-Approval+1\n\n(5 comments)"},{"timestamp":1517442708,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 19: -Code-Review -Integration-Approval"},{"timestamp":1517443749,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 20."},{"timestamp":1517443751,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 20:\n\nNew commits:\n    \n    commit a3690aaf2b93064598d772fb6538a871cec5f0c0\n    \n    wrap error, log stderr\n    \n    commit 28cdaa417500bb1b823b0a34f0938f77b461de10\n    \n    remove logging\n    \n    commit e75097f4bacb897f21e423bd6e6f493f8b41f31a\n    \n    Rebase master"},{"timestamp":1517443773,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 21."},{"timestamp":1517443774,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 21:\n\nNew commits:\n    \n    commit f110fb89d90df84472957c753f30c7b5f47d989f\n    \n    wrap error, log stderr\n    \n    commit 3616292037495d2273334bbe2573b19fc307090d\n    \n    remove logging\n    \n    commit 03da395cfa948e9a09174d43ccb16945f04edc03\n    \n    Rebase master"},{"timestamp":1517443783,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 20: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517443807,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 21: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517445187,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 22."},{"timestamp":1517445188,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 22:\n\nNew commits:\n    \n    commit 5461d42486e2d083526d4711bf91103829279efb\n    \n    don\u0027t return"},{"timestamp":1517445218,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 22: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517445398,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 22: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1517445452,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 23: Commit message was updated."},{"timestamp":1517445463,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Orlando Vazquez"}],"currentPatchSet":{"number":"23","revision":"b9fa8d4e2a0e73b050e49e0e0173d58413c2eec6","parents":["bb151c8f1472c835986e837dd8e34860d0983519"],"ref":"refs/changes/77/3177/23","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517445452,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517445218,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"SUBM","value":"1","grantedOn":1517445463,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":32,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":20,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":335,"sizeDeletions":-93},"patchSets":[{"number":"1","revision":"efce379ebd7634bd81c70bbafc15977bc76b9179","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/1","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1515485407,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515485434,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":175,"deletions":-34},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":202,"sizeDeletions":-42},{"number":"2","revision":"87bfb5a362f544a49fc503d17c06e38258e5ee1c","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/2","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1515789028,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515789054,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":188,"deletions":-34},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":215,"sizeDeletions":-42},{"number":"3","revision":"b354d16daea196e3f6ad5d54a16b0acad646f6ab","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1515791924,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515791950,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":180,"deletions":-71},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":207,"sizeDeletions":-79},{"number":"4","revision":"808b87d6c1529307ca298796775422e1e99d5a2b","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/4","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1515792062,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515792089,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":179,"deletions":-71},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":206,"sizeDeletions":-79},{"number":"5","revision":"b9c4dcc5d726d04c7d1357cdae6cf06bd1ca1d86","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/5","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1515792161,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515792188,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/docker-stdio.js","line":30,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: we might want to use this CR as an opportunity to alphabetize the declaration of all these variables.\n\nNot big deal though if you don\u0027t want to do that now."},{"file":"lib/docker-stdio.js","line":30,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":41,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: The name \"ZLOGINS_PI\" is a bit confusing for someone not familiar with the change. It reads to me like the plural form of \"ZLOGIN\". Maybe \"ZLOGIN_DASH_S_PI\" or \"SAFE_ZLOGIN_PI\"?"},{"file":"lib/docker-stdio.js","line":41,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":194,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we need to assert the presence of properties of \"opts.sysinfo\" that we use in this function (like \u0027Live Image\u0027)? Or do we handle their absence gracefully?"},{"file":"lib/docker-stdio.js","line":194,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I guess it\u0027s very unlikely that the sysinfo would be present without the \u0027Live Image\u0027 value, but you\u0027re right in that it\u0027s probably better to be a bit defensive (better safe that sorry)"},{"file":"lib/docker-stdio.js","line":245,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback (for post-mortem debugging)."},{"file":"lib/docker-stdio.js","line":245,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":268,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback (for post-mortem debugging)."},{"file":"lib/docker-stdio.js","line":268,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":269,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: maybe add a comment that explains why we want to error (because it\u0027s not safe, etc.) when the zone is not running and we can\u0027t use \"zlogin -S\"?"},{"file":"lib/docker-stdio.js","line":269,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":395,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback (for post-mortem debugging)."},{"file":"lib/docker-stdio.js","line":397,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should this be log.error?"},{"file":"lib/docker-stdio.js","line":397,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":403,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we want to add a listener for the \u0027error\u0027 event?"},{"file":"lib/docker-stdio.js","line":406,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback (for post-mortem debugging)."},{"file":"lib/docker-stdio.js","line":411,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback (for post-mortem debugging)."},{"file":"lib/docker-stdio.js","line":639,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"When do we call \"next()\" in this function?"},{"file":"lib/docker-stdio.js","line":639,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Great catch!"},{"file":"lib/docker-stdio.js","line":641,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we want to add a listner for the \u0027error\u0027 event?"},{"file":"lib/task_agent/task_agent.js","line":186,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"What version of node is cn-agent running? If \u003c 4.x, then we should name the function so that it shows up in stack traces when inspecting core dumps with mdb_v8."},{"file":"lib/task_agent/task_agent.js","line":188,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is the goal of having a \".setSysinfo\" method to clone the \"sysinfo\" object passed as an argument, because we know that object would otherwise be modified (if so, what modifies it?) and we wouldn\u0027t want those modifications?"},{"file":"package.json","line":4,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"How and by whom is this version number used? In other words, why a minor version bump instead of a patch or a major one?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":179,"deletions":-71},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":207,"sizeDeletions":-80},{"number":"6","revision":"6328ddc83d6758c9f54f6b9508d6b825c83dda4b","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/6","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516239950,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516239994,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":216,"deletions":-74},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":275,"sizeDeletions":-87},{"number":"7","revision":"243bae0caa37b9c55ef513670e34a3063ade0919","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/7","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516257925,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516257952,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/common.js","line":112,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: use assert.arrayOfType where \"Type\" is \"String\", \"Number\", \"Object\", etc.?"},{"file":"lib/common.js","line":112,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":46,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Typo: \"block attempts *to* copy\"?"},{"file":"lib/docker-stdio.js","line":46,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":256,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should that be log.error instead of log.info?"},{"file":"lib/docker-stdio.js","line":256,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":262,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: use a less generic name than \"close\". Maybe \"closeTcpServer()\"?"},{"file":"lib/docker-stdio.js","line":262,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":289,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: superfluous return statements."},{"file":"lib/docker-stdio.js","line":289,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":328,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Unmounting the zone here seems a bit out of place and unclear, why not unmount the zone only where we know we\u0027ve mounted it and after we\u0027re done with it (in case of error or success)?"},{"file":"lib/docker-stdio.js","line":328,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":341,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"It seems a bit odd to try to unmount when we know we haven\u0027t mounted the zone (in case \"onDataTimeout\" is called when the zone was running). Is there a way to just inline the data timeout callbacks to have the one called in case the zone is running to just kill the gtar process and in the other case to kill the gtar process _and_ unmount the zone?"},{"file":"lib/docker-stdio.js","line":341,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":341,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":364,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Why are we not handling the \u0027error\u0027 event on the \"streamProc\" object?"},{"file":"lib/docker-stdio.js","line":364,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":410,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"We don\u0027t want to close the TCP server in this case?\n\nSide note: maybe we can perform all cleanup (closing the tcp server, unmounting the zone and killing the tar process in the waterfall\u0027s final callback to simplify things?"},{"file":"lib/docker-stdio.js","line":410,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":412,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we still want to run gtar if we failed to mount the zone?"},{"file":"lib/docker-stdio.js","line":412,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":526,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"log.error instead of log.info?"},{"file":"lib/docker-stdio.js","line":526,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":532,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: use a less generic name, maybe \"closeTcpServer\"?"},{"file":"lib/docker-stdio.js","line":532,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":608,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"What is this return statement used for?"},{"file":"lib/docker-stdio.js","line":608,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":648,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Isn\u0027t there already a listener for the \u0027close\u0027 event set at line 701? Are those duplicates?"},{"file":"lib/docker-stdio.js","line":648,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":670,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we want to continue with running gar when we failed to mount the zone?"},{"file":"lib/docker-stdio.js","line":670,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/tasks/machine_boot.js","line":104,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Isn\u0027t this file about starting zones, not destroying them?"},{"file":"lib/tasks/machine_boot.js","line":104,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Oops, meant to write does not like booting or destroying, thanks."},{"file":"lib/tasks/machine_boot.js","line":124,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback for post-mortem debugging.\n\nCan we still log the error even if we continue?"},{"file":"lib/tasks/machine_boot.js","line":131,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Same as above."},{"file":"lib/tasks/machine_destroy.js","line":101,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name callback and log error."},{"file":"lib/tasks/machine_destroy.js","line":101,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I didn\u0027t log the error here since in most cases, the zone will not be in a \"mounted\" state. I didn\u0027t want to give the impression that by me logging an error there was necessarily something wrong."},{"file":"lib/tasks/machine_destroy.js","line":101,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I agree we don\u0027t necessary want to give the impression that something is wrong, but I think we should at least log something (maybe at the info level?), because I can definitely imagine that one day we\u0027ll want to determine what went wrong when trying to unmount a zone."},{"file":"package.json","line":4,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"How and by whom is this version number used? In other words, why a minor version bump instead of a patch or a major one?"},{"file":"package.json","line":4,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I don\u0027t really have a good answer. This will break some people but the program still has the same API. A major version bump seemed too much but a patch level one seemed too small? The version string is displayed in a few places but I don\u0027t think it\u0027s used for anything serious."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":218,"deletions":-74},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":275,"sizeDeletions":-86},{"number":"8","revision":"f57a4e10d8162a14a234cabad997437ca963b2f1","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/8","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516646351,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516646378,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/docker-stdio.js","line":251,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: can we avoid duplication of code by factoring out tryUnmount to a common function that can be used by \"createDockerFileReadStreamServer\", \"createDockerFileWriteStreamServer\", etc.?"},{"file":"lib/docker-stdio.js","line":251,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":252,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Would it be worth it to have _tryUnmount take a callback as its first argument so that users of that function could determine when the unmount operation is actually complete?"},{"file":"lib/docker-stdio.js","line":252,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":382,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"If the zone is running, why would we try to unmount it? IIUC we didn\u0027t mount it, so that would be useless."},{"file":"lib/docker-stdio.js","line":382,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":448,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"By default, kill is sending SIGTERM, do we want to send SIGTERM or SIGKILL? SIGTERM can be intercepted, SIGKILL cannot, so it seems maybe SIGKILL is safer if we want to force the process to exit?\n\nAlso, just thinking out loud, it\u0027s fine if we don\u0027t do this in this CR: what happens if the process doesn\u0027t exit after a while  even after sending it a TERM or KILL signal? Do we want to have a timeout on that and call next after a while, or retry, or something else?"},{"file":"lib/docker-stdio.js","line":448,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Ah, interesting point. I changed the SIGNAL, but I think maybe this is different and significant enough to maybe send to a new ticket?"},{"file":"lib/docker-stdio.js","line":448,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Yes, doing that in a new ticket is fine."},{"file":"lib/docker-stdio.js","line":449,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"We already call tryUnmount() in the vasync.waterfall\u0027s final callback, why do we need to call it here?"},{"file":"lib/docker-stdio.js","line":449,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":246,"deletions":-86},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":313,"sizeDeletions":-98},{"number":"9","revision":"c0607ebe0dd0ce22855260044a304c50cf12e0f9","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/9","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516657363,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516657390,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":252,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":319,"sizeDeletions":-99},{"number":"10","revision":"62fee3e77f9dea1f8cd6659dc13e91164df35833","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/10","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516754984,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1516755009,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/docker-stdio.js","line":252,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: identifer callback hides an identifier in a parent scope"},{"file":"lib/docker-stdio.js","line":543,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: identifer callback hides an identifier in a parent scope"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":323,"sizeDeletions":-99},{"number":"11","revision":"7bbf43922d113a852aa4816876355e5726392bba","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/11","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516764240,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516764267,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":323,"sizeDeletions":-99},{"number":"12","revision":"a9e17cd31517de8cf820957a75b12a735854c2e6","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/12","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516787740,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516787767,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":323,"sizeDeletions":-99},{"number":"13","revision":"f5dd3fb619847ed36610bd41e54b7ef649c31b6d","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/13","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516789162,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516789190,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516829396,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"comments":[{"file":"lib/docker-stdio.js","line":450,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should we call next with an error if code !\u003d\u003d 0?"},{"file":"lib/docker-stdio.js","line":450,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/docker-stdio.js","line":719,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should we call next with an error if code !\u003d\u003d 0?"},{"file":"lib/docker-stdio.js","line":719,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":323,"sizeDeletions":-99},{"number":"14","revision":"639ad3079530365cc25fdcecc8012d67c5e0a468","parents":["e06898fe0eec3180041ec43544fdd9b770ded827"],"ref":"refs/changes/77/3177/14","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1516841628,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516841656,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":248,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":315,"sizeDeletions":-99},{"number":"15","revision":"c838a03e5f49556de40eed231aa6980e63742779","parents":["c421bcf8ce41d55070538d5c2707878dd3493765"],"ref":"refs/changes/77/3177/15","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517222024,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516841656,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/docker-copy.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/app.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":248,"deletions":-87},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0}],"sizeInsertions":313,"sizeDeletions":-97},{"number":"16","revision":"5f73d92b66f90b77dedb8f562a973a6ae0794035","parents":["ac0fb53fb729e6107cd5920c1623c738965aab70"],"ref":"refs/changes/77/3177/16","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517389798,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1517389826,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/task_agent/task_agent.js","line":32,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"line \u003e 80 characters"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":333,"sizeDeletions":-94},{"number":"17","revision":"ab65a4342f90d614f4bb707dca39f68dd62c93ea","parents":["ac0fb53fb729e6107cd5920c1623c738965aab70"],"ref":"refs/changes/77/3177/17","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517390683,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517390710,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":332,"sizeDeletions":-94},{"number":"18","revision":"6ea3968fdf1249022a6646e99ab462a162007766","parents":["ac0fb53fb729e6107cd5920c1623c738965aab70"],"ref":"refs/changes/77/3177/18","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517419456,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517419497,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":330,"sizeDeletions":-94},{"number":"19","revision":"742a83d99f3552515a06ba41be59b104a0e4df7c","parents":["ac0fb53fb729e6107cd5920c1623c738965aab70"],"ref":"refs/changes/77/3177/19","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517419505,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517419558,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517435188,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517435188,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"comments":[{"file":"lib/backends/smartos/common.js","line":91,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is that a \"simple\" string or a UUID? If it requires a UUID, should we assert.uuid(...) instead?"},{"file":"lib/backends/smartos/common.js","line":91,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/backends/smartos/common.js","line":100,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"We don\u0027t want to keep the original error somewhere, e.g. by wrapping it in a verror.WError or something like that?"},{"file":"lib/backends/smartos/common.js","line":100,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/backends/smartos/common.js","line":104,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is there always a stderr value that is a string when \"error\" is truthy? Is it possible for stderr to be null or undefined and err to be truthy? If so then that call to trim could throw."},{"file":"lib/backends/smartos/common.js","line":104,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"It\u0027s not clear to me under what conditions node will /not/ pass a string back to the caller of execFile. Am I missing something?\n\n require(\u0027child_process\u0027).execFile(\u0027/usr/bin/false\u0027, {}, function (err) { console.dir(arguments); });\n\n \u003e { \u00270\u0027:\n   { Error: Command failed: /usr/bin/false\n\n       at ChildProcess.exithandler (child_process.js:198:12)\n       at emitTwo (events.js:106:13)\n       at ChildProcess.emit (events.js:191:7)\n       at maybeClose (internal/child_process.js:920:16)\n       at Socket.\u003canonymous\u003e (internal/child_process.js:351:11)\n       at emitOne (events.js:96:13)\n       at Socket.emit (events.js:188:7)\n       at Pipe._handle.close [as _onclose] (net.js:497:12) killed: false, code: 1, signal: null, cmd: \u0027/usr/bin/false\u0027 },\n  \u00271\u0027: \u0027\u0027,\n  \u00272\u0027: \u0027\u0027 }\n\nIn any case, I will change the function to take an opts option (containing log), so we can log the stderr if any, but not make it part of the exception name."},{"file":"lib/backends/smartos/common.js","line":104,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I was just asking a question, if stderr is always defined then that sounds good to me!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":19,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":327,"sizeDeletions":-94},{"number":"20","revision":"1e02139d13cf3b4b9406de22613df76882d0f097","parents":["ac0fb53fb729e6107cd5920c1623c738965aab70"],"ref":"refs/changes/77/3177/20","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517443749,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517443783,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":20,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":337,"sizeDeletions":-94},{"number":"21","revision":"035c921f5e92ee89ed560892b51a4117b500ebfb","parents":["bb151c8f1472c835986e837dd8e34860d0983519"],"ref":"refs/changes/77/3177/21","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517443773,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517443807,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":20,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":336,"sizeDeletions":-93},{"number":"22","revision":"769977d8246cca0afe92a5cf9eefc5f315835b34","parents":["bb151c8f1472c835986e837dd8e34860d0983519"],"ref":"refs/changes/77/3177/22","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517445187,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517445218,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":32,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":20,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":335,"sizeDeletions":-93},{"number":"23","revision":"b9fa8d4e2a0e73b050e49e0e0173d58413c2eec6","parents":["bb151c8f1472c835986e837dd8e34860d0983519"],"ref":"refs/changes/77/3177/23","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1517445452,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517445218,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517445398,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"SUBM","value":"1","grantedOn":1517445463,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/backends/smartos/bin/docker-copy.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/backends/smartos/common.js","type":"MODIFIED","insertions":32,"deletions":-1},{"file":"lib/backends/smartos/lib/docker-stdio.js","type":"MODIFIED","insertions":256,"deletions":-86},{"file":"lib/backends/smartos/tasks/docker_copy.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/backends/smartos/tasks/machine_boot.js","type":"MODIFIED","insertions":20,"deletions":-2},{"file":"lib/backends/smartos/tasks/machine_destroy.js","type":"MODIFIED","insertions":15,"deletions":0},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/task_agent/task_runner.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/task_agent/task_worker.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":335,"sizeDeletions":-93}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}