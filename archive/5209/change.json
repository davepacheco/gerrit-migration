{"project":"joyent/node-cueball","branch":"master","id":"Ia60872d8c0952f30eba404df5f6c0714105fe18a","number":"5209","subject":"joyent/node-cueball#137 Want error counters for DNSResolver joyent/node-cueball#151 DNSResolver should retry at TTL if it\u0027s seen it Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Cody Peter","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/5209","commitMessage":"joyent/node-cueball#137 Want error counters for DNSResolver\njoyent/node-cueball#151 DNSResolver should retry at TTL if it\u0027s seen it\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1544231113,"lastUpdated":1561421249,"open":false,"status":"MERGED","comments":[{"timestamp":1544231113,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1544231138,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(4 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1544231211,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1544231269,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544838157,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1545084533,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1545085644,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1545085707,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545087243,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1545087450,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1545094607,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1545850026,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1546557975,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1546558032,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1548886202,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1549913447,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1549926499,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Code-Review+1\n\n(1 comment)"},{"timestamp":1561420761,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1561421197,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1561421247,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1561421249,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"6","revision":"5ce21c417e2b5763acf8973571a1b66bd2548c89","parents":["bb047ba1393fb71b92920c0080c82b05912979d3"],"ref":"refs/changes/09/5209/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1561421247,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545085707,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545850026,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549926499,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561421197,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1561421249,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":35,"deletions":-2},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":138,"sizeDeletions":-8},"patchSets":[{"number":"1","revision":"51e1fe9cb6931e42ddfab2197076bff01739c6e3","parents":["0e3bd2d97ad762f4f5f30179a37b1e42b203f7d2"],"ref":"refs/changes/09/5209/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1544231113,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1544231138,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/cbresolve","line":243,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: kangServer"},{"file":"bin/cbresolve","line":247,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: kangServer"},{"file":"bin/cbresolve","line":248,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: kangServer"},{"file":"bin/cbresolve","line":252,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: kangServer"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":122,"sizeDeletions":-6},{"number":"2","revision":"5eb08c59c4c4ea476ab056a0b78abf499882d467","parents":["0e3bd2d97ad762f4f5f30179a37b1e42b203f7d2"],"ref":"refs/changes/09/5209/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1544231211,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544231269,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/cbresolve","line":243,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why is a client CLI resolver creating a restify server? I think I\u0027m missing something about how this interacts with other consumers."},{"file":"bin/cbresolve","line":243,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"To make it nice to test the kang endpoints, haha. This whole tool is kind of a testing/development tool really. I\u0027ll put it behind a command-line option so it\u0027s not so surprising?"},{"file":"bin/cbresolve","line":243,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, it just wasn\u0027t clear to me in general. I didn\u0027t realize that was the purpose since it didn\u0027t seem to be clear how the CLI program was using it. A flag might be nice or just commenting it here for future readers to understand."},{"file":"lib/pool-monitor.js","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why isn\u0027t this ever called?"},{"file":"lib/pool-monitor.js","line":54,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Because DNS resolvers currently never stop forever, but I might want to fix that up in future, so I put this function in anyway."},{"file":"lib/pool-monitor.js","line":196,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there only always a single next entry for a given resolver?"},{"file":"lib/pool-monitor.js","line":196,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I\u0027m not sure what you\u0027re asking about here, sorry. What do you mean by \"next entry\"?"},{"file":"lib/pool-monitor.js","line":196,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027m trying to understand how far deep the chain of r_nextService can go. Is it only one layer, or can whatever the r_nextService is, have its own subsequent and corresponding next entry. The same is true for the v4/v6. Does that make more sense?"},{"file":"lib/pool-monitor.js","line":196,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Ah. These are not pointers to a \"next\" instance, but rather Dates of the \"next time\" at which we need to do a type of resolution (i.e. the time when the TTL of the last time expired, or some other value in error or fallback conditions)."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":122,"sizeDeletions":-6},{"number":"3","revision":"a60872d8c0952f30eba404df5f6c0714105fe18a","parents":["2e654ccfce314700fb93e4ef71f472cbe2f80dfd"],"ref":"refs/changes/09/5209/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545085644,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545850026,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545085707,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":35,"deletions":-2},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":138,"sizeDeletions":-8},{"number":"4","revision":"372697eb9eae7959c0341d18a618980e9b24f746","parents":["9d4f83b492b83cefbc427141a2183f20f29e38d9"],"ref":"refs/changes/09/5209/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1546557975,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545850026,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549926499,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545085707,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/cbresolve","line":132,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Use jsprim.parseInteger() instead so that things like \"1foo\" will be rejected."},{"file":"bin/cbresolve","line":132,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Ehhh... you reckon it\u0027s worth bringing in a whole new dep just for this? This is a developer tool anyway, I think it\u0027s fine for it to have some rough edges where they keep the code simple and deps smaller..."},{"file":"bin/cbresolve","line":132,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"That\u0027s fair. I thought that it already depended on jsprim, but that\u0027s actually just for \"devDependencies\"."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":35,"deletions":-2},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":138,"sizeDeletions":-8},{"number":"5","revision":"cf585fe0942750a407df53a80f3ee7c7798602f0","parents":["bb047ba1393fb71b92920c0080c82b05912979d3"],"ref":"refs/changes/09/5209/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1561420761,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545850026,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549926499,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561421197,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545085707,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":35,"deletions":-2},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":138,"sizeDeletions":-8},{"number":"6","revision":"5ce21c417e2b5763acf8973571a1b66bd2548c89","parents":["bb047ba1393fb71b92920c0080c82b05912979d3"],"ref":"refs/changes/09/5209/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1561421247,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545850026,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549926499,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561421197,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1561421249,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545085707,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"bin/cbresolve","type":"MODIFIED","insertions":35,"deletions":-2},{"file":"lib/pool-monitor.js","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"lib/resolver.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"test/monitor.test.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":138,"sizeDeletions":-8}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}