From e9b9a64ad8a9da3939826a9b0e0ab8c11b3eade4 Mon Sep 17 00:00:00 2001
From: Dave Eddy <dave@daveeddy.com>
Date: Tue, 4 Apr 2017 12:16:33 -0400
Subject: [PATCH] OS-6033 node v0.10.26 error: stream.push() after EOF

---
 node.js/Patches/node-f2b297c-stream-eof.diff | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 node.js/Patches/node-f2b297c-stream-eof.diff

diff --git a/node.js/Patches/node-f2b297c-stream-eof.diff b/node.js/Patches/node-f2b297c-stream-eof.diff
new file mode 100644
index 0000000..c7aed97
--- /dev/null
+++ b/node.js/Patches/node-f2b297c-stream-eof.diff
@@ -0,0 +1,14 @@
+diff --git a/lib/http.js b/lib/http.js
+index 3b1484b..0623668 100644
+--- a/lib/http.js
++++ b/lib/http.js
+@@ -344,9 +344,7 @@ IncomingMessage.prototype._read = function(n) {
+   // We actually do almost nothing here, because the parserOnBody
+   // function fills up our internal buffer directly.  However, we
+   // do need to unpause the underlying socket so that it flows.
+-  if (!this.socket.readable)
+-    this.push(null);
+-  else
++  if (this.socket.readable)
+     readStart(this.socket);
+ };
-- 
2.21.0

