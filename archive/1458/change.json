{"project":"joyent/sdcadm","branch":"master","id":"I6f2b2dbfab0e5e4343de50a5de0107873fd5e774","number":"1458","subject":"TOOLS-1683 `sdcadm experimental update AGENT` should support updates of individual instances Reviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/1458","commitMessage":"TOOLS-1683 `sdcadm experimental update AGENT` should support updates of individual instances\nReviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e\n","createdOn":1486471351,"lastUpdated":1486580936,"open":false,"status":"MERGED","comments":[{"timestamp":1486471351,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1486471383,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486493969,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(4 comments)\n\nAlso please bump the minor version and add a CHANGES.md entry for the user."},{"timestamp":1486578894,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1486578911,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\n(3 comments)\n\nDone with the suggested changes!"},{"timestamp":1486578931,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486579426,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1486579467,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486579680,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1486579712,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486579978,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1486580936,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"6f2b2dbfab0e5e4343de50a5de0107873fd5e774","parents":["5389bada75b3cf386d5b6220b3a4185cb66c2c7c"],"ref":"refs/changes/58/1458/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1486579680,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486579712,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486579978,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486579978,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1486580936,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":10,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":26,"deletions":-15},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":16,"deletions":-8},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":68,"sizeDeletions":-31},"patchSets":[{"number":"1","revision":"d6b88c7978ec149b2666aee3c312fb7829499e2b","parents":["15bc1c85511709f20ac8a73f55b7a07436f8e16c"],"ref":"refs/changes/58/1458/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1486471351,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486471383,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"/COMMIT_MSG","line":7,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I updated the ticket title, can this commit message be updated to match, please? THanks."},{"file":"lib/procedures/update-agent-v1.js","line":45,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: should drop this trailing space now that the rest is on a new line"},{"file":"lib/procedures/update-agent-v1.js","line":45,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-agent-v1.js","line":52,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: should drop this trailing space now that the rest is on a new line"},{"file":"lib/procedures/update-agent-v1.js","line":52,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-agent-v1.js","line":54,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Two nits here:\n\n```\nThis update will make the following changes:\n    download 1 image (9 MiB):\n        image d6cd2c90-3c30-4e40-8ba9-1af175da2435\n            (vm-agent@1.6.0)\n    update \"62d81005-af00-484d-aa5c-6773b6ccfa5b\" instance of \"vm-agent\" service to image d6cd2c90-3c30-4e40-8ba9-1af175da2435\n        vm-agent@1.6.0\n```\n\n1. It blows out 80-columns.\n2. The \"vm-agent@1.6.0\" should be wrapped in parentheses.\n\nJust doing a quick hardcoded newline before \"to image ...\" would be fine.\n\n\nPlaying around manually, I\u0027d love to eventually get to something like this:\n\n```\nThis update will make the following changes:\n    - download 1 image (9 MiB):\n        image d6cd2c90-3c30-4e40-8ba9-1af175da2435 (vm-agent@1.6.0)\n    - update vm-agent instance 62d81005-af00-484d-aa5c-6773b6ccfa5b (on server\n      headnode) to image d6cd2c90-3c30-4e40-8ba9-1af175da2435\n      (vm-agent@1.6.0)\n```\n\nbut not with this ticket. :)"},{"file":"lib/procedures/update-agent-v1.js","line":54,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":26,"deletions":-15},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":13,"deletions":-7},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":16,"deletions":-8}],"sizeInsertions":55,"sizeDeletions":-30},{"number":"2","revision":"98685c8f17ae80392255861031b9ce9406e2d262","parents":["5389bada75b3cf386d5b6220b3a4185cb66c2c7c"],"ref":"refs/changes/58/1458/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1486578894,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486578931,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":26,"deletions":-15},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":16,"deletions":-8},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":74,"sizeDeletions":-31},{"number":"3","revision":"a59aa1a6a673995ca6334312447b4d66f8e6af9f","parents":["5389bada75b3cf386d5b6220b3a4185cb66c2c7c"],"ref":"refs/changes/58/1458/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1486579426,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486579467,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":26,"deletions":-15},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":16,"deletions":-8},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":74,"sizeDeletions":-31},{"number":"4","revision":"6f2b2dbfab0e5e4343de50a5de0107873fd5e774","parents":["5389bada75b3cf386d5b6220b3a4185cb66c2c7c"],"ref":"refs/changes/58/1458/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1486579680,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486579712,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486579978,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486579978,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1486580936,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":10,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":26,"deletions":-15},{"file":"lib/procedures/update-agent-v1.js","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":16,"deletions":-8},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":68,"sizeDeletions":-31}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}