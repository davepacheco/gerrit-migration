{"project":"joyent/illumos-joyent","branch":"master","id":"I48514b9d3e7aeee085e365e879a73a9e4873323d","number":"5306","subject":"OS-7449 Add custom allocators to libcustr Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/5306","commitMessage":"OS-7449 Add custom allocators to libcustr\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\n","createdOn":1546540967,"lastUpdated":1553708195,"open":false,"status":"MERGED","comments":[{"timestamp":1546540967,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1546543138,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(10 comments)"},{"timestamp":1546619550,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1546619658,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1546707523,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1\n\n(1 comment)\n\nIn general, this looks good. Thanks for refactoring. This at least feels like a cleaner API to me, hopefully you agree."},{"timestamp":1547478050,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1547478056,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3."},{"timestamp":1547485726,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1547859616,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3:\n\n(2 comments)\n\nA couple of small nits.  I\u0027m not 100% sold on the way the allocator interface is structured at the moment.  In particular, the library is currently completely opaque and I\u0027d probably rather we not have consumers directly encode structs in the future probably.  At the very least it\u0027d be good to have versioned structs, if we\u0027re going to do that.\n\nSorry for the vagueness -- I\u0027ll have a bit more of a think over the weekend and provide some more concrete ideas next week."},{"timestamp":1547933671,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 3:\n\nIt was modeled after libnvpair\u0027s allocator API since its model hasn\u0027t seemed to present any problems over its history AFAIK.\n\nThis is still private to illumos-joyent (the smartos-live bits have their own local copy of libcustr) as well -- the intended consumer (libdemangle-sys) is also private to illumos-joyent."},{"timestamp":1547961696,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4."},{"timestamp":1547961745,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1550014393,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1550033328,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 6."},{"timestamp":1550079155,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1550895655,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 7."},{"timestamp":1550895698,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 7:\n\nJust fixing a couple whitespace nits."},{"timestamp":1551205568,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1551912943,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1551913477,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1553626204,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 9: Patch Set 8 was rebased."},{"timestamp":1553707016,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 10: Patch Set 9 was rebased."},{"timestamp":1553708195,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"10","revision":"48514b9d3e7aeee085e365e879a73a9e4873323d","parents":["e741beb43b44dc9de3b96bc2e4a00502c0f11c76"],"ref":"refs/changes/06/5306/10","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1553707016,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551205568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551912943,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"SUBM","value":"1","grantedOn":1553708195,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13},"patchSets":[{"number":"1","revision":"49fd077d47fce4b0842adae86e7f8c3426ec2bb1","parents":["fbc6cdbe2367492a7eae42ed12751b4cdaeb6b9b"],"ref":"refs/changes/06/5306/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1546540967,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/lib/libcustr/common/custr.c","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Not all consumers of this are being built as C99 programs, so this is only working because they\u0027re getting away with GNU99. If you\u0027re going to use C99isms, please update all consumers and Makefiles to clearly indicate that intent rather than relying on GNU89 allowing it please."},{"file":"usr/src/lib/libcustr/common/custr.c","line":54,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"usr/src/lib/libcustr/common/custr.c","line":187,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t think this is right. We should make sure that we return -1 here no matter what the custr_ao_init returns. If you want that ret to be an errno, then we should set that to indicate more information. Otherwise, we\u0027re breaking the current contract that failure is -1 and errno is set."},{"file":"usr/src/lib/libcustr/common/custr.c","line":188,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"See notes in the header file, but I think we should try to avoid the setup being implicit in the allocation as it feels rather awkward to pass the va_list around here. Especially since there\u0027s no way for a consumer to do anything useful in the vector."},{"file":"usr/src/lib/libcustr/common/custr.c","line":194,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"What is the contract arround errno? Is it expected that the ao_alloc will set it? If so, shouldn\u0027t we save it around the call to fini since that might clobber errno?"},{"file":"usr/src/lib/libcustr/common/custr.c","line":265,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Please declare the variable at the top to be consistent with the rest of the library. I know this is legal due to assumption of C99."},{"file":"usr/src/lib/libcustr/common/custr.c","line":265,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"usr/src/lib/libcustr/common/custr.c","line":283,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"custr is used in the tools build, it\u0027s unsafe to use __unused in the tools build so we can build on older platforms."},{"file":"usr/src/lib/libcustr/common/custr.c","line":283,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"To try to move us forward, I\u0027ll add a check to see if __unused is defined and define it if missing (with a comment explaining the check is necessary when building tools on older platforms where it may be missing)."},{"file":"usr/src/lib/libcustr/common/libcustr.h","line":31,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This operations vector deserves comments that describe the expected contract. For example, custr_ao_alloc should set errno on failure, in addition to returning NULL. custr_ao_init should set errno or maybe return it, etc."},{"file":"usr/src/lib/libcustr/common/libcustr.h","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027m a bit confused by these definitions here. If the custr_alloc_t is the same as the operations, then why is there an initialization and finalization entry point as there\u0027s no way for the caller to get back an argument that uses it.\n\nI think that if we\u0027re going to have a custom init and fini ops, then the operations vectors needs to have a different type of argument than an custr_alloc and have something which also takes an argument ala the nvlist pluggable allocator."},{"file":"usr/src/lib/libcustr/common/libcustr.h","line":43,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t think this should have the nvlist_t argument. I think if this is something that we want, we should instead use an API like the nvlists have where by you have to call nv_alloc_init() and nv_alloc_fini(). I think that will simplify the APIs we give folks."},{"file":"usr/src/lib/libcustr/common/libcustr.h","line":51,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s probably worth expanding in the comment that this will only allocate memory for the custr_t using the allocator, as the normal memory will have already been allocated as that\u0027s the point of he interface."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":91,"deletions":-10},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":103,"sizeDeletions":-10},{"number":"2","revision":"87ab0c3d6d03d32cdf82ac9de71b56fecac26b07","parents":["fbc6cdbe2367492a7eae42ed12751b4cdaeb6b9b"],"ref":"refs/changes/06/5306/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1546619550,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1546707523,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/lib/libcustr/common/libcustr.h","line":58,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"at least"},{"file":"usr/src/lib/libcustr/common/libcustr.h","line":58,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":50,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":168,"sizeDeletions":-13},{"number":"3","revision":"805e70389407fb2d367b6a78eccc2cba01a60fd1","parents":["fbc6cdbe2367492a7eae42ed12751b4cdaeb6b9b"],"ref":"refs/changes/06/5306/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1547478056,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1547485726,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/lib/libcustr/common/custr.c","line":40,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"GNUC?"},{"file":"usr/src/lib/libcustr/common/custr.c","line":40,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"usr/src/lib/libcustr/common/custr.c","line":260,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Can you leave the structure of this the way it was; i.e.,\n\n    if ((ret \u003d custr_xalloc(cus, cao)) !\u003d 0)\n        return (ret);"},{"file":"usr/src/lib/libcustr/common/custr.c","line":260,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":50,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":168,"sizeDeletions":-13},{"number":"4","revision":"950bcf53ff4b81be37484d6c1230fbaf91946771","parents":["fbc6cdbe2367492a7eae42ed12751b4cdaeb6b9b"],"ref":"refs/changes/06/5306/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1547961696,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":111,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":50,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":166,"sizeDeletions":-13},{"number":"5","revision":"8216abd59f7b5afe1af5c070319b55f77c64b55e","parents":["6f70878428a80e83775ad270d9b856d4a4fe3f54"],"ref":"refs/changes/06/5306/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1550014393,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":111,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":50,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":166,"sizeDeletions":-13},{"number":"6","revision":"f04fd96f7cab5979380d23a4bdafc62c87306926","parents":["6f70878428a80e83775ad270d9b856d4a4fe3f54"],"ref":"refs/changes/06/5306/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1550033328,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550079155,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13},{"number":"7","revision":"713c73d1a6c1513835f5b82dc105c21146fdf387","parents":["6f70878428a80e83775ad270d9b856d4a4fe3f54"],"ref":"refs/changes/06/5306/7","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1550895655,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551205568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551912943,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13},{"number":"8","revision":"180192a1c9d1d5e3719cbfadbdc16be205532788","parents":["6f70878428a80e83775ad270d9b856d4a4fe3f54"],"ref":"refs/changes/06/5306/8","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1551913477,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551205568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551912943,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13},{"number":"9","revision":"3f1416fd46538cb765be6df507d1ff73fb90170b","parents":["5ffb784f5a3c76e1a0dfe2349748d3a9a8f33082"],"ref":"refs/changes/06/5306/9","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1553626204,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551205568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551912943,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13},{"number":"10","revision":"48514b9d3e7aeee085e365e879a73a9e4873323d","parents":["e741beb43b44dc9de3b96bc2e4a00502c0f11c76"],"ref":"refs/changes/06/5306/10","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1553707016,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551205568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1553708195,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551912943,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libcustr/common/custr.c","type":"MODIFIED","insertions":113,"deletions":-11},{"file":"usr/src/lib/libcustr/common/libcustr.h","type":"MODIFIED","insertions":74,"deletions":-1},{"file":"usr/src/lib/libcustr/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-13}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}