From db46a4798855c02ceb77a80c6bbcc112d394cf07 Mon Sep 17 00:00:00 2001
From: Cody Peter Mello <cody.mello@joyent.com>
Date: Tue, 31 Jul 2018 22:34:52 +0000
Subject: [PATCH] MORAY-492 Restrict Moray's Postgres connection pool churn
 rate

---
 lib/pg.js    | 1 +
 package.json | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/lib/pg.js b/lib/pg.js
index 79f9b8c..dbd1347 100644
--- a/lib/pg.js
+++ b/lib/pg.js
@@ -757,6 +757,7 @@ function PGPool(options) {
         checkTimeout: options.checkInterval,
         checker: pgCheck,
         targetClaimDelay: options.targetClaimDelay,
+        maxChurnRate: 2.0,
         recovery: {
             default: {
                 timeout: this.connectTimeout,
diff --git a/package.json b/package.json
index 4925370..8391e89 100644
--- a/package.json
+++ b/package.json
@@ -13,7 +13,7 @@
         "bunyan-syslog": "~0.3.2",
         "clone": "0.1.11",
         "crc": "0.2.1",
-        "cueball": "~2.7.1",
+        "cueball": "~2.8.0",
         "dtrace-provider": "~0.8",
         "deep-equal": "0.0.0",
         "exeunt": "^1.1.1",
-- 
2.21.0

