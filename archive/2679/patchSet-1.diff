From e6e69ee7388bdc30de4233401dce156ed060081d Mon Sep 17 00:00:00 2001
From: Dave Eddy <dave@daveeddy.com>
Date: Thu, 28 Sep 2017 12:39:10 -0400
Subject: [PATCH] DOCKER-1112 waitContainer should wait for exit_status to
 become available

---
 lib/backends/sdc/containers.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/lib/backends/sdc/containers.js b/lib/backends/sdc/containers.js
index 48912e3..ffdf1a4 100644
--- a/lib/backends/sdc/containers.js
+++ b/lib/backends/sdc/containers.js
@@ -3520,7 +3520,9 @@ function waitContainer(opts, callback) {
             if (getErr) {
                 log.error(getErr, 'Error getting container.');
                 return callback(getErr);
-            } else if (vm.state === 'stopped') {
+            } else if (vm.state === 'stopped'
+                && vm.hasOwnProperty('exit_status')) {
+
                 callback(null, vm.exit_status);
             } else {
                 setTimeout(waitVm, 1000);
-- 
2.21.0

