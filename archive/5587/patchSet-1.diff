From b9e16305b75a2e36a8db7a7a7ddea97063391952 Mon Sep 17 00:00:00 2001
From: Josh Wilsdon <josh@wilsdon.ca>
Date: Thu, 14 Feb 2019 10:14:32 -0800
Subject: [PATCH] TRITON-1230 CommandExecute needs to watch out for sabotage
 from validation

---
 lib/endpoints/servers.js | 4 +++-
 package.json             | 2 +-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/lib/endpoints/servers.js b/lib/endpoints/servers.js
index 4e81cf4..b802add 100644
--- a/lib/endpoints/servers.js
+++ b/lib/endpoints/servers.js
@@ -1228,7 +1228,9 @@ Server.execute = function handlerCommandExecute(req, res, next) {
 
         if (handleWithUr) {
             // Ur's execute functionality
-            if (req.params.hasOwnProperty('timeout')) {
+            if (req.params.hasOwnProperty('timeout') &&
+                req.params.timeout !== undefined) {
+
                 msg = 'timeout only supported when using cn-agent (See: ' +
                     'FEATURE_USE_CNAGENT_COMMAND_EXECUTE)';
                 self.log.error(msg);
diff --git a/package.json b/package.json
index 3f3a6c7..285b84d 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "cnapi",
   "description": "SmartDataCenter Compute Node API",
-  "version": "1.19.3",
+  "version": "1.19.4",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
-- 
2.21.0

