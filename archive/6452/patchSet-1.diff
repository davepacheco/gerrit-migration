From 8749bcc14fc1d6ed9e45c4001825ed59eb425643 Mon Sep 17 00:00:00 2001
From: Robert Mustacchi <rm@joyent.com>
Date: Fri, 8 Feb 2019 06:59:24 +0000
Subject: [PATCH] OS-7620 Use -fstack-protector-strong when available

---
 usr/src/uts/intel/Makefile.intel | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/usr/src/uts/intel/Makefile.intel b/usr/src/uts/intel/Makefile.intel
index 7c04637fcd..561775c3b3 100644
--- a/usr/src/uts/intel/Makefile.intel
+++ b/usr/src/uts/intel/Makefile.intel
@@ -133,7 +133,9 @@ CFLAGS			+= $(SPACEFLAG)
 CFLAGS			+= $(CCUNBOUND)
 CFLAGS			+= $(CFLAGS_uts)
 CFLAGS			+= -xstrconst
-CFLAGS			+= -_gcc=-fstack-protector
+CFLAGS			+= -_gcc4=-fstack-protector
+CFLAGS			+= -_gcc7=-fstack-protector-strong
+CFLAGS			+= -_gcc8=-fstack-protector-strong
 
 ASFLAGS_XARCH_32	= $(i386_ASFLAGS)
 ASFLAGS_XARCH_64	= $(amd64_ASFLAGS)
-- 
2.21.0

