{"project":"joyent/illumos-joyent","branch":"master","id":"Ifa7f53629a85f53179cc4dda4b8fb062a7a05124","number":"3375","subject":"OS-6612 reboot in bhyve guest should reboot, not poweroff OS-6626 bhyve hangs forever when requesting too much kernel memory OS-6627 bhyve needs to support 100+ GB RAM Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Mike Gerdts \u003cmike.","owner":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"url":"https://cr.joyent.us/3375","commitMessage":"OS-6612 reboot in bhyve guest should reboot, not poweroff\nOS-6626 bhyve hangs forever when requesting too much kernel memory\nOS-6627 bhyve needs to support 100+ GB RAM\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1518733390,"lastUpdated":1518821710,"open":false,"status":"MERGED","comments":[{"timestamp":1518733390,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 1."},{"timestamp":1518736044,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1518736296,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1518736534,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1518738511,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 2."},{"timestamp":1518791496,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\nThe code seems fine, but there are a few process things that I\u0027m unsure of.\n\n- I thought there was a rule of one bug per commit either here or in illumos.  I\u0027m guessing that\u0027s in my imagination.\n- These bugs all imply they are fixing something that is broken with bhyve in master, but bhyve isn\u0027t in master.  Should the synopsis for each be updated to describe the issue in general terms?"},{"timestamp":1518796330,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\nAlthough it is typical for us to have one ticket per commit, there is no rule and in the past we have resolved multiple issues with a single commit.\n\nAs far as the bug synopsis, these are just the base OS changes for bhyve which I am pulling in to master in preparation for the bhyve merge. It seems clearer to me to leave the synopsis as-is so we can see why this work was done by looking at the synopsis itself."},{"timestamp":1518797848,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1518812580,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1518812834,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\nI put a testing note for all three of these into OS-6612."},{"timestamp":1518813045,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\nJerry: Have you circled back on LX and native zones to ensure their init restart behavior remained the same?"},{"timestamp":1518813904,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\nI have. I added that info the the testing note on the ticket."},{"timestamp":1518818351,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1518821555,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1518821687,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1518821710,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jerry Jelinek"}],"currentPatchSet":{"number":"4","revision":"fa7f53629a85f53179cc4dda4b8fb062a7a05124","parents":["32f885afcedb16f3b8334274714b013343c23d6e"],"ref":"refs/changes/75/3375/4","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1518821687,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518797848,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518812580,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1518818351,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1518821710,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/uts/common/os/exit.c","type":"MODIFIED","insertions":117,"deletions":-49},{"file":"usr/src/uts/common/os/zone.c","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/sys/zone.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/vm/vm_page.c","type":"MODIFIED","insertions":18,"deletions":-2}],"sizeInsertions":148,"sizeDeletions":-51},"patchSets":[{"number":"1","revision":"cb85ba90c93fd7ec42b00e7fe030bafe30d64f5a","parents":["284a6e28f3bf022a4b8320b2c2cb8db90b05df1e"],"ref":"refs/changes/75/3375/1","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1518733390,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/vm/vm_page.c","line":456,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"I tend to agree with Andy in the github discussion. This should be 0x1f.  Or ASSERT(max_page_get \u003e 0) after 457."},{"file":"usr/src/uts/common/vm/vm_page.c","line":456,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Can you clarify why that is better?"},{"file":"usr/src/uts/common/vm/vm_page.c","line":456,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Nevermind, I finally got it straight in my head."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/os/exit.c","type":"MODIFIED","insertions":117,"deletions":-49},{"file":"usr/src/uts/common/os/zone.c","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/sys/zone.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/vm/vm_page.c","type":"MODIFIED","insertions":18,"deletions":-2}],"sizeInsertions":148,"sizeDeletions":-51},{"number":"2","revision":"a26756a69d1b3e9407d26a02693b4157388ee303","parents":["284a6e28f3bf022a4b8320b2c2cb8db90b05df1e"],"ref":"refs/changes/75/3375/2","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1518738511,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518812580,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1518818351,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518797848,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/os/exit.c","type":"MODIFIED","insertions":117,"deletions":-49},{"file":"usr/src/uts/common/os/zone.c","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/sys/zone.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/vm/vm_page.c","type":"MODIFIED","insertions":18,"deletions":-2}],"sizeInsertions":148,"sizeDeletions":-51},{"number":"3","revision":"2b6ac32e33c114b8b47dd168f7935ee29f9557be","parents":["32f885afcedb16f3b8334274714b013343c23d6e"],"ref":"refs/changes/75/3375/3","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1518821555,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518812580,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1518818351,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518797848,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/os/exit.c","type":"MODIFIED","insertions":117,"deletions":-49},{"file":"usr/src/uts/common/os/zone.c","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/sys/zone.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/vm/vm_page.c","type":"MODIFIED","insertions":18,"deletions":-2}],"sizeInsertions":148,"sizeDeletions":-51},{"number":"4","revision":"fa7f53629a85f53179cc4dda4b8fb062a7a05124","parents":["32f885afcedb16f3b8334274714b013343c23d6e"],"ref":"refs/changes/75/3375/4","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1518821687,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1518821710,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518812580,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1518818351,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518797848,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/uts/common/os/exit.c","type":"MODIFIED","insertions":117,"deletions":-49},{"file":"usr/src/uts/common/os/zone.c","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/sys/zone.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/vm/vm_page.c","type":"MODIFIED","insertions":18,"deletions":-2}],"sizeInsertions":148,"sizeDeletions":-51}],"allReviewers":[{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}]}