{"project":"joyent/illumos-joyent","branch":"vpc","id":"Ia600bc1d768c038aca26139e445c740929ca583d","number":"4626","subject":"Allow adjustment of 2Q cache sizes while running","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/4626","commitMessage":"Allow adjustment of 2Q cache sizes while running\n","createdOn":1533242873,"lastUpdated":1533663752,"open":false,"status":"MERGED","comments":[{"timestamp":1533242873,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1533256901,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\n(4 comments)\n\nAlso, testing notes?"},{"timestamp":1533257786,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1533257959,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1533258641,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2: Code-Review+1\n\nI\u0027ve tested some of this on kebecloud (but not recently), but can you spell out what else you\u0027ve done (even if it\u0027s \"use sources with a userspace test driver\")?"},{"timestamp":1533259434,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\nSo far its been the userspace testing (to test setting the cache sizes).  I can add some more tests on that (it\u0027s a quicker turn around time and the code)"},{"timestamp":1533663514,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1533663699,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1533663752,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"3","revision":"a600bc1d768c038aca26139e445c740929ca583d","parents":["38eaa9073f3b1365a3482b1054115a1d664e6529"],"ref":"refs/changes/26/4626/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1533663699,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1533258641,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1533663514,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"SUBM","value":"1","grantedOn":1533663752,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/dladm/dladm.c","type":"MODIFIED","insertions":43,"deletions":-6},{"file":"usr/src/lib/libdladm/common/libdloverlay.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/libdladm/common/libdloverlay.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libdladm/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay.c","type":"MODIFIED","insertions":295,"deletions":-23},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"usr/src/uts/common/sys/overlay_impl.h","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":358,"sizeDeletions":-44},"patchSets":[{"number":"1","revision":"bd8ca8447cca8cb48cfd31d19e810ca293450b3e","parents":["936c8427b43691e4ce7ba92f2365dc8de29ae3b5"],"ref":"refs/changes/26/4626/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1533242873,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/overlay/overlay.c","line":2089,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"If ret is not 0, should you reset odd-\u003eodd_vl2sz as well?"},{"file":"usr/src/uts/common/io/overlay/overlay.c","line":2089,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"It currently doesn\u0027t matter -- the size adjust functions can only fail if passed an invalid size (which we already validate via overlay_i_setprop), however that\u0027s probably better to be cautious in case the qqcache_() implementation ever change."},{"file":"usr/src/uts/common/io/overlay/overlay.c","line":2113,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Same question here."},{"file":"usr/src/uts/common/io/overlay/overlay.c","line":2140,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"And here..."},{"file":"usr/src/uts/common/io/overlay/overlay.c","line":2164,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"...and here too."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/dladm/dladm.c","type":"MODIFIED","insertions":43,"deletions":-6},{"file":"usr/src/lib/libdladm/common/libdloverlay.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/libdladm/common/libdloverlay.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libdladm/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay.c","type":"MODIFIED","insertions":290,"deletions":-23},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"usr/src/uts/common/sys/overlay_impl.h","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":353,"sizeDeletions":-44},{"number":"2","revision":"d4c0739c5cfe876832e2e4d966dbe61a7b67ab04","parents":["936c8427b43691e4ce7ba92f2365dc8de29ae3b5"],"ref":"refs/changes/26/4626/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1533257959,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1533258641,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1533663514,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/dladm/dladm.c","type":"MODIFIED","insertions":43,"deletions":-6},{"file":"usr/src/lib/libdladm/common/libdloverlay.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/libdladm/common/libdloverlay.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libdladm/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay.c","type":"MODIFIED","insertions":295,"deletions":-23},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"usr/src/uts/common/sys/overlay_impl.h","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":358,"sizeDeletions":-44},{"number":"3","revision":"a600bc1d768c038aca26139e445c740929ca583d","parents":["38eaa9073f3b1365a3482b1054115a1d664e6529"],"ref":"refs/changes/26/4626/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1533663699,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"SUBM","value":"1","grantedOn":1533663752,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1533258641,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1533663514,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/dladm/dladm.c","type":"MODIFIED","insertions":43,"deletions":-6},{"file":"usr/src/lib/libdladm/common/libdloverlay.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/libdladm/common/libdloverlay.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libdladm/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay.c","type":"MODIFIED","insertions":295,"deletions":-23},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"usr/src/uts/common/sys/overlay_impl.h","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":358,"sizeDeletions":-44}],"allReviewers":[{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}