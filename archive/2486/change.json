{"project":"joyent/sdc-booter","branch":"master","id":"I554cb97172454939e905fcc4d50e4b078eb3d19c","number":"2486","subject":"NET-376 hn-netfile should work for a server that isn\u0027t yet a headnode Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"url":"https://cr.joyent.us/2486","commitMessage":"NET-376 hn-netfile should work for a server that isn\u0027t yet a headnode\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1504222609,"lastUpdated":1504809035,"open":false,"status":"MERGED","comments":[{"timestamp":1504222609,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 1."},{"timestamp":1504222610,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 1bb1fb4e51befa64c5bbb2a4ee3f141da8cc9345\n    \n    don\u0027t require server to be an HN already"},{"timestamp":1504222636,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504223229,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1504223862,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1504655151,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 2."},{"timestamp":1504655152,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 9b35ec37f78467ece25f211c5c722eaeab505bc6\n    \n    sdc-clients update to get CNAPI.listServers from TOOLS-1854; nodeunit update to fix --reporter\u003dtap; node patch-level update for good measure"},{"timestamp":1504655178,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504655265,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1504721158,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nFWIW, testing out in a new COAL worked fine: headnode setup and booting a CN."},{"timestamp":1504733102,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1504809025,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1504809035,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Trent Mick"}],"currentPatchSet":{"number":"3","revision":"554cb97172454939e905fcc4d50e4b078eb3d19c","parents":["0e513df9bb90b408407f1e167f907c03b4202dc5"],"ref":"refs/changes/86/2486/3","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1504809025,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504655178,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1504809035,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/hn-netfile","type":"MODIFIED","insertions":13,"deletions":-13},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":16,"sizeDeletions":-16},"patchSets":[{"number":"1","revision":"e71a82d67fd0b762d98b94a195f6f34a487c1182","parents":["0e513df9bb90b408407f1e167f907c03b4202dc5"],"ref":"refs/changes/86/2486/1","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1504222609,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504222636,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/hn-netfile","line":121,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Should we modify this to also support pagination in DCs which have over 1000 CNs?"},{"file":"bin/hn-netfile","line":121,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Ah, yes that would be good.\n\nWhen looking, I\u0027d have hoped that modern node-sdc-clients/lib/cnapi.js would support pagination, but it doesn\u0027t. Also... adding it now and updating sdc-booter to use the newer sdc-clients would be \"fun\" because booter has over 2 *years* of sdc-clients updates to consider.\n\nI\u0027ll take a look tomorrow. Thanks."},{"file":"bin/hn-netfile","line":121,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"@cody: Done, via a node-sdc-clients update that adds paging support to CNAPI.listServers.  I\u0027ve tested the node-sdc-clients update works for some basic booter functionality: booting CNs, hn-netfile, etc.\n\nI\u0027ll be testing a booter image build (to better test out functionality and the sdcnode patch-level update rider) today and tomorrow."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/hn-netfile","type":"MODIFIED","insertions":13,"deletions":-13}],"sizeInsertions":13,"sizeDeletions":-13},{"number":"2","revision":"dfab083a8bcf2267eae688ddb20fc5434c18f243","parents":["0e513df9bb90b408407f1e167f907c03b4202dc5"],"ref":"refs/changes/86/2486/2","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1504655151,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504655178,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/hn-netfile","type":"MODIFIED","insertions":13,"deletions":-13},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":16,"sizeDeletions":-16},{"number":"3","revision":"554cb97172454939e905fcc4d50e4b078eb3d19c","parents":["0e513df9bb90b408407f1e167f907c03b4202dc5"],"ref":"refs/changes/86/2486/3","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1504809025,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1504733102,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504655178,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1504809035,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/hn-netfile","type":"MODIFIED","insertions":13,"deletions":-13},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":16,"sizeDeletions":-16}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}