{"project":"joyent/illumos-joyent","branch":"master","id":"I6bfe83218b9bffd2cc76dc2241e58b639ebd16d4","number":"1772","subject":"OS-XXXX tgkill incorrectly handles init threads","owner":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"url":"https://cr.joyent.us/1772","commitMessage":"OS-XXXX tgkill incorrectly handles init threads\n","createdOn":1491680296,"lastUpdated":1491870423,"open":true,"status":"NEW","comments":[{"timestamp":1491680296,"reviewer":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"message":"Uploaded patch set 1."},{"timestamp":1491849541,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)\n\nDo you have a set of test circumstances which trigger the improper behavior which this change addresses?"},{"timestamp":1491869010,"reviewer":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"message":"Patch Set 1:\n\n(1 comment)\n\n\u003e (1 comment)\n \u003e \n \u003e Do you have a set of test circumstances which trigger the improper\n \u003e behavior which this change addresses?\n\nI do. This was all motivated by trying to use .NET Core in Docker.\n\nDockerfile:\nFROM microsoft/dotnet:1-sdk-projectjson\n\nCOPY . /app\n\nWORKDIR /app\n\nRUN [\"dotnet\", \"restore\"]\n\nRUN [\"dotnet\", \"build\"]\n\nRUN [\"dotnet\", \"ef\", \"database\", \"drop\", \"-f\"]\n\nRUN [\"dotnet\", \"ef\", \"database\", \"update\"]\n\nEXPOSE 5000/tcp\n\nCMD [\"dotnet\", \"run\", \"--server.urls\", \"http://*:5000\"]\n\nproject.json:\n{\n  \"dependencies\": {\n    \"Microsoft.NETCore.App\": {\n      \"version\": \"1.1.0\",\n      \"type\": \"platform\"\n    },\n    \"Microsoft.AspNetCore.Authentication.Cookies\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Diagnostics\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Identity.EntityFrameworkCore\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Mvc\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Razor.Tools\": {\n      \"version\": \"1.1.0-preview4-final\",\n      \"type\": \"build\"\n    },\n    \"Microsoft.AspNetCore.Routing\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Server.IISIntegration\": \"1.1.0\",\n    \"Microsoft.AspNetCore.Server.Kestrel\": \"1.1.0\",\n    \"Microsoft.AspNetCore.StaticFiles\": \"1.1.0\",\n    \"Microsoft.EntityFrameworkCore.Sqlite\": \"1.1.0\",\n    \"Microsoft.EntityFrameworkCore.Sqlite.Design\": {\n      \"version\": \"1.1.0\",\n      \"type\": \"build\"\n    },\n    \"Microsoft.EntityFrameworkCore.Tools\": {\n      \"version\": \"1.1.0-preview4-final\",\n      \"type\": \"build\"\n    },\n    \"Microsoft.Extensions.Configuration.EnvironmentVariables\": \"1.1.0\",\n    \"Microsoft.Extensions.Configuration.Json\": \"1.1.0\",\n    \"Microsoft.Extensions.Configuration.CommandLine\": \"1.1.0\",\n    \"Microsoft.Extensions.Configuration.UserSecrets\": \"1.1.0\",\n    \"Microsoft.Extensions.Logging\": \"1.1.0\",\n    \"Microsoft.Extensions.Logging.Console\": \"1.1.0\",\n    \"Microsoft.Extensions.Logging.Debug\": \"1.1.0\",\n    \"Microsoft.Extensions.Options.ConfigurationExtensions\": \"1.1.0\",\n    \"Microsoft.VisualStudio.Web.BrowserLink.Loader\": \"14.1.0\",\n    \"Microsoft.VisualStudio.Web.CodeGeneration.Tools\": {\n      \"version\": \"1.1.0-preview4-final\",\n      \"type\": \"build\"\n    },\n    \"Microsoft.VisualStudio.Web.CodeGenerators.Mvc\": {\n      \"version\": \"1.1.0-preview4-final\",\n      \"type\": \"build\"\n    }\n  },\n\n  \"tools\": {\n    \"BundlerMinifier.Core\": \"2.2.306\",\n    \"Microsoft.AspNetCore.Razor.Tools\": \"1.1.0-preview4-final\",\n    \"Microsoft.AspNetCore.Server.IISIntegration.Tools\": \"1.1.0-preview4-final\",\n    \"Microsoft.EntityFrameworkCore.Tools.DotNet\": \"1.1.0-preview4-final\",\n    \"Microsoft.Extensions.SecretManager.Tools\": \"1.1.0-preview4-final\",\n    \"Microsoft.VisualStudio.Web.CodeGeneration.Tools\": {\n      \"version\": \"1.1.0-preview4-final\",\n      \"imports\": [\n        \"portable-net45+win8\"\n      ]\n    }\n  },\n\n  \"frameworks\": {\n    \"netcoreapp1.0\": {\n      \"imports\": [\n        \"dotnet5.6\",\n        \"portable-net45+win8\"\n      ]\n    }\n  },\n\n  \"buildOptions\": {\n    \"emitEntryPoint\": true,\n    \"preserveCompilationContext\": true\n  },\n\n  \"runtimeOptions\": {\n    \"configProperties\": {\n      \"System.GC.Server\": true\n    }\n  },\n\n  \"publishOptions\": {\n    \"include\": [\n      \"wwwroot\",\n      \"**/*.cshtml\",\n      \"appsettings.json\",\n      \"web.config\"\n    ]\n  },\n\n  \"scripts\": {\n    \"precompile\": [ \"dotnet bundle\" ],\n    \"prepublish\": [ \"bower install\" ],\n    \"postpublish\": [ \"dotnet publish-iis --publish-folder %publish:OutputPath% --framework %publish:FullTargetFramework%\" ]\n  },\n\n  \"tooling\": {\n    \"defaultNamespace\": \"test\"\n  }\n}"},{"timestamp":1491870420,"reviewer":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"message":"Uploaded patch set 2."}],"currentPatchSet":{"number":"2","revision":"6bfe83218b9bffd2cc76dc2241e58b639ebd16d4","parents":["59d73dcf2d9b389641c1b420dc1dc2db59257220"],"ref":"refs/changes/72/1772/2","uploader":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"createdOn":1491870420,"author":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":5,"deletions":-5}],"sizeInsertions":5,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"dcba702ef8e7ffdb3ff2d981ec10268659437e31","parents":["59d73dcf2d9b389641c1b420dc1dc2db59257220"],"ref":"refs/changes/72/1772/1","uploader":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"createdOn":1491680296,"author":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","line":121,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Maybe turn this into a little ternary declaration/assignment."},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","line":121,"reviewer":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":10,"deletions":-5}],"sizeInsertions":10,"sizeDeletions":-5},{"number":"2","revision":"6bfe83218b9bffd2cc76dc2241e58b639ebd16d4","parents":["59d73dcf2d9b389641c1b420dc1dc2db59257220"],"ref":"refs/changes/72/1772/2","uploader":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"createdOn":1491870420,"author":{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":5,"deletions":-5}],"sizeInsertions":5,"sizeDeletions":-5}],"allReviewers":[{"name":"Dillon Amburgey","email":"dillona@dillona.com","username":"dillona"}]}