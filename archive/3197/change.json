{"project":"joyent/illumos-joyent","branch":"master","id":"I85c7b8606e4a61f48f51d72efd00cb54a4afc46a","number":"3197","subject":"OS-6525 SADB_ACQUIRE proposals don\u0027t include mechanism salt length Reviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e Reviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e Approved by: Dan McDonald \u003cdanmcd@joyent.com\u003e","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/3197","commitMessage":"OS-6525 SADB_ACQUIRE proposals don\u0027t include mechanism salt length\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\nReviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e\nApproved by: Dan McDonald \u003cdanmcd@joyent.com\u003e\n","createdOn":1515706751,"lastUpdated":1515786868,"open":false,"status":"MERGED","comments":[{"timestamp":1515706751,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1515709590,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1515710914,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1515711108,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1515718100,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1515720467,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1515720561,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2: Code-Review+1\n\nMuch better."},{"timestamp":1515772782,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1515775813,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1515776064,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1515779899,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1515780439,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1515780633,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 6."},{"timestamp":1515780752,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1\n\nDon\u0027t forget to regression-test IKEv1.  (Should be quick \u0026 sane.)"},{"timestamp":1515786737,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1515786839,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1515786868,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"7","revision":"85c7b8606e4a61f48f51d72efd00cb54a4afc46a","parents":["1b0a60de665f13f5c841058f4f77632d5b3769df"],"ref":"refs/changes/97/3197/7","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515786839,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515786737,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}},{"type":"SUBM","value":"1","grantedOn":1515786868,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":24,"sizeDeletions":-16},"patchSets":[{"number":"1","revision":"ef0afd28c142a9d95294dd90c0985d66e22bbf5a","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515706751,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/net/pfkeyv2.h","line":293,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"the other lengths measured in bits are named ...bits. saltlen is in bits ? or ?"},{"file":"usr/src/uts/common/net/pfkeyv2.h","line":293,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"I was following the naming convention used by ipsec_alg_t for this (where the value originates from) -- sadly there\u0027s no guidance from struct sadb_x_algdesc (which just sticks the value in a single byte \u0027reserved\u0027 field).\n\nI\u0027m fine w/ changing the value, though I\u0027d like to make sure danmcd is ok with it first (as he\u0027s the pfkey expert)."},{"file":"usr/src/uts/common/net/pfkeyv2.h","line":293,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"that\u0027s what I expected, as long as this matches the convention.\n\ngiven that it is here with a bunch of things measured in bits, it\u0027d be worth adding a comment that this is in bytes, I think."},{"file":"usr/src/uts/common/net/pfkeyv2.h","line":293,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"saltlen is in bytes, BUT we have prior art in the SADB_REGISTER response below.  Change it to \"saltbits\" and do the SADB_8TO1(saltlen).  Consistency in this case is good."},{"file":"usr/src/uts/common/net/pfkeyv2.h","line":357,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"I\u0027m wondering if we can/should rename THIS to be sadb_x_algdesc_saltbits while we have the patient open?  More readable, and breaks no binaries."},{"file":"usr/src/uts/common/net/pfkeyv2.h","line":401,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"See, right here:  \"saltbits\"."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":4,"deletions":-2}],"sizeInsertions":13,"sizeDeletions":-8},{"number":"2","revision":"3a1dd67d298c565dccdc9ab5c608a07bf1c0a478","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515720467,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515720561,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":22,"sizeDeletions":-15},{"number":"3","revision":"58b49f2e520e177e93afb499c6796e4ce69f5471","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515772782,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515720561,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515775813,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":22,"sizeDeletions":-15},{"number":"4","revision":"2a2880a69333cee71f60ac61144214ec44887fa2","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515776064,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515720561,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515779899,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515775813,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":22,"sizeDeletions":-15},{"number":"5","revision":"c8e478c3067ce35d0687dd56568c84b6b7d5c5a4","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515780439,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515720561,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515779899,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515775813,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":22,"sizeDeletions":-15},{"number":"6","revision":"84da093dec5a3c71071697b7491189c54321a80c","parents":["d8ddf16008a51aa54084b62a0daaf70315115833"],"ref":"refs/changes/97/3197/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515780633,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515786737,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":24,"sizeDeletions":-16},{"number":"7","revision":"85c7b8606e4a61f48f51d72efd00cb54a4afc46a","parents":["1b0a60de665f13f5c841058f4f77632d5b3769df"],"ref":"refs/changes/97/3197/7","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1515786839,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"SUBM","value":"1","grantedOn":1515786868,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515780752,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515786737,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libipsecutil/common/ipsec_util.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man7p/pf_key.7p","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/inet/ip/sadb.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/net/pfkeyv2.h","type":"MODIFIED","insertions":7,"deletions":-5}],"sizeInsertions":24,"sizeDeletions":-16}],"allReviewers":[{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}