{"project":"joyent/illumos-joyent","branch":"master","id":"I8aa50c38088a8b6eb3373c2d5b449a4cd791495a","number":"4470","subject":"OS-7015 pagefault loop because somebody lost our %cr3 Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Robert Mustacchi \u003crm@joyent.com\u003e","owner":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"url":"https://cr.joyent.us/4470","commitMessage":"OS-7015 pagefault loop because somebody lost our %cr3\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1530620363,"lastUpdated":1531921442,"open":false,"status":"MERGED","comments":[{"timestamp":1530620363,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 1."},{"timestamp":1530620366,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit dcc932ab3f16b9a91539feae50a0323892e2fc9a\n    \n    m"},{"timestamp":1530620405,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1: Code-Review-1"},{"timestamp":1530693033,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 2."},{"timestamp":1530693040,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit b91b8d2680f010d336afe59254da00ea01107223\n    \n    m\n    \n    commit c4131049b01bf6a2b1438e267ec78394a9bd3f5e\n    \n    m"},{"timestamp":1530693895,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 3."},{"timestamp":1530693909,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 6677fe3df0ee2fe88b2dd5b08eeaba7a37c764d9\n    \n    m\n    \n    commit dbd5516c8a50b23dec55d8f7cebf9708c5587574\n    \n    m"},{"timestamp":1530788949,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3: -Code-Review"},{"timestamp":1531786284,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1531820178,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1531835258,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 4."},{"timestamp":1531835280,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit bbf6841d56d012593ebbe5cf2832f4b9a5660d1a\n    \n    m"},{"timestamp":1531848287,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1531905592,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1531905698,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1531905701,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 08d63bd1c9bec1bf9fc2fcc746a29ba788fbea77\n    \n    m\n    \n    commit de33832d8565586e4a8f3d2ed6b729570f6d4c46\n    \n    m\n    \n    commit 4361eebd594fd71e425f8184531212b9f4d18160\n    \n    m\n    \n    commit 3194f075780803f213fc1a560bc76c93dfc279bc\n    \n    m\n    \n    commit 3c56f6b57cdbb54ad7455d09192a1c25763485b4\n    \n    m\n    \n    commit 10170f5bb9bd93c9f3982ad90ff0deb197081dbf\n    \n    m"},{"timestamp":1531920986,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1531921442,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by John Levon"}],"currentPatchSet":{"number":"7","revision":"db2cbbce01c8ea53b138c42594279a7645ac574a","parents":["68687f36834e36f95885b75155ae1959bd96d450"],"ref":"refs/changes/70/4470/7","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1531920986,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1531921441,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28},"patchSets":[{"number":"1","revision":"a78c74971068be909f45ff8283412e12c3f7a127","parents":["17296045b06634567568b1654a46c22c764d76e9"],"ref":"refs/changes/70/4470/1","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1530620363,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1530620405,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-15}],"sizeInsertions":47,"sizeDeletions":-15},{"number":"2","revision":"bb61d58039c5f51fcff702d2d996b8e345886406","parents":["17296045b06634567568b1654a46c22c764d76e9"],"ref":"refs/changes/70/4470/2","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1530693033,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1530620405,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":64,"deletions":-27},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":77,"sizeDeletions":-38},{"number":"3","revision":"33fb0b95fe43845cd39baa886f4ea8b56b2444ed","parents":["17296045b06634567568b1654a46c22c764d76e9"],"ref":"refs/changes/70/4470/3","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1530693895,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/intel/kdi/kdi_asm.s","line":617,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Who saves and restore %r13 in this case which is normally a callee saved register? Should we instead clobber %r11 or something else? Presuming that it\u0027s the surrounding kmdb trap code then this is probably fine."},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","line":617,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"We\u0027re about to KDI_RESTORE_REGS with KDIREG_R13, so it doesn\u0027t matter. However, same applies to %r11, and that\u0027s a little less jarring, so I\u0027ll fix it up anyway."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28},{"number":"4","revision":"fef5ee021344eec183d73979c67f7f41f5148bc8","parents":["7ded4aeabf16d6abbb8a3f24364a66a321136b44"],"ref":"refs/changes/70/4470/4","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1531835258,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28},{"number":"5","revision":"ec230f99d71cccf9160c59f94f33fcb38992caae","parents":["251183602619045ad135f45b198a24867b0b1299"],"ref":"refs/changes/70/4470/5","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1531905592,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28},{"number":"6","revision":"8aa50c38088a8b6eb3373c2d5b449a4cd791495a","parents":["251183602619045ad135f45b198a24867b0b1299"],"ref":"refs/changes/70/4470/6","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1531905698,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28},{"number":"7","revision":"db2cbbce01c8ea53b138c42594279a7645ac574a","parents":["68687f36834e36f95885b75155ae1959bd96d450"],"ref":"refs/changes/70/4470/7","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1531920986,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531848287,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1531921441,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":47,"deletions":-17},{"file":"usr/src/uts/intel/kdi/kdi_idt.c","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":60,"sizeDeletions":-28}],"allReviewers":[{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}