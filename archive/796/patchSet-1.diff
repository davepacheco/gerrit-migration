From 0b44a5419eabe73f9867783d7117c05a1ceca9ee Mon Sep 17 00:00:00 2001
From: Patrick Mooney <pmooney@pfmooney.com>
Date: Thu, 27 Oct 2016 21:19:36 +0000
Subject: [PATCH] OS-5748 lxbrand /proc/1/stat access fails

---
 usr/src/uts/common/brand/lx/procfs/lx_prsubr.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/usr/src/uts/common/brand/lx/procfs/lx_prsubr.c b/usr/src/uts/common/brand/lx/procfs/lx_prsubr.c
index 0e26346b63..53d68ca4cc 100644
--- a/usr/src/uts/common/brand/lx/procfs/lx_prsubr.c
+++ b/usr/src/uts/common/brand/lx/procfs/lx_prsubr.c
@@ -227,7 +227,8 @@ retry:
 	 *
 	 * This is necessary to constrain paths such as /proc/<pid>/task/<tid>.
 	 */
-	if (lxpnp->lxpr_pid != 0 && lxpnp->lxpr_pid != pid) {
+	if (lxpnp->lxpr_pid != 0 && lxpnp->lxpr_pid != pid &&
+	    !(pid == 1 && lxpnp->lxpr_pid == zone->zone_proc_initpid)) {
 		klwp_t *lwp;
 		lx_lwp_data_t *lwpd;
 
-- 
2.21.0

