{"project":"joyent/sdc-cloudapi","branch":"master","id":"I9ed2ed90dba284a46b4082403e9e5b914fbcfe9f","number":"3218","subject":"VOLAPI-82 volume names should be limited in size Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Approved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"url":"https://cr.joyent.us/3218","commitMessage":"VOLAPI-82 volume names should be limited in size\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nApproved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1516045281,"lastUpdated":1516140759,"open":false,"status":"MERGED","comments":[{"timestamp":1516045281,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 1."},{"timestamp":1516045312,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516045658,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 1:\n\nTesting notes: ran all volumes-* tests suites in my COAL environment, all passed successfully."},{"timestamp":1516045805,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1516045837,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1516049071,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2:\n\n(9 comments)"},{"timestamp":1516061025,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(8 comments)"},{"timestamp":1516061045,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 3."},{"timestamp":1516061081,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516062360,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 4."},{"timestamp":1516062392,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516087815,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1516133981,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1516134013,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1516140723,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1516140751,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1516140755,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1516140759,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Julien Gilli"}],"currentPatchSet":{"number":"7","revision":"cb80f4c9c9b06a106cc7cad112c1b9e300691303","parents":["8a31083fbc4d684588ba04dd02e1f00d335227c7"],"ref":"refs/changes/18/3218/7","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516140751,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516062392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1516140759,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-147},"patchSets":[{"number":"1","revision":"a70f1840c57ebc3af4ee64156f5fa6514ddd11bc","parents":["878874de7fa51d73a0be4ad5ba7d3914cf98a54b"],"ref":"refs/changes/18/3218/1","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516045281,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516045312,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":60,"deletions":-53},{"file":"lib/machines.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-51},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":202,"sizeDeletions":-138},{"number":"2","revision":"77eeb83517a77f6e06843d8c09359cf629dda03e","parents":["fcc5f22a8265a6f023c6ede2ee9e0f9691bbb1da"],"ref":"refs/changes/18/3218/2","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516045805,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516045312,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/volumes.js","line":138,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This block is functionally equivalent to:\n\nvalidationErrs \u003d validationErrs.concat(latestErrs);\n\nI think this diff would be cleaner and shorter if this pattern was removed from this file."},{"file":"lib/endpoints/volumes.js","line":138,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Good point and agreed, will fix!"},{"file":"lib/endpoints/volumes.js","line":265,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Given how common req.params is, maybe assign it to its own variable (params)."},{"file":"lib/endpoints/volumes.js","line":265,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/endpoints/volumes.js","line":467,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This seems superfluous here -- you could assign the validateVolumeId directly to validationErrs and get rid of latestErrs."},{"file":"lib/endpoints/volumes.js","line":467,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/machines.js","line":1193,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Likewise as with the other file."},{"file":"lib/machines.js","line":1193,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/validation/predicate.js","line":68,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Not concat()?"},{"file":"lib/validation/predicate.js","line":68,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Good catch, will fix!"},{"file":"lib/validation/volumes.js","line":52,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"constrain"},{"file":"lib/validation/volumes.js","line":52,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/validation/volumes.js","line":143,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"else"},{"file":"lib/validation/volumes.js","line":143,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"test/volumes-create-name.test.js","line":59,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"There\u0027s also t.fail()"},{"file":"test/volumes-create-name.test.js","line":59,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"test/volumes-create-name.test.js","line":144,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Oooh! TIL!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":60,"deletions":-53},{"file":"lib/machines.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-51},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":202,"sizeDeletions":-138},{"number":"3","revision":"49cd785a9c34c73b832b59c9ad869182cf333422","parents":["878874de7fa51d73a0be4ad5ba7d3914cf98a54b"],"ref":"refs/changes/18/3218/3","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516061045,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516061081,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":192,"sizeDeletions":-147},{"number":"4","revision":"9ed2ed90dba284a46b4082403e9e5b914fbcfe9f","parents":["878874de7fa51d73a0be4ad5ba7d3914cf98a54b"],"ref":"refs/changes/18/3218/4","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516062360,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516062392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-147},{"number":"5","revision":"b8b358f484aa3b39c659f0b423fa410ff4596a99","parents":["fcc5f22a8265a6f023c6ede2ee9e0f9691bbb1da"],"ref":"refs/changes/18/3218/5","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516133981,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516062392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-147},{"number":"6","revision":"baa46363013e7f39ee13dfc0b9473a2bc7ce233f","parents":["8a31083fbc4d684588ba04dd02e1f00d335227c7"],"ref":"refs/changes/18/3218/6","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516140723,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516062392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-147},{"number":"7","revision":"cb80f4c9c9b06a106cc7cad112c1b9e300691303","parents":["8a31083fbc4d684588ba04dd02e1f00d335227c7"],"ref":"refs/changes/18/3218/7","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516140751,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516062392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1516140759,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516087815,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":44,"deletions":-59},{"file":"lib/machines.js","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":65,"deletions":-53},{"file":"test/volumes-create-name.test.js","type":"MODIFIED","insertions":40,"deletions":-20},{"file":"test/volumes-create-validation.test.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/volumes-list-sizes.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/volumes-update-name.test.js","type":"MODIFIED","insertions":25,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-147}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}]}