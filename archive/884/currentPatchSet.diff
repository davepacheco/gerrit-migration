From af1592e701d29f3224e5f120b19eeaca1e49f22e Mon Sep 17 00:00:00 2001
From: Patrick Mooney <pmooney@pfmooney.com>
Date: Fri, 11 Nov 2016 18:33:26 +0000
Subject: [PATCH] OS-5785 libidn2 broken on automake 1.14 Reviewed by: Robert
 Mustacchi <rm@joyent.com> Approved by: Robert Mustacchi <rm@joyent.com>

---
 libidn2/Makefile                |  2 +-
 libidn2/Patches/0000-docs.patch | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+), 1 deletion(-)
 create mode 100644 libidn2/Patches/0000-docs.patch

diff --git a/libidn2/Makefile b/libidn2/Makefile
index eaf1f5b..57b94b7 100644
--- a/libidn2/Makefile
+++ b/libidn2/Makefile
@@ -23,7 +23,7 @@ CFLAGS +=	-g
 AUTOCONF_ENV += \
 	INSTALL="/usr/ucb/install -c"
 
-#PATCHES =	Patches/*
+PATCHES =	Patches/*
 
 include ../Makefile.targ
 
diff --git a/libidn2/Patches/0000-docs.patch b/libidn2/Patches/0000-docs.patch
new file mode 100644
index 0000000..2922be0
--- /dev/null
+++ b/libidn2/Patches/0000-docs.patch
@@ -0,0 +1,18 @@
+From: Patrick Mooney <patrick.mooney@joyent.com>
+Date: Fri, 11 Nov 2016 18:07:10 +0000
+
+Disable the building of documentation.  If one attempts to build that target,
+it will invoke automake which has a tendency to be very picky about version.
+Since we aren't shipping the docs anyways, it's unecessary to fret about them.
+
+--- a/Makefile.in
++++ b/Makefile.in
+@@ -596,7 +596,7 @@
+ top_builddir = @top_builddir@
+ top_srcdir = @top_srcdir@
+ DISTCHECK_CONFIGURE_FLAGS = --enable-gtk-doc
+-SUBDIRS = gl . src doc examples tests
++SUBDIRS = gl . src examples tests
+ ACLOCAL_AMFLAGS = -I m4 -I gl/m4
+ EXTRA_DIST = gl/m4/gnulib-cache.m4 gen-tables-from-rfc5892.pl \
+ 	gen-tables-from-iana.pl
-- 
2.21.0

