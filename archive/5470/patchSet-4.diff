From d594d57e62cd961ec8a7135fae0eb8cab6664ab8 Mon Sep 17 00:00:00 2001
From: Tim Foster <tim.foster@joyent.com>
Date: Thu, 7 Feb 2019 18:18:13 +0000
Subject: [PATCH] TRITON-1178 sdcadm man page build expects node in $PATH
 Reviewed by: Trent Mick <trentm@gmail.com> Approved by: Trent Mick
 <trentm@gmail.com>

---
 CHANGES.md   | 6 +++++-
 Makefile     | 7 ++++---
 package.json | 2 +-
 3 files changed, 10 insertions(+), 5 deletions(-)

diff --git a/CHANGES.md b/CHANGES.md
index 3d5dfb9..2d01589 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -5,11 +5,15 @@
 -->
 
 <!--
-    Copyright (c) 2019 Joyent, Inc.
+    Copyright (c) 2019, Joyent, Inc.
 -->
 
 # sdcadm Changelog
 
+## 1.24.4
+
+- TRITON-1178 sdcadm man page build expects node in $PATH
+
 ## 1.24.3
 
 - TRITON-754 lib/sdcadm.js is not admin rack aware
diff --git a/Makefile b/Makefile
index 42372f9..a48c525 100644
--- a/Makefile
+++ b/Makefile
@@ -5,7 +5,7 @@
 #
 
 #
-# Copyright 2018 Joyent, Inc.
+# Copyright (c) 2019, Joyent, Inc.
 #
 
 #
@@ -116,9 +116,10 @@ check:: check-version
 
 
 .PHONY: man
-man: man/man1/sdcadm.1.ronn
+man: man/man1/sdcadm.1.ronn | $(NODE_EXEC)
 	rm -f man/man1/sdcadm.1
-	./node_modules/.bin/marked-man --input man/man1/sdcadm.1.ronn \
+	$(NODE_EXEC) ./node_modules/.bin/marked-man \
+		--input man/man1/sdcadm.1.ronn \
 		--date `git log -1 --pretty=format:%cd --date=short` \
 		--output man/man1/sdcadm.1
 	chmod 444 man/man1/sdcadm.1
diff --git a/package.json b/package.json
index 2608504..31bec76 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "sdcadm",
   "description": "Administer a SmartDataCenter (SDC) standup",
-  "version": "1.24.3",
+  "version": "1.24.4",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
-- 
2.21.0

