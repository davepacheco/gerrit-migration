From 31a3a25bd62b1d46920088fe395cf1393e866054 Mon Sep 17 00:00:00 2001
From: Nick Zivkovic <nick.zivkovic@joyent.com>
Date: Wed, 21 Mar 2018 20:18:23 +0000
Subject: [PATCH] TOOLS-2004 Warden should adopt assert-plus naming convention

---
 lib/validate.js   |  16 ++---
 lib/validators.js |  16 ++---
 package.json      |   2 +-
 tests/run.js      | 164 +++++++++++++++++++++++-----------------------
 4 files changed, 99 insertions(+), 99 deletions(-)

diff --git a/lib/validate.js b/lib/validate.js
index 7cf76d4..a99055f 100644
--- a/lib/validate.js
+++ b/lib/validate.js
@@ -236,18 +236,18 @@ function crossValidate(errs, arg, raw, validated, afterFuncs, callback) {
 
 module.exports = {
     params: validateParams,
-    fieldsArray: validators.fieldsArray,
-    IParray: validators.IParray,
-    IP: validators.IP,
+    arrayOfFields: validators.arrayOfFields,
+    arrayOfIp: validators.arrayOfIp,
+    ip: validators.ip,
     string: validators.string,
-    stringArray: validators.stringArray,
+    arrayOfString: validators.arrayOfString,
     stringOrArray: validators.stringOrArray,
     subnet: validators.subnet,
-    subnetArray: validators.subnetArray,
-    UUID: validators.UUID,
+    arrayOfSubnet: validators.arrayOfSubnet,
+    uuid: validators.uuid,
     uuidPrefix: validators.uuidPrefix,
-    isUUID: validators.isUUID,
-    UUIDarray: validators.UUIDarray,
+    isUuid: validators.isUuid,
+    arrayOfUuid: validators.arrayOfUuid,
     isNotInteger: validators.isNotInteger,
     offset: validators.offset,
     limit: validators.limit,
diff --git a/lib/validators.js b/lib/validators.js
index 36f3f18..b97cb30 100644
--- a/lib/validators.js
+++ b/lib/validators.js
@@ -514,18 +514,18 @@ function validateBoolean(_, name, val, callback) {
 
 
 module.exports = {
-    fieldsArray: validateFieldsArray,
-    IParray: validateIParray,
-    IP: validateIP,
+    arrayOfFields: validateFieldsArray,
+    arrayOfIp: validateIParray,
+    ip: validateIP,
     subnet: validateSubnet,
-    subnetArray: validateSubnetArray,
-    stringArray: validateStringArray,
+    arrayOfSubnet: validateSubnetArray,
+    arrayOfString: validateStringArray,
     string: validateString,
     stringOrArray: validateStringOrArray,
     uuidPrefix: validateUUIDPrefix,
-    UUID: validateUUID,
-    isUUID: isValidUUID,
-    UUIDarray: validateUUIDarray,
+    uuid: validateUUID,
+    isUuid: isValidUUID,
+    arrayOfUuid: validateUUIDarray,
     isNotInteger: isNotInteger,
     offset: validateOffset,
     limit: validateLimit,
diff --git a/package.json b/package.json
index caa91da..5348e3e 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "restify-warden",
-  "version": "0.2.0",
+  "version": "1.0.0",
   "description": "Yet another parameter validator",
   "author": "Joyent, Inc",
   "main": "./lib/validate.js",
diff --git a/tests/run.js b/tests/run.js
index ad20f25..87e874d 100644
--- a/tests/run.js
+++ b/tests/run.js
@@ -44,7 +44,7 @@ function expErrInternal(err, t) {
 
 function expVErrInternal(err, errs,  t) {
     var errExp = new restify.InternalError('Internal error');
-    errExp.we_cause = new verror.MultiError(errs);
+    errExp.jse_cause = new verror.MultiError(errs);
 
     t.deepEqual(err, errExp);
 }
@@ -71,7 +71,7 @@ test('IP-S-KV', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IP
+            ip: validate.ip
         }
     };
     var params = { ip: '8.8.8.8' };
@@ -102,9 +102,9 @@ test('GEN-S-MULTI', function (t) {
 test('Fields-S-KV', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name' ])
+            fields: validate.arrayOfFields([ 'name' ])
         }
     };
 
@@ -120,9 +120,9 @@ test('Fields-S-KV', function (t) {
 test('Params-S-Undef', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name' ])
+            fields: validate.arrayOfFields([ 'name' ])
         }
     };
 
@@ -141,9 +141,9 @@ test('Params-S-Undef', function (t) {
 test('Params-S-Arr', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name' ])
+            fields: validate.arrayOfFields([ 'name' ])
         }
     };
 
@@ -162,9 +162,9 @@ test('Params-S-Arr', function (t) {
 test('Params-S-Num', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name' ])
+            fields: validate.arrayOfFields([ 'name' ])
         }
     };
 
@@ -183,9 +183,9 @@ test('Params-S-Num', function (t) {
 test('Fields-S-KI-arr-excess', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name', 'addr' ])
+            fields: validate.arrayOfFields([ 'name', 'addr' ])
         }
     };
 
@@ -206,9 +206,9 @@ test('Fields-S-KI-arr-excess', function (t) {
 test('Fields-S-KI-notarr', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name', 'addr' ])
+            fields: validate.arrayOfFields([ 'name', 'addr' ])
         }
     };
 
@@ -228,9 +228,9 @@ test('Fields-S-KI-notarr', function (t) {
 test('Fields-S-KI-arr-has-no-str', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name', 'addr' ])
+            fields: validate.arrayOfFields([ 'name', 'addr' ])
         }
     };
 
@@ -250,9 +250,9 @@ test('Fields-S-KI-arr-has-no-str', function (t) {
 test('Fields-S-KI-arr-bad-name', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name', 'addr' ])
+            fields: validate.arrayOfFields([ 'name', 'addr' ])
         }
     };
 
@@ -272,9 +272,9 @@ test('Fields-S-KI-arr-bad-name', function (t) {
 test('Fields-S-KI-arr-zero', function (t) {
     var opts = {
         strict: true,
-        required: { name: validate.UUID },
+        required: { name: validate.uuid },
         optional: {
-            fields: validate.fieldsArray([ 'name', 'addr' ])
+            fields: validate.arrayOfFields([ 'name', 'addr' ])
         }
     };
 
@@ -295,7 +295,7 @@ test('IP-S-KI', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IP
+            ip: validate.ip
         }
     };
     var params = { ip: 'Veni, vidi, vici' };
@@ -314,7 +314,7 @@ test('IP-S-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IP
+            ip: validate.ip
         }
     };
     var params = { hal: '1000' };
@@ -332,7 +332,7 @@ test('IP-S-KI-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IP
+            ip: validate.ip
         }
     };
     var params = { ip: 'Et tu, Brute?', hal: '1000' };
@@ -347,11 +347,11 @@ test('IP-S-KI-U', function (t) {
     });
 });
 
-test('IParray-S-KV-array', function (t) {
+test('arrayOfIp-S-KV-array', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { ip: ['8.8.8.8', '4.4.4.4'] };
@@ -362,11 +362,11 @@ test('IParray-S-KV-array', function (t) {
     });
 });
 
-test('IParray-S-KV-array-after', function (t) {
+test('arrayOfIp-S-KV-array-after', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         },
         after: function some_no_op(_, _raw, _validated, cb) {
                    return cb();
@@ -380,11 +380,11 @@ test('IParray-S-KV-array-after', function (t) {
     });
 });
 
-test('IParray-S-KV-string', function (t) {
+test('arrayOfIp-S-KV-string', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { ip: '8.8.8.8,4.4.4.4' };
@@ -395,11 +395,11 @@ test('IParray-S-KV-string', function (t) {
     });
 });
 
-test('IParray-S-KV-array-after', function (t) {
+test('arrayOfIp-S-KV-array-after', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         },
         after: function some_no_op(_, _raw, _validated, cb) {
                    return cb({my_err_obj: 42});
@@ -414,12 +414,12 @@ test('IParray-S-KV-array-after', function (t) {
     });
 });
 
-test('IParray-S-KV-array-after2', function (t) {
+test('arrayOfIp-S-KV-array-after2', function (t) {
     var afterErrs = [ {my_err_obj: 42}, {meo: 43} ];
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         },
         after: function some_no_op(_, _raw, _validated, cb) {
             return cb(afterErrs);
@@ -434,11 +434,11 @@ test('IParray-S-KV-array-after2', function (t) {
     });
 });
 
-test('IParray-S-KI-string-empty', function (t) {
+test('arrayOfIp-S-KI-string-empty', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { ip: '' };
@@ -454,11 +454,11 @@ test('IParray-S-KI-string-empty', function (t) {
     });
 });
 
-test('IParray-S-KI-string-notArr', function (t) {
+test('arrayOfIp-S-KI-string-notArr', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { ip: {obj: 'notanarray', foo: 43 } };
@@ -473,11 +473,11 @@ test('IParray-S-KI-string-notArr', function (t) {
     });
 });
 
-test('subnetArray-S-KI-string-notArr', function (t) {
+test('arrayOfSubnet-S-KI-string-notArr', function (t) {
     var opts = {
         strict: true,
         required: {
-            subnet: validate.subnetArray
+            subnet: validate.arrayOfSubnet
         }
     };
     var params = { subnet: {obj: 'notanarray', foo: 43 } };
@@ -492,11 +492,11 @@ test('subnetArray-S-KI-string-notArr', function (t) {
     });
 });
 
-test('IParray-S-U', function (t) {
+test('arrayOfIp-S-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { hotdog: ['frank', 'bun', 'dijon'] };
@@ -537,11 +537,11 @@ function set_err_inv(error, invalid, noproc, sort) {
     }
 }
 
-test('IParray-S-KI-U', function (t) {
+test('arrayOfIp-S-KI-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            ip: validate.IParray
+            ip: validate.arrayOfIp
         }
     };
     var params = { nirvana: ['in bloom', 'smells like teen spirit'],
@@ -765,11 +765,11 @@ test('subnet-S-KI-U', function (t) {
     });
 });
 
-test('subnetArray-S-KV', function (t) {
+test('arrayOfSubnet-S-KV', function (t) {
     var opts = {
         strict: true,
         required: {
-            subnet: validate.subnetArray
+            subnet: validate.arrayOfSubnet
         }
     };
     var params = { subnet: '8.8.8.0/24,4.4.4.0/24' };
@@ -780,11 +780,11 @@ test('subnetArray-S-KV', function (t) {
     });
 });
 
-test('subnetArray-S-KI-gibberish', function (t) {
+test('arrayOfSubnet-S-KI-gibberish', function (t) {
     var opts = {
         strict: true,
         required: {
-            subnet: validate.subnetArray
+            subnet: validate.arrayOfSubnet
         }
     };
     var params = { subnet: 'not,a,subnet,tro,lo,lo' };
@@ -800,11 +800,11 @@ test('subnetArray-S-KI-gibberish', function (t) {
     });
 });
 
-test('subnetArray-S-KI-emptystring', function (t) {
+test('arrayOfSubnet-S-KI-emptystring', function (t) {
     var opts = {
         strict: true,
         required: {
-            subnet: validate.subnetArray
+            subnet: validate.arrayOfSubnet
         }
     };
     var params = { subnet: '' };
@@ -821,7 +821,7 @@ test('subnetArray-S-KI-emptystring', function (t) {
     });
 });
 
-test('subnetArray-S-KI-notobject', function (t) {
+test('arrayOfSubnet-S-KI-notobject', function (t) {
     var opts = {
         strict: true,
         required: {
@@ -844,7 +844,7 @@ test('UUID-S-KV', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUID
+            uuid: validate.uuid
         }
     };
     var params = { uuid: '895ef360-aadb-11e6-b917-178ac4f402e3' };
@@ -858,7 +858,7 @@ test('UUID-S-KI', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUID
+            uuid: validate.uuid
         }
     };
     var params = { uuid: 'Yo mama\'s pudgey. Face it.' };
@@ -876,7 +876,7 @@ test('UUID-S-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUID
+            uuid: validate.uuid
         }
     };
     var params = { kilroy: 'was here' };
@@ -894,7 +894,7 @@ test('UUID-S-KI-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUID
+            uuid: validate.uuid
         }
     };
     var params = { uuid: 'they took my spider-jars into prison',
@@ -978,11 +978,11 @@ test('uuidPrefix-S-KI-suffix', function (t) {
     });
 });
 
-test('UUIDarray-S-KV: accepts and returns array of UUIDs', function (t) {
+test('arrayOfUuid-S-KV: accepts and returns array of UUIDs', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
 
@@ -1000,11 +1000,11 @@ test('UUIDarray-S-KV: accepts and returns array of UUIDs', function (t) {
     });
 });
 
-test('UUIDarray-S-KV: accepts and converts UUID string', function (t) {
+test('arrayOfUuid-S-KV: accepts and converts UUID string', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
 
@@ -1018,11 +1018,11 @@ test('UUIDarray-S-KV: accepts and converts UUID string', function (t) {
     });
 });
 
-test('UUIDarray-S-KI: array containing an invalid UUID', function (t) {
+test('arrayOfUuid-S-KI: array containing an invalid UUID', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
     var params = { uuid: ['Gotta keep my mind free...',
@@ -1039,11 +1039,11 @@ test('UUIDarray-S-KI: array containing an invalid UUID', function (t) {
     });
 });
 
-test('UUIDarray-S-KI: not an array (object)', function (t) {
+test('arrayOfUuid-S-KI: not an array (object)', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
 
@@ -1059,11 +1059,11 @@ test('UUIDarray-S-KI: not an array (object)', function (t) {
     });
 });
 
-test('UUIDarray-S-KI: not an array (boolean)', function (t) {
+test('arrayOfUuid-S-KI: not an array (boolean)', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
 
@@ -1079,11 +1079,11 @@ test('UUIDarray-S-KI: not an array (boolean)', function (t) {
     });
 });
 
-test('UUIDarray-S-U', function (t) {
+test('arrayOfUuid-S-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
     var params = { badcafe: [ '1719a244-ab78-11e6-bd7e-c71f1a793a36'] };
@@ -1098,11 +1098,11 @@ test('UUIDarray-S-U', function (t) {
     });
 });
 
-test('UUIDarray-S-KI-U', function (t) {
+test('arrayOfUuid-S-KI-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            uuid: validate.UUIDarray
+            uuid: validate.arrayOfUuid
         }
     };
     var params = { quickcheck: [ 'The way tests were meant', 'to be written'],
@@ -1369,13 +1369,13 @@ test('boolean-S-U', function (t) {
     });
 });
 
-test('isUUID', function (t) {
+test('isUuid', function (t) {
     var uuid = '4aafe9a6-ab7d-11e6-93bb-c315b954888f';
-    var T = validate.isUUID(uuid);
+    var T = validate.isUuid(uuid);
     t.ok(T === true, 'Expected true');
-    var F = validate.isUUID('4aafe9a6ab7d11e693bbc315b954888f');
+    var F = validate.isUuid('4aafe9a6ab7d11e693bbc315b954888f');
     t.ok(F === false, 'Expected false');
-    F = validate.isUUID(0x4aafe9a6ab7d);
+    F = validate.isUuid(0x4aafe9a6ab7d);
     t.ok(F === false, 'Expected false');
     t.end();
 });
@@ -1468,11 +1468,11 @@ test('String-S-KI-U', function (t) {
     });
 });
 
-test('StringArray-S-KV', function (t) {
+test('arrayOfString-S-KV', function (t) {
     var opts = {
         strict: true,
         required: {
-            strs: validate.stringArray
+            strs: validate.arrayOfString
         }
     };
     var params = { strs: ['String', 'String', 'String'] };
@@ -1483,11 +1483,11 @@ test('StringArray-S-KV', function (t) {
     });
 });
 
-test('StringArray-S-KI-one-empty', function (t) {
+test('arrayOfString-S-KI-one-empty', function (t) {
     var opts = {
         strict: true,
         required: {
-            strs: validate.stringArray
+            strs: validate.arrayOfString
         }
     };
     var params = { strs: ['String', 'String', ''] };
@@ -1501,11 +1501,11 @@ test('StringArray-S-KI-one-empty', function (t) {
     });
 });
 
-test('StringArray-S-KI-not-array', function (t) {
+test('arrayOfString-S-KI-not-array', function (t) {
     var opts = {
         strict: true,
         required: {
-            strs: validate.stringArray
+            strs: validate.arrayOfString
         }
     };
     var params = { strs: 'String,With,Commas' };
@@ -1519,11 +1519,11 @@ test('StringArray-S-KI-not-array', function (t) {
     });
 });
 
-test('StringArray-S-U', function (t) {
+test('arrayOfString-S-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            strs: validate.stringArray
+            strs: validate.arrayOfString
         }
     };
     var params = { trash: ['MyString'] };
@@ -1537,11 +1537,11 @@ test('StringArray-S-U', function (t) {
     });
 });
 
-test('StringArray-S-KI-U', function (t) {
+test('arrayOfString-S-KI-U', function (t) {
     var opts = {
         strict: true,
         required: {
-            strs: validate.stringArray
+            strs: validate.arrayOfString
         }
     };
     var params = { trash: ['MyString'], strs: [''] };
-- 
2.21.0

