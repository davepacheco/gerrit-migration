{"project":"joyent/sdc-napi","branch":"master","id":"I1fa6924a8f26d807de46c98112bd940301ca4609","number":"3843","subject":"TRITON-269 Upgrade NAPI to Moray client v3 Reviewed by: Jason King \u003cjason.king@joyent.com\u003e Approved by: Jason King \u003cjason.king@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/3843","commitMessage":"TRITON-269 Upgrade NAPI to Moray client v3\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nApproved by: Jason King \u003cjason.king@joyent.com\u003e\n","createdOn":1524177903,"lastUpdated":1524509497,"open":false,"status":"MERGED","comments":[{"timestamp":1524177903,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1524177933,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n xmllint --noout --path tools/ --dtdvalid tools/service_bundle.dtd.1 smf/manifests/napi.xml\n /tmp/repo/build/node/bin/node node_modules/.bin/eslint  server.js lib/migratectl.js lib/napictl.js lib/endpoints/search.js lib/endpoints/fabrics/networks.js lib/endpoints/fabrics/common.js lib/endpoints/fabrics/vlans.js lib/endpoints/nics.js lib/endpoints/ping.js lib/endpoints/aggregations.js lib/endpoints/manage.js lib/endpoints/index.js lib/endpoints/network-pools.js lib/endpoints/nic-tags.js lib/endpoints/networks/index.js lib/endpoints/networks/ips.js lib/endpoints/networks/nics.js lib/endpoints/networks/common.js lib/init.js lib/migrate.js lib/napi.js lib/models/network.js lib/models/fabric.js lib/models/aggregation.js lib/models/network-pool.js lib/models/nic-tag.js lib/models/nic/obj.js lib/models/nic/create.js lib/models/nic/provision.js lib/models/nic/bucket.js lib/models/nic/index.js lib/models/nic/list.js lib/models/nic/common.js lib/models/nic/get.js lib/models/nic/del.js lib/models/nic/update.js lib/models/ip/provision.js lib/models/ip/common.js lib/models/ip/index.js lib/models/vlan.js lib/models/index.js lib/util/intersect.js lib/util/ip.js lib/util/constants.js lib/util/common.js lib/util/oui.js lib/util/errors.js lib/util/validate.js lib/apis/moray.js lib/config.js test/lib/migration.js test/lib/err.js test/lib/moray.js test/lib/config.js test/lib/log.js test/lib/ip.js test/lib/common.js test/lib/portolan.js test/lib/net.js test/lib/fabric-net.js test/lib/mock-wf.js test/lib/nic-tag.js test/lib/vlan.js test/lib/fabrics.js test/lib/aggr.js test/lib/nic.js test/lib/client.js test/lib/pool.js test/lib/server.js test/unit/helpers.js test/unit/nics.test.js test/unit/search-ips.test.js test/unit/network-owner.test.js test/unit/nics-list.test.js test/unit/networks.test.js test/unit/util-oui.test.js test/unit/nic-tags.test.js test/unit/util-intersect.test.js test/unit/ips.test.js test/unit/run.js test/unit/network-pools.test.js test/unit/aggregations.test.js test/unit/util-ip.test.js test/unit/networks-list.test.js test/integration/ips.test.js test/integration/helpers.js test/integration/fabrics.test.js test/integration/nic-tags.test.js test/integration/aggregations.test.js test/integration/regression-NET-281.test.js test/integration/migration-1.2.0-networks.test.js test/integration/network-owner.test.js test/integration/networks.test.js test/integration/zz-delete-test-networks.test.js test/integration/fabrics-invalid.test.js test/integration/nics.test.js test/integration/provision.test.js test/integration/network-overlap.test.js test/integration/network-pools.test.js bin/ip2num bin/num2ip bin/mac2num bin/num2mac\n \n /tmp/repo/lib/napi.js\n   44:5  error  \u0027NAPI_CHANGEFEED_BUCKET\u0027 is defined but never used  no-unused-vars\n \n âœ– 1 problem (1 error, 0 warnings)\n \n tools/mk/Makefile.targ:201: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1524178152,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1524178214,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1524178548,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1524178608,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1524254859,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1524255762,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1524255776,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1524255824,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1524255828,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1524505388,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1524505458,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1524509396,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1524509463,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1524509484,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1524509497,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"7","revision":"207d8989621a446d238a98d72796347ca158ddfc","parents":["40a13a8774ba75b37acd467e688c4e5f93227c95"],"ref":"refs/changes/43/3843/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524509484,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524255824,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1524255828,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1524509463,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"SUBM","value":"1","grantedOn":1524509497,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},"patchSets":[{"number":"1","revision":"20fbd4da6be425518726624b97636df90344a147","parents":["51d853b18e1f02f3ac2165f6dfb5691c8217e7bb"],"ref":"refs/changes/43/3843/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524177903,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1524177933,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":162,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":236,"sizeDeletions":-207},{"number":"2","revision":"67119125522915ddcfcc5f77303cb778942011a6","parents":["51d853b18e1f02f3ac2165f6dfb5691c8217e7bb"],"ref":"refs/changes/43/3843/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524178152,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524178214,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},{"number":"3","revision":"fb0624569b7467dd27afe32f4dc29d3c957ffc40","parents":["51d853b18e1f02f3ac2165f6dfb5691c8217e7bb"],"ref":"refs/changes/43/3843/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524178548,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524178608,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/napi.js","line":324,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Should this function have a name?"},{"file":"lib/napi.js","line":324,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},{"number":"4","revision":"293ef8a45678e9560a539e5088238910c078e1e9","parents":["ee605c6db4cea5b91222e8e13b01323aa1d6cd47"],"ref":"refs/changes/43/3843/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524255762,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524255824,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1524255828,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},{"number":"5","revision":"2f66cc95fd48505a9b8113a2383783ad3458440a","parents":["7de64d4c5d79e26192b9a839905d6d25fc713012"],"ref":"refs/changes/43/3843/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524505388,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524255824,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1524255828,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},{"number":"6","revision":"1fa6924a8f26d807de46c98112bd940301ca4609","parents":["40a13a8774ba75b37acd467e688c4e5f93227c95"],"ref":"refs/changes/43/3843/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524509396,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524255824,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1524255828,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1524509463,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207},{"number":"7","revision":"207d8989621a446d238a98d72796347ca158ddfc","parents":["40a13a8774ba75b37acd467e688c4e5f93227c95"],"ref":"refs/changes/43/3843/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1524509484,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1524509497,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524255824,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1524255828,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1524509463,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/config.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/migratectl.js","type":"MODIFIED","insertions":6,"deletions":-13},{"file":"lib/napi.js","type":"MODIFIED","insertions":161,"deletions":-145},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"sapi_manifests/napi/template","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"server.js","type":"MODIFIED","insertions":2,"deletions":-19},{"file":"test/lib/portolan.js","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"test/lib/server.js","type":"MODIFIED","insertions":13,"deletions":-18}],"sizeInsertions":235,"sizeDeletions":-207}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}