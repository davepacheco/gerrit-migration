{"project":"joyent/mountain-gorilla","branch":"master","id":"Ica8049dbaef632b7956fcdf5a07ff001a5b5b1df","number":"721","subject":"PUBAPI-1310: Upgrade Node.js to v4 before 0.10 EOL in Oct 2016 PUBAPI-1339: Move haproxy from cloudapi repo to pkgsrc Reviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/721","commitMessage":"PUBAPI-1310: Upgrade Node.js to v4 before 0.10 EOL in Oct 2016\nPUBAPI-1339: Move haproxy from cloudapi repo to pkgsrc\nReviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e\n","createdOn":1476762253,"lastUpdated":1479950168,"open":false,"status":"MERGED","comments":[{"timestamp":1476762253,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1476843299,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1476883059,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1476883310,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1476883468,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\n\u003e Won\u0027t cloudapi require haproxy as well? My understanding is that the haproxy in pkgsrc has whatever locally applied patches that cloudapi was using. We should verify and move to the haproxy build from pkgsrc for cloudapi.\n\nOh, whoops, I misunderstood what you wanted here. Cloudapi has haproxy as a git module dep -- and I agree that we should switch from that to using pkgsrc haproxy.\n\nThe rest were changed as per your suggestions."},{"timestamp":1476920198,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\nMarsell, so this looks good. Are you going to\n\n(a) update this to add haproxy and sdc-cloudapi.git to use that one, and\n(b) push these to a branch so we can get TRY_BUILDs of cloudapi for testing\n\n?"},{"timestamp":1476921907,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nEvery single commit here and for 720 have had TRY_BUILDs done. But yes, I\u0027ll do the haproxy switcheroo and make a new build."},{"timestamp":1476936600,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 4."},{"timestamp":1476936695,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4:\n\nsdcadm up cloudapi@9bd3edd8-9678-11e6-bceb-db1fde9d8fcd"},{"timestamp":1477087855,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Code-Review+1\n\nObviously don\u0027t integrate until the cloudapi.git CR is ready as well."},{"timestamp":1477992789,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1479375000,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1479375041,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6:\n\nUsed to build the following: sdcadm up cloudapi@eb713452-aca5-11e6-bd7b-d360385171b5"},{"timestamp":1479870480,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1479949438,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1479950159,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1479950168,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Marsell Kukuljevic"}],"currentPatchSet":{"number":"8","revision":"ca8049dbaef632b7956fcdf5a07ff001a5b5b1df","parents":["20f8b7c99f7c061f2f6c500f8d90ca820f80cc08"],"ref":"refs/changes/21/721/8","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1479950159,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479949438,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1479950168,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"981cacc3c057c2ebe223de11af8e48d693c492b3","parents":["8192983cec6ecc17b8fffb45128fbf92d4cb888b"],"ref":"refs/changes/21/721/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1476762253,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","comments":[{"file":"targets.json.in","line":373,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Won\u0027t cloudapi require haproxy as well? My understanding is that the haproxy in pkgsrc has whatever locally applied patches that cloudapi was using. We should verify and move to the haproxy build from pkgsrc for cloudapi."},{"file":"targets.json.in","line":375,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Suggestion: have two blocks here so that it looks like this:\n\n```\n    \"pkgsrc\": [\n        \"coreutils-8.23nb2\",\n        \"curl-7.47.1\",\n        \"gsed-4.2.2nb4\",\n        \"patch-2.7.5\",\n        \"sudo-1.8.15\",\n\n        \"openssl-1.0.2j\",\n        \"stud-0.3p53nb5\"\n    ],\n```\n\nThe idea is to separate the former (the set of pkgs we expect to eventually be part of an origin \"triton-origin\" image per RFD 46) and the latter (specific to this image)."},{"file":"targets.json.in","line":379,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Drop dateutils and grep. I\u0027ve updated RFD 59 and RFD 46 accordingly. After DATASET-1269, the \u0027grep\u0027 package should no longer be required in core images. For \u0027dateutils\u0027 I think it is only IMGAPI (or not even IMGAPI) that requires it. We should start without it and if there is a found reason to have it, then cool, we\u0027ll add it back and update the RFDs."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"2","revision":"fe35b20a7cf3c64b96a1f7e9f4535782301eca99","parents":["8192983cec6ecc17b8fffb45128fbf92d4cb888b"],"ref":"refs/changes/21/721/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1476883059,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":10,"deletions":-4}],"sizeInsertions":10,"sizeDeletions":-4},{"number":"3","revision":"af194edffd801772e41abf8e17abc3115da9714c","parents":["c914c89927c12e7b7b67c090b892a071ba2ed2e4"],"ref":"refs/changes/21/721/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1476883310,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":10,"deletions":-4}],"sizeInsertions":10,"sizeDeletions":-4},{"number":"4","revision":"633496c44f8fda5cb4811784ad22f1405edee910","parents":["c914c89927c12e7b7b67c090b892a071ba2ed2e4"],"ref":"refs/changes/21/721/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1476936600,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"5","revision":"04ef2869214abca3346957d78261f193ce3d8edc","parents":["a32114cac62695329a2ced7c0a9700a34acd344f"],"ref":"refs/changes/21/721/5","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1477992789,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"6","revision":"7d5d32f881a6cfbacb29392f51a254c3abbb4812","parents":["308976115ec752b6bd816b531d95609f0f8d6de9"],"ref":"refs/changes/21/721/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1479375000,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"7","revision":"942734537e7f3b01d39c29935340eebbee1c66e1","parents":["20f8b7c99f7c061f2f6c500f8d90ca820f80cc08"],"ref":"refs/changes/21/721/7","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1479870480,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479949438,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"8","revision":"ca8049dbaef632b7956fcdf5a07ff001a5b5b1df","parents":["20f8b7c99f7c061f2f6c500f8d90ca820f80cc08"],"ref":"refs/changes/21/721/8","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1479950159,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477087855,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479949438,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1479950168,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"targets.json.in","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4}],"allReviewers":[{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}