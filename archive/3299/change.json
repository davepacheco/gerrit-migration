{"project":"joyent/sdc-vm-agent","branch":"master","id":"I559a0f6af543e6afce81af6081324daa6074e0a5","number":"3299","subject":"TRITON-107 vm-agent: zoneevent overflow test doesn\u0027t work as intended on vminfod-enabled nodes Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e","owner":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"url":"https://cr.joyent.us/3299","commitMessage":"TRITON-107 vm-agent: zoneevent overflow test doesn\u0027t work as intended on vminfod-enabled nodes\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1517895486,"lastUpdated":1518027370,"open":false,"status":"MERGED","comments":[{"timestamp":1517895486,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 1."},{"timestamp":1517895489,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 20a1491919fb7ce5ba378003cff418db82d47fda\n    \n    initial commit"},{"timestamp":1517895541,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517895716,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n2 quick notes:\n\n1. I\u0027ll update this CR/ticket with testing notes tomorrow\n2. It\u0027s unfortunate that the diff makes this change look so substantial, when a majority of it is just indenting all of the code one level to put it all into the \"main\" function, which gets conditionally called based on the eventSource determined."},{"timestamp":1517945537,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1: Code-Review+1\n\n(1 comment)"},{"timestamp":1517951399,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1517952157,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 2."},{"timestamp":1517952160,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 14e5fa54a8da424b7ad39e993b035b74ad584599\n    \n    be more explicit about determine source error if present"},{"timestamp":1517952216,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517984932,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\nlgtm"},{"timestamp":1518026459,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1518027370,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dave Eddy"}],"currentPatchSet":{"number":"3","revision":"559a0f6af543e6afce81af6081324daa6074e0a5","parents":["a4e32d5bd1db31d32ed358799688de7e44d009b9"],"ref":"refs/changes/99/3299/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1518026459,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517952216,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1518027370,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":208,"deletions":-176}],"sizeInsertions":208,"sizeDeletions":-176},"patchSets":[{"number":"1","revision":"f19df5d1105f5a9b6b693bc939629b3249bcc964","parents":["a4e32d5bd1db31d32ed358799688de7e44d009b9"],"ref":"refs/changes/99/3299/1","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1517895486,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517895541,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517945537,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"tests/test.ZoneeventWatcherOverflow.js","line":283,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Is it useful to know that this failed?\n\nFor example, changing instead to:\n    \n    if (err) {\n        t.ok(false, \u0027failed to determine event source\u0027);\n        t.end();\n    } else if (eventSource \u003d\u003d\u003d \u0027default\u0027) {\n        t.end();\n        main();\n    } else {\n        t.ok(true, \u0027skipping tests: eventSource !\u003d\u003d default\u0027);\n        t.end();\n    }\n\nI realize we\u0027ll also get an error in the t.ifError() above, but the message \u0027skipping tests: eventSource !\u003d\u003d default\u0027 might be confusing in that case? Just a thought."},{"file":"tests/test.ZoneeventWatcherOverflow.js","line":283,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Good call, i think that makes it more explicit and easier to follow the logic here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":205,"deletions":-176}],"sizeInsertions":205,"sizeDeletions":-176},{"number":"2","revision":"de4ef007193af0764b54889c1659455019fa0029","parents":["a4e32d5bd1db31d32ed358799688de7e44d009b9"],"ref":"refs/changes/99/3299/2","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1517952157,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517952216,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":208,"deletions":-176}],"sizeInsertions":208,"sizeDeletions":-176},{"number":"3","revision":"559a0f6af543e6afce81af6081324daa6074e0a5","parents":["a4e32d5bd1db31d32ed358799688de7e44d009b9"],"ref":"refs/changes/99/3299/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1518026459,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517952216,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517984932,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1518027370,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":208,"deletions":-176}],"sizeInsertions":208,"sizeDeletions":-176}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}