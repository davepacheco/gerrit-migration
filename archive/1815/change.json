{"project":"joyent/illumos-joyent","branch":"master","id":"I712f6ddfc80a10d6a9c0868a708bb43069ef6825","number":"1815","subject":"OS-3617 libc ulwp walker should use CTF for uberdata offsets","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/1815","commitMessage":"OS-3617 libc ulwp walker should use CTF for uberdata offsets\n","createdOn":1492723743,"lastUpdated":1493155351,"open":false,"status":"ABANDONED","comments":[{"timestamp":1492723743,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1492807886,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(6 comments)"},{"timestamp":1493155351,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Abandoned\n\nGoing to break this up into two separate changes."}],"currentPatchSet":{"number":"1","revision":"712f6ddfc80a10d6a9c0868a708bb43069ef6825","parents":["053ab6d63a92aabacf6aec75c7c0b67ee93727dd"],"ref":"refs/changes/15/1815/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1492723743,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":795,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It looks like this function is never called with a non-zero value for this param?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":842,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This comment could use some rephrasing. \u0027it\u0027 is overloaded."},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":857,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Unable"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":956,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m really not a huge fan of this macro usage, especially given that it refers to variables expected to be in the scope.  This uberdata/ctf rework seems like a great opportunity for clean-up in that regard.\n\nRelated: When does it make sense to fallback to the offset defined in the local uberdata_t if we cannot find it in CTF?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":974,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If the core is ancient, and lacking CTF entirely, would we perhaps want to fall back to a legacy definition of uberdata_t?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":1150,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps mdb_warn() here like the other lookup failures?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","type":"MODIFIED","insertions":260,"deletions":-37}],"sizeInsertions":261,"sizeDeletions":-37},"patchSets":[{"number":"1","revision":"712f6ddfc80a10d6a9c0868a708bb43069ef6825","parents":["053ab6d63a92aabacf6aec75c7c0b67ee93727dd"],"ref":"refs/changes/15/1815/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1492723743,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":795,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It looks like this function is never called with a non-zero value for this param?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":842,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This comment could use some rephrasing. \u0027it\u0027 is overloaded."},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":857,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Unable"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":956,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m really not a huge fan of this macro usage, especially given that it refers to variables expected to be in the scope.  This uberdata/ctf rework seems like a great opportunity for clean-up in that regard.\n\nRelated: When does it make sense to fallback to the offset defined in the local uberdata_t if we cannot find it in CTF?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":974,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If the core is ancient, and lacking CTF entirely, would we perhaps want to fall back to a legacy definition of uberdata_t?"},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","line":1150,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps mdb_warn() here like the other lookup failures?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/libc/libc.c","type":"MODIFIED","insertions":260,"deletions":-37}],"sizeInsertions":261,"sizeDeletions":-37}],"allReviewers":[{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}