{"project":"joyent/sdc-manta","branch":"master","id":"Ibc374bb18227de5ac01fda61819ea88fae556116","number":"6528","subject":"MANTA-4365 Add \u0027--experimental\u0027 flag to `manta-adm` to control the deployment of experimental services Reviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e Approved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e","owner":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"url":"https://cr.joyent.us/6528","commitMessage":"MANTA-4365 Add \u0027--experimental\u0027 flag to `manta-adm` to control the deployment of experimental services\nReviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1561760946,"lastUpdated":1563221437,"open":false,"status":"MERGED","comments":[{"timestamp":1561760946,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 1."},{"timestamp":1561761006,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1561761234,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 1:\n\nSee ticket for testing notes."},{"timestamp":1562110713,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 1:\n\n(5 comments)"},{"timestamp":1562371553,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 2."},{"timestamp":1562371573,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 2:\n\n(5 comments)\n\nSee ticket for brief additional testing notes."},{"timestamp":1562371615,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562373694,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 3."},{"timestamp":1562373743,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 3:\n\nPatch set 3: moved helper function from adm.js to services.js; ran through procedure outlined in testing notes yet again."},{"timestamp":1562373758,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1563217230,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\nThank you for the changes.  Testing notes in the ticket look good to me!"},{"timestamp":1563221374,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1563221429,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1563221434,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Isaac Davis"},{"timestamp":1563221437,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"5","revision":"71b14d22cf0fe008d744a4467feb7e0104dea164","parents":["29fd87e48ead14e0c00146c1705d2d0e720746c4"],"ref":"refs/changes/28/6528/5","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1563221429,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562373758,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1563221434,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":49,"deletions":-5},{"file":"lib/services.js","type":"MODIFIED","insertions":20,"deletions":0}],"sizeInsertions":80,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"af49db259b77bb26be73181d8501154d0d8dd3b9","parents":["0890ca74513e453ed680ee4d51317a55f2f446d3"],"ref":"refs/changes/28/6528/1","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1561760946,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561761006,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"cmd/manta-adm.js","line":952,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"It\u0027s somewhat unusual but this file is using four space indents (at least above, on 944-947) instead of a tab here.\n\nI think it\u0027d be good to add a short alias for this, too; e.g., maybe \"-X\"?"},{"file":"cmd/manta-adm.js","line":952,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Done and done"},{"file":"lib/adm.js","line":62,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Should this go in \"lib/services.js\" instead, as \"mSvcNamesExperimental\" perhaps, and be exported from there for use here?"},{"file":"lib/adm.js","line":62,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Done"},{"file":"lib/adm.js","line":3883,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Above the optional member assertions below, I would add base asserts for these parameters given we\u0027re changing the signature now; e.g.,\n\n    assertplus.object(opts, \u0027opts\u0027);\n    assertplus.func(callback, \u0027callback\u0027);"},{"file":"lib/adm.js","line":3883,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Done"},{"file":"lib/adm.js","line":3887,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"It seems like \"service\" is actually meant to be a string?"},{"file":"lib/adm.js","line":3887,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Nice catch! Fixed."},{"file":"lib/adm.js","line":3895,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Because \"optionalBool()\" will actually allow both \"undefined\" _and_ \"null\" values through, I would replace this with:\n\n    var noreprovision \u003d opts.noreprovision ? true : false;\n    var experimental \u003d opts.experimental ? true : false;"},{"file":"lib/adm.js","line":3895,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Nice catch; fixed."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":58,"deletions":-5}],"sizeInsertions":69,"sizeDeletions":-7},{"number":"2","revision":"18524a51c2908f6f80e663a558836d4bf841bad6","parents":["0890ca74513e453ed680ee4d51317a55f2f446d3"],"ref":"refs/changes/28/6528/2","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1562371553,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562371615,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":53,"deletions":-5},{"file":"lib/services.js","type":"MODIFIED","insertions":12,"deletions":0}],"sizeInsertions":76,"sizeDeletions":-7},{"number":"3","revision":"bc374bb18227de5ac01fda61819ea88fae556116","parents":["0890ca74513e453ed680ee4d51317a55f2f446d3"],"ref":"refs/changes/28/6528/3","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1562373694,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562373758,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":49,"deletions":-5},{"file":"lib/services.js","type":"MODIFIED","insertions":20,"deletions":0}],"sizeInsertions":80,"sizeDeletions":-7},{"number":"4","revision":"747eb703c74c3b3b03d1df1ce07eab3f45d6058c","parents":["29fd87e48ead14e0c00146c1705d2d0e720746c4"],"ref":"refs/changes/28/6528/4","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1563221374,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562373758,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":49,"deletions":-5},{"file":"lib/services.js","type":"MODIFIED","insertions":20,"deletions":0}],"sizeInsertions":80,"sizeDeletions":-7},{"number":"5","revision":"71b14d22cf0fe008d744a4467feb7e0104dea164","parents":["29fd87e48ead14e0c00146c1705d2d0e720746c4"],"ref":"refs/changes/28/6528/5","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1563221429,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563217230,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562373758,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1563221434,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"cmd/manta-adm.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/adm.js","type":"MODIFIED","insertions":49,"deletions":-5},{"file":"lib/services.js","type":"MODIFIED","insertions":20,"deletions":0}],"sizeInsertions":80,"sizeDeletions":-7}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}]}