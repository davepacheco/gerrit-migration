{"project":"joyent/illumos-joyent","branch":"master","id":"I727bed32b7989281f9523c760608c1eff5217b07","number":"6782","subject":"OS-7944 Want support for printing RTT variance with connstat(1M) Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: John Levon \u003cjohn.levon@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/6782","commitMessage":"OS-7944 Want support for printing RTT variance with connstat(1M)\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: John Levon \u003cjohn.levon@joyent.com\u003e\n","createdOn":1565628849,"lastUpdated":1566499334,"open":false,"status":"MERGED","comments":[{"timestamp":1565628849,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1565655392,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1565899541,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1565899632,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1565914589,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1565914769,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1565977029,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1566003375,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1566003404,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1566226153,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1566493627,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1566499298,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1566499325,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1566499334,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"6","revision":"bc729a97a9286d8629f774f23f1edeb945c6b29c","parents":["4ad9cc07d7a3af5dbe729bd2da31e2919a64a691"],"ref":"refs/changes/82/6782/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1566499325,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566226153,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566493627,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"SUBM","value":"1","grantedOn":1566499334,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":7,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"24cbc0f417199b039db14dc886cc8f838594d4c2","parents":["9cba20af356f81a5f469ca8aa89ed17ee827b6a6"],"ref":"refs/changes/82/6782/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1565628849,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":10,"sizeDeletions":0},{"number":"2","revision":"d1152fc83c4a70a919630e040129862cc476b588","parents":["9cba20af356f81a5f469ca8aa89ed17ee827b6a6"],"ref":"refs/changes/82/6782/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1565655392,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/man/man1m/connstat.1m","line":19,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"You need to update the date of the manual page."},{"file":"usr/src/man/man1m/connstat.1m","line":19,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","line":131,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s not quite clear to me why we have the shift by two here before converting it. Is that because it\u0027s a decimal value in actuality?"},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","line":131,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"tcp_rtt_sd is stored as 4 times the value of the average deviation, so that it can be referenced without multiplying it in tcp_calculate_rto(). There\u0027s a note on that here:\n\nhttps://github.com/joyent/illumos-joyent/blob/release-20190815/usr/src/uts/common/inet/tcp/tcp_input.c#L5381-L5390"},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","line":131,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Maybe we should leave a comment here about this then?"},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","line":131,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":14,"sizeDeletions":0},{"number":"3","revision":"9f48a7db12502af9af1cc66c77f47a18d42aee12","parents":["9cba20af356f81a5f469ca8aa89ed17ee827b6a6"],"ref":"refs/changes/82/6782/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1565914589,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977029,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":15,"sizeDeletions":-1},{"number":"4","revision":"02eec7903abf39ad0b6a663db71abef800b13bab","parents":["9cba20af356f81a5f469ca8aa89ed17ee827b6a6"],"ref":"refs/changes/82/6782/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1566003375,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566226153,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566493627,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":7,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-2},{"number":"5","revision":"727bed32b7989281f9523c760608c1eff5217b07","parents":["9cba20af356f81a5f469ca8aa89ed17ee827b6a6"],"ref":"refs/changes/82/6782/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1566499298,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566226153,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566493627,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":7,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-2},{"number":"6","revision":"bc729a97a9286d8629f774f23f1edeb945c6b29c","parents":["4ad9cc07d7a3af5dbe729bd2da31e2919a64a691"],"ref":"refs/changes/82/6782/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1566499325,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566226153,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1566499334,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566493627,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/connstat/connstat_tcp.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/man/man1m/connstat.1m","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/common/inet/mib2.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/inet/tcp/tcp_stats.c","type":"MODIFIED","insertions":7,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-2}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}