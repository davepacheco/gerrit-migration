{"project":"joyent/sdc-designation","branch":"master","id":"I3ac425117c8989f2c9f64557b00c1d51db27efbb","number":"504","subject":"DAPI-323: Add support for async calls in pipeline DAPI-332: hard-filter-setup and hard-filter-running are overly paranoid about passed server arg Reviewed by: Pedro P. Candel \u003cpedro@joyent.com\u003e","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/504","commitMessage":"DAPI-323: Add support for async calls in pipeline\nDAPI-332: hard-filter-setup and hard-filter-running are overly paranoid about passed server arg\nReviewed by: Pedro P. Candel \u003cpedro@joyent.com\u003e\n","createdOn":1474376841,"lastUpdated":1482389462,"open":false,"status":"MERGED","comments":[{"timestamp":1474376841,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1474376892,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477301270,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1477354678,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480499819,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1480499855,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1481905341,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(55 comments)\n\nWow man, this is huge! More or less the issues are the same through the whole review: missing assertions, superfluous return statements, outdated copyright notice ... Lots of files to modify!"},{"timestamp":1482226284,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 4."},{"timestamp":1482226320,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1482227523,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\n(2 comments)\n\nThanks for taking a look, man. :)\n\nI did all your suggestions except for the \"return\" elimination and the asserts in allocator.js. There are some missing asserts which you noted which haven\u0027t been added to CR 524 yet, which I\u0027ll do when I get to it."},{"timestamp":1482337180,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1482389462,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Marsell Kukuljevic"}],"currentPatchSet":{"number":"4","revision":"3ac425117c8989f2c9f64557b00c1d51db27efbb","parents":["8181a228310a81efd2bcc702db152fb2f8c5bd62"],"ref":"refs/changes/04/504/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1482226284,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1482226320,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1482337180,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1482337180,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1482389462,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/algorithms/calculate-ticketed-vms.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-headnode.js","type":"MODIFIED","insertions":15,"deletions":-4},{"file":"lib/algorithms/hard-filter-invalid-servers.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/algorithms/hard-filter-large-servers.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-locality-hints.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/algorithms/hard-filter-min-cpu.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-min-disk.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"lib/algorithms/hard-filter-min-ram.js","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-platform-versions.js","type":"MODIFIED","insertions":15,"deletions":-3},{"file":"lib/algorithms/hard-filter-reserved.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-reservoir.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-running.js","type":"MODIFIED","insertions":10,"deletions":-10},{"file":"lib/algorithms/hard-filter-setup.js","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"lib/algorithms/hard-filter-sick-servers.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-traits.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/algorithms/hard-filter-vlans.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-vm-count.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"lib/algorithms/hard-filter-volumes-from.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"lib/algorithms/identity.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/override-overprovisioning.js","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"lib/algorithms/score-current-platform.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-next-reboot.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"lib/algorithms/score-num-owner-zones.js","type":"MODIFIED","insertions":12,"deletions":-4},{"file":"lib/algorithms/score-uniform-random.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-unreserved-disk.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-unreserved-ram.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/soft-filter-locality-hints.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/allocator.js","type":"MODIFIED","insertions":133,"deletions":-176},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"test/algorithms/calculate-ticketed-vms.test.js","type":"MODIFIED","insertions":68,"deletions":-62},{"file":"test/algorithms/common.js","type":"MODIFIED","insertions":31,"deletions":0},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":30,"deletions":-42},{"file":"test/algorithms/hard-filter-headnode.test.js","type":"MODIFIED","insertions":26,"deletions":-25},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":19,"deletions":-24},{"file":"test/algorithms/hard-filter-large-servers.test.js","type":"MODIFIED","insertions":22,"deletions":-23},{"file":"test/algorithms/hard-filter-locality-hints.test.js","type":"MODIFIED","insertions":146,"deletions":-168},{"file":"test/algorithms/hard-filter-min-cpu.test.js","type":"MODIFIED","insertions":128,"deletions":-173},{"file":"test/algorithms/hard-filter-min-disk.test.js","type":"MODIFIED","insertions":153,"deletions":-210},{"file":"test/algorithms/hard-filter-min-ram.test.js","type":"MODIFIED","insertions":127,"deletions":-176},{"file":"test/algorithms/hard-filter-overprovision-ratios.test.js","type":"MODIFIED","insertions":29,"deletions":-40},{"file":"test/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":55,"deletions":-83},{"file":"test/algorithms/hard-filter-platform-versions.test.js","type":"MODIFIED","insertions":145,"deletions":-234},{"file":"test/algorithms/hard-filter-reserved.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-reservoir.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-running.test.js","type":"MODIFIED","insertions":42,"deletions":-63},{"file":"test/algorithms/hard-filter-setup.test.js","type":"MODIFIED","insertions":27,"deletions":-43},{"file":"test/algorithms/hard-filter-sick-servers.test.js","type":"MODIFIED","insertions":14,"deletions":-21},{"file":"test/algorithms/hard-filter-traits.test.js","type":"MODIFIED","insertions":329,"deletions":-390},{"file":"test/algorithms/hard-filter-vlans.test.js","type":"MODIFIED","insertions":103,"deletions":-57},{"file":"test/algorithms/hard-filter-vm-count.test.js","type":"MODIFIED","insertions":34,"deletions":-36},{"file":"test/algorithms/hard-filter-volumes-from.test.js","type":"MODIFIED","insertions":16,"deletions":-34},{"file":"test/algorithms/identity.test.js","type":"MODIFIED","insertions":11,"deletions":-21},{"file":"test/algorithms/override-overprovisioning.test.js","type":"MODIFIED","insertions":172,"deletions":-183},{"file":"test/algorithms/score-current-platform.test.js","type":"MODIFIED","insertions":50,"deletions":-46},{"file":"test/algorithms/score-next-reboot.test.js","type":"MODIFIED","insertions":73,"deletions":-78},{"file":"test/algorithms/score-num-owner-zones.test.js","type":"MODIFIED","insertions":51,"deletions":-116},{"file":"test/algorithms/score-uniform-random.test.js","type":"MODIFIED","insertions":47,"deletions":-27},{"file":"test/algorithms/score-unreserved-disk.test.js","type":"MODIFIED","insertions":33,"deletions":-77},{"file":"test/algorithms/score-unreserved-ram.test.js","type":"MODIFIED","insertions":58,"deletions":-129},{"file":"test/algorithms/soft-filter-locality-hints.test.js","type":"MODIFIED","insertions":120,"deletions":-145},{"file":"test/allocator.test.js","type":"MODIFIED","insertions":435,"deletions":-306},{"file":"test/integration.test.js","type":"MODIFIED","insertions":30,"deletions":-17}],"sizeInsertions":3171,"sizeDeletions":-3415},"patchSets":[{"number":"1","revision":"00a7a97dcb7a6b260ce879559c0f27fd9f6ee27b","parents":["3da0da9b37d064e1d4416ca3a8339c660391cdc5"],"ref":"refs/changes/04/504/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1474376841,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474376892,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/algorithms/calculate-ticketed-vms.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-headnode.js","type":"MODIFIED","insertions":15,"deletions":-4},{"file":"lib/algorithms/hard-filter-invalid-servers.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/algorithms/hard-filter-large-servers.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-locality-hints.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/algorithms/hard-filter-min-cpu.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/algorithms/hard-filter-min-disk.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/algorithms/hard-filter-min-ram.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/hard-filter-platform-versions.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/hard-filter-reserved.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-reservoir.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-running.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-setup.js","type":"MODIFIED","insertions":17,"deletions":-7},{"file":"lib/algorithms/hard-filter-sick-servers.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-traits.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/algorithms/hard-filter-vlans.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-vm-count.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-volumes-from.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/identity.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/override-overprovisioning.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/score-current-platform.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-next-reboot.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/algorithms/score-num-owner-zones.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-uniform-random.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-unreserved-disk.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/algorithms/score-unreserved-ram.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/soft-filter-locality-hints.js","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"lib/allocator.js","type":"MODIFIED","insertions":133,"deletions":-176},{"file":"lib/scorers.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"test/algorithms/calculate-ticketed-vms.test.js","type":"MODIFIED","insertions":68,"deletions":-62},{"file":"test/algorithms/common.js","type":"MODIFIED","insertions":31,"deletions":0},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":30,"deletions":-42},{"file":"test/algorithms/hard-filter-headnode.test.js","type":"MODIFIED","insertions":26,"deletions":-25},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":19,"deletions":-24},{"file":"test/algorithms/hard-filter-large-servers.test.js","type":"MODIFIED","insertions":22,"deletions":-23},{"file":"test/algorithms/hard-filter-locality-hints.test.js","type":"MODIFIED","insertions":146,"deletions":-168},{"file":"test/algorithms/hard-filter-min-cpu.test.js","type":"MODIFIED","insertions":128,"deletions":-173},{"file":"test/algorithms/hard-filter-min-disk.test.js","type":"MODIFIED","insertions":153,"deletions":-210},{"file":"test/algorithms/hard-filter-min-ram.test.js","type":"MODIFIED","insertions":127,"deletions":-176},{"file":"test/algorithms/hard-filter-overprovision-ratios.test.js","type":"MODIFIED","insertions":29,"deletions":-40},{"file":"test/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":55,"deletions":-83},{"file":"test/algorithms/hard-filter-platform-versions.test.js","type":"MODIFIED","insertions":145,"deletions":-234},{"file":"test/algorithms/hard-filter-reserved.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-reservoir.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-running.test.js","type":"MODIFIED","insertions":53,"deletions":-53},{"file":"test/algorithms/hard-filter-setup.test.js","type":"MODIFIED","insertions":38,"deletions":-34},{"file":"test/algorithms/hard-filter-sick-servers.test.js","type":"MODIFIED","insertions":14,"deletions":-21},{"file":"test/algorithms/hard-filter-traits.test.js","type":"MODIFIED","insertions":329,"deletions":-390},{"file":"test/algorithms/hard-filter-vlans.test.js","type":"MODIFIED","insertions":103,"deletions":-57},{"file":"test/algorithms/hard-filter-vm-count.test.js","type":"MODIFIED","insertions":34,"deletions":-36},{"file":"test/algorithms/hard-filter-volumes-from.test.js","type":"MODIFIED","insertions":16,"deletions":-34},{"file":"test/algorithms/identity.test.js","type":"MODIFIED","insertions":11,"deletions":-21},{"file":"test/algorithms/override-overprovisioning.test.js","type":"MODIFIED","insertions":172,"deletions":-183},{"file":"test/algorithms/score-current-platform.test.js","type":"MODIFIED","insertions":32,"deletions":-47},{"file":"test/algorithms/score-next-reboot.test.js","type":"MODIFIED","insertions":72,"deletions":-78},{"file":"test/algorithms/score-num-owner-zones.test.js","type":"MODIFIED","insertions":51,"deletions":-116},{"file":"test/algorithms/score-uniform-random.test.js","type":"MODIFIED","insertions":47,"deletions":-27},{"file":"test/algorithms/score-unreserved-disk.test.js","type":"MODIFIED","insertions":33,"deletions":-77},{"file":"test/algorithms/score-unreserved-ram.test.js","type":"MODIFIED","insertions":58,"deletions":-129},{"file":"test/algorithms/soft-filter-locality-hints.test.js","type":"MODIFIED","insertions":120,"deletions":-145},{"file":"test/allocator.test.js","type":"MODIFIED","insertions":435,"deletions":-306},{"file":"test/integration.test.js","type":"MODIFIED","insertions":30,"deletions":-17}],"sizeInsertions":3159,"sizeDeletions":-3390},{"number":"2","revision":"b89bf844d77c9d8e7ba15d0c3e32dd1a04974e91","parents":["9ea03b4041f67afa88e722b93f21f9a693792091"],"ref":"refs/changes/04/504/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1477301270,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477354678,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/algorithms/calculate-ticketed-vms.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-headnode.js","type":"MODIFIED","insertions":15,"deletions":-4},{"file":"lib/algorithms/hard-filter-invalid-servers.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/algorithms/hard-filter-large-servers.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-locality-hints.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/algorithms/hard-filter-min-cpu.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/algorithms/hard-filter-min-disk.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/algorithms/hard-filter-min-ram.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/hard-filter-platform-versions.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/hard-filter-reserved.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-reservoir.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-running.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-setup.js","type":"MODIFIED","insertions":17,"deletions":-7},{"file":"lib/algorithms/hard-filter-sick-servers.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-traits.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/algorithms/hard-filter-vlans.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-vm-count.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-volumes-from.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/identity.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/override-overprovisioning.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/score-current-platform.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-next-reboot.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/algorithms/score-num-owner-zones.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-uniform-random.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-unreserved-disk.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/algorithms/score-unreserved-ram.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/soft-filter-locality-hints.js","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"lib/allocator.js","type":"MODIFIED","insertions":133,"deletions":-176},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"test/algorithms/calculate-ticketed-vms.test.js","type":"MODIFIED","insertions":68,"deletions":-62},{"file":"test/algorithms/common.js","type":"MODIFIED","insertions":31,"deletions":0},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":30,"deletions":-42},{"file":"test/algorithms/hard-filter-headnode.test.js","type":"MODIFIED","insertions":26,"deletions":-25},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":19,"deletions":-24},{"file":"test/algorithms/hard-filter-large-servers.test.js","type":"MODIFIED","insertions":22,"deletions":-23},{"file":"test/algorithms/hard-filter-locality-hints.test.js","type":"MODIFIED","insertions":146,"deletions":-168},{"file":"test/algorithms/hard-filter-min-cpu.test.js","type":"MODIFIED","insertions":128,"deletions":-173},{"file":"test/algorithms/hard-filter-min-disk.test.js","type":"MODIFIED","insertions":153,"deletions":-210},{"file":"test/algorithms/hard-filter-min-ram.test.js","type":"MODIFIED","insertions":127,"deletions":-176},{"file":"test/algorithms/hard-filter-overprovision-ratios.test.js","type":"MODIFIED","insertions":29,"deletions":-40},{"file":"test/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":55,"deletions":-83},{"file":"test/algorithms/hard-filter-platform-versions.test.js","type":"MODIFIED","insertions":145,"deletions":-234},{"file":"test/algorithms/hard-filter-reserved.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-reservoir.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-running.test.js","type":"MODIFIED","insertions":53,"deletions":-53},{"file":"test/algorithms/hard-filter-setup.test.js","type":"MODIFIED","insertions":38,"deletions":-34},{"file":"test/algorithms/hard-filter-sick-servers.test.js","type":"MODIFIED","insertions":14,"deletions":-21},{"file":"test/algorithms/hard-filter-traits.test.js","type":"MODIFIED","insertions":329,"deletions":-390},{"file":"test/algorithms/hard-filter-vlans.test.js","type":"MODIFIED","insertions":103,"deletions":-57},{"file":"test/algorithms/hard-filter-vm-count.test.js","type":"MODIFIED","insertions":34,"deletions":-36},{"file":"test/algorithms/hard-filter-volumes-from.test.js","type":"MODIFIED","insertions":16,"deletions":-34},{"file":"test/algorithms/identity.test.js","type":"MODIFIED","insertions":11,"deletions":-21},{"file":"test/algorithms/override-overprovisioning.test.js","type":"MODIFIED","insertions":172,"deletions":-183},{"file":"test/algorithms/score-current-platform.test.js","type":"MODIFIED","insertions":49,"deletions":-46},{"file":"test/algorithms/score-next-reboot.test.js","type":"MODIFIED","insertions":72,"deletions":-78},{"file":"test/algorithms/score-num-owner-zones.test.js","type":"MODIFIED","insertions":51,"deletions":-116},{"file":"test/algorithms/score-uniform-random.test.js","type":"MODIFIED","insertions":47,"deletions":-27},{"file":"test/algorithms/score-unreserved-disk.test.js","type":"MODIFIED","insertions":33,"deletions":-77},{"file":"test/algorithms/score-unreserved-ram.test.js","type":"MODIFIED","insertions":58,"deletions":-129},{"file":"test/algorithms/soft-filter-locality-hints.test.js","type":"MODIFIED","insertions":120,"deletions":-145},{"file":"test/allocator.test.js","type":"MODIFIED","insertions":435,"deletions":-306},{"file":"test/integration.test.js","type":"MODIFIED","insertions":30,"deletions":-17}],"sizeInsertions":3175,"sizeDeletions":-3388},{"number":"3","revision":"9bc21b39b965faafb66938970253a0790bde613b","parents":["8181a228310a81efd2bcc702db152fb2f8c5bd62"],"ref":"refs/changes/04/504/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1480499819,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477354678,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/algorithms/calculate-server-unreserved.js","line":113,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"You can safely skip return here and just left `cb(null, servers, {});` I think"},{"file":"lib/algorithms/calculate-server-unreserved.js","line":113,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I think I\u0027ll pass on this particular change. As a rule, I always stuff a return on the same line as a callback, to ensure I don\u0027t end up with potentially confusing bugs. I don\u0027t think removing it is worth the future risk. :)"},{"file":"lib/algorithms/calculate-ticketed-vms.js","line":76,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same here, un-needed return statement given you\u0027re calling the callback here as the final function statement"},{"file":"lib/algorithms/hard-filter-capness.js","line":67,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same return thing again :-)"},{"file":"lib/algorithms/hard-filter-headnode.js","line":37,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same"},{"file":"lib/algorithms/hard-filter-invalid-servers.js","line":48,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto"},{"file":"lib/algorithms/hard-filter-large-servers.js","line":54,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto here. Not sure if you have that flag of \"always return a value set\" though"},{"file":"lib/algorithms/hard-filter-locality-hints.js","line":74,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Idem"},{"file":"lib/algorithms/hard-filter-min-cpu.js","line":37,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I\u0027d assert vm is an object before calling one of its properties here. You can always reach that \"cannot call foo of undefined\" thing"},{"file":"lib/algorithms/hard-filter-min-cpu.js","line":77,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same return thing here"},{"file":"lib/algorithms/hard-filter-min-disk.js","line":42,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same here. Ensure there\u0027s a \"vm\" object before calling properties on it"},{"file":"lib/algorithms/hard-filter-min-disk.js","line":94,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return issue"},{"file":"lib/algorithms/hard-filter-min-ram.js","line":38,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same thing again. Ensure \"vm\" is defined and it\u0027s an object before calling its properties"},{"file":"lib/algorithms/hard-filter-min-ram.js","line":72,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return thing (TM)"},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","line":70,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/hard-filter-owners-servers.js","line":38,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"You\u0027re calling constraints.vm properties and constraints.defaults properties. I\u0027d add an assert.object() for both right above the other assertions"},{"file":"lib/algorithms/hard-filter-owners-servers.js","line":54,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/hard-filter-platform-versions.js","line":38,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Missing assert.object assertion for constraints.defaults IMO"},{"file":"lib/algorithms/hard-filter-platform-versions.js","line":45,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Missing assert.object assertion for img or constraints.img at the top of the function"},{"file":"lib/algorithms/hard-filter-platform-versions.js","line":56,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/hard-filter-reserved.js","line":29,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Return"},{"file":"lib/algorithms/hard-filter-reservoir.js","line":29,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same"},{"file":"lib/algorithms/hard-filter-running.js","line":38,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Can we assume that, at this point, every server will be an object which is not null?"},{"file":"lib/algorithms/hard-filter-running.js","line":53,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"No need for the return keyword here"},{"file":"lib/algorithms/hard-filter-setup.js","line":38,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"This is exactly the kind of function I asked for into the previous file. is it being called before the previous one? If so, ignore my comment on the previous file"},{"file":"lib/algorithms/hard-filter-setup.js","line":45,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The same return thing"},{"file":"lib/algorithms/hard-filter-sick-servers.js","line":46,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Can safely drop the return"},{"file":"lib/algorithms/hard-filter-traits.js","line":30,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Wouldn\u0027t these be good candidates for assertions too? constraints.vm, constraints.pk, constraints.img"},{"file":"lib/algorithms/hard-filter-traits.js","line":79,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/hard-filter-vlans.js","line":88,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ping!"},{"file":"lib/algorithms/hard-filter-vm-count.js","line":33,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same reasoning here regarding assertion for constraints.defaults"},{"file":"lib/algorithms/hard-filter-vm-count.js","line":55,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/hard-filter-volumes-from.js","line":40,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto for assertions"},{"file":"lib/algorithms/hard-filter-volumes-from.js","line":67,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/identity.js","line":8,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Shouldn\u0027t you consider the Copyright to 2016 or even 2017 now that you\u0027re modifying pretty much all the files?"},{"file":"lib/algorithms/identity.js","line":25,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/override-overprovisioning.js","line":47,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Missing assertion for constraints.defaults. Also for constraints.pkg below"},{"file":"lib/algorithms/override-overprovisioning.js","line":78,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/score-current-platform.js","line":49,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Missing constraints.defaults assertion"},{"file":"lib/algorithms/score-current-platform.js","line":54,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/algorithms/score-next-reboot.js","line":95,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same thing about constrainst.defaults"},{"file":"lib/algorithms/score-next-reboot.js","line":103,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto for return"},{"file":"lib/algorithms/score-num-owner-zones.js","line":41,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same missing assertions than on the previous files"},{"file":"lib/algorithms/score-num-owner-zones.js","line":103,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"And the same return thing"},{"file":"lib/algorithms/score-uniform-random.js","line":42,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto for missing assertions"},{"file":"lib/algorithms/score-uniform-random.js","line":77,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"And for the return"},{"file":"lib/algorithms/score-unreserved-disk.js","line":32,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"EhNoAssertionsAtAllError!"},{"file":"lib/algorithms/score-unreserved-disk.js","line":66,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same here"},{"file":"lib/algorithms/score-unreserved-ram.js","line":41,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same missing assertions and the final return thing"},{"file":"lib/algorithms/soft-filter-locality-hints.js","line":142,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Should assert object constraints.vm before checking for the uuid, though"},{"file":"lib/algorithms/soft-filter-locality-hints.js","line":181,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same return thing"},{"file":"lib/allocator.js","line":95,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Eh no assertions?"},{"file":"lib/allocator.js","line":95,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Good catch. I checked before changing, and assertions are added in https://cr.joyent.us/#/c/524"},{"file":"lib/allocator.js","line":135,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Superfluous return"},{"file":"lib/allocator.js","line":149,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Again, no assertions"},{"file":"lib/allocator.js","line":182,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"The return"},{"file":"lib/allocator.js","line":201,"reviewer":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Shouldn\u0027t be assertions here too?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/algorithms/calculate-ticketed-vms.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-headnode.js","type":"MODIFIED","insertions":15,"deletions":-4},{"file":"lib/algorithms/hard-filter-invalid-servers.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/algorithms/hard-filter-large-servers.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-locality-hints.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/algorithms/hard-filter-min-cpu.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/algorithms/hard-filter-min-disk.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/algorithms/hard-filter-min-ram.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/hard-filter-platform-versions.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/hard-filter-reserved.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-reservoir.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-running.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-setup.js","type":"MODIFIED","insertions":17,"deletions":-7},{"file":"lib/algorithms/hard-filter-sick-servers.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-traits.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/algorithms/hard-filter-vlans.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-vm-count.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-volumes-from.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/identity.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/override-overprovisioning.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/algorithms/score-current-platform.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-next-reboot.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/algorithms/score-num-owner-zones.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-uniform-random.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/score-unreserved-disk.js","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"lib/algorithms/score-unreserved-ram.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"lib/algorithms/soft-filter-locality-hints.js","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"lib/allocator.js","type":"MODIFIED","insertions":133,"deletions":-176},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"test/algorithms/calculate-ticketed-vms.test.js","type":"MODIFIED","insertions":68,"deletions":-62},{"file":"test/algorithms/common.js","type":"MODIFIED","insertions":31,"deletions":0},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":30,"deletions":-42},{"file":"test/algorithms/hard-filter-headnode.test.js","type":"MODIFIED","insertions":26,"deletions":-25},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":19,"deletions":-24},{"file":"test/algorithms/hard-filter-large-servers.test.js","type":"MODIFIED","insertions":22,"deletions":-23},{"file":"test/algorithms/hard-filter-locality-hints.test.js","type":"MODIFIED","insertions":146,"deletions":-168},{"file":"test/algorithms/hard-filter-min-cpu.test.js","type":"MODIFIED","insertions":128,"deletions":-173},{"file":"test/algorithms/hard-filter-min-disk.test.js","type":"MODIFIED","insertions":153,"deletions":-210},{"file":"test/algorithms/hard-filter-min-ram.test.js","type":"MODIFIED","insertions":127,"deletions":-176},{"file":"test/algorithms/hard-filter-overprovision-ratios.test.js","type":"MODIFIED","insertions":29,"deletions":-40},{"file":"test/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":55,"deletions":-83},{"file":"test/algorithms/hard-filter-platform-versions.test.js","type":"MODIFIED","insertions":145,"deletions":-234},{"file":"test/algorithms/hard-filter-reserved.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-reservoir.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-running.test.js","type":"MODIFIED","insertions":53,"deletions":-53},{"file":"test/algorithms/hard-filter-setup.test.js","type":"MODIFIED","insertions":38,"deletions":-34},{"file":"test/algorithms/hard-filter-sick-servers.test.js","type":"MODIFIED","insertions":14,"deletions":-21},{"file":"test/algorithms/hard-filter-traits.test.js","type":"MODIFIED","insertions":329,"deletions":-390},{"file":"test/algorithms/hard-filter-vlans.test.js","type":"MODIFIED","insertions":103,"deletions":-57},{"file":"test/algorithms/hard-filter-vm-count.test.js","type":"MODIFIED","insertions":34,"deletions":-36},{"file":"test/algorithms/hard-filter-volumes-from.test.js","type":"MODIFIED","insertions":16,"deletions":-34},{"file":"test/algorithms/identity.test.js","type":"MODIFIED","insertions":11,"deletions":-21},{"file":"test/algorithms/override-overprovisioning.test.js","type":"MODIFIED","insertions":172,"deletions":-183},{"file":"test/algorithms/score-current-platform.test.js","type":"MODIFIED","insertions":49,"deletions":-46},{"file":"test/algorithms/score-next-reboot.test.js","type":"MODIFIED","insertions":72,"deletions":-78},{"file":"test/algorithms/score-num-owner-zones.test.js","type":"MODIFIED","insertions":51,"deletions":-116},{"file":"test/algorithms/score-uniform-random.test.js","type":"MODIFIED","insertions":47,"deletions":-27},{"file":"test/algorithms/score-unreserved-disk.test.js","type":"MODIFIED","insertions":33,"deletions":-77},{"file":"test/algorithms/score-unreserved-ram.test.js","type":"MODIFIED","insertions":58,"deletions":-129},{"file":"test/algorithms/soft-filter-locality-hints.test.js","type":"MODIFIED","insertions":120,"deletions":-145},{"file":"test/allocator.test.js","type":"MODIFIED","insertions":435,"deletions":-306},{"file":"test/integration.test.js","type":"MODIFIED","insertions":30,"deletions":-17}],"sizeInsertions":3175,"sizeDeletions":-3388},{"number":"4","revision":"3ac425117c8989f2c9f64557b00c1d51db27efbb","parents":["8181a228310a81efd2bcc702db152fb2f8c5bd62"],"ref":"refs/changes/04/504/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1482226284,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1482226320,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1482337180,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1482337180,"by":{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1482389462,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/algorithms/calculate-ticketed-vms.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-headnode.js","type":"MODIFIED","insertions":15,"deletions":-4},{"file":"lib/algorithms/hard-filter-invalid-servers.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/algorithms/hard-filter-large-servers.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-locality-hints.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/algorithms/hard-filter-min-cpu.js","type":"MODIFIED","insertions":15,"deletions":-5},{"file":"lib/algorithms/hard-filter-min-disk.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"lib/algorithms/hard-filter-min-ram.js","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"lib/algorithms/hard-filter-overprovision-ratios.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-platform-versions.js","type":"MODIFIED","insertions":15,"deletions":-3},{"file":"lib/algorithms/hard-filter-reserved.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-reservoir.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-running.js","type":"MODIFIED","insertions":10,"deletions":-10},{"file":"lib/algorithms/hard-filter-setup.js","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"lib/algorithms/hard-filter-sick-servers.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/hard-filter-traits.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/algorithms/hard-filter-vlans.js","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"lib/algorithms/hard-filter-vm-count.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"lib/algorithms/hard-filter-volumes-from.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"lib/algorithms/identity.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/algorithms/override-overprovisioning.js","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"lib/algorithms/score-current-platform.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-next-reboot.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"lib/algorithms/score-num-owner-zones.js","type":"MODIFIED","insertions":12,"deletions":-4},{"file":"lib/algorithms/score-uniform-random.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-unreserved-disk.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/score-unreserved-ram.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/algorithms/soft-filter-locality-hints.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/allocator.js","type":"MODIFIED","insertions":133,"deletions":-176},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"test/algorithms/calculate-ticketed-vms.test.js","type":"MODIFIED","insertions":68,"deletions":-62},{"file":"test/algorithms/common.js","type":"MODIFIED","insertions":31,"deletions":0},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":30,"deletions":-42},{"file":"test/algorithms/hard-filter-headnode.test.js","type":"MODIFIED","insertions":26,"deletions":-25},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":19,"deletions":-24},{"file":"test/algorithms/hard-filter-large-servers.test.js","type":"MODIFIED","insertions":22,"deletions":-23},{"file":"test/algorithms/hard-filter-locality-hints.test.js","type":"MODIFIED","insertions":146,"deletions":-168},{"file":"test/algorithms/hard-filter-min-cpu.test.js","type":"MODIFIED","insertions":128,"deletions":-173},{"file":"test/algorithms/hard-filter-min-disk.test.js","type":"MODIFIED","insertions":153,"deletions":-210},{"file":"test/algorithms/hard-filter-min-ram.test.js","type":"MODIFIED","insertions":127,"deletions":-176},{"file":"test/algorithms/hard-filter-overprovision-ratios.test.js","type":"MODIFIED","insertions":29,"deletions":-40},{"file":"test/algorithms/hard-filter-owners-servers.js","type":"MODIFIED","insertions":55,"deletions":-83},{"file":"test/algorithms/hard-filter-platform-versions.test.js","type":"MODIFIED","insertions":145,"deletions":-234},{"file":"test/algorithms/hard-filter-reserved.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-reservoir.test.js","type":"MODIFIED","insertions":14,"deletions":-20},{"file":"test/algorithms/hard-filter-running.test.js","type":"MODIFIED","insertions":42,"deletions":-63},{"file":"test/algorithms/hard-filter-setup.test.js","type":"MODIFIED","insertions":27,"deletions":-43},{"file":"test/algorithms/hard-filter-sick-servers.test.js","type":"MODIFIED","insertions":14,"deletions":-21},{"file":"test/algorithms/hard-filter-traits.test.js","type":"MODIFIED","insertions":329,"deletions":-390},{"file":"test/algorithms/hard-filter-vlans.test.js","type":"MODIFIED","insertions":103,"deletions":-57},{"file":"test/algorithms/hard-filter-vm-count.test.js","type":"MODIFIED","insertions":34,"deletions":-36},{"file":"test/algorithms/hard-filter-volumes-from.test.js","type":"MODIFIED","insertions":16,"deletions":-34},{"file":"test/algorithms/identity.test.js","type":"MODIFIED","insertions":11,"deletions":-21},{"file":"test/algorithms/override-overprovisioning.test.js","type":"MODIFIED","insertions":172,"deletions":-183},{"file":"test/algorithms/score-current-platform.test.js","type":"MODIFIED","insertions":50,"deletions":-46},{"file":"test/algorithms/score-next-reboot.test.js","type":"MODIFIED","insertions":73,"deletions":-78},{"file":"test/algorithms/score-num-owner-zones.test.js","type":"MODIFIED","insertions":51,"deletions":-116},{"file":"test/algorithms/score-uniform-random.test.js","type":"MODIFIED","insertions":47,"deletions":-27},{"file":"test/algorithms/score-unreserved-disk.test.js","type":"MODIFIED","insertions":33,"deletions":-77},{"file":"test/algorithms/score-unreserved-ram.test.js","type":"MODIFIED","insertions":58,"deletions":-129},{"file":"test/algorithms/soft-filter-locality-hints.test.js","type":"MODIFIED","insertions":120,"deletions":-145},{"file":"test/allocator.test.js","type":"MODIFIED","insertions":435,"deletions":-306},{"file":"test/integration.test.js","type":"MODIFIED","insertions":30,"deletions":-17}],"sizeInsertions":3171,"sizeDeletions":-3415}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palaz贸n Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}