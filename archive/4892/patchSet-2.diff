commit fcf94db8d8ef6d34473e7b535a470d7807c6eb6a (refs/changes/92/4892/2)
Author: Josh Wilsdon <josh@wilsdon.ca>
Date:   2018-09-27T15:59:24-07:00 (1 year ago)
    
    TRITON-801 net-agent doesn't update NIC state if VM is created but not updated

diff --git a/lib/vmadm-watcher-fsm.js b/lib/vmadm-watcher-fsm.js
index d844945..3f9a883 100644
--- a/lib/vmadm-watcher-fsm.js
+++ b/lib/vmadm-watcher-fsm.js
@@ -90,6 +90,8 @@ VmadmEventsFSM.prototype.state_init = function (S) {
             assert(!self.vms.hasOwnProperty(ev.zonename), 'VM already created');
 
             self.vms[ev.zonename] = ev.vm;
+            self.log.debug('VM %s created - setting needsUpdate', ev.zonename);
+            needsUpdate = true;
             break;
         case 'modify':
             assert.object(ev.vm, 'ev.vm');
