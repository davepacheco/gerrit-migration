{"project":"joyent/manta-muskie","branch":"master","id":"I1b6dd87b0d30fa14e046214ab972f87dc57d4cc0","number":"2447","subject":"MANTA-3344 MPU commit doesn\u0027t store a muskie `etag` on the Moray record Reviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e Approved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e","owner":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"url":"https://cr.joyent.us/2447","commitMessage":"MANTA-3344 MPU commit doesn\u0027t store a muskie `etag` on the Moray record\nReviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1503523180,"lastUpdated":1503934281,"open":false,"status":"MERGED","comments":[{"timestamp":1503523180,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 1."},{"timestamp":1503523215,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503525492,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1503525801,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1503526079,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 2."},{"timestamp":1503526108,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 2:\n\nPatchset 2 addresses the feedback from patchset 1.\n\nThis patchset is `make prepush` clean."},{"timestamp":1503526117,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503526129,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1503528853,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 3."},{"timestamp":1503528881,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503529082,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 4."},{"timestamp":1503529116,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1503537862,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 4: Integration-Approval+1\n\nThanks for the testing notes.  I approve!"},{"timestamp":1503933629,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1503933664,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1503933992,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 6."},{"timestamp":1503934025,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1503934222,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1503934250,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"},{"timestamp":1503934281,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jordan Hendricks"}],"currentPatchSet":{"number":"7","revision":"1b6dd87b0d30fa14e046214ab972f87dc57d4cc0","parents":["135d7acdb2c9e6c18ec14f174ea1a84691975df3"],"ref":"refs/changes/47/2447/7","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503934222,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503537862,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1503934281,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"489e8634f39f8be510ab2dbae4706592935e8b92","parents":["cecdfce62528af5535e29640b414287860afaf25"],"ref":"refs/changes/47/2447/1","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503523180,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503523215,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/uploads/common.js","line":395,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"would it make more sense to get the objectId for the upload one time instead of twice ?\n\nthat is, something like\n\nmd.objectId \u003d upload.get(mdKeys.OBJECT_ID);\nmd.etag \u003d md.objectId;\n\n(I\u0027m assuming that this is equivalent (ie no side-effects to upload.get()"},{"file":"lib/uploads/common.js","line":395,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Thanks for the quick review!\n\nThe upload.get() operation just indexes into a Javascript object, so they are indeed equivalent.\n\nThe way you suggest is closer to the way we do this for object PUTs, so that seems fine to me. I will update."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":58,"sizeDeletions":0},{"number":"2","revision":"67400a5aeb366850d90fa35c643c658e049caf43","parents":["cecdfce62528af5535e29640b414287860afaf25"],"ref":"refs/changes/47/2447/2","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503526079,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},{"number":"3","revision":"da89807a45d0f8e724ee2f0fe1a32b07d4ad2c60","parents":["c69a24c82305739298e3d41cfcd73fafd0b4be66"],"ref":"refs/changes/47/2447/3","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1503528853,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503528881,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/uploads/commit.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":42,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":3,"deletions":-3}],"sizeInsertions":46,"sizeDeletions":-3},{"number":"4","revision":"5c458e71ea9ccbfb25d67256fb8a78e00ba8cfb0","parents":["cecdfce62528af5535e29640b414287860afaf25"],"ref":"refs/changes/47/2447/4","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503529082,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503537862,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},{"number":"5","revision":"57de88a904ca6660b7d652bb475db4358a757981","parents":["135d7acdb2c9e6c18ec14f174ea1a84691975df3"],"ref":"refs/changes/47/2447/5","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503933629,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503537862,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},{"number":"6","revision":"bc4cb30039c25ecb1eb872d375911bb3831bf89a","parents":["cecdfce62528af5535e29640b414287860afaf25"],"ref":"refs/changes/47/2447/6","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503933992,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503537862,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},{"number":"7","revision":"1b6dd87b0d30fa14e046214ab972f87dc57d4cc0","parents":["135d7acdb2c9e6c18ec14f174ea1a84691975df3"],"ref":"refs/changes/47/2447/7","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1503934222,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503537862,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503526117,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1503934281,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503526129,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":3,"deletions":0},{"file":"test/mpu/commit.test.js","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}]}