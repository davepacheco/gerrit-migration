From 40aad1ea9a7434c4136d69a130d925d8c590b9b6 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Fri, 19 Oct 2018 14:27:42 -0700
Subject: [PATCH] TRITON-880 want ufds to store and understand Yubikey
 attestation certs

---
 lib/index.js | 3 +++
 package.json | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/index.js b/lib/index.js
index 0da4102..c6d62fc 100644
--- a/lib/index.js
+++ b/lib/index.js
@@ -1193,6 +1193,9 @@ UFDS.prototype.addKey = function addKey(user, key, account, cb) {
             name: key.name || pkey.comment || fingerprint,
             objectclass: 'sdckey'
         };
+        if (key.attestation) {
+            entry.attestation = key.attestation;
+        }
 
         // We are searching keys by fingerprint or name before allowing
         // addition of a new one with same fingerprint or name:
diff --git a/package.json b/package.json
index 85d9c94..90bca89 100644
--- a/package.json
+++ b/package.json
@@ -2,7 +2,7 @@
   "name": "ufds",
   "author": "Joyent (joyent.com)",
   "description": "SmartDataCenter UFDS Client API",
-  "version": "1.3.0",
+  "version": "1.4.0",
   "homepage": "https://github.com/joyent/sdc",
   "repository": {
     "type": "git",
-- 
2.21.0

