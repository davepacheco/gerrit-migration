{"project":"joyent/illumos-joyent","branch":"master","id":"I87738edeea3a17bfc0f19c6e1c3a597f3970e943","number":"6346","subject":"OS-7520 OS-6778 broke IPv4 forwarding OS-6878 mac_fix_cksum is incomplete OS-7806 cannot move link from NGZ to GZ Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Robert Mustacchi \u003crm@joyen","owner":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"url":"https://cr.joyent.us/6346","commitMessage":"OS-7520 OS-6778 broke IPv4 forwarding\nOS-6878 mac_fix_cksum is incomplete\nOS-7806 cannot move link from NGZ to GZ\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1558559563,"lastUpdated":1561032463,"open":false,"status":"MERGED","comments":[{"timestamp":1558559563,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 1."},{"timestamp":1558559724,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 1: Code-Review-1\n\nThe current usr/src/test integration doesn\u0027t really work as the script requires options/arguments that must be provided by the user. I have to see if I can find a way to modify it to play nice with usr/src/test. But I wanted to get a CR up before I lost my sanity."},{"timestamp":1558603982,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\nThis has peaked my interest as OS-7520 describes what I am seeing in https://github.com/joyent/smartos-live/issues/814 pretty well. In that case the NAT is done by FreeBSD but it also gets discarded on the return path due to bad checksums.\n\nI have a busy weekend but I will try and squeeze in a build with this change, out of curiousity."},{"timestamp":1558624987,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\nDidn\u0027t fix my problem, but did not cause anything else to break either."},{"timestamp":1558628932,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 1:\n\n\u003e This has peaked my interest as OS-7520 describes what I am seeing\n \u003e in https://github.com/joyent/smartos-live/issues/814 pretty well.\n \u003e In that case the NAT is done by FreeBSD but it also gets discarded\n \u003e on the return path due to bad checksums.\n \u003e \n \u003e I have a busy weekend but I will try and squeeze in a build with\n \u003e this change, out of curiousity.\n\nI wouldn\u0027t expect this to fix any issues with a guest HVM because the problem was specific to the native IP forwarding path."},{"timestamp":1559233955,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 2."},{"timestamp":1559233989,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 2: -Code-Review"},{"timestamp":1559329515,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(24 comments)\n\nFirst round of comments"},{"timestamp":1559502284,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 2:\n\n(24 comments)"},{"timestamp":1559502296,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 3."},{"timestamp":1559572461,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1559575003,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 4."},{"timestamp":1559575053,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1559586702,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4:\n\n(15 comments)\n\nI\u0027ll be taking another pass through all the testing related code, but I wanted to get this round out there."},{"timestamp":1559593586,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4:\n\n(22 comments)\n\nI know there are a lot of SmartOS-isms here and they\u0027re not all going to be removed at this time, but it\u0027d be good to try and at least get some of the things related using vmadm vs. zoneadmd changed or if not now, file a follow up so someone else can do that."},{"timestamp":1559597195,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1560358399,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 4:\n\n(37 comments)"},{"timestamp":1560358408,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 5."},{"timestamp":1560367156,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1560367229,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(10 comments)\n\nIn general this looks pretty good. I know it\u0027s been a bit of a pain to get here."},{"timestamp":1560377290,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 5:\n\n(5 comments)"},{"timestamp":1560378246,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1560398707,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 6."},{"timestamp":1560444285,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1560451744,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1560482332,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1560482338,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 7."},{"timestamp":1560519235,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1560523662,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1560899521,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 7:\n\nTesting notes added to the various tickets."},{"timestamp":1560900005,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1561032253,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 8: Patch Set 7 was rebased."},{"timestamp":1561032413,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Uploaded patch set 9: Commit message was updated."},{"timestamp":1561032463,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Ryan Zezeski"}],"currentPatchSet":{"number":"9","revision":"87738edeea3a17bfc0f19c6e1c3a597f3970e943","parents":["285d665c1bfb19b7a0d31074cbb554aae649ca56"],"ref":"refs/changes/46/6346/9","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1561032413,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560519235,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560523662,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560900005,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1561032463,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":362,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2699,"sizeDeletions":-412},"patchSets":[{"number":"1","revision":"fe1afa39c0ae53fc1493f37cc043a3394ab04169","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/1","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1558559563,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1558559724,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":37,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/smartos.run","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":40,"deletions":0},{"file":"usr/src/test/net-tests/tests/ip_forwarding.ksh","type":"ADDED","insertions":445,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":527,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":2,"deletions":-94},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":252,"deletions":-109},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":355,"deletions":-83},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":30,"deletions":-4}],"sizeInsertions":2028,"sizeDeletions":-317},{"number":"2","revision":"acbdcd35238c7eac3730252d6c70f691a9ed0364","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/2","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1559233955,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":34,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Not immediately pressing, but maybe we want to formalize a distro setting in the buildenv (if it doesn\u0027t already exist)."},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":34,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Maybe? I copied this from existing test scripts. I think they all do this."},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":114,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"ATM machine"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":114,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":120,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"PIN number"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":120,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip6.c","line":2737,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: While we\u0027re here, change this to a uint16_t?"},{"file":"usr/src/uts/common/inet/ip/ip6.c","line":2737,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1012,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1012,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1018,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1018,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1022,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Make this \u0027!\u003d 0\u0027 to match the explicitness of the other checks?"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1022,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1161,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I don\u0027t know enough about semicolons to know if this is valid or not"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I changed this around since the conjunction was meant to apply to the first sentence. But I\u0027m still using the semicolon to connect the two sentence because they are tightly related."},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1163,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"does \"travels via MAC-loopback\" seem clearer"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1163,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1205,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/inet/ip/ip_input.c","line":1205,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Great to see these split out as they are."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Shouldn\u0027t this be a \u0027const char **\u0027 to properly communicate out the error?  (with the additional necessary changes below)"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"No. We are changing the pointer to a constant char; we are not modifying a character array."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Ack."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"But in order to communicate out, via the argument, the pointer to the error, it needs to be \u0027const char **\u0027.  Right now, the caller passes in the existing error (pointer to \"\") in via %rcx.  If this (or mac_sw_cksum_ipv6) encounters an issue, it\u0027ll change the function local pointer to a new address, but when the function returns, there is no way for that to be communicated out to the caller where it will be later passed to mac_drop_pkt() below."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Sigh, yea my brain was in the other room when I wrote that."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":163,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: could be const"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":163,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":251,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Same deal, \u0027const char **\u0027"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":251,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"See previous comment."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":254,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: could be const"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":254,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":275,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Belt-and-suspenders or belt-and-landmine?"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":275,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I\u0027m not sure I follow but I believe you are saying I\u0027m being redundant? If so, yes, that is on purpose. On a debug build I want to crash here because we should never hit this case. The if logic is only there as defensive programming so we don\u0027t take ourselves out in production. In the future we should either a) a better way to get this info or b) use the \"mblk helpers\" to walk the chain so that this function is agnostic as to where the data resides. I want to keep this code as it was before until we make the appropriate changes."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":331,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Could use an extra local \u0027uint16_t *\u0027 var for this instead of the define hacks?"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":331,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":679,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"behavior"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":679,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":781,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: Since we\u0027re in here, can we make \u0027len\u0027 and \u0027size\u0027 both size_t?  So much is wrong with them being of type \u0027int\u0027"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":781,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":923,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: the body doesn\u0027t need to be tabbed in this far. compare above"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":923,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Whoops, must have botched a refactoring. Done."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":925,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: maybe a \u0027const uint_t\u0027 instead, if the terseness is needed? up to you"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":925,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1208,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"let the const flow through you"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1208,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Indeed."},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","line":88,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: Any reason these are defined smack dab in the middle of a struct?"},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","line":88,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I\u0027ve seen this done in a lot of other structs and I thought I\u0027d try it out. But it is kind of unsightly. I\u0027ll move it."},{"file":"usr/src/uts/common/sys/mac_impl.h","line":295,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Defining variables inside a macro is a code smell to me.  Maybe it\u0027s time to turn this and/or MAX_RING_TX into real functions?"},{"file":"usr/src/uts/common/sys/mac_impl.h","line":295,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I was reading a lot of glibc code and felt inspired.\n\nJust kidding...I took a shower in paint thinner after writing this. You\u0027re right to call it out. I\u0027ll change this to a function."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/smartos.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":125,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":422,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":527,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":2,"deletions":-94},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":252,"deletions":-109},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":355,"deletions":-83},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":30,"deletions":-4}],"sizeInsertions":2432,"sizeDeletions":-317},{"number":"3","revision":"893219e140247d709a7ac6d3b8304b886b05be97","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/3","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1559502296,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/smartos.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":422,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":527,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":42,"deletions":-4},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":251,"deletions":-109},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":353,"deletions":-85},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":6,"deletions":-17}],"sizeInsertions":2459,"sizeDeletions":-345},{"number":"4","revision":"6eb7693a838f9935b0e432761f2547fdf8acc766","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/4","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1559575003,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should this or the forwarding test verify that we have socat present somewhere?"},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":23,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Shouldn\u0027t this go to stderr?"},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":23,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Yes it should. I just copied what every other test is doing and didn\u0027t notice this. I\u0027ll file a bug for the other tests."},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":34,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"See the note on the run file, but it\u0027d be nice if we didn\u0027t need to do any distro detection and were just one single thing."},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":34,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I\u0027m just following the logic of all the other tests here. I\u0027l remove the smartos logic and instead use a default runfile."},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","line":34,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Thanks. The per-distro test files, imho, aren\u0027t something we should be doing."},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","line":14,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we add a block comment here that points one to the README or some other file that describes what should be set up here and the state of the zones? Otherwise, one might be searching for a bit."},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","line":14,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","line":17,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027ll probably be clearer to have the use of name and not uuid. As the fact that we use UUIDs for the zone name is just a convention and a zone itself doesn\u0027t have a UUID per se."},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","line":17,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/runfiles/smartos.run","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Given that all of this is basically a manual set up right now, is there any reason we need a SmartOS-specific version of this? In theory, assuming that we have all of the simnet changes present (which are coming with the code that introduces this test), there isn\u0027t anything SmartOS specific per se."},{"file":"usr/src/test/net-tests/runfiles/smartos.run","line":0,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":6,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"These should actually be the names of the zones. We use a UUID, but as this is probably using zlogin, the name\u0027s the relevant part."},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":6,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":74,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we file bugs that refer to what you\u0027d like to be able to do as in the fullness of time it\u0027d be nice to do it all natively."},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":74,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Filed OS-7830."},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":74,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Thank you!"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":81,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"names"},{"file":"usr/src/test/net-tests/tests/forwarding/README","line":81,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":112,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"In general, I recommend prefixing all of these like you would a global in a C program."},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":112,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":184,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can you double check with Jerry to make sure that this is generally valid? Maybe we should zlogin and mkdir instead, tbh."},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":184,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I\u0027ve been doing this for years and it\u0027s shown no problems but I changed it to use zlogin anyways."},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":184,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s fine if and only if you\u0027re on SmartOS and even then there are some gotchas there. So thanks for changing it to use zlogin. That will make it easier for us to actually run these more generally."},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":223,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there a reason that these IP addresses and related aren\u0027t constants like the $server_ip and $client_ip?"},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":223,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":367,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can all these ports be constants please?"},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","line":367,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":12,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Minor nit, but match the prototype with the comment spacing around the blocks?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":12,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":50,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we use zoneadm?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":50,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":62,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we use zoneadm?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":62,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":96,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"If we hit this, don\u0027t we need to still return even if we don\u0027t fail? As won\u0027t this continue execution?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":96,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":146,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Worth checking that the arguments are all non-empty?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":146,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I added an argument count check to all functions. That should catch the most likely incorrect usage of these functions during development."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":166,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Worth checking that the arguments are all non-empty? I\u0027m not going to mention this going forward."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":166,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":180,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It might be clearer to just have a variable that\u0027s an option string you append and vid is non-zero you add \u0027-v $vid\u0027 to it, otherwise it\u0027s just empty and have a single dladm create-vnic arg."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":180,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":207,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we still try to delete the vnic even if this fails?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":207,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Nope. I missed a return call in a bunch of places where maybe_fail is not the last statement."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":526,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, what happens if the pid in question gets recycled?"},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":526,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Good question. I could get rid of this, use regular wait, and rely on the test runner\u0027s built-in timeout mechanism. I only added this because I was first testing this by running it by hand. But in that case the user can just Ctrl-C and cleanup manually."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":526,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027m not sure what the best answer is. I was just initially surprised to see us manually trying to kill things to figure out what was going on with the process state."},{"file":"usr/src/uts/common/io/mac/mac.c","line":8797,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m not sure const is a good idea here, considering we immediately cast it away."},{"file":"usr/src/uts/common/io/mac/mac.c","line":8797,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/mac/mac.c","line":8825,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This seems a little problematic. Today, the ring related tx functions assume that they will only ever receive a single packet at a time. However, if we do LSO emulation, then this may be split into several packets. Many drivers that I\u0027ve looked at including hxge, igb, ixgbe, i40e, etc. will do the wrong thing if a b_next is set. So I think we need to possibly redo the logic here about splitting the number of packets that exist as the way that mac_ring_tx operates, it only gets a single packet. On the other hand, ironically, the traditional tx interface is documented and handles chains correctly."},{"file":"usr/src/uts/common/io/mac/mac.c","line":8825,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Yep. This was an oversight on my part. I moved the emulation into `mac_tx()` which passes the chain to `st_func`. The `st_func` API is still based on mblk chains and all possible callbacks are chain safe (I had to tweak a few spots but overall they were already meant to handle chains)."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Worth indicating that this only calculates the L4 header?"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we comment somewhere that offset here is the offset to the start of the IP header?"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Change the variable name of ip_hdr_offset."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":161,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":170,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we add some kind of comment indicating the assumptions around the fact that the IP header doesn\u0027t have extensions and if it does, that\u0027s already been handled and verified elsewhere / is a prerequisite of callers?"},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":170,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I updated the function to handle non-basic headers."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":186,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"These comments are no longer required as lint is dead."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":186,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Removed."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":251,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"See notes about the ipv4 version bits here."},{"file":"usr/src/uts/common/io/mac/mac_util.c","line":251,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":927,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can these be explicit comparisons?"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":927,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1227,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Since all of the ethernet properties here are basically boolean values, it feels like things will be much clearer if we check the strings for something like \u0027on\u0027 and \u0027off\u0027. This will make it easier to process and understand semantically."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1227,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I was just following what I saw in other places. But this is a good point. I changed this around a bit to use self-describing strings. I think it looks a bit cleaner now."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1227,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Thanks for doing that."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1236,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Shouldn\u0027t we return EINVAL if this fails? Shouldn\u0027t we check to make sure that the user gave us a valid string and not the string \u002734pasdf\u0027 and actually check the end pointer?"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1236,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1250,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s not clear to me why all values except the number 1 mean turn it off. If you\u0027re keeping it as numbers, I think it\u0027ll be much clearer if you return EINAVL if a value is not zero or one then."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1250,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1253,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"All of the above comments hold for the rest of the properties."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1253,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1420,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, why can we get these properties for WiFi devices if we can\u0027t actually set them for WiFi devices? It\u0027s a little weird that the the get path has this, but the set and propinfo path does not. If we\u0027re going to keep them, shouldn\u0027t it also be in propinfo?"},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1420,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"This looks like some copy-pasta to me. Removed."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1426,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This feels unsporting. If the value doesn\u0027t fit, we\u0027ll return zero saying we wrote it but instead it\u0027ll be possibly arbitrary value. If snprintf returns \u003e\u003d to len, shouldn\u0027t we return an error? Per mc_getprop(9E) this should be EOVERFLOW."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1426,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I was doing this based off other code. E.g. if you look at linkprop.c it\u0027s all like this. And I think the reasoning is that we know the lengths involved a priori and we know nothing is going to fail. In this case it\u0027s a bit different since it\u0027s a private prop in kernel land but we also know the size is 1024 and nothing here is close to overflowing that.\n\nThat said, I\u0027ll change this code to make no assumptions, as you suggest."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1426,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Thanks. I try to never rely on user land or the broader frameworks doing the right things here so we have a bit of defense in depth in these APIs."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1451,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"See above."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1451,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Done"},{"file":"usr/src/uts/common/sys/mac_impl.h","line":474,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I would probably indicate in the name that these are the tx_cksum_flags. As the set of rx and tx checksums may be independent (though it\u0027s not often that way)."},{"file":"usr/src/uts/common/sys/mac_impl.h","line":474,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"That\u0027s a good point, done."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/smartos.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":422,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":527,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":42,"deletions":-4},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":251,"deletions":-109},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":353,"deletions":-85},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":6,"deletions":-17}],"sizeInsertions":2459,"sizeDeletions":-345},{"number":"5","revision":"f8bc13a30f60eaa5f2cb11d9425d1249d5ac4f66","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/5","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1560358408,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":58,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: Here and elsewhere, you could be paranoid about $name potentially containing spaces by wrapping it with \"\", I think.  If there\u0027s no risk of that due to the scripts, then I suppose it\u0027s all fine."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":58,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"It\u0027s a fair point. But if it doesn\u0027t bother you too much I\u0027d like to defer that to when it becomes a problem."},{"file":"usr/src/test/net-tests/tests/net_common.ksh","line":58,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Deference is fine."},{"file":"usr/src/uts/common/io/mac/mac_client.c","line":3587,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Could you explain a little bit more why we have the check for LSO being disabled? Is this logically saying that the packet has something set that the provider doesn\u0027t support and right now the only thing that triggers that is LSO?"},{"file":"usr/src/uts/common/io/mac/mac_client.c","line":3587,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"I had to add this guard because it\u0027s a special case for sending a single packet (along with the other constraints). If we let an LSO packet enter and perform the emulation then we are sending a chain to the provider, which it can\u0027t handle. Or we have to add another loop. I decided to just avoid letting LSO packets takes this route.\n\nFurthermore, I would argue we should consider axing this entire code block. I\u0027m not sure if it\u0027s really an optimization if it hardly ever applies. And in the cases it does apply it\u0027s maybe buying some tiny amount of latency...maybe? And I wonder if we are just penalizing the more typical code path.\n\nI can add a comment explaining the chain issue if you think it would help."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1577,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This seems dangerous. Please open a bug so we can fix it and have it properly pass along a size. We shouldn\u0027t rely on a userland implementation in the kernel as the sizing here really is ultimately decided by MAC."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1577,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Yea I\u0027m going to pull the range stuff. I filed OS-7837 which I\u0027m going to follow up immediately after this."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1582,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"GLDv3 drivers really aren\u0027t supposed to dig into this structure. We should instead add a new mac_provider option to add a string to the range and fix the question of sizing. I don\u0027t want to block this work on this, but it seems a bit dangerous to have this be here long term. I\u0027m not sure if it\u0027s better to just not have a range for strings right now or to put back as is and come back and clean this up."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1582,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Yea that\u0027s a good point. I should have realized I was violating the ROE when making the cast."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1597,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This is the source length. strlcpy is supposed to take the destination buffer length."},{"file":"usr/src/uts/common/io/simnet/simnet.c","line":1597,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Whoops, that was an oversight."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":74,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":397,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2735,"sizeDeletions":-412},{"number":"6","revision":"1a2dc222a35dfc905e79b1e286a0b1878d3d4ee4","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/6","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1560398707,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560444285,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/uts/common/io/mac/mac_client.c","line":3700,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If the first packet in the chain does not use any of the offload features, then tail will remain NULL, and on the next mblk_t, the new_tail-\u003eb_next dereference will be a problem."},{"file":"usr/src/uts/common/io/mac/mac_client.c","line":3700,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Nice catch."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":74,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":362,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2700,"sizeDeletions":-412},{"number":"7","revision":"50f7402163fc66530db2c1d899ab17afc219023e","parents":["006c23064de517ad172bcb4d24d8fbba01b875ec"],"ref":"refs/changes/46/6346/7","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1560482338,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560519235,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560900005,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560523662,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":362,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2699,"sizeDeletions":-412},{"number":"8","revision":"7c527132783f993e3f7adb8c170ed40c83301dcc","parents":["285d665c1bfb19b7a0d31074cbb554aae649ca56"],"ref":"refs/changes/46/6346/8","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1561032253,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560519235,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560900005,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560523662,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":362,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2699,"sizeDeletions":-412},{"number":"9","revision":"87738edeea3a17bfc0f19c6e1c3a597f3970e943","parents":["285d665c1bfb19b7a0d31074cbb554aae649ca56"],"ref":"refs/changes/46/6346/9","uploader":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"createdOn":1561032413,"author":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560519235,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560900005,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560523662,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1561032463,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/cmd/dlmgmtd/dlmgmt_door.c","type":"MODIFIED","insertions":2,"deletions":-16},{"file":"usr/src/test/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/test/net-tests/Makefile","type":"ADDED","insertions":20,"deletions":0},{"file":"usr/src/test/net-tests/cmd/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/test/net-tests/cmd/nettest.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/net-tests/config/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/config/ip_forwarding.config","type":"ADDED","insertions":22,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/Makefile","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/runfiles/default.run","type":"ADDED","insertions":29,"deletions":0},{"file":"usr/src/test/net-tests/tests/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/Makefile","type":"ADDED","insertions":51,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/README","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_forwarding.ksh","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_full_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_no_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/forwarding/ip_fwd_partial_cksum_lso.ksh","type":"ADDED","insertions":38,"deletions":0},{"file":"usr/src/test/net-tests/tests/net_common.ksh","type":"ADDED","insertions":631,"deletions":0},{"file":"usr/src/uts/common/inet/ip/ip6.c","type":"MODIFIED","insertions":3,"deletions":-95},{"file":"usr/src/uts/common/inet/ip/ip6_input.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/inet/ip/ip_input.c","type":"MODIFIED","insertions":39,"deletions":-6},{"file":"usr/src/uts/common/inet/ip6.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/bridge.c","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"usr/src/uts/common/io/fcoe/fcoe_fc.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":54,"deletions":-6},{"file":"usr/src/uts/common/io/mac/mac_bcast.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_provider.c","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"usr/src/uts/common/io/mac/mac_sched.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/mac/mac_util.c","type":"MODIFIED","insertions":259,"deletions":-120},{"file":"usr/src/uts/common/io/simnet/simnet.c","type":"MODIFIED","insertions":362,"deletions":-100},{"file":"usr/src/uts/common/io/simnet/simnet_impl.h","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/os/ip_cksum.c","type":"MODIFIED","insertions":108,"deletions":0},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":7,"deletions":-48}],"sizeInsertions":2699,"sizeDeletions":-412}],"allReviewers":[{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}