{"project":"joyent/sdc-nfsserver","branch":"master","topic":"lullaby-phase2","id":"I1b4d0ede8dd5c0537306eb3367c3789db6afbc79","number":"5535","subject":"TRITON-1128 convert sdc-nfsserver to engbld framework Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"url":"https://cr.joyent.us/5535","commitMessage":"TRITON-1128 convert sdc-nfsserver to engbld framework\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1549625219,"lastUpdated":1551184501,"open":false,"status":"MERGED","comments":[{"timestamp":1549625219,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 1."},{"timestamp":1549625226,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 1b0ad2d2432d22e65197828e9c10a52339189538\n    \n    TRITON-1128 convert sdc-nfsserver to engbld framework"},{"timestamp":1549626117,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1549626895,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Topic set to lullaby-phase2"},{"timestamp":1550762787,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 2."},{"timestamp":1550762794,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 2484d12ec6ef1a74a136a8eb2f3350ab137fe4ee\n    \n    TRITON-1128 convert sdc-nfsserver to engbld framework"},{"timestamp":1550764161,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550854247,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 3."},{"timestamp":1550854255,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit dc23001a66cbb25e7b76048d3f8fcf4efe2105b2\n    \n    TRITON-1128 convert sdc-nfsserver to engbld framework"},{"timestamp":1550854409,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550875827,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\nBuilt, imported and tested as follows in nihtly-1:\n\nFirst apply this manual tweak to volapi\u0027s config to have it use the newly imported image:\n\n```\n[root@db9c9915-fd13-4ace-b45c-1c12c8cc1145 (nightly-1:volapi0) /opt/smartdc/volapi]# diff -u config.json.old  config.json\n--- config.json.old     Fri Feb 22 22:44:46 2019\n+++ config.json Fri Feb 22 22:44:52 2019\n@@ -2,8 +2,7 @@\n     \"logLevel\": \"debug\",\n     \"maxSockets\": 100,\n     \"ufdsAdminUuid\": \"930896af-bf8c-48d4-885c-6573a94b1853\",\n-    \"XXXold nfsServerImageUuid\": \"9fb86870-1941-11e6-8002-4f231c890ed1\",\n-    \"nfsServerImageUuid\": \"53117db9-1f8a-4ebc-b0e1-2dc4c781486d\",\n+    \"nfsServerImageUuid\": \"9fb86870-1941-11e6-8002-4f231c890ed1\",\n     \"api\": {\n         \"port\": 80\n     },\n```\n\nwhere that image is:\n\n```\n[root@headnode (nightly-1) ~]# sdc-imgadm list name\u003dnfsserver\nUUID                                  NAME       VERSION                              FLAGS  OS       PUBLISHED\n9fb86870-1941-11e6-8002-4f231c890ed1  nfsserver  master-20160513T193027Z-g5c46a06     I      smartos  2016-05-13T19:33:39Z\n53117db9-1f8a-4ebc-b0e1-2dc4c781486d  nfsserver  cr-5535-2-20190222T053243Z-geeac5c0  I      smartos  2019-02-22T22:34:39Z\n```\n\nTested via `GT/bin/stage-test-volapi nightly-1`. Tests passed:\n\n```\n...\n# test results:\n# Completed in 331 seconds.\n# PASS: 306 / 306\n\n\n--\n# Get the tap results.\n./bin/stage-test-volapi finished in 345 seconds.\n```"},{"timestamp":1550875836,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1551184489,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1551184501,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Tim Foster"}],"currentPatchSet":{"number":"4","revision":"1b4d0ede8dd5c0537306eb3367c3789db6afbc79","parents":["23a47f2947236d29d836aa73bf93185917bc9b26"],"ref":"refs/changes/35/5535/4","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1551184489,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550854409,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1551184501,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":2,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":3,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":22,"deletions":-21},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"DELETED","insertions":0,"deletions":-51},{"file":"tools/mk/Makefile.deps","type":"DELETED","insertions":0,"deletions":-54},{"file":"tools/mk/Makefile.manpages.defs","type":"DELETED","insertions":0,"deletions":-128},{"file":"tools/mk/Makefile.manpages.targ","type":"DELETED","insertions":0,"deletions":-28},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-104},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_deps.defs","type":"DELETED","insertions":0,"deletions":-43},{"file":"tools/mk/Makefile.node_deps.targ","type":"DELETED","insertions":0,"deletions":-24},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-153},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29},{"file":"tools/mk/Makefile.targ","type":"DELETED","insertions":0,"deletions":-319}],"sizeInsertions":28,"sizeDeletions":-1078},"patchSets":[{"number":"1","revision":"38fa8fa03e08dc35aa226fc71b766d95b1c5085c","parents":["23a47f2947236d29d836aa73bf93185917bc9b26"],"ref":"refs/changes/35/5535/1","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1549625219,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1549626117,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":2,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":3,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":23,"deletions":-18},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"DELETED","insertions":0,"deletions":-51},{"file":"tools/mk/Makefile.deps","type":"DELETED","insertions":0,"deletions":-54},{"file":"tools/mk/Makefile.manpages.defs","type":"DELETED","insertions":0,"deletions":-128},{"file":"tools/mk/Makefile.manpages.targ","type":"DELETED","insertions":0,"deletions":-28},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-104},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_deps.defs","type":"DELETED","insertions":0,"deletions":-43},{"file":"tools/mk/Makefile.node_deps.targ","type":"DELETED","insertions":0,"deletions":-24},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-153},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29},{"file":"tools/mk/Makefile.targ","type":"DELETED","insertions":0,"deletions":-319}],"sizeInsertions":29,"sizeDeletions":-1075},{"number":"2","revision":"eeac5c0367500db8f69ce1130ec12bef1da481b2","parents":["23a47f2947236d29d836aa73bf93185917bc9b26"],"ref":"refs/changes/35/5535/2","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1550762787,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550764161,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":2,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":3,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":21,"deletions":-20},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"DELETED","insertions":0,"deletions":-51},{"file":"tools/mk/Makefile.deps","type":"DELETED","insertions":0,"deletions":-54},{"file":"tools/mk/Makefile.manpages.defs","type":"DELETED","insertions":0,"deletions":-128},{"file":"tools/mk/Makefile.manpages.targ","type":"DELETED","insertions":0,"deletions":-28},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-104},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_deps.defs","type":"DELETED","insertions":0,"deletions":-43},{"file":"tools/mk/Makefile.node_deps.targ","type":"DELETED","insertions":0,"deletions":-24},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-153},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29},{"file":"tools/mk/Makefile.targ","type":"DELETED","insertions":0,"deletions":-319}],"sizeInsertions":27,"sizeDeletions":-1077},{"number":"3","revision":"72c9f5b7ea77cb63738e637eae8eccc4b765e089","parents":["23a47f2947236d29d836aa73bf93185917bc9b26"],"ref":"refs/changes/35/5535/3","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1550854247,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550854409,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":2,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":3,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":22,"deletions":-21},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"DELETED","insertions":0,"deletions":-51},{"file":"tools/mk/Makefile.deps","type":"DELETED","insertions":0,"deletions":-54},{"file":"tools/mk/Makefile.manpages.defs","type":"DELETED","insertions":0,"deletions":-128},{"file":"tools/mk/Makefile.manpages.targ","type":"DELETED","insertions":0,"deletions":-28},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-104},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_deps.defs","type":"DELETED","insertions":0,"deletions":-43},{"file":"tools/mk/Makefile.node_deps.targ","type":"DELETED","insertions":0,"deletions":-24},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-153},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29},{"file":"tools/mk/Makefile.targ","type":"DELETED","insertions":0,"deletions":-319}],"sizeInsertions":28,"sizeDeletions":-1078},{"number":"4","revision":"1b4d0ede8dd5c0537306eb3367c3789db6afbc79","parents":["23a47f2947236d29d836aa73bf93185917bc9b26"],"ref":"refs/changes/35/5535/4","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1551184489,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550854409,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550875836,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1551184501,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":2,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":3,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":22,"deletions":-21},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"DELETED","insertions":0,"deletions":-51},{"file":"tools/mk/Makefile.deps","type":"DELETED","insertions":0,"deletions":-54},{"file":"tools/mk/Makefile.manpages.defs","type":"DELETED","insertions":0,"deletions":-128},{"file":"tools/mk/Makefile.manpages.targ","type":"DELETED","insertions":0,"deletions":-28},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-104},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_deps.defs","type":"DELETED","insertions":0,"deletions":-43},{"file":"tools/mk/Makefile.node_deps.targ","type":"DELETED","insertions":0,"deletions":-24},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-153},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29},{"file":"tools/mk/Makefile.targ","type":"DELETED","insertions":0,"deletions":-319}],"sizeInsertions":28,"sizeDeletions":-1078}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}]}