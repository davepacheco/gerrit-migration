From 871ccd0182ab925d3d3a7665a5a9d477213371e0 Mon Sep 17 00:00:00 2001
From: YangYong3 <yy1111.yang@samsung.com>
Date: Thu, 16 Feb 2017 11:00:58 +0900
Subject: [PATCH] joyent/node-triton#172 how about check the current state
 before change the instance state...

---
 lib/do_instance/gen_do_ACTION.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/do_instance/gen_do_ACTION.js b/lib/do_instance/gen_do_ACTION.js
index 030c241..28565bf 100644
--- a/lib/do_instance/gen_do_ACTION.js
+++ b/lib/do_instance/gen_do_ACTION.js
@@ -135,10 +135,13 @@ function _doOnEachInstance(self, action, command, state, instances,
                     }
                     alias = arg;
                     uuid = inst.id;
+                    if (state === inst.state) {
+                        console.log('current state is already ' + state);
+                        cb(new Error());
+                    }
                     done();
                 });
             }
-
             // called when "uuid" is set
             function done() {
                 var cOpts = uuid;
-- 
2.21.0

