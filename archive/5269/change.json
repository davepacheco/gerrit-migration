{"project":"joyent/node-sshpk","branch":"master","id":"I586dfb59378dab827774aafa3a510b962f9632e6","number":"5269","subject":"joyent/node-sshpk#18 support for PKCS8 encrypted private keys Reviewed by: Isaac Davis \u003cisaac.davis@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/5269","commitMessage":"joyent/node-sshpk#18 support for PKCS8 encrypted private keys\nReviewed by: Isaac Davis \u003cisaac.davis@joyent.com\u003e\n","createdOn":1545267244,"lastUpdated":1545359968,"open":false,"status":"MERGED","comments":[{"timestamp":1545267244,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1545267269,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n deps/javascriptlint/build/install/jsl --nologo --nosummary --conf\u003dtools/jsl.node.conf lib/key.js lib/certificate.js lib/utils.js lib/identity.js lib/fingerprint.js lib/errors.js lib/private-key.js lib/signature.js lib/dhe.js lib/ssh-buffer.js lib/ed-compat.js lib/formats/ssh-private.js lib/formats/x509.js lib/formats/putty.js lib/formats/pkcs1.js lib/formats/pem.js lib/formats/dnssec.js lib/formats/pkcs8.js lib/formats/ssh.js lib/formats/auto.js lib/formats/openssh-cert.js lib/formats/rfc4253.js lib/formats/x509-pem.js lib/algs.js lib/index.js\n /tmp/repo/lib/key.js\n /tmp/repo/lib/certificate.js\n /tmp/repo/lib/utils.js\n /tmp/repo/lib/utils.js(141): warning: identifer i hides an identifier in a parent scope\n /tmp/repo/lib/identity.js\n /tmp/repo/lib/fingerprint.js\n /tmp/repo/lib/errors.js\n /tmp/repo/lib/private-key.js\n /tmp/repo/lib/signature.js\n /tmp/repo/lib/dhe.js\n /tmp/repo/lib/ssh-buffer.js\n /tmp/repo/lib/ed-compat.js\n /tmp/repo/lib/formats/ssh-private.js\n /tmp/repo/lib/formats/x509.js\n /tmp/repo/lib/formats/putty.js\n /tmp/repo/lib/formats/putty.js(35): warning: variable is declared but never referenced: enc\n /tmp/repo/lib/formats/pkcs1.js\n /tmp/repo/lib/formats/pem.js\n /tmp/repo/lib/formats/dnssec.js\n /tmp/repo/lib/formats/pkcs8.js\n /tmp/repo/lib/formats/ssh.js\n /tmp/repo/lib/formats/auto.js\n /tmp/repo/lib/formats/openssh-cert.js\n /tmp/repo/lib/formats/rfc4253.js\n /tmp/repo/lib/formats/x509-pem.js\n /tmp/repo/lib/algs.js\n /tmp/repo/lib/index.js\n tools/mk/Makefile.targ:170: recipe for target \u0027check-jsl-node\u0027 failed\n gmake: *** [check-jsl-node] Error 1"},{"timestamp":1545267378,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1545267501,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1545267507,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545267620,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545338666,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\nLooks good. I\u0027d like to see test cases that exercise the error-checks in the read() function, but if it\u0027s quite difficult to generate the appropriate malformed inputs, that\u0027s ok."},{"timestamp":1545356507,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1545356533,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545356744,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1545357093,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1545357103,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"},{"timestamp":1545359968,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(5 comments)"}],"currentPatchSet":{"number":"5","revision":"574ff21e77117b478baf4664856bfc4b0aa41a12","parents":["f647cf22c3258ef514d2ba098a4a6aad3492f425"],"ref":"refs/changes/69/5269/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545357093,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545356533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"SUBM","value":"1","grantedOn":1545357103,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-hash","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-iters","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-kdf","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-scheme","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":51,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":54,"deletions":0}],"sizeInsertions":288,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"a4aa75eed1016f591ad989d3510604f108d7193f","parents":["31285de59caf6648a013d31f58dabfe3749720e6"],"ref":"refs/changes/69/5269/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545267244,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1545267269,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":35,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":53,"deletions":0}],"sizeInsertions":233,"sizeDeletions":-4},{"number":"2","revision":"b6fab99faf1bb8d4c8c8f1ada0c92bd1007a300a","parents":["44aec4ad8bcf7324009c92a52e4c81487cbc24b9"],"ref":"refs/changes/69/5269/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545267378,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545267507,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":35,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":53,"deletions":0}],"sizeInsertions":233,"sizeDeletions":-4},{"number":"3","revision":"2f189ff5f587cd2a84c80921319f2ebf066cb372","parents":["44aec4ad8bcf7324009c92a52e4c81487cbc24b9"],"ref":"refs/changes/69/5269/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545267501,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545267620,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545338666,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545338666,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"comments":[{"file":"lib/formats/pem.js","line":100,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This won\u0027t actually slice off the first line, since the first argument is 0, not 1. This may just be a problem with the comment though, and not the code, since it\u0027s the same thing as what it was doing before."},{"file":"lib/formats/pem.js","line":130,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"A comment explaining what the two .readSequence() calls are for, like there are below, would be good."},{"file":"lib/formats/pem.js","line":154,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This should probably use !OID_TO_HASH.hasOwnProperty(hashAlgOid) first instead of testing if the fetched value is undefined."},{"file":"lib/formats/pem.js","line":164,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Ditto"},{"file":"test/utils.js","line":38,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"\"These examples were taken from RFC6070\""}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":54,"deletions":0}],"sizeInsertions":235,"sizeDeletions":-4},{"number":"4","revision":"586dfb59378dab827774aafa3a510b962f9632e6","parents":["f647cf22c3258ef514d2ba098a4a6aad3492f425"],"ref":"refs/changes/69/5269/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545356507,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545356533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-hash","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-iters","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-kdf","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-scheme","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":51,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":54,"deletions":0}],"sizeInsertions":288,"sizeDeletions":-4},{"number":"5","revision":"574ff21e77117b478baf4664856bfc4b0aa41a12","parents":["f647cf22c3258ef514d2ba098a4a6aad3492f425"],"ref":"refs/changes/69/5269/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545357093,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1545357103,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545356533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545356744,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/formats/pem.js","type":"MODIFIED","insertions":91,"deletions":-3},{"file":"lib/utils.js","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"test/assets/id_ecdsa_pkcs8_enc","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc2","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/id_ecdsa_pkcs8_enc3","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-hash","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-iters","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-kdf","type":"ADDED","insertions":8,"deletions":0},{"file":"test/assets/pkcs8-enc-bad-scheme","type":"ADDED","insertions":8,"deletions":0},{"file":"test/pem.js","type":"MODIFIED","insertions":51,"deletions":0},{"file":"test/utils.js","type":"MODIFIED","insertions":54,"deletions":0}],"sizeInsertions":288,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}