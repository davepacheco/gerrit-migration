{"project":"joyent/illumos-joyent","branch":"master","id":"Icbb3bef02017a9ab77b89506f9ced6c9546074ea","number":"4760","subject":"OS-7200 would like thread name API OS-7205 bhyve makefile uses wrong linker flags Reviewed by: Jason King \u003cjason.king@joyent.com\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"url":"https://cr.joyent.us/4760","commitMessage":"OS-7200 would like thread name API\nOS-7205 bhyve makefile uses wrong linker flags\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1535556386,"lastUpdated":1536605027,"open":false,"status":"MERGED","comments":[{"timestamp":1535556386,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 1."},{"timestamp":1535556389,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 7cdaca3ea474ec950aaf674783795aa06dd5b2f5\n    \n    self-review\n    \n    commit ce2282f0052d6611674b4a7369073c309c46349b\n    \n    ps fixes\n    \n    commit 86d31e2605605c49ff44cba0eeef425e4107d821\n    \n    pbchk\n    \n    commit f2098da98b82288269e9c5e8f5bf4f4f9ac74cd2\n    \n    lwpname, thr_setname, fixes\n    \n    commit a75403ae29bbc99119dc3e30f07fd6de07adb1ab\n    \n    MDB module improvements / fixes\n    \n    commit d43cb89dc3b2663fd4f1edbef340d32140057301\n    \n    NULL setname clears thread name\n    \n    commit 4c852ee1916771a60120e1a0c12c802f73b862cf\n    \n    bhyve thread names\n    \n    commit d60635cbeb4e1c8d790377c23da679a1f99fc283\n    \n    fix ps -o lname,pid\n    \n    commit 08d41ce61190bcf61256e61bec6b1415e8c0c7a8\n    \n    thread_vsetname()\n    \n    commit 7a0b27344d754f55a4f32f121004be96cf130295\n    \n    fix error returns\n    \n    commit a91295c0e351c72f8c30b629d3b1e16868757a1c\n    \n    threadname in dtrace not uthreadname\n    \n    commit c1dd724d1fe88a599a5998f45f46822e0febd64d\n    \n    tests\n    \n    commit 0a3e6646fd5cfedab90164bbeece820dd86839e7\n    \n    PTHREAD_MAX_NAMELEN_NP\n    \n    commit 38aad3f2c17450fa777999e74caffa5e742f4e95\n    \n    man page fixes\n    \n    commit ba744def0e30eded13dab6082fe5531b73c65001\n    \n    prstat - curses formatting seems working\n    \n    commit 5535bc7d258887654eeb09fe6d4233bbf8f58375\n    \n    prstat (WIP)\n    \n    commit f7aee976bb653f420d992253f77dd6dc6e9ec6b1\n    \n    dtrace (WIP)\n    \n    commit ad73a22c4f94c57e868f8f1202123fb4d9a108a6\n    \n    ps\n    \n    commit b3f37e6b78f640863df744132e044830cca67516\n    \n    pstack\n    \n    commit 7c0b52c9887b220450ac53e7bfaabfc83b319b09\n    \n    ldap_cachemgr thread names\n    \n    commit 3ac4f9e56c94ed849e48d2e40c1f9c9f1e02ad83\n    \n    nscd thread names\n    \n    commit 12b797f88a054f46fc330f96eef828731c3ff986\n    \n    ipmgmtd thread names\n    \n    commit 58652b9f43bfca3b5b2bd4c710f0fe03a6b73d0a\n    \n    svc.startd thread names\n    \n    commit 43eb9fe126bb36ccf292fe9ace93e28001a3db36\n    \n    manpages\n    \n    commit 2c977ae34cc46233ac7eac130dc882c32ff59c2d\n    \n    MDB fix\n    \n    commit 19f97a14b2715c90192d407ba14d4475a013463f\n    \n    implementation"},{"timestamp":1535556493,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\nThis is based on Jason King\u0027s initial work. The prstat format itself is still being debated but AFAIK everything else is ready for review."},{"timestamp":1535566196,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(4 comments)\n\nA few man page fixes -- I can push these fixes to the RFD96 branch if that\u0027d help."},{"timestamp":1535568398,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 2."},{"timestamp":1535568408,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit dffae9357f092090de679f58aa680d71d787fc5f\n    \n    manpage fixes"},{"timestamp":1535568510,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1535573922,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1535584156,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1535651702,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(32 comments)"},{"timestamp":1535725089,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\n(28 comments)"},{"timestamp":1535725113,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 3."},{"timestamp":1535725133,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 683ad9953aecd6f1585a9b0b5f09e59dcd334623\n    \n    rm review 1"},{"timestamp":1535726831,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(7 comments)"},{"timestamp":1535729032,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1535754573,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 4."},{"timestamp":1535754596,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit e7e0b5e7e4e94f144530abeb6cfbe3df354b81fb\n    \n    rework prstat\n    \n    commit 7fc0ca053287cc00ccc14b290760d2df0a7d0a37\n    \n    pbchk\n    \n    commit 624a3f2be9ccec4cf219fa5785c025157b1eb59f\n    \n    rm round 2\n    \n    commit 38466fdb1c4f984dd112bf0bc77dc58d37710bbb\n    \n    jbk review\n    \n    commit d3d8a0a098df226bd3c084f46545f53eb2ffbe80\n    \n    thread name sanitization"},{"timestamp":1535754809,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 4:\n\n(4 comments)\n\nThis has the new prstat behaviour, as well as the at-set-time sanitization."},{"timestamp":1535886657,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 5."},{"timestamp":1535886695,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 6bacd98e56f04c9c75361538472add46f351a670\n    \n    prstat manpage"},{"timestamp":1536077975,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(4 comments)\n\nI have a few minor notes of the new version. Also, we should probably be adding some additional tests to dtest for the safety of the new operator, right?"},{"timestamp":1536158475,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 6."},{"timestamp":1536158513,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 55ee7f39b6dbb1c7c8e9605651ab0234f39fd3b1\n    \n    pbchk\n    \n    commit ee951fca86f063fd85f3c45f063b358adcfc0ec6\n    \n    another rm round"},{"timestamp":1536172717,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1536174843,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 6: Code-Review+1\n\nSince I did part of the original work, I\u0027m not sure how much my +1 should count (if at all) -- though my +1 does encompass my review of the subsequent work done by John."},{"timestamp":1536242303,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1536246888,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1536246945,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 8:\n\nI updated the ticket with testing notes"},{"timestamp":1536602698,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 8: Integration-Approval+1"},{"timestamp":1536604712,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 9: Commit message was updated."},{"timestamp":1536604767,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 10: Patch Set 9 was rebased"},{"timestamp":1536605027,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by John Levon"}],"currentPatchSet":{"number":"10","revision":"e639e7fb5bc8e8f25f3c1ea960c37baf9fcd5f3f","parents":["bf3893188b13fb85ead1f29fc911e443b816ffb5"],"ref":"refs/changes/60/4760/10","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536604767,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536602698,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1536605027,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378},"patchSets":[{"number":"1","revision":"a465f5e7d11cbe47944719218fb17bdc21b3b7ff","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/1","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1535556386,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/cmd/nscd/cache.c","line":1822,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"We could probably change a number of these consumers to use thr_setname() now that it exists, though I wouldn\u0027t consider it a blocker."},{"file":"usr/src/cmd/nscd/cache.c","line":1822,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I\u0027m inclined not to bother, but if someone feels strongly enough I can..."},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","line":58,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"This should probably be .Dv"},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","line":58,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Think I got all these, thanks."},{"file":"usr/src/man/man3c/pthread_getname_np.3c","line":75,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"These should be .Xr macros"},{"file":"usr/src/man/man3c/thr_getname.3c","line":52,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"This should probably be a .Dv macro"},{"file":"usr/src/man/man3c/thr_getname.3c","line":75,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"These should use .Xr"},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","line":462,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Nit: \u003d { 0 } for C99 will initialize the entire structure to 0s."},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","line":462,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":186,"deletions":-57},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":41,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":36,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":44,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":81,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":21,"deletions":-10},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":101,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":116,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":116,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"usr/src/test/os-tests/tests/Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/test/os-tests/tests/thread/Makefile","type":"ADDED","insertions":48,"deletions":0},{"file":"usr/src/test/os-tests/tests/thread/thread_name.c","type":"ADDED","insertions":255,"deletions":0},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":21,"deletions":0},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":84,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":1790,"sizeDeletions":-326},{"number":"2","revision":"dca4be21bbe25b5406aeb97a89ce625dca3bbda3","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/2","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1535568398,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/cmd/bhyve/Makefile","line":127,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Feels like a second bug ID should cover this? Should we use a conditional assignment for LDLIBS for this program as well rather than manually append -lsocket?"},{"file":"usr/src/cmd/bhyve/Makefile","line":127,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Filed OS-7205. I\u0027ll include it in the commit message later on (grr user here for my sins).\n\nI can change the way we add -lsocket, sure."},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","line":470,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why do we ignore the return value?"},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","line":470,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Don\u0027t want to speak for jbk, but my presumption would be some combination of \"we don\u0027t care that much if it fails\" and \"it\u0027s very unlikely to fail\". In fact for the attr variants, we are definitely not going to fail.\n\nIf you feel strongly I can go and belt \u0026 braces all these points (except bhyve which I\u0027d rather leave as upstream has)."},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","line":470,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Ultimately it\u0027s probably fine. While I wish the surrounding code was more rigid, it\u0027s probably not worth differentiating this call versus the rest of it."},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","line":470,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Yeah -- the thought was if the current code doesn\u0027t care if it was successful in setting the detached state (arguably more important than the thread name), not much sense in worrying if the thread name setting is successful or not."},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","line":541,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there any particular reason we ignore the return value?"},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","line":44,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why the new bracketing of this on _KERNEL?"},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","line":44,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Now we call thread_getdesc(), which is only built for kernel targets (mdb_proc.c has its own stack printer). Will comment."},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","line":105,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Missing endif annotation."},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","line":105,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","line":624,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Using both NIL and NUL in this comment."},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","line":624,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Ugh, the NILs are all mine, dunno where that came from. Will fix."},{"file":"usr/src/cmd/prstat/prstat.c","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Since you mentioned that this was all changing, I\u0027m going to come back to this in a future revision."},{"file":"usr/src/cmd/prstat/prstat.c","line":0,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Well, that depends on your and Jason\u0027s opinion of the prstat change I suggested in the RFD?"},{"file":"usr/src/cmd/prstat/prstat.c","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I realized I forgot to post there that I liked the suggestion versus the new column."},{"file":"usr/src/cmd/ps/ps.c","line":1786,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Do we need to sanitize this name at all?"},{"file":"usr/src/cmd/ptools/pstack/pstack.c","line":517,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Do we need to escape this like we do other information in things like pargs?"},{"file":"usr/src/cmd/ptools/pstack/pstack.c","line":517,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"My inclination here is to effectively check for isprint() across the buffer at set time. But that\u0027s technically incompatible with Linux, which imposes no restrictions on comm contents at all. Opinions?\n\nIf we do any escaping at all, I\u0027d be inclined to just replace any !isprint() with \u0027?\u0027 rather than attempt to handle wchars or anything."},{"file":"usr/src/cmd/ptools/pstack/pstack.c","line":517,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I feel like transforming it at set time will make life a lot easier for all consumers, but I do worry about the loss of information and compat that you mention. Maybe we should just make the consumers more paranoid and do the transformation at the expense of more code? Even folks like OpenBSD don\u0027t seem to care, though for them it\u0027s just a libc thing it seems."},{"file":"usr/src/lib/libc/port/mapfile-vers","line":80,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"We cannot add new libc symbol versions directly in illumos-joyent. This must go into a private version and then be moved to a public version when we upstream it."},{"file":"usr/src/lib/libc/port/mapfile-vers","line":80,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":492,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we use the character constant?"},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":492,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"replaced with bzero()"},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":497,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, at this point if the user drove on and created the thread, they\u0027d have a truncated name buffer for the thread name. I expect no one actually checks the return values of this, given the examples so far in this change set. In the case of failure, should we be going through and rezeroing the array?\n\nWe should probably update the manual page in terms of what happens if this is invalid and at least have some kind of behavior or say it\u0027s undefined."},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":497,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Replaced this with an explicit strlen() check so we don\u0027t have this issue."},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":512,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Probably worth mentioning in the manual page that the contents of the buffer may be overwritten on ERANGE."},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","line":512,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2434,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I guess the assumption here is that this will always fit within PATH_MAX and there\u0027s no need to check for overflow?"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2434,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Yes"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2443,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"__close here can clobber errno. Please snapshot errno before calling close if you want it to be accurate at +2448.\n\nAlso, should we really continue if close returns an errno? If we get EBADF or similar, that would be rather unfortunate, etc."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2443,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"The situations in which code can meaningfully respond to an error from close() are very limited AFAIK, and none of them apply here. Realistically the only failure mode we\u0027d get is if another thread incorrectly closed our fd. The fact that so much existing code around this area is happy to ignore failures makes me happy enough to leave it as is.\n\nI\u0027ll preserve errno though."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2443,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, that\u0027s fine. I agree that usually the only thing we can do on close errors is to abort."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2446,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why is this being set to EFAULT in this case? What guarantees /proc won\u0027t perform a short I/O or EINTR, etc.?"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2446,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I don\u0027t think we\u0027ll ever do a short I/O ?\nI had the check the wrong way around for errno, indeed."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2446,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s true today that I don\u0027t think /proc won\u0027t perform that. I\u0027ll admit my paranoia is a bit strong and that leads me to always just want to think about those. I guess the theory for the EFAULT case is that if we were to fail for some reason it\u0027d have to be because the buffer failed?"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2446,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Yeah, it just doesn\u0027t seem like other scenarios are reasonable. If we didn\u0027t always ship libc and the kernel together, I\u0027d probably want to be much more paranoid."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2477,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Same notes on the clobbering of errno and return value above."},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2482,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Worth mentioning in the manual page that on failure contents of buf are undefined and may be clobbered?"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2482,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why are we assuming this is ERANGE? Wouldn\u0027t it only be ERANGE if n \u003e sizeof (name)?"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2482,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/lib/libc/port/threads/thr.c","line":2482,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/lib/libproc/common/libproc.h","line":439,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can you please write a Plwp_getname(3PROC) manual page for this. Don\u0027t forget to update libproc(3LIB) as well."},{"file":"usr/src/lib/libproc/common/libproc.h","line":439,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","line":45,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Are there restrictions on the character set used for name? Do we force it to be 7-bit ASCII, should callers expect it to be in any character set? What if we put terminal escape sequences in it?"},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","line":60,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"NUL?"},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","line":60,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man3c/pthread_getname_np.3c","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"NUL?"},{"file":"usr/src/man/man3c/pthread_getname_np.3c","line":54,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man3c/pthread_getname_np.3c","line":79,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think bits after the macro have to go on the next line, though maybe not the comma?"},{"file":"usr/src/man/man3c/pthread_getname_np.3c","line":79,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man3c/thr_getname.3c","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"NUL?"},{"file":"usr/src/man/man3c/thr_getname.3c","line":54,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man4/proc.4","line":1651,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This general design makes it sound like we can never change the size of THREAD_NAME_MAX. Perhaps we should make it clear to readers that they should expect this value to change over time (possibly increasing) and to adjust accordingly?"},{"file":"usr/src/man/man4/proc.4","line":1651,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/man/man4/proc.4","line":1655,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"NUL?"},{"file":"usr/src/man/man4/proc.4","line":1655,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/test/os-tests/tests/thread/Makefile","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, we already have a bunch of thread related tests sitting in lib/libc-tests/ for both C11 and pthread_attr_get_np. Can we consolidate these perhaps into the same loc? I don\u0027t care which moves."},{"file":"usr/src/test/os-tests/tests/thread/Makefile","line":0,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/uts/common/dtrace/dtrace.c","line":3550,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think it\u0027s worth a brief comment about the fact that once t_name exists, it will always be a valid pointer. That makes it safe to always dereference it once it exists and is non-NULL."},{"file":"usr/src/uts/common/dtrace/dtrace.c","line":3550,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2910,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Shouldn\u0027t we checking for residuary bytes here so we can properly error out if someone tries to write a larger name and return a proper error? Otherwise we\u0027ll be truncating whatever\u0027s written."},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2910,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2927,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Any reason we don\u0027t just use thread_setname() for this? Is the problem that we need to check for ZNO?"},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2927,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"At least that. I haven\u0027t worked out the other cases where prlock() is different to just taking -\u003ep_lock."},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2927,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK. That\u0027s fine. Maybe worth a brief comment saying we do it this way because we need the additional checking of prlock()."},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2927,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"},{"file":"usr/src/uts/common/sys/elf.h","line":1020,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Erm, isn\u0027t it actually a structure and not just this char array?"},{"file":"usr/src/uts/common/sys/elf.h","line":1020,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":186,"deletions":-57},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":41,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":36,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":44,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":81,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":21,"deletions":-10},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":102,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":120,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":120,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"usr/src/test/os-tests/tests/Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/test/os-tests/tests/thread/Makefile","type":"ADDED","insertions":48,"deletions":0},{"file":"usr/src/test/os-tests/tests/thread/thread_name.c","type":"ADDED","insertions":255,"deletions":0},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":21,"deletions":0},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":84,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":1799,"sizeDeletions":-326},{"number":"3","revision":"62cfe3221fecbe97fae402491909992aa3dbb598","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/3","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1535725113,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2918,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is VERIFY3B right here? Why are we casting a char (lwpname[THREAD_NAME_MAX-1] to a boolean_t?"},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2918,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":186,"deletions":-57},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":41,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":36,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":47,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":103,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":123,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":123,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":255,"deletions":0},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":21,"deletions":0},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":90,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":1918,"sizeDeletions":-366},{"number":"4","revision":"669f81365d7122389dbf5a02f4578b98d222b3ad","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/4","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1535754573,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":88,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":36,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":1917,"sizeDeletions":-373},{"number":"5","revision":"28b359cd8ec36ab0fa05d17ce73661cdb6827a83","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/5","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1535886657,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/cmd/prstat/prstat.c","line":417,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Shouldn\u0027t this be initialized to opts.o_cols? It seems like we\u0027re trying to set it to a value such that when we hit the default case and there is no setting of n down below (which honestly seems circumspect), that we end up printing zero columns in the printf at +467. In that case, shouldn\u0027t we set it to the length that we\u0027re subtracting from? Also, this may fit better logically as a default statement to make it clearer to the user that it\u0027s meant to be overriden below. But that doesn\u0027t really matter."},{"file":"usr/src/cmd/prstat/prstat.c","line":920,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The current design allows this to be a possible non-null terminated buffer by construction. Currently reading from lwpname does not guarantee a nul terminator if the buffer is less than the size of lwpname. That would then lead the caller of this to end up off the edge of the cliff. Because this is taking a bufsize as an argument, I believe we need to own making sure we don\u0027t return with an incorrect buffer and not just assume the caller has sized it correctly."},{"file":"usr/src/cmd/ps/ps.c","line":1777,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"If for some reason THREAD_NAME_MAX is ever insufficiently sized, this will create a buffer overflow because nothing guarantees that lwpname will be null terminated due to the /proc impl."},{"file":"usr/src/uts/common/fs/proc/prvnops.c","line":2914,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Explicit comparison preferred."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":88,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":36,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":1921,"sizeDeletions":-376},{"number":"6","revision":"39ee75c73e2cd261555a9fc30797df5e7c964d97","parents":["57b471aeb372d625bad5f7340300b0d5f2d7d7f7"],"ref":"refs/changes/60/4760/6","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536158475,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378},{"number":"7","revision":"7b7c663f922a929373f2955520f46dfa8b7ab5b9","parents":["93e19c9346ce9d27b339cc14132d82b2e8a668e4"],"ref":"refs/changes/60/4760/7","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536242303,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378},{"number":"8","revision":"b5e88b86135ca5f438ae5c274bce6375d788ba0a","parents":["93e19c9346ce9d27b339cc14132d82b2e8a668e4"],"ref":"refs/changes/60/4760/8","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536246888,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536602698,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378},{"number":"9","revision":"cbb3bef02017a9ab77b89506f9ced6c9546074ea","parents":["93e19c9346ce9d27b339cc14132d82b2e8a668e4"],"ref":"refs/changes/60/4760/9","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536604712,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536602698,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378},{"number":"10","revision":"e639e7fb5bc8e8f25f3c1ea960c37baf9fcd5f3f","parents":["bf3893188b13fb85ead1f29fc911e443b816ffb5"],"ref":"refs/changes/60/4760/10","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1536604767,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536172717,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536602698,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536174843,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"SUBM","value":"1","grantedOn":1536605027,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/cmd/bhyve/rfb.c","type":"MODIFIED","insertions":0,"deletions":-7},{"file":"usr/src/cmd/cmd-inet/lib/ipmgmtd/ipmgmt_persist.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/dtrace/test/tst/common/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.c","type":"ADDED","insertions":99,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/threadname/tst.threadname.d","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_change.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_discovery.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/ldapcachemgr/cachemgr_getldap.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/mdb/common/mdb/mdb_proc.c","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"usr/src/cmd/mdb/common/modules/genunix/findstack.c","type":"MODIFIED","insertions":20,"deletions":-8},{"file":"usr/src/cmd/mdb/common/modules/genunix/genunix.c","type":"MODIFIED","insertions":8,"deletions":-10},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.c","type":"MODIFIED","insertions":118,"deletions":-118},{"file":"usr/src/cmd/mdb/common/modules/genunix/thread.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/cmd/nscd/cache.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/cmd/nscd/nscd_frontend.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/cmd/nscd/nscd_getentctx.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/cmd/nscd/nscd_selfcred.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/nscd/nscd_smfmonitor.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/prstat/Makefile.com","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/prstat/prstat.c","type":"MODIFIED","insertions":89,"deletions":-51},{"file":"usr/src/cmd/prstat/prstat.h","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/prstat/prutil.c","type":"MODIFIED","insertions":73,"deletions":-3},{"file":"usr/src/cmd/prstat/prutil.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/ps/ps.c","type":"MODIFIED","insertions":37,"deletions":-12},{"file":"usr/src/cmd/ptools/pstack/pstack.c","type":"MODIFIED","insertions":51,"deletions":-15},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":19,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/elfdump.msg","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_layout_obj.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/gen_struct_layout.c","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout.h","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_amd64.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_i386.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparc.c","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/cmd/sgs/elfdump/common/struct_layout_sparcv9.c","type":"MODIFIED","insertions":11,"deletions":0},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/svc/startd/graph.c","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/cmd/svc/startd/method.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/svc/startd/restarter.c","type":"MODIFIED","insertions":13,"deletions":-3},{"file":"usr/src/cmd/svc/startd/wait.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/compat/freebsd/pthread_np.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/head/pthread.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/head/thread.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/lib/libc/inc/thr_uberdata.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libc/port/mapfile-vers","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/lib/libc/port/threads/pthr_attr.c","type":"MODIFIED","insertions":56,"deletions":-5},{"file":"usr/src/lib/libc/port/threads/pthread.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/threads/thr.c","type":"MODIFIED","insertions":85,"deletions":-3},{"file":"usr/src/lib/libdtrace/common/dt_open.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/lib/libfakekernel/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libproc/common/Pcontrol.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/lib/libproc/common/Pcore.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/lib/libproc/common/Pgcore.c","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/lib/libproc/common/Plwpregs.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libproc/common/libproc.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libproc/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/man/man1/ps.1","type":"MODIFIED","insertions":22,"deletions":-11},{"file":"usr/src/man/man1m/prstat.1m","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/man/man3c/Makefile","type":"MODIFIED","insertions":12,"deletions":0},{"file":"usr/src/man/man3c/pthread_attr_getname_np.3c","type":"ADDED","insertions":105,"deletions":0},{"file":"usr/src/man/man3c/pthread_getname_np.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3c/thr_getname.3c","type":"ADDED","insertions":124,"deletions":0},{"file":"usr/src/man/man3lib/libproc.3lib","type":"MODIFIED","insertions":30,"deletions":-30},{"file":"usr/src/man/man3proc/Makefile","type":"MODIFIED","insertions":8,"deletions":-7},{"file":"usr/src/man/man3proc/Plwp_getname.3proc","type":"ADDED","insertions":94,"deletions":0},{"file":"usr/src/man/man4/proc.4","type":"MODIFIED","insertions":17,"deletions":-3},{"file":"usr/src/pkg/manifests/system-dtrace-tests.mf","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3c.inc","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/pkg/manifests/system-library.man3proc.inc","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-libctest.mf","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/pkg/manifests/system-test-ostest.mf","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"usr/src/test/libc-tests/tests/threads/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/libc-tests/tests/threads/thread_name.c","type":"ADDED","insertions":278,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_prctl.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/disp/thread.c","type":"MODIFIED","insertions":28,"deletions":-1},{"file":"usr/src/uts/common/dtrace/dtrace.c","type":"MODIFIED","insertions":22,"deletions":-3},{"file":"usr/src/uts/common/exec/elf/elf_notes.c","type":"MODIFIED","insertions":17,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prdata.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/proc/prvnops.c","type":"MODIFIED","insertions":99,"deletions":-12},{"file":"usr/src/uts/common/sys/dtrace.h","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/common/sys/elf.h","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"usr/src/uts/common/sys/procfs.h","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/uts/common/sys/thread.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":2055,"sizeDeletions":-378}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}]}