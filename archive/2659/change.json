{"project":"joyent/moray","branch":"master","id":"Ica2d98812a35f9213b224de4c2d4ff55d6c9b5bd","number":"2659","subject":"MORAY-421 Moray could expose metrics Reviewed by: David Pacheco \u003cdap@joyent.com\u003e Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"url":"https://cr.joyent.us/2659","commitMessage":"MORAY-421 Moray could expose metrics\nReviewed by: David Pacheco \u003cdap@joyent.com\u003e\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1506528435,"lastUpdated":1507561101,"open":false,"status":"MERGED","comments":[{"timestamp":1506528435,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 1."},{"timestamp":1506528462,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506529439,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\n(1 comment)\n\nFeel free to take a look at the code. This depends on a node-artedi CR, and a node-fast CR, which are both out for review. I\u0027ll update the package.json when those are finished."},{"timestamp":1506537177,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(7 comments)"},{"timestamp":1506537397,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1506543750,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\n(2 comments)\n\nThanks, Cody. I\u0027ll start on these changes."},{"timestamp":1506621670,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1506720543,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 2."},{"timestamp":1506720570,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506723117,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\n(11 comments)"},{"timestamp":1506978058,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 3."},{"timestamp":1506978096,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506978160,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3:\n\nPS3 was a non-trivial rebase. The rebase was non-trivial because there was a previous change to the package.json file. This patch set also points to the new node-artedi version."},{"timestamp":1507049922,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(1 comment)\n\nI haven\u0027t wrapped my head around the change to `createPool` in lib/pg.js, but the rest looks good."},{"timestamp":1507053729,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 4."},{"timestamp":1507053765,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507056970,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1507068808,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1507233067,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1507233131,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 5."},{"timestamp":1507233155,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1507233168,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507233424,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1507236507,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1507239655,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1507315149,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 6."},{"timestamp":1507315190,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507315359,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 6:\n\nI addressed the bug that Cody brought up where we could leak trigger functions after a manatee flip event (because PGPool objects are recreated).\n\nThe gist of it is that the trigger function is created in the manatee.js and standalone.js functions, which will call a helper pg.js function to record pool information. I tested this by triggering a manatee flip. The details are in the MORAY ticket."},{"timestamp":1507322684,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1507327591,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1507560986,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 7: Commit message was updated."},{"timestamp":1507561101,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kody A Kantor"}],"currentPatchSet":{"number":"7","revision":"ca2d98812a35f9213b224de4c2d4ff55d6c9b5bd","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/7","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507560986,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507315190,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507322684,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1507561101,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":18,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":226,"sizeDeletions":-35},"patchSets":[{"number":"1","revision":"a634ed7d848a1048e62288f4a66eb9009ec52bb7","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/59/2659/1","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506528435,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506528462,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"README.md","line":199,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Needs rewrap."},{"file":"README.md","line":199,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"README.md","line":205,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This section should also mention the `kang` command-line tool, and mention that it\u0027s available inside the Moray zone. You can use it with something like:\n\n    $ kang -h localhost:3021,localhost:3022,localhost:3023,localhost:3024"},{"file":"README.md","line":205,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"README.md","line":229,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"s/postgres/Postgres/ here and below"},{"file":"README.md","line":229,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"README.md","line":234,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"These are the changes made to fast, right? In that case, it looks like they\u0027ll be available regardless of whether we\u0027re in Manatee or standalone mode, so they can probably just be part of the list above."},{"file":"README.md","line":234,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Great! I thought I noticed they weren\u0027t there when I ran the moray-test-suite, but I must have been mistaken, or not using the new version of Fast. I\u0027ll test that again."},{"file":"README.md","line":234,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Yes, these are included when you run it in standalone mode. I must have been missed it or had the fast server misconfigured when I ran it initially."},{"file":"etc/config.coal.json","line":0,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I\u0027m not sure what these etc/ config files are used for, or if they were deprecated at some point."},{"file":"etc/config.coal.json","line":30,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I believe these are probably just templates for developers to use.  (I would love to remove them in favor of a config-agent tool for generating a config from the real template.)\n\nI think we may want to change these to fake identifiers instead of uuids."},{"file":"etc/config.coal.json","line":30,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Sounds good. I just put in some strings. Let me know if you had something else in mind."},{"file":"etc/config.coal.json","line":30,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I would make it clearer that you\u0027re supposed to change it so that if people miss it, it\u0027s somewhat obvious.  Maybe `fake-coal-server-uuid`?"},{"file":"lib/pg.js","line":571,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Does this artedi interface support this being asynchronous?  In that case, I think it might be better to wrap this with a setImmediate."},{"file":"lib/pg.js","line":571,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done. The artedi interface does support trigger functions being async. That code is in CR right now."},{"file":"lib/pg.js","line":707,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Did you run into a problem with the code that was here before?\n\njsprim.deepCopy() won\u0027t work correctly here, since the options object contains a bunyan Logger object, and jsprim.deepCopy() will lose that aspect of the object during the copy. The artedi Collector will have the same problem. (See joyent/node-jsprim#25.) If you keep the delete logic from before and extend it to the \"collector\" field then it should be fine.\n\nThere doesn\u0027t seem to be a real reason to do a deep copy of the options object, though, since the two consumers of this function always pass in a new object just for it. I\u0027d be fine removing the copy logic here entirely. (I\u0027m pretty sure  we don\u0027t want do a deep copy of the Logger and Collector, anyways.)"},{"file":"lib/pg.js","line":707,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Sorry, I\u0027d forgotten the details of the ticket. The problem isn\u0027t that they lose their prototype, but that they don\u0027t actually get copied. So this would work fine, but it\u0027d be working due to surprising behaviour. I think we should just remove copying the object entirely."},{"file":"lib/pg.js","line":707,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I\u0027ll test this out without the copy logic. I really didn\u0027t want to continue the copy/delete/copy behavior, but I can do that if removing the logic won\u0027t work."},{"file":"lib/pg.js","line":707,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"This seems to work without the copy logic as well! Thanks for offering that suggestion. It makes me feel a little weird not making a copy of the object, but I think that\u0027s better than the weird copy logic it had before. This may all change when we get the cueball stuff in anyway."},{"file":"lib/server.js","line":67,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I think we can use mod_os.hostname() instead of adding a new field to the configuration. (We already call it below for setting up Kang.)"},{"file":"lib/server.js","line":67,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"lib/server.js","line":173,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I have the same question about whether this leaks for large requests as I did for node-fast (with the same priority, which is to say it\u0027s likely not that big a deal, but I think it\u0027s worth handling if it\u0027s easy)."},{"file":"lib/server.js","line":173,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I did the same thing that I did in the node-fast CR for this. Let me know if that\u0027s not what you had in mind (in either CR). It seems to fix the issue for me."},{"file":"lib/server.js","line":180,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"nit: please move these lines back 4 spaces, so that they\u0027re indented from the \"this\" and not the \"function\"."},{"file":"lib/server.js","line":180,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"lib/server.js","line":187,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"same as above"},{"file":"lib/server.js","line":187,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":54,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":46,"deletions":-7},{"file":"lib/server.js","type":"MODIFIED","insertions":56,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":4,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-33},{"number":"2","revision":"85faa801ed10680be6b99cc4fe42d399076c9b26","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/59/2659/2","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506720543,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506720570,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":47,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-35},{"number":"3","revision":"e8df254aa7f9333e3c108ec9bb5f7d91656451ad","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/3","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506978058,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506978096,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":47,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-35},{"number":"4","revision":"f2fd5e516b70639968c3dac79f212a2c7a7c2a31","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/4","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507053729,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507056970,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507068808,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507053765,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"package.json","line":18,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"This needs updating once node-fast is published."},{"file":"package.json","line":18,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done. Sorry, I forgot to push the latest change to gerrit. Thanks for pointing this out."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":47,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-35},{"number":"5","revision":"a9b919de96b791df0797604fb8f1e8de376fd64f","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/5","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507233131,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507233424,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507239655,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507236507,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507233168,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":47,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":208,"sizeDeletions":-35},{"number":"6","revision":"c4cc88b5fbd391ad1c9779eda2ad75895b4bf273","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/6","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507315149,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507322684,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507315190,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":18,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":226,"sizeDeletions":-35},{"number":"7","revision":"ca2d98812a35f9213b224de4c2d4ff55d6c9b5bd","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/59/2659/7","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507560986,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507322684,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507327591,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507315190,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1507561101,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"etc/config.coal.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.coal.manta.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.lab.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.local.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"etc/config.standalone.json","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/manatee.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":-9},{"file":"lib/server.js","type":"MODIFIED","insertions":59,"deletions":-12},{"file":"lib/standalone.js","type":"MODIFIED","insertions":18,"deletions":-2},{"file":"main.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":226,"sizeDeletions":-35}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}]}