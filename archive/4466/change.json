{"project":"joyent/sdc-net-agent","branch":"master","topic":"RFD 28","id":"Ia7ec38be08277088970309011b214b519cf6a555","number":"4466","subject":"TRITON-389 net-agent should subscribe to NAPI changefeed Reviewed by: Jason King \u003cjason.king@joyent.com\u003e Approved by: Jason King \u003cjason.king@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/4466","commitMessage":"TRITON-389 net-agent should subscribe to NAPI changefeed\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nApproved by: Jason King \u003cjason.king@joyent.com\u003e\n","createdOn":1530556080,"lastUpdated":1559153030,"open":false,"status":"MERGED","comments":[{"timestamp":1530556080,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1530556122,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Topic set to RFD 28"},{"timestamp":1530562224,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1531499942,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1557361668,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1557361831,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1557440225,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1558045867,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1559085516,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1559085548,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1559085556,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1559085589,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1559086154,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1559152819,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1559152899,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1559153030,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"5","revision":"5d848e0473d265caa4f0d30d1adce89234c47c9a","parents":["b5b4d6003a945ea46e7c9e299243a45df6d7776e"],"ref":"refs/changes/66/4466/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1559152899,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559085589,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559086154,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559152819,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"SUBM","value":"1","grantedOn":1559153030,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":185,"deletions":-1},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"41044f8ce6e8aadc458d99bb7794723e8c08b836","parents":["c38ec6078b3bf2a5d151d1b61b2efa21615a7a06"],"ref":"refs/changes/66/4466/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1530556080,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1531499942,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530562224,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":178,"deletions":-2},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":182,"sizeDeletions":-5},{"number":"2","revision":"5a3eda78668bae1ac2520d51d6f7225dcf1fc114","parents":["9a95f6e773fa61614678a5d92f3455a0fb65a666"],"ref":"refs/changes/66/4466/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1557361668,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557361831,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/net-agent.js","line":457,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"What\u0027s the impact of not implementing this?  Does it just generate some unnecessary log entries, or otherwise cause any problems?"},{"file":"lib/net-agent.js","line":457,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"The impact is that it will need to do an extra HTTP request to get the 404."},{"file":"lib/net-agent.js","line":457,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"It\u0027ll need to do an extra HTTP request to get the 404. I realized that the previous .releaseAggr() call wasn\u0027t right here, since it hasn\u0027t been released locally, but removed remotely from NAPI."},{"file":"lib/net-agent.js","line":496,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Same as above."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":185,"deletions":-1},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":189,"sizeDeletions":-4},{"number":"3","revision":"1cf317305408854db0ecb62d56058d460f434c81","parents":["b5b4d6003a945ea46e7c9e299243a45df6d7776e"],"ref":"refs/changes/66/4466/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1559085516,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557361831,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":185,"deletions":-1},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":189,"sizeDeletions":-4},{"number":"4","revision":"a7ec38be08277088970309011b214b519cf6a555","parents":["b5b4d6003a945ea46e7c9e299243a45df6d7776e"],"ref":"refs/changes/66/4466/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1559085548,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559085589,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559086154,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559152819,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":185,"deletions":-1},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-5},{"number":"5","revision":"5d848e0473d265caa4f0d30d1adce89234c47c9a","parents":["b5b4d6003a945ea46e7c9e299243a45df6d7776e"],"ref":"refs/changes/66/4466/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1559152899,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1559153030,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559085589,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559086154,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559152819,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/aggr-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":185,"deletions":-1},{"file":"lib/net-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/nic-fsm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-5}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}