{"project":"joyent/moray","branch":"master","topic":"MORAY-428","id":"I7594ea98bba375e1e68d63422d49e7bd2f1fff38","number":"2651","subject":"MORAY-428 Make it safer to use reindexing buckets Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e Approved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/2651","commitMessage":"MORAY-428 Make it safer to use reindexing buckets\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\nApproved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n","createdOn":1506374419,"lastUpdated":1507784997,"open":false,"status":"MERGED","comments":[{"timestamp":1506374419,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1506374429,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Topic set to MORAY-428"},{"timestamp":1506374450,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506375062,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1506390236,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1506390272,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506542375,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1506724400,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(12 comments)"},{"timestamp":1506984720,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1506984762,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506984768,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(6 comments)"},{"timestamp":1506987604,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1506989666,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1506989693,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507152921,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1507588782,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1507588811,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1507588814,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507594479,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1507594507,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1507596137,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 7."},{"timestamp":1507596164,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507596331,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\nPS7 adds a change that Julien and I discussed. Initially, I was going to make \"requireOnlineReindexing\" and \"requireIndexes\" orthogonal, but, after talking with Julien, we decided that the weird behaviour surrounding searching on unindexed and reindexing fields is undesirable enough that the \"requireOnlineReindexing\" option should also prevent it, since it\u0027s meant to imply a certain level of safety and correctness."},{"timestamp":1507750186,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1507750310,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7: -Integration-Approval\n\nSomething I failed to mention during my previous review: what about versioning? I\u0027m not sure if/how the version number in package.json is used, but should we bump it\u0027s minor version number?"},{"timestamp":1507752599,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1507755431,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1507755453,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 9."},{"timestamp":1507755468,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"},{"timestamp":1507755479,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507755523,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 10: Commit message was updated."},{"timestamp":1507755527,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 9: Code-Review+1 Integration-Approval+1"},{"timestamp":1507755568,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 10: Code-Review+1 Integration-Approval+1"},{"timestamp":1507784997,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"10","revision":"7594ea98bba375e1e68d63422d49e7bd2f1fff38","parents":["3e9f411275c50bb25ef8108c64d39d9c11ee2f74"],"ref":"refs/changes/51/2651/10","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507755523,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507755479,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507755568,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507755568,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"SUBM","value":"1","grantedOn":1507784997,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":325,"sizeDeletions":-118},"patchSets":[{"number":"1","revision":"8a8c65dbe4e44f1e51fef75ab66414367d158ddd","parents":["813236226d925a144b22d90c4f9156e4f92076e8"],"ref":"refs/changes/51/2651/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506374419,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506374450,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":495,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I chose not to mention \"noCache\" here, since we decided to drop mention of it in MORAY-382."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":17,"deletions":-5},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":37,"deletions":-2},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":126,"sizeDeletions":-20},{"number":"2","revision":"4dd94cabef8c29c6a19cc70763d74c63e7f9ce89","parents":["813236226d925a144b22d90c4f9156e4f92076e8"],"ref":"refs/changes/51/2651/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506390236,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506390272,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":500,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"There seems to be inconsistency in how this file lists options. I like how we\u0027re linking to the documentation for these options. Would it make sense to add a \u0027common options\u0027 section, and have each of the CLI command link to the appropriate options for their command?"},{"file":"docs/index.md","line":500,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve moved the common options up to the top, and then linked to them throughout the RPC descriptions."},{"file":"docs/index.md","line":631,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit and thinking out loud: maybe that\u0027s already clear enough, or should we mention that \"The default is false\"?"},{"file":"docs/index.md","line":631,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve updated the text: https://cr.joyent.us/#/c/2651/3/docs/index.md@145"},{"file":"lib/objects/common.js","line":871,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: do we want to assert on the type of \"bucket\"?"},{"file":"lib/objects/common.js","line":871,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/objects/common.js","line":876,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I\u0027m slightly confused by what\u0027s happening here. Is this loop equivalent to \u0027ignore \u003d Object.keys(bucket.reindex_active)\u0027 ?"},{"file":"lib/objects/common.js","line":876,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Kody: the structure of the \"reindex_active\" property is:\n\n{ 1: [\u0027some-field\u0027, some-other-field\u0027, 2: [\u0027yet-another-field\u0027] } \n\nso running:\n\nignore \u003d Object.keys(bucket.reindex_active);\n\nwould yield:\n\nignore \u003d\u003d\u003d [1, 2]\n\nwhen we want:\n\nignore \u003d\u003d\u003d [\u0027some-field\u0027, \u0027some-other-field\u0027, \u0027yet-another-field\u0027]"},{"file":"lib/objects/common.js","line":1076,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Nice! Thanks for cleaning that up :)"},{"file":"lib/objects/common.js","line":1137,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: do we want to assert on the type of \"req\" and \"cb\"?"},{"file":"lib/objects/common.js","line":1137,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/objects/del_many.js","line":32,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Don\u0027t we want to run that check only when the \"onlineReindexing\" option is used for backward compatibility, or at least send the set of \"handled options\" so that clients can make sure that they get the guarantees they expect?"},{"file":"lib/objects/del_many.js","line":32,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"We don\u0027t need an option here, since we want to prevent people from doing anything with unindexed or reindexing fields here, since it will definitely be wrong, and result in surprising results. (Objects that survive the deleteMany() call, objects that never get updated, etc.)\n\nI\u0027m not sure if there\u0027s much benefit to sending the handled options in this RPC, since the client won\u0027t be able to stop the effects of the RPC after making the initial request."},{"file":"lib/objects/find.js","line":208,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Do we want to do that only when the \"onlineReindexing\" option is set to true for backward compatibility?"},{"file":"lib/objects/find.js","line":208,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"No, we\u0027d like this to be the new behaviour going forward. \n\nThe only way someone could be broken by this change is if they intentionally never called reindexObjects(), and expected it to drop things. Anyone who calls reindexObjects() to completion before doing anything else won\u0027t be affected. Anyone not waiting on reindexObjects() before servicing requests but doing it concurrently instead will get objects returned to them as if the object had already been reindexed by a previous call.\n\nThe only service I\u0027m uncertain of is UFDS, which currently never calls reindexObjects(), but could potentially update its bucket if you move from an image with the old schema, to one with the latest 2014 schema. I talked to Patrick, and it sounds like UFDS\u0027s data in west-1 is in a state where you can\u0027t successfully call reindexObjects() anymore. I\u0027m going to take a further look into that.\n\nPAPI seems to have never reindexed its buckets, but looking at its code, it isn\u0027t relying on the current Moray behaviour, since it hasn\u0027t inserted unindexed values into the database and then later tried to index them. I looked at the staging DCs to see if there was possibly anyone else:\n\n    [root@daaf9577-cf38-4a3d-ae9c-3b2764e21851 (staging-3:moray1) ~]# listbuckets | json -ga -c \u0027typeof (reindex_active) !\u003d\u003d \"undefined\" \u0026\u0026 Object.keys(reindex_active) \u003e 0\u0027 name\n    sdc_packages\n\nThere were none in the Manta Moray zones, and the other staging DCs matched up with the above staging-3 output. I\u0027ve filed PAPI-143 for fixing that.\n\nEveryone else who makes schema modifications at least reindexes concurrently (Marlin, Docker, FWAPI, NAPI, and VMAPI). There are a number of other services who only have one version of their bucket, or who don\u0027t use versioned services."},{"file":"lib/objects/get.js","line":80,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is this something we can factor out to a shared module in this repo? Or maybe factoring it out wouldn\u0027t save that much duplication?"},{"file":"lib/objects/get.js","line":129,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Same question as before: do we want to do that _only_ when onlineReindexing is set to true for backward compat?"},{"file":"lib/objects/reindex.js","line":137,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Nice!"},{"file":"lib/objects/update.js","line":85,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Same question about doing this only when onlineReindexing is true."},{"file":"lib/schema.js","line":206,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Nice and thanks! I wasn\u0027t aware of that schema :)"},{"file":"lib/schema.js","line":206,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"No problem! This schema didn\u0027t exist when \"requireIndexes\" went in, but I had started this work beforehand, and forgot to update it before integration."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":17,"deletions":-5},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":38,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":127,"sizeDeletions":-30},{"number":"3","revision":"ce95d6cbdc3ea416f6748ab5d9f2e5e252665a1e","parents":["76c9924d3d2ffba3b743377039428bfdf41e7208"],"ref":"refs/changes/51/2651/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506984720,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506984762,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":200,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":320,"sizeDeletions":-116},{"number":"4","revision":"fb5bdfa5d27f84d183287038ce492c3a7661c3c8","parents":["76c9924d3d2ffba3b743377039428bfdf41e7208"],"ref":"refs/changes/51/2651/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506989666,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506989693,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/objects/common.js","line":893,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"assert.arrayOfString?"},{"file":"lib/objects/common.js","line":893,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/objects/common.js","line":1153,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/uses/references/ ?"},{"file":"lib/objects/common.js","line":1153,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":321,"sizeDeletions":-116},{"number":"5","revision":"563188bbefe3ee65bfff6f94375118168ee91976","parents":["42a5581051507d73236d6868d5f7ff8170fcd9d4"],"ref":"refs/changes/51/2651/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507588782,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507588814,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":321,"sizeDeletions":-116},{"number":"6","revision":"726a3c39557f40c62a9bac33ac8bb57d4bb3d1d8","parents":["89d18606da8cad0b03023f020d5e113e9bc4561b"],"ref":"refs/changes/51/2651/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507594479,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507588814,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":321,"sizeDeletions":-116},{"number":"7","revision":"64fbf0fed16be4d660beb649692f622c15c46c6d","parents":["89d18606da8cad0b03023f020d5e113e9bc4561b"],"ref":"refs/changes/51/2651/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507596137,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507596164,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507752599,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507750186,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"comments":[{"file":"lib/schema.js","line":167,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: should this mention that it implies \"requireIndexes\" for findObjects requests? It\u0027s already in the documentation, so here may not be a good place to have that much detail."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":324,"sizeDeletions":-117},{"number":"8","revision":"a2beee43c70606271d76a863e986a04ae6240a61","parents":["3e9f411275c50bb25ef8108c64d39d9c11ee2f74"],"ref":"refs/changes/51/2651/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507755431,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507596164,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507752599,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507750186,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":324,"sizeDeletions":-117},{"number":"9","revision":"45ad25dba29b15a03a07fa85d55b28a279508113","parents":["3e9f411275c50bb25ef8108c64d39d9c11ee2f74"],"ref":"refs/changes/51/2651/9","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507755453,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507755479,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507755527,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507755527,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":325,"sizeDeletions":-118},{"number":"10","revision":"7594ea98bba375e1e68d63422d49e7bd2f1fff38","parents":["3e9f411275c50bb25ef8108c64d39d9c11ee2f74"],"ref":"refs/changes/51/2651/10","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507755523,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1507784997,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507755479,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507755568,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507755568,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":325,"sizeDeletions":-118}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}