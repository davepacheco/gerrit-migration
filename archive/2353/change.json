{"project":"joyent/smartos-live","branch":"master","id":"Icf724feb7e804b55266b0d298598a4d28d0fd090","number":"2353","subject":"OS-6336 vmadm should check for VNC port conflicts Reviewed by: Dave Eddy \u003cdave@daveeddy.com\u003e Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: Dave Eddy \u003cdave@daveeddy.com\u003e","owner":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"url":"https://cr.joyent.us/2353","commitMessage":"OS-6336 vmadm should check for VNC port conflicts\nReviewed by: Dave Eddy \u003cdave@daveeddy.com\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Dave Eddy \u003cdave@daveeddy.com\u003e\n","createdOn":1502277334,"lastUpdated":1505753388,"open":false,"status":"MERGED","comments":[{"timestamp":1502277334,"reviewer":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"message":"Uploaded patch set 1."},{"timestamp":1502277367,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n (for file in filewait.js node_modules/{system,onlyif,net-boot-config}.js net-boot-config vm/sbin/*.js vm/node_modules/dladm.js vm/node_modules/expander.js vm/node_modules/ip.js vm/node_modules/nic.js vm/node_modules/proptable.js vm/node_modules/utils.js vm/node_modules/VM.js vm/node_modules/qmp.js vm/node_modules/openonerrlogger.js vm/node_modules/vmload/*.js vm/node_modules/sysevent-stream.js img/lib/*.js img/sbin/imgadm vm/common/nictag.js vm/tests/test-alias.js vm/tests/test-cleanup-on-failure.js vm/tests/test-create.js vm/tests/test-create-filesystems.js vm/tests/test-docker.js vm/tests/test-defaults.js vm/tests/test-indestructible.js vm/tests/test-internal_metadata_namespaces.js vm/tests/test-lastexited.js vm/tests/test-openonerrlogger.js vm/tests/test-reboot.js vm/tests/test-reprovision.js vm/tests/test-snapshots.js vm/tests/test-spoof-opts.js vm/tests/test-tmpfs.js vm/tests/test-update.js vm/tests/test-vrrp-nics.js vm/lib/metadata/*.js; do \\\n \techo /tmp/repo/src/$file; \\\n \t/tmp/repo/src/../tools/jsstyle/jsstyle -o indent\u003d4,strict-indent\u003d1,doxygen,unparenthesized-return\u003d0,continuation-at-front\u003d1,leading-right-paren-ok\u003d1 $file; \\\n \t[[ $? \u003d\u003d \"0\" ]] || exit 1; \\\n done)\n /tmp/repo/src/filewait.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/node_modules/system.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/node_modules/onlyif.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/node_modules/net-boot-config.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/net-boot-config\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/sbin/add-userscript.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/sbin/metadata.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/sbin/vmadm.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/sbin/vmadmd.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/sbin/vmdf.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/dladm.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/expander.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/ip.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/nic.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/proptable.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/utils.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n /tmp/repo/src/vm/node_modules/VM.js\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at /tmp/repo/src/../tools/jsstyle/jsstyle line 644.\n vm/node_modules/VM.js: 1683: indent is 19 not a multiple of 4 spaces\n vm/node_modules/VM.js: 1754: indent is 10 not a multiple of 4 spaces\n vm/node_modules/VM.js: 1755: indent is 14 not a multiple of 4 spaces\n vm/node_modules/VM.js: 1756: indent is 10 not a multiple of 4 spaces\n vm/node_modules/VM.js: 5013: indent is 6 not a multiple of 4 spaces\n Makefile:429: recipe for target \u0027check\u0027 failed\n make[1]: *** [check] Error 1\n make[1]: Leaving directory \u0027/tmp/repo/src\u0027\n Makefile:356: recipe for target \u0027check\u0027 failed\n gmake: *** [check] Error 2"},{"timestamp":1502281134,"reviewer":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"message":"Uploaded patch set 2."},{"timestamp":1502281174,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1502697514,"reviewer":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1502697553,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1503070277,"reviewer":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"message":"Uploaded patch set 4."},{"timestamp":1503070317,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504715111,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4: Code-Review+1\n\nLGTM! I tested this change in COAL and it all works as expected. I ran the entire test suite with no failures."},{"timestamp":1504771810,"reviewer":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"message":"Uploaded patch set 5."},{"timestamp":1504771851,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504888126,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 6."},{"timestamp":1504888166,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505405657,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1505507700,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1505753025,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1505753141,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 7: Commit message was updated."},{"timestamp":1505753343,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1505753388,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"},{"timestamp":1505753388,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dave Eddy"}],"currentPatchSet":{"number":"8","revision":"faa8f38c6c58e2324583d187f8fb89981fba1216","parents":["4ae68c2fc2247b15f8f65b9ffec00257e7cdf4f8"],"ref":"refs/changes/53/2353/8","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1505753343,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504888166,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505405657,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505507700,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505753025,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1505753388,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"82191446d57fd2680c634ce343d81a3a88c6a829","parents":["f9431baafd69372698cd5ed87d377633064dafa1"],"ref":"refs/changes/53/2353/1","uploader":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"createdOn":1502277334,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1502277367,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"2","revision":"4f273289fa12026f5fa6922bad79b46a9dd82351","parents":["f9431baafd69372698cd5ed87d377633064dafa1"],"ref":"refs/changes/53/2353/2","uploader":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"createdOn":1502281134,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502281174,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"3","revision":"ea1b57edf4e86386f3fab40c1017844c8de35324","parents":["29100bc1e2e46593a3ea7956e2a51f008ed8f747"],"ref":"refs/changes/53/2353/3","uploader":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"createdOn":1502697514,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502281174,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"4","revision":"4ee51bdedeafd049c47c2b2967378db99e1e346e","parents":["ed7577cb855337d9a93e66fa0eb73eb604fe8f04"],"ref":"refs/changes/53/2353/4","uploader":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"createdOn":1503070277,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503070317,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504715111,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"5","revision":"e5298b15171aca2557fb8cb531b4f0bd04ac9bea","parents":["02903085fdcd37f35b712d4f2012eae108051838"],"ref":"refs/changes/53/2353/5","uploader":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"createdOn":1504771810,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504771851,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"6","revision":"7493a772b70e9a816c6aea197d2b1da3d44001ec","parents":["84d5cbd190a2601a5deea0758345b2bcdd583ebf"],"ref":"refs/changes/53/2353/6","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1504888126,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504888166,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505507700,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505405657,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505753025,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"7","revision":"cf724feb7e804b55266b0d298598a4d28d0fd090","parents":["84d5cbd190a2601a5deea0758345b2bcdd583ebf"],"ref":"refs/changes/53/2353/7","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1505753141,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504888166,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505507700,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505405657,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505753025,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6},{"number":"8","revision":"faa8f38c6c58e2324583d187f8fb89981fba1216","parents":["4ae68c2fc2247b15f8f65b9ffec00257e7cdf4f8"],"ref":"refs/changes/53/2353/8","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1505753343,"author":{"name":"Daniel Kontšek","email":"daniel@kontsek.sk","username":"dn0"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504888166,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505507700,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505405657,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505753025,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1505753388,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"src/vm/tests/test-net-conflicts.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-6}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}