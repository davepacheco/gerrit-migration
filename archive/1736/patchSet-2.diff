From 643b7d1046243a1040e956b72c1fe533c10efdab Mon Sep 17 00:00:00 2001
From: Kody Kantor <Kody.Kantor@gmail.com>
Date: Mon, 3 Apr 2017 16:26:33 -0500
Subject: [PATCH] MANTA-2980 electric-moray should report moray shard

---
 lib/moray.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/moray.js b/lib/moray.js
index 3790927..4b5c5e7 100644
--- a/lib/moray.js
+++ b/lib/moray.js
@@ -433,7 +433,7 @@ function put(options, cb) {
         headers: opts.headers
     }, 'Moray.' + op + ': entered');
 
-    client.putObject(bucket, key, md, opts, function (err) {
+    client.putObject(bucket, key, md, opts, function (err, data) {
         if (err) {
             log.debug({
                 err: err,
@@ -450,6 +450,9 @@ function put(options, cb) {
                 cb(err);
             }
         } else {
+            if (data) { // add the shard information
+                md._node = data._node;
+            }
             log.debug({
                 key: key,
                 requestId: opts.requestId
-- 
2.21.0

