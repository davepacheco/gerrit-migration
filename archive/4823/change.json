{"project":"joyent/illumos-joyent","branch":"master","id":"I4c14c4cff5adaaa79d7099e153c3ace3a0d65148","number":"4823","subject":"OS-7238 bhyve zones should add hostbridge device Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Reviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e Reviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e Approved by: Hans Rosenfeld \u003chans.rosenfeld@joyent.","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/4823","commitMessage":"OS-7238 bhyve zones should add hostbridge device\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nReviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e\nReviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\nApproved by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\n","createdOn":1536691504,"lastUpdated":1538682397,"open":false,"status":"MERGED","comments":[{"timestamp":1536691504,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1536741383,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1536743484,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1537806471,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1537806489,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1537889871,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3."},{"timestamp":1537889978,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\nRough draft on more expansive hostbridge configurability.  I still need to test the edge cases."},{"timestamp":1537891800,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 3: Code-Review+1\n\n(2 comments)"},{"timestamp":1537892873,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1538085593,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\nTest notes added to the ticket.  I haven\u0027t yet confirmed that openbsd is happy, due to OS-6836."},{"timestamp":1538112561,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 3:\n\nDon\u0027t let that hold up IA, I will try to do some testing with this included this weekend but might not have time."},{"timestamp":1538228509,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 3:\n\nI tested these bits with an freshly create OpenBSD VM because I could not figure out what I did to have my old one work. So here are the instruction and pcidump output.\n\nI was able to install OpenBSD 6.3 inside bhyve with this patch using the following config:\n- bootrom\u003duefi\n- bhyve_extra_opts\u003d-w\n- 1x cpu + 1G ram\n- 1x virtio nic\n- 2x virtio block device (1x OS, 1x for install63.fs)\n\nSet the 2nd disk to boot\u003dtrue, dd install63.fs to the disk, boot the vm, zlogin -C, \u0027set tty com0\u0027, follow instructions. Remove the 2nd disk and set disk0 to boot\u003dtrue.\n\n\n\n---\nobsd# pcidump  -v\nDomain /dev/pci0:\n 0:0:0: Intel 82441FX\n        0x0000: Vendor ID: 8086 Product ID: 1237\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 06 Subclass: 00 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 00 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR empty (00000000)\n        0x0014: BAR empty (00000000)\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 0000 Product ID: 0000\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 00 Line: ff Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x10: PCI Express\n                Link Speed: 2.5 / 2.5 GT/s Link Width: x1 / x1\n        0x0100: Enhanced Capability 0x00: Unknown\n 0:4:0: Qumranet Virtio Storage\n        0x0000: Vendor ID: 1af4 Product ID: 1001\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 01 Subclass: 00 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 00 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR io addr: 0x00002000/0x0040\n        0x0014: BAR mem 32bit addr: 0xc0000000/0x00002000\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 1af4 Product ID: 0002\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 01 Line: 05 Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x11: Extended Message Signalled Interrupts (MSI-X)\n        0x004c: Capability 0x05: Message Signalled Interrupts (MSI)\n 0:5:0: Qumranet Virtio Storage\n        0x0000: Vendor ID: 1af4 Product ID: 1001\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 01 Subclass: 00 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 00 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR io addr: 0x00002040/0x0040\n        0x0014: BAR mem 32bit addr: 0xc0002000/0x00002000\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 1af4 Product ID: 0002\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 01 Line: 06 Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x11: Extended Message Signalled Interrupts (MSI-X)\n        0x004c: Capability 0x05: Message Signalled Interrupts (MSI)\n 0:6:0: Qumranet Virtio Network\n        0x0000: Vendor ID: 1af4 Product ID: 1000\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 02 Subclass: 00 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 00 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR io addr: 0x00002080/0x0020\n        0x0014: BAR mem 32bit addr: 0xc0004000/0x00002000\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 1af4 Product ID: 0001\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 01 Line: 07 Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x11: Extended Message Signalled Interrupts (MSI-X)\n 0:30:0: unknown unknown\n        0x0000: Vendor ID: fb5d Product ID: 40fb\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 03 Subclass: 00 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 80 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR mem 32bit addr: 0xc0006000/0x00000080\n        0x0014: BAR mem 32bit addr: 0xc1000000/0x01000000\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 0000 Product ID: 0000\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 00 Line: ff Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x05: Message Signalled Interrupts (MSI)\n 0:30:1: Intel 7 Series xHCI\n        0x0000: Vendor ID: 8086 Product ID: 1e31\n        0x0004: Command: 0007 Status: 0010\n        0x0008: Class: 0c Subclass: 03 Interface: 30 Revision: 00\n        0x000c: BIST: 00 Header Type: 80 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR mem 32bit addr: 0xc2000000/0x00001000\n        0x0014: BAR empty (00000000)\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 0000 Product ID: 0000\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 01 Line: 07 Min Gnt: 00 Max Lat: 00\n        0x0040: Capability 0x05: Message Signalled Interrupts (MSI)\n 0:31:0: Intel 82371SB ISA\n        0x0000: Vendor ID: 8086 Product ID: 7000\n        0x0004: Command: 0007 Status: 0000\n        0x0008: Class: 06 Subclass: 01 Interface: 00 Revision: 00\n        0x000c: BIST: 00 Header Type: 00 Latency Timer: 00 Cache Line Size: 00\n        0x0010: BAR empty (00000000)\n        0x0014: BAR empty (00000000)\n        0x0018: BAR empty (00000000)\n        0x001c: BAR empty (00000000)\n        0x0020: BAR empty (00000000)\n        0x0024: BAR empty (00000000)\n        0x0028: Cardbus CIS: 00000000\n        0x002c: Subsystem Vendor ID: 0000 Product ID: 0000\n        0x0030: Expansion ROM Base Address: 00000000\n        0x0038: 00000000\n        0x003c: Interrupt Pin: 00 Line: ff Min Gnt: 00 Max Lat: 00\nobsd#\n---"},{"timestamp":1538426652,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1538429771,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4:\n\n(4 comments)"},{"timestamp":1538439255,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5."},{"timestamp":1538439359,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(4 comments)"},{"timestamp":1538439624,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\nI re-tested that valid vendor\u003dX,device\u003dY combos still work while invalid entries (such as with trailing garbage or over-UINT16_MAX) yielded the errors designed by the small additions."},{"timestamp":1538445692,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1538459197,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1538504232,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1538668560,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1538679517,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1538680754,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1538682397,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"8","revision":"4c14c4cff5adaaa79d7099e153c3ace3a0d65148","parents":["1f946b3740393b0dc458e4d386c40f40dd9b8465"],"ref":"refs/changes/23/4823/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538680754,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538445692,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538459197,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"SUBM","value":"1","grantedOn":1538682397,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":164,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"4822b9771c351e0fb17c550b7556ada98117e316","parents":["320339a509cdabf5e7ef29b9822e874e35e0c1bf"],"ref":"refs/changes/23/4823/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1536691504,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536741383,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":460,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"This will break existing OpenBSD VMs (and possible others) that require amd_hostbridge.\n\nhttps://wiki.freebsd.org/bhyve/OpenBSD\n\n\"Slot 0 should use amd_hostbridge for all OpenBSD instances, even on Intel based hardware as MSI/MSI-x interrupts which are used by the xhci/tablet for accurate mouse control are not available in OpenBSD unless the hostbridge is advertised as AMD.\"\n\nCan we switch this to amd_hostbridge instead? Linux, Windows and FreeBSD are happy with either hostbridge or amd_hostbridge. But OpenBSD is not.\n\nConfigurable would be better, but that is more work. Although I am willing to tackle that if there is consensus on what the attr should be called for zonecfg."},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":460,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Linux, Windows, and FreeBSD guests continued to operate fine.  That said, I\u0027ll look into other options here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":20,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-1},{"number":"2","revision":"f77d3acb1765315ab5e1989f1f94e9b47b299a89","parents":["eae4e4f053cd08905af071b7fa6b8392026b68cb"],"ref":"refs/changes/23/4823/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1537806489,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536741383,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":20,"deletions":-1}],"sizeInsertions":20,"sizeDeletions":-1},{"number":"3","revision":"8baba4ace07891c068add6d591e0db6ac21e9958","parents":["eae4e4f053cd08905af071b7fa6b8392026b68cb"],"ref":"refs/changes/23/4823/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1537889871,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1537892873,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1537891800,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"comments":[{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":460,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Nice!"},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":474,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"nit: might want to use i440fx instead of Natoma here to keep it consistent naming"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":163,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":202,"sizeDeletions":-1},{"number":"4","revision":"0c36c9821ff3c9fb2e0626c11c49ebab5439d223","parents":["1c1a890e7ba95068bc573dd82bcec35fbe2ad66b"],"ref":"refs/changes/23/4823/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538426652,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1537892873,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1537891800,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"comments":[{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":90,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"should pass \u0026endptr so that (*endptr \u003d\u003d \u0027\\0\u0027) can be checked."},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":90,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":95,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This will either print \"0000\" or something else that is longer than 4 characters long.  Taking input in any radix then printing in hex without 0x can lead to confusion.  Better as 0x%x or %ld."},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":95,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"will add the 0x prefix"},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":120,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Per http://pci-ids.ucw.cz/v2.2/pci.ids there are a number of devices with ID 0.  Probably not a huge deal for this case, so I\u0027m fine if you decide to leave as-is."},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":120,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m not concerned about it.  This is meant as as easy runtime shortcut instead of adding something to pci_hb_models."},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":131,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"strtok_r()?"},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","line":131,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"There seems to be a mix of strchr and strtok(non _r) in bhyve.  Since this works fine, I\u0027m inclined to leave it for now."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":163,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":202,"sizeDeletions":-1},{"number":"5","revision":"2190d06a093105b5c643638082a60ad795d06b10","parents":["1c1a890e7ba95068bc573dd82bcec35fbe2ad66b"],"ref":"refs/changes/23/4823/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538439255,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538459197,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538445692,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":164,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-1},{"number":"6","revision":"84a64ff7e8eaa764f93eea7921a2e5433ee46f6c","parents":["1f6101e0488d5d4aff07f6da56980c87fc92e790"],"ref":"refs/changes/23/4823/6","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538504232,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538459197,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538445692,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":164,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-1},{"number":"7","revision":"671e6501484b237c2d41af910eedc18a7db2cad8","parents":["1f946b3740393b0dc458e4d386c40f40dd9b8465"],"ref":"refs/changes/23/4823/7","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538679517,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538459197,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538445692,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":164,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-1},{"number":"8","revision":"4c14c4cff5adaaa79d7099e153c3ace3a0d65148","parents":["1f946b3740393b0dc458e4d386c40f40dd9b8465"],"ref":"refs/changes/23/4823/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1538680754,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1538682397,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1538668560,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538459197,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538445692,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/bhyve/pci_hostbridge.c","type":"MODIFIED","insertions":164,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":39,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-1}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}