From a4c5ee23f60fe5bb608a9f6ef5c3cfce92f78cf5 Mon Sep 17 00:00:00 2001
From: Hans Rosenfeld <hans.rosenfeld@joyent.com>
Date: Tue, 24 Oct 2017 09:12:49 +0000
Subject: [PATCH] OS-6415 remove old Sun as workaround from gcc 4.4.4 build

---
 gcc4/Patches/sol2.h.diff | 13 +++++++++++++
 1 file changed, 13 insertions(+)
 create mode 100644 gcc4/Patches/sol2.h.diff

diff --git a/gcc4/Patches/sol2.h.diff b/gcc4/Patches/sol2.h.diff
new file mode 100644
index 0000000..85c2beb
--- /dev/null
+++ b/gcc4/Patches/sol2.h.diff
@@ -0,0 +1,13 @@
+--- gcc-4.4.4/gcc/config/i386/sol2.h.orig	2016-12-01 22:55:44.000000000 +0000
++++ gcc-4.4.4/gcc/config/i386/sol2.h	2017-10-19 21:20:13.141448013 +0000
+@@ -48,8 +48,10 @@ along with GCC; see the file COPYING3.
+ #define EH_TABLES_CAN_BE_READ_ONLY (TARGET_64BIT)
+ 
+ /* Solaris 2/Intel as chokes on #line directives.  */
++#ifndef USE_GAS
+ #undef CPP_SPEC
+ #define CPP_SPEC "%{,assembler-with-cpp:-P} %(cpp_subtarget)"
++#endif
+ 
+ /* FIXME: Removed -K PIC from generic Solaris 2 ASM_SPEC: the native assembler
+    gives many warnings: R_386_32 relocation is used for symbol ".text".  */
-- 
2.21.0

