{"project":"joyent/sdc-cloudapi","branch":"master","id":"I86420a23ff451f4993c5dd073d3c130ebfca71bd","number":"1606","subject":"joyent/node-triton#128 triton ls state\u003dprovisioning` doesn\u0027t filter on state","owner":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"url":"https://cr.joyent.us/1606","commitMessage":"joyent/node-triton#128 triton ls state\u003dprovisioning` doesn\u0027t filter on state\n","createdOn":1488529947,"lastUpdated":1491390400,"open":true,"status":"NEW","comments":[{"timestamp":1488529947,"reviewer":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"message":"Uploaded patch set 1."},{"timestamp":1488529976,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1488531005,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1\n\nNormally I\u0027d ask for a test for this, but it probably would be tricky to do reliably."},{"timestamp":1489536981,"reviewer":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1489537027,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1491349279,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2:\n\nYang Yong, are you planning to integrate this? It\u0027s been a while, so I\u0027m wondering if this is in limbo."},{"timestamp":1491350713,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nMarsell,\n\nHave you tested this? I wasn\u0027t actually sure that querying for state\u003dprovisioning to VMAPI would have results."},{"timestamp":1491390400,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2: -Integration-Approval\n\n\u003e Have you tested this? I wasn\u0027t actually sure that querying for\n \u003e state\u003dprovisioning to VMAPI would have results.\n\nTurns out you\u0027re right. It looked like it should work with vmapi, and that the docs were wrong, but nope: VALID_VM_STATES in common/validation.js doesn\u0027t allow it.\n\nIs there a good reason we shouldn\u0027t add it to vmapi -- other than dealing with the ripple to other callers? Right now cloudapi gives an odd result when attempting to filter by \u0027provisioning\u0027: it returns all running VMs, not just VMs provisioning.\n\nI think it\u0027d be useful to allow filtering by provisioning, but the alternative is we disallow filtering by \u0027provisioning\u0027 in cloudapi; at least the results will be consistent with what was requested.\n\nUnrelatedly, I was quite wrong about this being tricky to add tests for: it\u0027s not. If we decide to add support to vmapi for filtering by \u0027provisioning\u0027, I\u0027m okay with driving all of this the rest of the way if need be (tests, dealing with other vmapi callers, etc)."}],"currentPatchSet":{"number":"2","revision":"86420a23ff451f4993c5dd073d3c130ebfca71bd","parents":["e79d6bb1d272100fb78d54ce60e9c5f5e24ea8cd"],"ref":"refs/changes/06/1606/2","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1489536981,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488529976,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1488531005,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/machines.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"f0ac2dcf23bff61edb63d266a484c7d392508f4e","parents":["93fa72519a21dcc18758e31a5408b6f5da325795"],"ref":"refs/changes/06/1606/1","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1488529947,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488529976,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1488531005,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1488531005,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/machines.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},{"number":"2","revision":"86420a23ff451f4993c5dd073d3c130ebfca71bd","parents":["e79d6bb1d272100fb78d54ce60e9c5f5e24ea8cd"],"ref":"refs/changes/06/1606/2","uploader":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"createdOn":1489536981,"author":{"name":"Yang Yong","email":"yy1111.yang@samsung.com","username":"YangYong3"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1488529976,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1488531005,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/machines.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}