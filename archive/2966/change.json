{"project":"joyent/sdc-sapi","branch":"master","id":"I072e966b2d10a846c9a1094743e11c3da4c6caf4","number":"2966","subject":"SAPI-283 sapi multi-DC master mode is undocumented Reviewed by: David Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/2966","commitMessage":"SAPI-283 sapi multi-DC master mode is undocumented\nReviewed by: David Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1510934442,"lastUpdated":1512151227,"open":false,"status":"MERGED","comments":[{"timestamp":1510934442,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1510934447,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 70139560a3c586d7c297d6afcb07266074881d64\n    \n    SAPI-283 sapi multi-DC master mode is undocumented\n    \n    commit b2660225e720a4133fc4c57834dc158cdf41ee4e\n    \n    SAPI-212 Unclear how to adopt existing instances in SAPI"},{"timestamp":1510934468,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1510934516,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nDave, what I\u0027ve found and tested so far added to SAPI\u0027s docs regarding Multi-DC mode. Can you take a look? No rush at all, of course!"},{"timestamp":1511217824,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\n(10 comments)\n\nThanks for doing this.  This looks good.  It looks like you based this on my notes in the ticket, but I have some suggestions for restructuring it a bit.\n\nYou may want to have Brian Bennett take a look too, since he\u0027s had to go through this a few times now."},{"timestamp":1511279505,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1511279510,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit d41996bdc29f66ce4d66694078058688db20f475\n    \n    SAPI-283 sapi multi-DC master mode is undocumented"},{"timestamp":1511279530,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511280776,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1511280781,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 1c467c4b1a769c7257031b08c18154515b2965ef\n    \n    SAPI-283 sapi multi-DC master mode is undocumented"},{"timestamp":1511280801,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511280836,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(10 comments)\n\nDone with the suggested changes Dave. Added Brian as a reviewer too so he can take a look before we move ahead on this one. Thanks!"},{"timestamp":1511283273,"reviewer":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1511285639,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1511372420,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1511372426,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 94a50b7999d7a71902055e36eb5d44a941dbb480\n    \n    SAPI-283 sapi multi-DC master mode is undocumented"},{"timestamp":1511372446,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511372520,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(3 comments)\n\nDone with all the suggestions but using \"primary\" to name this feature. As explained into the comment, I think we\u0027ve always called this \"SAPI master\" despite of the lack of docs and changing naming now would be confusing."},{"timestamp":1511374494,"reviewer":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1512151211,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4: Integration-Approval+1\n\nGiven these are docs, I\u0027d say I\u0027m gonna IA+1 myself and merge it before I forget about its existence!"},{"timestamp":1512151227,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"072e966b2d10a846c9a1094743e11c3da4c6caf4","parents":["ccab35148089aab19d5191dae183cffbb898bc1f"],"ref":"refs/changes/66/2966/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1511372420,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511372446,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511374494,"by":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151211,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1512151227,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"d64bdae45f9ec1af227f94ab486119027702935c","parents":["5e4ea9d6f5896af89553ca058f95e3e6bc3111b1"],"ref":"refs/changes/66/2966/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1510934442,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1510934468,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":1101,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Drop the parentheses, since we talk about Manta later?  Maybe say something like: \"This is intended to support multi-DC applications like Manta.\""},{"file":"docs/index.md","line":1101,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1103,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Maybe link to documentation on this?"},{"file":"docs/index.md","line":1103,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1108,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"\"object\", so that people don\u0027t confuse this with SAPI instances?"},{"file":"docs/index.md","line":1108,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1112,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"\"and inter-datacenter routes\""},{"file":"docs/index.md","line":1112,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1115,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I don\u0027t understand this."},{"file":"docs/index.md","line":1115,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Just suggesting to pick the same DC for SAPI master that you already have for UFDS master."},{"file":"docs/index.md","line":1119,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think you might want to combine these with the first step (about linked UFDS), maybe into a separate \"prerequisites\" step."},{"file":"docs/index.md","line":1119,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Good Idea, yes"},{"file":"docs/index.md","line":1131,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"You can drop \"reasons\" here."},{"file":"docs/index.md","line":1131,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1137,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"\"Moray\""},{"file":"docs/index.md","line":1137,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Drop the comma."},{"file":"docs/index.md","line":1137,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1137,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1138,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Maybe clarify: \"include_master has no effect when requesting from the master.\""},{"file":"docs/index.md","line":1138,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Good call, done!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":81,"deletions":0}],"sizeInsertions":81,"sizeDeletions":0},{"number":"2","revision":"72b7c4a3b1368a1c5531852c29a3cc408dc14a8a","parents":["ccab35148089aab19d5191dae183cffbb898bc1f"],"ref":"refs/changes/66/2966/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1511279505,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511279530,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":52,"deletions":0}],"sizeInsertions":52,"sizeDeletions":0},{"number":"3","revision":"20ec51ff6c9ae7e3609b7633d6cfb745e82f9aa4","parents":["ccab35148089aab19d5191dae183cffbb898bc1f"],"ref":"refs/changes/66/2966/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1511280776,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511285639,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511280801,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":1102,"reviewer":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"},"message":"I think it would also be good to explicitly note that triton itself, even with linked datacenters does not need linked sapi."},{"file":"docs/index.md","line":1102,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"docs/index.md","line":1115,"reviewer":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"},"message":"Avoid the term \"master\", prefer \"primary\", except where the code is explicitly accepts the term \"master\". Same with UFDS, and elsewhere."},{"file":"docs/index.md","line":1115,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Aren\u0027t we using \"primary\" for manatee\u0027s shard primary and \"master\" for ufds_master? I think \"master\" has been the term in use for this since the beginning (mostly b/c it\u0027s how it\u0027s referenced into the code) and calling it something else would add confusion, IMO."},{"file":"docs/index.md","line":1116,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"semicolon?"},{"file":"docs/index.md","line":1116,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":57,"deletions":0}],"sizeInsertions":57,"sizeDeletions":0},{"number":"4","revision":"072e966b2d10a846c9a1094743e11c3da4c6caf4","parents":["ccab35148089aab19d5191dae183cffbb898bc1f"],"ref":"refs/changes/66/2966/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1511372420,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511372446,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511374494,"by":{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151211,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1512151227,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0}],"sizeInsertions":60,"sizeDeletions":0}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Brian Bennett","email":"brian.bennett@joyent.com","username":"bahamat"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}