commit 24ff92f9921fb9bbb51d4f27912769e69b452fd8 (refs/changes/65/2465/1)
Author: Jerry Jelinek <jerry.jelinek@joyent.com>
Date:   2017-08-25T22:24:32+00:00 (2 years, 1 month ago)
    
    OS-6313 backout fix for OS-6275, needs more work

diff --git a/usr/src/uts/common/brand/lx/syscall/lx_pipe.c b/usr/src/uts/common/brand/lx/syscall/lx_pipe.c
index b96727cd8a..d6c8f1d274 100644
--- a/usr/src/uts/common/brand/lx/syscall/lx_pipe.c
+++ b/usr/src/uts/common/brand/lx/syscall/lx_pipe.c
@@ -179,17 +179,6 @@ lx_hd_pipe(intptr_t arg, int flags)
 	VERIFY((str = vp1->v_stream) != NULL);
 	(void) lx_pipe_setsz(str, LX_DEFAULT_PIPE_SIZE, B_TRUE);
 
-	/*
-	 * Because we're using streams to increase the capacity of the pipe
-	 * up to the default Linux capacity, we have to switch the pipe
-	 * out of FIFOFAST mode and back to a normal stream. In fast mode
-	 * the pipe capacity is limited to "Fifohiwat" which is a compile-time
-	 * limit set to FIFOHIWAT.
-	 */
-	mutex_enter(&VTOF(vp1)->fn_lock->flk_lock);
-	fifo_fastoff(VTOF(vp1));
-	mutex_exit(&VTOF(vp1)->fn_lock->flk_lock);
-
 	/*
 	 * Set the O_NONBLOCK flag if requested.
 	 */
