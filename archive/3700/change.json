{"project":"joyent/manta-reshard","branch":"master","id":"Ia0713ca1ac64595d4ebb8d627a7643fa07f1bed1","number":"3700","subject":"MANTA-3603 reshard service hugs SAPI to death MANTA-3604 reshard service should not trust \"params\" from SAPI instance Reviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e Approved by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e","owner":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"url":"https://cr.joyent.us/3700","commitMessage":"MANTA-3603 reshard service hugs SAPI to death\nMANTA-3604 reshard service should not trust \"params\" from SAPI instance\nReviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e\nApproved by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e\n","createdOn":1521599925,"lastUpdated":1522102375,"open":false,"status":"MERGED","comments":[{"timestamp":1521599925,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 1."},{"timestamp":1521599928,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521683097,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1521840252,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1522101313,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 1: Code-Review+1\n\nThank you for the response!  This looks good to me."},{"timestamp":1522101621,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 1: Integration-Approval+1"},{"timestamp":1522102363,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1522102375,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Joshua M. Clulow"}],"currentPatchSet":{"number":"2","revision":"a0713ca1ac64595d4ebb8d627a7643fa07f1bed1","parents":["5bd3db7abadc02219cfed68064d72eae8bd9a746"],"ref":"refs/changes/00/3700/2","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1522102363,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521599928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522101313,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522101621,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"SUBM","value":"1","grantedOn":1522102375,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/executor.js","type":"MODIFIED","insertions":52,"deletions":-2},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":4,"deletions":-8},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":95,"deletions":-58}],"sizeInsertions":167,"sizeDeletions":-97},"patchSets":[{"number":"1","revision":"69c5ce56b085e175ef4ff589d4d35f906a2d8937","parents":["5bd3db7abadc02219cfed68064d72eae8bd9a746"],"ref":"refs/changes/00/3700/1","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1521599925,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521599928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522101313,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522101621,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"comments":[{"file":"lib/executor.js","line":501,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Does this not need to be cleared later?"},{"file":"lib/executor.js","line":501,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"The call to \"done()\" on L503 effectively removes this node from the status tree."},{"file":"lib/phase_create_manatee_peers.js","line":120,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Is the reason for this change related to sapiadm reprovision? (I have the same question for the similar change when creating the morays.)"},{"file":"lib/phase_create_manatee_peers.js","line":120,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Yes, the pair of changes to avoid the \"params\" properties is MANTA-3604, while most of the rest is for MANTA-3603."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/executor.js","type":"MODIFIED","insertions":52,"deletions":-2},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":4,"deletions":-8},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":95,"deletions":-58}],"sizeInsertions":167,"sizeDeletions":-97},{"number":"2","revision":"a0713ca1ac64595d4ebb8d627a7643fa07f1bed1","parents":["5bd3db7abadc02219cfed68064d72eae8bd9a746"],"ref":"refs/changes/00/3700/2","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1522102363,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1522102375,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521599928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522101313,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522101621,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/executor.js","type":"MODIFIED","insertions":52,"deletions":-2},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":4,"deletions":-8},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":95,"deletions":-58}],"sizeInsertions":167,"sizeDeletions":-97}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}]}