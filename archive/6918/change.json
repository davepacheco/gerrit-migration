{"project":"joyent/illumos-joyent","branch":"master","id":"I272503fac2578e6f595be3912edf4d788da25035","number":"6918","subject":"OS-7988 need swapgs mitigation","owner":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"url":"https://cr.joyent.us/6918","commitMessage":"OS-7988 need swapgs mitigation\n","createdOn":1568811203,"lastUpdated":1570546215,"open":true,"status":"NEW","comments":[{"timestamp":1568811203,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 1."},{"timestamp":1568811205,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 503b7a9877a2947048d01fc2814bea28995ee69c\n    \n    m\n    \n    commit 870cd2d35a6a8f11fd0af9a6567a06ebeb1aca19\n    \n    m"},{"timestamp":1568811286,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1: Code-Review-1"},{"timestamp":1568913483,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 2."},{"timestamp":1568913489,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit b228e54fba720929cc2f59bb9b98e6f2623b1a97\n    \n    small fixes\n    \n    commit 6d70d0b2f79685908d7f96ed4a3ef1815cd20ab9\n    \n    pbchk"},{"timestamp":1568913687,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2: -Code-Review\n\nLet me know if you\u0027d like to me talk through what the issue is in more detail.\n\nI didn\u0027t bother trying to find a code sequence that could *actually* be used to exploit this problem - while we know Windows did have at least one, Linux just mitigated on a paranoid basis, and so should we.\n\nNote that there\u0027s multiple other potential issues in the two bitdefender papers, but none of them seem relevant to us."},{"timestamp":1568919204,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Code-Review+1\n\nI\u0027m not an expert, but as best I can see, this seems fine to me."},{"timestamp":1570544555,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2: Code-Review+1\n\n(2 comments)\n\nQuestions aren\u0027t blockers for CR.\n\nCan\u0027t IA w/o test results, though.  I take it we\u0027re going to have a performance hit?"},{"timestamp":1570546215,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\n(1 comment)\n\nAs for performance, in theory, but in reality there\u0027s absolutely no way we\u0027d be able to measure it (unlike say KPTI which was pretty heavy)"}],"currentPatchSet":{"number":"2","revision":"272503fac2578e6f595be3912edf4d788da25035","parents":["496f2accfa0b13708051729f478a7bdaeff40d12"],"ref":"refs/changes/18/6918/2","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1568913483,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568919204,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570544555,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"usr/src/uts/intel/amd64/ml/amd64.il","line":199,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"This will be a Flag Day for old Opteron users (if there are any left?), right?"},{"file":"usr/src/uts/intel/ia32/os/sundep.c","line":559,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"OR does this cover the Opteron Erratum?"},{"file":"usr/src/uts/intel/ia32/os/sundep.c","line":559,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"The mfence is most likely enough, but also, it\u0027s highly unlikely anyone has one of those old systems still in a working state."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/ml/kpti_trampolines.s","type":"MODIFIED","insertions":10,"deletions":-7},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/intel/amd64/ml/amd64.il","type":"MODIFIED","insertions":8,"deletions":-12},{"file":"usr/src/uts/intel/amd64/sys/privregs.h","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/uts/intel/asm/cpu.h","type":"MODIFIED","insertions":0,"deletions":-11},{"file":"usr/src/uts/intel/ia32/ml/exception.s","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/intel/ia32/os/sundep.c","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/intel/sys/archsystm.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/sys/segments.h","type":"MODIFIED","insertions":1,"deletions":-2}],"sizeInsertions":79,"sizeDeletions":-47},"patchSets":[{"number":"1","revision":"a28fe73997ce5e3e1e1af0c5979f2e6c4e2f0d69","parents":["496f2accfa0b13708051729f478a7bdaeff40d12"],"ref":"refs/changes/18/6918/1","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1568811203,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1568811286,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/ml/kpti_trampolines.s","type":"MODIFIED","insertions":12,"deletions":-9},{"file":"usr/src/uts/i86pc/ml/syscall_asm_amd64.s","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/machprivregs.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/amd64/ml/amd64.il","type":"MODIFIED","insertions":0,"deletions":-8},{"file":"usr/src/uts/intel/amd64/sys/privregs.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/intel/asm/cpu.h","type":"MODIFIED","insertions":0,"deletions":-11},{"file":"usr/src/uts/intel/ia32/ml/exception.s","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/intel/ia32/os/sundep.c","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/intel/sys/archsystm.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/sys/segments.h","type":"MODIFIED","insertions":1,"deletions":-2}],"sizeInsertions":69,"sizeDeletions":-44},{"number":"2","revision":"272503fac2578e6f595be3912edf4d788da25035","parents":["496f2accfa0b13708051729f478a7bdaeff40d12"],"ref":"refs/changes/18/6918/2","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1568913483,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568919204,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570544555,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"usr/src/uts/intel/amd64/ml/amd64.il","line":199,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"This will be a Flag Day for old Opteron users (if there are any left?), right?"},{"file":"usr/src/uts/intel/ia32/os/sundep.c","line":559,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"OR does this cover the Opteron Erratum?"},{"file":"usr/src/uts/intel/ia32/os/sundep.c","line":559,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"The mfence is most likely enough, but also, it\u0027s highly unlikely anyone has one of those old systems still in a working state."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/ml/kpti_trampolines.s","type":"MODIFIED","insertions":10,"deletions":-7},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":37,"deletions":-3},{"file":"usr/src/uts/intel/amd64/ml/amd64.il","type":"MODIFIED","insertions":8,"deletions":-12},{"file":"usr/src/uts/intel/amd64/sys/privregs.h","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/uts/intel/asm/cpu.h","type":"MODIFIED","insertions":0,"deletions":-11},{"file":"usr/src/uts/intel/ia32/ml/exception.s","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/intel/ia32/os/sundep.c","type":"MODIFIED","insertions":7,"deletions":-4},{"file":"usr/src/uts/intel/kdi/kdi_asm.s","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/intel/sys/archsystm.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/sys/segments.h","type":"MODIFIED","insertions":1,"deletions":-2}],"sizeInsertions":79,"sizeDeletions":-47}],"allReviewers":[{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}]}