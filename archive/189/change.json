{"project":"joyent/node-smartdc","branch":"master","id":"I38c0526ca74481fcaea0419ec87f282cc3dd023d","number":"189","subject":"PORTAL-2165 The ability to append fields to the log record","owner":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"url":"https://cr.joyent.us/189","commitMessage":"PORTAL-2165 The ability to append fields to the log record\n","createdOn":1470125660,"lastUpdated":1470265989,"open":false,"status":"MERGED","comments":[{"timestamp":1470125660,"reviewer":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"message":"Uploaded patch set 1."},{"timestamp":1470125690,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1470126172,"reviewer":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"message":"Uploaded patch set 2."},{"timestamp":1470126208,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1470126234,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1470127340,"reviewer":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"message":"Uploaded patch set 3."},{"timestamp":1470127371,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1470178018,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1470244423,"reviewer":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"message":"Uploaded patch set 4."},{"timestamp":1470244454,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1470247353,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 4: Code-Review+1\n\nThanks for the changes."},{"timestamp":1470265839,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1470265923,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Trent Mick"},{"timestamp":1470265989,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\nSorry, I forgot to update the commit message with \"Reviewed by\" et al before integrating this."}],"currentPatchSet":{"number":"4","revision":"38c0526ca74481fcaea0419ec87f282cc3dd023d","parents":["f7ccf57a6860650d19504d3c9f1c36cdafde4662"],"ref":"refs/changes/89/189/4","uploader":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"createdOn":1470244423,"author":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1470244454,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1470247353,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1470265839,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1470265922,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cloudapi.js","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":12,"sizeDeletions":-3},"patchSets":[{"number":"1","revision":"1a6c621f1ef077e1cf6c719af6c1fc8063c3c80a","parents":["f7ccf57a6860650d19504d3c9f1c36cdafde4662"],"ref":"refs/changes/89/189/1","uploader":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"createdOn":1470125660,"author":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1470125690,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/cloudapi.js","line":173,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"line \u003e 80 characters"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cloudapi.js","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":3,"sizeDeletions":0},{"number":"2","revision":"37a84a4d732bb9ba37bb88c49ffc3de596e7841b","parents":["f7ccf57a6860650d19504d3c9f1c36cdafde4662"],"ref":"refs/changes/89/189/2","uploader":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"createdOn":1470126172,"author":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1470126208,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/cloudapi.js","line":197,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"A couple of things.  It would be good to \"assert.optionalObject()\" the new \"logFields\" option.\n\nIn addition, it seems like we\u0027re actually mutating the global \"log\" object here.  It would probably be best to first create a light-weight child and _then_ mutate, in all cases.  For example:\n\n    if (options.logFields) {\n        options.log \u003d log.child(options.logFields);\n    } else {\n        options.log \u003d log.child();\n    }\n    if (options.logLevel) {\n        options.log.level(options.logLevel);\n    }\n\nThis way, two CloudAPI instances in the same application don\u0027t trod on one another."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cloudapi.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":4,"sizeDeletions":0},{"number":"3","revision":"49b11f8d7076785103e9990b4c42745f10c1abdf","parents":["f7ccf57a6860650d19504d3c9f1c36cdafde4662"],"ref":"refs/changes/89/189/3","uploader":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"createdOn":1470127340,"author":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1470127371,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/cloudapi.js","line":192,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I don\u0027t think this will work at all.  The argument to Bunyan\u0027s \"Logger#child()\" method is an _object_, not a list of field names:\n\nhttps://github.com/trentm/node-bunyan/blob/cbfaa9a7bd86c658dbb8333c894191d23b65be33/lib/bunyan.js#L661-L689"},{"file":"lib/cloudapi.js","line":198,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"You are still mutating the global \"log\".  As per the example I provided, we should copy it and then mutate the copy."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cloudapi.js","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":8,"sizeDeletions":-1},{"number":"4","revision":"38c0526ca74481fcaea0419ec87f282cc3dd023d","parents":["f7ccf57a6860650d19504d3c9f1c36cdafde4662"],"ref":"refs/changes/89/189/4","uploader":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"createdOn":1470244423,"author":{"name":"Dan Lukinykh","email":"dan.lukinykh@joyent.com","username":"dan-luk"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1470247353,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1470244454,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1470265839,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1470265922,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cloudapi.js","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":12,"sizeDeletions":-3}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"}]}