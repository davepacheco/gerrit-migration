{"project":"joyent/illumos-joyent","branch":"master","id":"Ief4b4986560f8d8cf1018503062f9c13da02073a","number":"926","subject":"OS-5811 basic support for ECDSA in smartlogin Reviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/926","commitMessage":"OS-5811 basic support for ECDSA in smartlogin\nReviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1479514798,"lastUpdated":1479775305,"open":false,"status":"MERGED","comments":[{"timestamp":1479514798,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1479674574,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1479678538,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1479678590,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1479682880,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1479753647,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1479754116,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1479756422,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Code-Review+1\n\n(1 comment)"},{"timestamp":1479771418,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Published edit on patch set 4."},{"timestamp":1479771474,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1479771988,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 6."},{"timestamp":1479772234,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1479772348,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 7."},{"timestamp":1479772535,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1479775248,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1479775292,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1479775305,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"8","revision":"0e094404f4a199a440ac665b3442f89891352798","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479775292,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479772535,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1479775305,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":50,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"18974f844b068aad392ccfe83283d0fbc34edee8","parents":["5b508be5188fbc34f5e626fc0125a75be65a2057"],"ref":"refs/changes/26/926/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479514798,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":142,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Is it not possible for \"j\" to point past the end of \"hexstr\" here?\n\nAlso, it seems like it would be better to return failure if we overflow the string, and then not use the result in \"sshd_user_key_allowed()\"."},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":142,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Yeah fair enough... although in this particular context, the length can be predicted, since md5 always is 16 bytes and in colonhex that expands to exactly 48 bytes incl null terminator. I\u0027ve changed it to return an int anyway in case we ever reuse the function for something else."},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":155,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"You should use \"sizeof\" instead of the hard-coded 16 and 48, here."},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":155,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":39,"deletions":0}],"sizeInsertions":43,"sizeDeletions":-1},{"number":"2","revision":"cc55eb200d0bf13157d89d65865acb9c1beb6dd1","parents":["b6ebeeac71aba19031ac94ed8f38ac1f180f5170"],"ref":"refs/changes/26/926/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479678538,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":47,"deletions":0}],"sizeInsertions":51,"sizeDeletions":-1},{"number":"3","revision":"2af55b70a9ec0f6fa88722b22d6acca0fdcdaebc","parents":["b6ebeeac71aba19031ac94ed8f38ac1f180f5170"],"ref":"refs/changes/26/926/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479678590,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":157,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we use MD5_DIGEST_LENGTH?"},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":158,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027d suggest making this a #define in the source code with a comment describing where it\u0027s derived from."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":47,"deletions":0}],"sizeInsertions":51,"sizeDeletions":-1},{"number":"4","revision":"adcc36746d5251f45a08f5568ee297e3f4b93a81","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479754116,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479756422,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","line":158,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Still probably worth saying why this is safe or where it comes from, though I know inherently (two chars per byte plus a third covers all the ancillary things we need)."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":47,"deletions":0}],"sizeInsertions":51,"sizeDeletions":-1},{"number":"5","revision":"f83c77199b8034bfbdcac26babb9352ea3387b54","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479771418,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479771474,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":51,"deletions":0}],"sizeInsertions":55,"sizeDeletions":-1},{"number":"6","revision":"4fc068f35a2d8d624a8b075ecf6488e796952a55","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479771988,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479772234,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":50,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-3},{"number":"7","revision":"ef4b4986560f8d8cf1018503062f9c13da02073a","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/7","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479772348,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479772535,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":50,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-4},{"number":"8","revision":"0e094404f4a199a440ac665b3442f89891352798","parents":["de53b36c571e97a4fbff4241211ffe91ace1c684"],"ref":"refs/changes/26/926/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1479775292,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479772535,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1479775305,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1479775248,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/libsmartsshd/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/lib/libsmartsshd/common/mapfile-vers","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/lib/libsmartsshd/common/sshd-plugin.c","type":"MODIFIED","insertions":50,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-4}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}