{"project":"joyent/illumos-joyent","branch":"master","id":"I3661208596c321e7fff78aa2bede68d33cf6217b","number":"1870","subject":"OS-5097 lxbrand mlock(2) permissions too strict Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Ryan Zezeski \u003cryan.zeseski@joyent.com\u003e Approved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"url":"https://cr.joyent.us/1870","commitMessage":"OS-5097 lxbrand mlock(2) permissions too strict\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Ryan Zezeski \u003cryan.zeseski@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1493393576,"lastUpdated":1493414001,"open":false,"status":"MERGED","comments":[{"timestamp":1493393576,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 1."},{"timestamp":1493394470,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\nI\u0027m writing a new test suite and I just found one issue with this. We should bypass the process rctl check if we\u0027re running as root. I\u0027ll fix that, but wait before uploading a new rev in case there are other issues from review."},{"timestamp":1493395737,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 2."},{"timestamp":1493395769,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\nI just went ahead and pushed that update so it can be reviewed altogether."},{"timestamp":1493405030,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1493407232,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 3."},{"timestamp":1493407859,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1493408874,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1493412685,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1493413921,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1493413993,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1493414001,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jerry Jelinek"}],"currentPatchSet":{"number":"5","revision":"3661208596c321e7fff78aa2bede68d33cf6217b","parents":["6868c57d2033d43b327fe6549e9f1f552eae1e86"],"ref":"refs/changes/70/1870/5","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493413993,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493407859,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493408874,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493412685,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1493414001,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/man/man5/resource_controls.5","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":22,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-18},"patchSets":[{"number":"1","revision":"d6d81e4c388cfafd1a9875037e5bc37b89d1a587","parents":["116dc71c1ce421b83a11edca6fe15122f4b49adc"],"ref":"refs/changes/70/1870/1","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493393576,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","line":34,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":19,"deletions":-1}],"sizeInsertions":67,"sizeDeletions":-15},{"number":"2","revision":"77dd0654776bdd8e1582ecb6063e63fe1ff78784","parents":["116dc71c1ce421b83a11edca6fe15122f4b49adc"],"ref":"refs/changes/70/1870/2","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493395737,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","line":71,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why not use \u0027curproc\u0027 for these?"},{"file":"usr/src/uts/common/os/rctl_proc.c","line":226,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"As we discussed, this exception basically makes the rctl toothless on native illumos since all performing memory locking will possess the appropriate privilege to bypass the limit.\n\nExplicit advertisement of this fact should be present in the man page documentation to avoid any confusion about perceived rctl overages."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":22,"deletions":-1}],"sizeInsertions":70,"sizeDeletions":-15},{"number":"3","revision":"395cef7e24dda5ca46c875361bf0fd23489eebbf","parents":["116dc71c1ce421b83a11edca6fe15122f4b49adc"],"ref":"refs/changes/70/1870/3","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493407232,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493407859,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493412685,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493408874,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/man/man5/resource_controls.5","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":22,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-18},{"number":"4","revision":"93e361ffe9d85e57b16ae7bb3ada12a45463775d","parents":["6868c57d2033d43b327fe6549e9f1f552eae1e86"],"ref":"refs/changes/70/1870/4","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493413921,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493407859,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493412685,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493408874,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/man/man5/resource_controls.5","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":22,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-18},{"number":"5","revision":"3661208596c321e7fff78aa2bede68d33cf6217b","parents":["6868c57d2033d43b327fe6549e9f1f552eae1e86"],"ref":"refs/changes/70/1870/5","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493413993,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1493414001,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493407859,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493412685,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493408874,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/man/man5/resource_controls.5","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/syscall/lx_mem.c","type":"MODIFIED","insertions":44,"deletions":-3},{"file":"usr/src/uts/common/os/rctl.c","type":"MODIFIED","insertions":4,"deletions":-11},{"file":"usr/src/uts/common/os/rctl_proc.c","type":"MODIFIED","insertions":22,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-18}],"allReviewers":[{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}]}