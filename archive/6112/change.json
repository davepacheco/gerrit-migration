{"project":"joyent/sdc-booter","branch":"master","id":"I704dd6fab7f7513b1ed9abe12789f4c51560e5fc","number":"6112","subject":"TRITON-1333 Always include networking.json boot module when booting CNs Reviewed by: Cody Peter Mello \u003cmelloc@writev.io\u003e Reviewed by: Jason King \u003cjason.king@joyent.com\u003e Approved by: Cody Peter Mello \u003cmelloc@writev.io\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/6112","commitMessage":"TRITON-1333 Always include networking.json boot module when booting CNs\nReviewed by: Cody Peter Mello \u003cmelloc@writev.io\u003e\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nApproved by: Cody Peter Mello \u003cmelloc@writev.io\u003e\n","createdOn":1555339798,"lastUpdated":1556096865,"open":false,"status":"MERGED","comments":[{"timestamp":1555339798,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1555339803,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit c5201ea69dd7e32d4f8a4b6c8c24002756f6885c\n    \n    TRITON-1333 Always include networking.json boot module when booting CNs"},{"timestamp":1555339828,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555342458,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1555350029,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1555425308,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1555425313,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit c36a271429a2a1b5e6834ad77318394251b93dc7\n    \n    TRITON-1333 Always include networking.json boot module when booting CNs"},{"timestamp":1555425349,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555425356,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nCannot see why not adding the option to disable boot time files if that\u0027s what user wants. Done!"},{"timestamp":1555426610,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1555426764,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1555445363,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1555521990,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1555521995,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit f46b3711a878594eae717276a3bf39cffe5e4570\n    \n    TRITON-1333 Always include networking.json boot module when booting CNs"},{"timestamp":1555522020,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555522364,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1555522456,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(1 comment)\n\nI\u0027m just making a new image including Cody\u0027s suggested change. Once I\u0027ve verified it\u0027s behaving as expected I\u0027ll bug somebody else for IA+1. Thanks folks!"},{"timestamp":1555522944,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1555864069,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n\u003e I\u0027m just making a new image including Cody\u0027s suggested change. Once\n \u003e I\u0027ve verified it\u0027s behaving as expected I\u0027ll bug somebody else for\n \u003e IA+1. Thanks folks!\n\nI forgot to say that testing went well after adding Cody\u0027s suggested change: Files are properly cached, networking.json file is received by the CNs when not explicitly configured to avoid it ... I think this is ready for IA+1"},{"timestamp":1556056166,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1556096850,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1556096865,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"704dd6fab7f7513b1ed9abe12789f4c51560e5fc","parents":["9aad9f29295fdafaa6c15ed61f61070e46b8051f"],"ref":"refs/changes/12/6112/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1556096850,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555522020,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522364,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522944,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556056166,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1556096865,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"lib/dhcpd.js","type":"MODIFIED","insertions":10,"deletions":-8},{"file":"sapi_manifests/dhcpd/template","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":41,"sizeDeletions":-36},"patchSets":[{"number":"1","revision":"06c909cda9d1d8a4bf1bee00b24864ce4b73af47","parents":["9aad9f29295fdafaa6c15ed61f61070e46b8051f"],"ref":"refs/changes/12/6112/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1555339798,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555339828,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555342458,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"comments":[{"file":"sapi_manifests/dhcpd/template","line":22,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"As far as I\u0027m aware, there\u0027s no reason people should want to disable boot-time files, but in case there is, perhaps we should add something just after \"allow_missing_class_id\" like:\n\n    {{#disable_boot_time_files}}\"disableBootTimeFiles\": true,{{/disable_boot_time_files}}\n\nSo that anyone who\u0027s not using fabrics will have a path out when they upgrade."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":28,"deletions":-25},{"file":"lib/dhcpd.js","type":"MODIFIED","insertions":10,"deletions":-8},{"file":"sapi_manifests/dhcpd/template","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":38,"sizeDeletions":-34},{"number":"2","revision":"58c62f4de9e1513bba6d27f9a4741978b8f9e379","parents":["9aad9f29295fdafaa6c15ed61f61070e46b8051f"],"ref":"refs/changes/12/6112/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1555425308,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555426764,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555425349,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555426610,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"comments":[{"file":"lib/cache.js","line":247,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Sorry for not noticing this the first time, but I think that \"admin\" is the wrong value to use here when running in a setup with multiple admin NIC tags (like \"admin_rack_99\"). I think that in stepFilterToMacs() we should be saving n.nic_tag in addition to n.mac, and using that value here."},{"file":"lib/cache.js","line":247,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Thanks for finding it!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":28,"deletions":-25},{"file":"lib/dhcpd.js","type":"MODIFIED","insertions":10,"deletions":-8},{"file":"sapi_manifests/dhcpd/template","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":39,"sizeDeletions":-34},{"number":"3","revision":"0c3baeaafec24e7950c2eecf31f71c7d083877e8","parents":["9aad9f29295fdafaa6c15ed61f61070e46b8051f"],"ref":"refs/changes/12/6112/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1555521990,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522364,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556056166,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555522020,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522944,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"lib/dhcpd.js","type":"MODIFIED","insertions":10,"deletions":-8},{"file":"sapi_manifests/dhcpd/template","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":41,"sizeDeletions":-36},{"number":"4","revision":"704dd6fab7f7513b1ed9abe12789f4c51560e5fc","parents":["9aad9f29295fdafaa6c15ed61f61070e46b8051f"],"ref":"refs/changes/12/6112/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1556096850,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522364,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556056166,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555522020,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1556096865,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555522944,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":30,"deletions":-27},{"file":"lib/dhcpd.js","type":"MODIFIED","insertions":10,"deletions":-8},{"file":"sapi_manifests/dhcpd/template","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":41,"sizeDeletions":-36}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}