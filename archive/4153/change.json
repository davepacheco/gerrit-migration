{"project":"joyent/illumos-joyent","branch":"master","id":"Ia33f24fd1b0665ec1cb9f57b5e860fed1d393793","number":"4153","subject":"OS-7003 Initial xsave xstate_bv should not include all features OS-6917 rtld should conditionally save AVX-512 state Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Jerry Jelinek \u003cjerry.","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/4153","commitMessage":"OS-7003 Initial xsave xstate_bv should not include all features\nOS-6917 rtld should conditionally save AVX-512 state\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nReviewed by: Bryan Cantrill \u003cbryan@joyent.com\u003e\nApproved by: Alex Wilson \u003calex.wilson@joyent.com\u003e\n","createdOn":1528398970,"lastUpdated":1528757715,"open":false,"status":"MERGED","comments":[{"timestamp":1528398970,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1528403645,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"Patch Set 1: Code-Review+1\n\n(6 comments)"},{"timestamp":1528426821,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(9 comments)\n\nlooks pretty good on a first pass"},{"timestamp":1528470498,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(21 comments)"},{"timestamp":1528505067,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2."},{"timestamp":1528505100,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(36 comments)\n\nThere were several issues with xsaveopt that make it not suitable for our use case due to how its optimizations work and our use of the stack. I\u0027ve eliminated the use of that."},{"timestamp":1528535860,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1528585187,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1528585923,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3."},{"timestamp":1528586089,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1528707371,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\n(2 comments)\n\nI\u0027m not quite clear on why xsaveopt was removed? Are we worried about the linear address being the same between different contexts?"},{"timestamp":1528709953,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\nOh, also, and I know it\u0027s pure distraction, but you could remove fpu_probe_pentium_fdivbug (both definition and fp.h), fp.h:fpu_pentium_fdivbug"},{"timestamp":1528716062,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\nI see you answer my xsaveopt question elsewhere from this gerrit (and it\u0027s what I guessed); please ignore."},{"timestamp":1528726221,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 3:\n\n(1 comment)\n\nThis looks good to me. I only had one small nit in addition to John\u0027s last few nits."},{"timestamp":1528732988,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 3: Code-Review+1\n\n(2 comments)"},{"timestamp":1528739594,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Code-Review+1\n\nLooks good, modulo jlevon\u0027s comments about typos"},{"timestamp":1528740246,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(5 comments)"},{"timestamp":1528740256,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 4."},{"timestamp":1528740716,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1528742070,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1528752535,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1528755882,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1528757316,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1528757626,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1528757696,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1528757715,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"6","revision":"a33f24fd1b0665ec1cb9f57b5e860fed1d393793","parents":["2d24d386afb2debdcfd0eb0aa496b2642ce2e7b7"],"ref":"refs/changes/53/4153/6","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528757696,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528740716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528742070,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528752535,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528755882,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528757626,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"SUBM","value":"1","grantedOn":1528757713,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-219},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-790},"patchSets":[{"number":"1","revision":"e4d47742f1f3df75d9dd0cf5184d612dbe3ecea3","parents":["788e26d53d698f1ae7fc91da6c1c4cd40d05dfd8"],"ref":"refs/changes/53/4153/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528398970,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528403645,"by":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"}}],"comments":[{"file":"usr/src/cmd/ptools/pargs/pargs.c","line":319,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"Grammar if you feel like it"},{"file":"usr/src/cmd/ptools/pargs/pargs.c","line":319,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/ptools/pargs/pargs.c","line":806,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I\u0027m not clear what the value of repeating this information is? Isn\u0027t \"AT_SUN_FPSIZE 0x...\" obvious enough? If anything, a decoder for AT_SUN_FPTYPE seems more useful."},{"file":"usr/src/cmd/ptools/pargs/pargs.c","line":806,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Fair enough, I\u0027ll remove it."},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"If this is correct, then I don\u0027t understand why..."},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ll add a comment that explains the sizing here. Basically the original save and restore routines which I\u0027ve kept around look at the hardware capabilities and save and restore the ABI based floating point registers that are used to pass arguments %xmm0-\u003e%xmm7. Because there are 8 registers to save and each one has up to 512 bytes in size in the zmm case.\n\nThat said, it should really be 8 * 64, not 8 * 512."},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I think you mean \"512 bits\" not bytes here, and that was also the source of my complaint, this should indeed be 8 * 64."},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, hopefully the new comment makes this clear."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":57,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"mandates"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":57,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":68,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Redundant with the first sentence of the next \u0027graph.  I would omit it."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":68,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"passes up, not down"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"one vote for \"passes down\" (the kernel representing heavens above)"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Counterpoint: upcalls :)"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve eliminated the directional sense from the comment."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":83,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":91,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"Comment here could be clearer"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":91,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":137,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"We lost the \u0027.save_*\u0027 names and now this is saving only %ymm?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":137,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Sorry, that happened at one point because of duplicates. I\u0027ll restore that."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":139,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"and this %zmm"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":139,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":179,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"ditto?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":179,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":228,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"An \"XSAVE_HEADER_OFF\" define might be nice, or even a XSAVE_ZERO_HEADER macro?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":228,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":256,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"xsaveopt?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":256,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Sigh, thanks."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":272,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"Out of interest, what does this ARGSUSED end up being for?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":272,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No idea, it was there in the original."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":319,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"grammar: can drop the comma"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":319,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":355,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Isn\u0027t the frame-pointer prolog missing here?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":355,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, it\u0027s not. Please see the comment that starts all this. Specifically the glue has already pushed our frame pointer. I\u0027ll add to the comment."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":581,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Any reason not to use the more C-like comment style here?"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":581,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s what was always there. I\u0027ll change it for you."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":676,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"needs grammar fix"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":676,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":706,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"restore\""},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":706,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":655,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"the\""},{"file":"usr/src/uts/common/exec/elf/elf.c","line":655,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"Is not conditioning this actually fine?  I can\u0027t remember."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"The padding is fine, IIRC, but I would considering guarding it with _amd64 ifdefs for now, to avoid the cost on platforms where it\u0027s useless."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"It can go join our COMMPAGE friend on line 639"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":658,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It was due to the way I padded, but I\u0027ve made it x86 only for now."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1088,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"wrap the addition checks in this guard if the padding becomes amd64-ifdef-conditional"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1088,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1089,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"With AT_386_FPINFO_FNSAVE being 0, this gets a bit weird. Any reason we can\u0027t just make that define be ...*NONE and explicitly check it here? We could also presume that a non-zero return value *must* have populated fpsize."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1089,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I guess that\u0027s reasonable. Given that we don\u0027t care about i386, there\u0027s probably no reason to treat AT_386_FPINFO_FNSAVE as useful."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1096,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Should we even add these entries for a 32-bit process? Especially given this value over-estimates in such a case."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1096,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think the size is actually accurate for them. While they can\u0027t access that region, they still need to be able to allocate space for it per the SDM\u0027s note on \u0027MEMORY ACCESSES BY THE XSAVE FEATURE SET\u0027."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1098,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: all the other \"calls\" omit the \u0027;\u0027"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1098,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Actually it\u0027s already grossly inconsistent. It\u0027d be nice if we could fix ADDAUX() to be a well-behaved macro and fix up the weirdos instead"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1098,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1098,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"For the moment I\u0027ve removed my additions."},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1101,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: omit the \u0027;\u0027?"},{"file":"usr/src/uts/common/exec/elf/elf.c","line":1101,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/auxv.h","line":209,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Perhaps while you\u0027re here, remove this useless-for-a-while comment?"},{"file":"usr/src/uts/common/sys/auxv.h","line":209,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I had added it originally when there was nothing else. I guess it doesn\u0027t serve much use now. I was just trying to make it clear it had been allocated."},{"file":"usr/src/uts/common/sys/auxv_386.h","line":116,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Seems fine not to have an XSAVEC entry, but it might be worth commenting that we don\u0027t use it?"},{"file":"usr/src/uts/common/sys/auxv_386.h","line":116,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/auxv_386.h","line":122,"reviewer":{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},"message":"I probably missed something, but do you actually need the _AMD distinctions?"},{"file":"usr/src/uts/common/sys/auxv_386.h","line":122,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Well, the problem is that the xsave mechanism is different for these AMD processors. It turns out that rtld doesn\u0027t care about that particular aspect of the mechanism, but I felt it was better to give userland more information. The problem is that some versions of AMD processors basically won\u0027t properly save and restore some of the FPU exception handling. It turns out that the ABI doesn\u0027t mandate that it be saved anyways."},{"file":"usr/src/uts/common/sys/user.h","line":206,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why cater to 32-bit now that it\u0027s gone?"},{"file":"usr/src/uts/common/sys/user.h","line":206,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I wasn\u0027t really trying to use this to clean up i386 at all to make it clearer as to what\u0027s going on."},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":68,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"why isn\u0027t this static?"},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":68,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So it can be dynamically patched at run-time or by /etc/system to override it potentially."},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":68,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"The latter wouldn\u0027t work as it\u0027s over-written unconditionally, but the former: sure."},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":242,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"If you\u0027re going to leave fp_elf inconsistent, can\u0027t we just delete all the 32-bit path?"},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":242,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve changed the default fp_elf to match xsave and deleted the i386 path here."},{"file":"usr/src/uts/intel/ia32/os/fpu.c","line":387,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This change was incorrect. This doesn\u0027t impact what we\u0027re saying is currently correct or not but rather what we should and shouldn\u0027t be saving on the restore. Because the instructions always take our request and bitwise and it xcr0, there\u0027s no reason for us to go through and it with the enable mask and this will also be incorrect if we enable additional features. The correct value here is XFEATURE_FP_ALL."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":19,"deletions":-10},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":71,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-522},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":30,"deletions":-6},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":40,"deletions":-1},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":624,"sizeDeletions":-566},{"number":"2","revision":"1420702887dca20270462919c3b66e2d6f13995f","parents":["788e26d53d698f1ae7fc91da6c1c4cd40d05dfd8"],"ref":"refs/changes/53/4153/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528505067,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":78,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-217},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-786},{"number":"3","revision":"1bbefae39c23e03b1b96adcb505de09aced21390","parents":["788e26d53d698f1ae7fc91da6c1c4cd40d05dfd8"],"ref":"refs/changes/53/4153/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528585923,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528732988,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528739594,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"comments":[{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":67,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"I just wanted to observe that this is an example of your distinctive voice -- like the em dash for me. When I read this grammatical construction, I know that I am in one of your block comments. It has become a comfort of home; please never change in this regard. ;)"},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":67,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"All I ask is exchange is that if future me skips out on the comment, make sure to tell him past me would be gravely disappointed."},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"registers"},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":102,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":104,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"registers"},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","line":104,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":29,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"This whole comment is masterful."},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","line":29,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Thank you."},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":73,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Since you\u0027ve cleaned up a few other things, I think this ifdef is no longer necessary."},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","line":73,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":78,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-217},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-787},{"number":"4","revision":"bb9bb51ae5d37a825e37d730d284ce04079922b4","parents":["788e26d53d698f1ae7fc91da6c1c4cd40d05dfd8"],"ref":"refs/changes/53/4153/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528740256,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528755882,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528742070,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528740716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528752535,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-219},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-790},{"number":"5","revision":"64d4edd9e9a692b04924d759bf32d7f1475c1b10","parents":["2d24d386afb2debdcfd0eb0aa496b2642ce2e7b7"],"ref":"refs/changes/53/4153/5","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528757316,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528755882,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528757626,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528742070,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528740716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528752535,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-219},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-790},{"number":"6","revision":"a33f24fd1b0665ec1cb9f57b5e860fed1d393793","parents":["2d24d386afb2debdcfd0eb0aa496b2642ce2e7b7"],"ref":"refs/changes/53/4153/6","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1528757696,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1528757713,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528755882,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528757626,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528742070,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528740716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528752535,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"usr/src/cmd/ptools/pargs/pargs.c","type":"MODIFIED","insertions":13,"deletions":-11},{"file":"usr/src/cmd/sgs/elfdump/common/corenote.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/cmd/sgs/libconv/common/corenote.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/cmd/sgs/libconv/common/corenote.msg","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/cmd/sgs/rtld/amd64/_setup.c","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"usr/src/cmd/sgs/rtld/amd64/boot_elf.s","type":"MODIFIED","insertions":404,"deletions":-526},{"file":"usr/src/uts/common/exec/elf/elf.c","type":"MODIFIED","insertions":22,"deletions":-5},{"file":"usr/src/uts/common/sys/auxv.h","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/common/sys/auxv_386.h","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"usr/src/uts/common/sys/user.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/i86pc/os/fpu_subr.c","type":"MODIFIED","insertions":124,"deletions":-219},{"file":"usr/src/uts/intel/ia32/os/fpu.c","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"usr/src/uts/intel/sys/fp.h","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":11,"deletions":0}],"sizeInsertions":700,"sizeDeletions":-790}],"allReviewers":[{"name":"Rich Lowe","email":"richlowe@richlowe.net","username":"richlowe"},{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}]}