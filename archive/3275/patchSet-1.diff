commit e1e8918e99f14a72ae9bc784955a94b9bc201d7e (refs/changes/75/3275/1)
Author: Kelly McLaughlin <kelly.mclaughlin@joyent.com>
Date:   2018-01-29T09:56:22-07:00 (1 year, 8 months ago)
    
    TRITON-85 log-scan probe plugin does not work for SMF services that run multiple instances per zone

diff --git a/plugins/lib/log-scan.js b/plugins/lib/log-scan.js
index db880c0..e05c95d 100644
--- a/plugins/lib/log-scan.js
+++ b/plugins/lib/log-scan.js
@@ -101,7 +101,7 @@ LogScanProbe.prototype._getPath = function (callback) {
                         'error getting SMF service path: `svcs -L %s`: %s',
                         self.smfServiceName, stderr)));
                 } else {
-                    self._pathCache = stdout.trim();
+                    self._pathCache = stdout.trim().replace(/\n/g, '\x20');
                     callback(null, self._pathCache);
                 }
             }
@@ -173,7 +173,7 @@ LogScanProbe.prototype.start = function (callback) {
             }, self.period * SECONDS);
 
             self._running = true;
-            self.tail = spawn('/usr/bin/tail', ['-1cF', path]);
+            self.tail = spawn('/usr/bin/tail', ['-1cF', '-q', path]);
             self.tail.stdout.on('data', function (chunk) {
                 if (!self._running) {
                     return;
