{"project":"joyent/sdc-ufds","branch":"master","topic":"joyent/sdc-ufds#3","id":"Ia2bc1ae3a13bff6032259696930a25875c8054c9","number":"6944","subject":"joyent/sdc-ufds#3 want smartlogin to support administrator role","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/6944","commitMessage":"joyent/sdc-ufds#3 want smartlogin to support administrator role\n","createdOn":1569905527,"lastUpdated":1570503162,"open":true,"status":"NEW","comments":[{"timestamp":1569905527,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1569905578,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n /tmp/repo/capi/keys.js\n /tmp/repo/schema/network.js\n /tmp/repo/schema/fwrule.js\n /tmp/repo/schema/authdev.js\n /tmp/repo/schema/sdcaccountuser.js\n /tmp/repo/schema/metadata.js\n /tmp/repo/schema/sdcaccountpolicy.js\n /tmp/repo/schema/sdcimage.js\n /tmp/repo/schema/o.js\n /tmp/repo/schema/amonprobe.js\n /tmp/repo/schema/sdcreplcheckpoint.js\n /tmp/repo/schema/amonprobegroup.js\n /tmp/repo/schema/sdcpackage.js\n /tmp/repo/schema/version.js\n /tmp/repo/schema/resolver.js\n /tmp/repo/schema/datacenter.js\n /tmp/repo/schema/keyapiprivkey.js\n /tmp/repo/schema/limit.js\n /tmp/repo/schema/sdcaccountrole.js\n /tmp/repo/schema/pwdpolicy.js\n /tmp/repo/schema/sdcreplicator.js\n /tmp/repo/schema/foreigndc.js\n /tmp/repo/schema/dclocalconfig.js\n /tmp/repo/schema/ou.js\n /tmp/repo/schema/config.js\n /tmp/repo/schema/blacklist.js\n /tmp/repo/schema/comment.js\n /tmp/repo/schema/sdcaccountresource.js\n /tmp/repo/schema/groupofuniquenames.js\n /tmp/repo/schema/sdcperson.js\n /tmp/repo/schema/sdckey.js\n /tmp/repo/schema/region.js\n /tmp/repo/test/account.test.js\n /tmp/repo/test/bind.test.js\n /tmp/repo/test/capi/customers.test.js\n /tmp/repo/test/mod.test.js\n /tmp/repo/test/pwdpolicy.test.js\n /tmp/repo/test/test.js\n /tmp/repo/test/del.test.js\n /tmp/repo/test/helper.js\n /tmp/repo/test/ufds-replicator/fixtures.js\n /tmp/repo/test/ufds-replicator/replicator.test.js\n /tmp/repo/test/search.test.js\n /tmp/repo/test/add.test.js\n /tmp/repo/test/compare.test.js\n deps/jsstyle/jsstyle -f tools/jsstyle.conf capi.js main.js replicator.js lib/owner.js lib/salt.js lib/ufds.js lib/ufds-replicator/checkpoint.js lib/ufds-replicator/errors.js lib/ufds-replicator/index.js lib/ufds-replicator/operations.js lib/ufds-replicator/instance.js lib/ufds-replicator/replicator.js lib/keys.js lib/index.js lib/schema/index.js lib/schema/validator.js lib/validator/index.js lib/db/compare.js lib/db/search.js lib/db/mod.js lib/db/pre.js lib/db/index.js lib/db/del.js lib/db/bind.js lib/db/common.js lib/db/login_attempt.js lib/db/add.js lib/db/authorize.js lib/db/changelog.js capi/metadata.js capi/limits.js capi/util.js capi/fraud.js capi/server.js capi/login.js capi/customers.js capi/keys.js schema/network.js schema/fwrule.js schema/authdev.js schema/sdcaccountuser.js schema/metadata.js schema/sdcaccountpolicy.js schema/sdcimage.js schema/o.js schema/amonprobe.js schema/sdcreplcheckpoint.js schema/amonprobegroup.js schema/sdcpackage.js schema/version.js schema/resolver.js schema/datacenter.js schema/keyapiprivkey.js schema/limit.js schema/sdcaccountrole.js schema/pwdpolicy.js schema/sdcreplicator.js schema/foreigndc.js schema/dclocalconfig.js schema/ou.js schema/config.js schema/blacklist.js schema/comment.js schema/sdcaccountresource.js schema/groupofuniquenames.js schema/sdcperson.js schema/sdckey.js schema/region.js test/account.test.js test/bind.test.js test/capi/customers.test.js test/mod.test.js test/pwdpolicy.test.js test/test.js test/del.test.js test/helper.js test/ufds-replicator/fixtures.js test/ufds-replicator/replicator.test.js test/search.test.js test/add.test.js test/compare.test.js\n deps/eng/tools/check-copyright -q\n error: capi/keys.js: copyright year not updated to 2019: \u0027 * Copyright (c) 2014, Joyent, Inc.\u0027\n gmake: *** [deps/eng/tools/mk/Makefile.targ:292: check-copyright] Error 1"},{"timestamp":1569905693,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1569905733,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1569906639,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1569907014,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1569942568,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1570060352,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1570060392,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1570060892,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1570451620,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1570503162,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Topic set to joyent/sdc-ufds#3"}],"currentPatchSet":{"number":"3","revision":"a2bc1ae3a13bff6032259696930a25875c8054c9","parents":["5b4625a7e25e8fd3bad2948a8730999d81560eae"],"ref":"refs/changes/44/6944/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1570060352,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1570060392,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570451620,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"capi/keys.js","type":"MODIFIED","insertions":60,"deletions":-2}],"sizeInsertions":60,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"bb949a5d0a3837c1560c394eea31fe96a33b3c83","parents":["5b4625a7e25e8fd3bad2948a8730999d81560eae"],"ref":"refs/changes/44/6944/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1569905527,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1569905578,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"capi/keys.js","type":"MODIFIED","insertions":42,"deletions":-1}],"sizeInsertions":42,"sizeDeletions":-1},{"number":"2","revision":"894187ac2d2bbb3b89699c0eab4421b57a1cbde8","parents":["5b4625a7e25e8fd3bad2948a8730999d81560eae"],"ref":"refs/changes/44/6944/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1569905693,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1569905733,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"capi/keys.js","line":105,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The schema both has uniquemember and uniquememberdefault (in schema/sdcaccountrole.js). Why do we use the default members and not the actual list of members? Or really, what\u0027s the actual difference supposed to be?"},{"file":"capi/keys.js","line":105,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"In the APIs, members in uniquememberdefault have the role apply to them whether they ask for it or not (using the Role: HTTP header), whereas members only in \"uniquemember\" have to ask for it using the Role header.\n\nI don\u0027t think there\u0027s a good analogy for the Role header in the context of smartlogin, so I think for now it\u0027s probably best to just use the uniquememberdefault list, since they haven\u0027t taken any affirmative action to activate the role."},{"file":"capi/keys.js","line":105,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK. That distinction here makes sense. I agree that there\u0027s no good way to make that the case via smartlogin at the moment. Can you add a comment that describes that here?"},{"file":"capi/keys.js","line":105,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Alright, comment added."},{"file":"capi/keys.js","line":134,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I assume we don\u0027t care if there are duplicates that end up in keys[]?"},{"file":"capi/keys.js","line":134,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Correct."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"capi/keys.js","type":"MODIFIED","insertions":44,"deletions":-2}],"sizeInsertions":44,"sizeDeletions":-2},{"number":"3","revision":"a2bc1ae3a13bff6032259696930a25875c8054c9","parents":["5b4625a7e25e8fd3bad2948a8730999d81560eae"],"ref":"refs/changes/44/6944/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1570060352,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570451620,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1570060392,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"capi/keys.js","type":"MODIFIED","insertions":60,"deletions":-2}],"sizeInsertions":60,"sizeDeletions":-2}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}