{"project":"joyent/illumos-joyent","branch":"master","id":"I19815442328f15b5cf5096d3a24f29862cb6b47c","number":"3052","subject":"OS-6494 libipmi: add support for GET_CHASSIS_STATUS command","owner":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"url":"https://cr.joyent.us/3052","commitMessage":"OS-6494 libipmi: add support for GET_CHASSIS_STATUS command\n","createdOn":1512528936,"lastUpdated":1512695634,"open":false,"status":"MERGED","comments":[{"timestamp":1512528936,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 1."},{"timestamp":1512586054,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1512589256,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 2."},{"timestamp":1512591707,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1512599004,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1\n\n(1 comment)\n\nIn general, this looks good. But I have a minor style issue/question."},{"timestamp":1512599476,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 3."},{"timestamp":1512599540,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 3:\n\n(1 comment)\n\nBraces added."},{"timestamp":1512601130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1512685295,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1512695166,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1512695634,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Rob Johnston"}],"currentPatchSet":{"number":"4","revision":"19815442328f15b5cf5096d3a24f29862cb6b47c","parents":["9a212cf317ce1d7fed4fcc798229efeda6ad43f2"],"ref":"refs/changes/52/3052/4","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1512695166,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512601130,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512685295,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1512695634,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libipmi/common/libipmi.h","type":"MODIFIED","insertions":55,"deletions":-1},{"file":"usr/src/lib/libipmi/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":93,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"c52ab9b77c383ef412878d2f4969002e728f6f48","parents":["76ae751c7caf1f881932a20d93fe56c4fd3cd743"],"ref":"refs/changes/52/3052/1","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1512528936,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","line":248,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027m not sure that we can just return ic_data. Other callers duplicate the data before they return it as the data response seems to be from memory allocated from the ipmi transport. In the case of the bmc, it looks like we get all the data into a per-transport buffer and set that back in the command. If we free that, won\u0027t we be freeing the per-transport data which is assumed to exist throughout the lifetime of the transport?"},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","line":248,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Doh!  You\u0027re correct.  I fixed this to allocate mem and memcpy the response."},{"file":"usr/src/lib/libipmi/common/libipmi.h","line":1864,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we have definitions for the power restore policy?"},{"file":"usr/src/lib/libipmi/common/libipmi.h","line":1864,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","type":"MODIFIED","insertions":26,"deletions":-1},{"file":"usr/src/lib/libipmi/common/libipmi.h","type":"MODIFIED","insertions":47,"deletions":-1},{"file":"usr/src/lib/libipmi/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":78,"sizeDeletions":-2},{"number":"2","revision":"f2b81acc9644e0a04050301d63d0eaab4582ee9d","parents":["4c6bbf9bcbf107a79d3b473ac44132d2891f829f"],"ref":"refs/changes/52/3052/2","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1512589256,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512599004,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","line":249,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Since we have the comment here (making this appear to be multiple lines), can we add braces?"},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","line":249,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","type":"MODIFIED","insertions":32,"deletions":-1},{"file":"usr/src/lib/libipmi/common/libipmi.h","type":"MODIFIED","insertions":55,"deletions":-1},{"file":"usr/src/lib/libipmi/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":92,"sizeDeletions":-2},{"number":"3","revision":"1987c66ae9d9b4b092050ecdccf9ce122595a6e4","parents":["4c6bbf9bcbf107a79d3b473ac44132d2891f829f"],"ref":"refs/changes/52/3052/3","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1512599476,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512601130,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512685295,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libipmi/common/libipmi.h","type":"MODIFIED","insertions":55,"deletions":-1},{"file":"usr/src/lib/libipmi/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":93,"sizeDeletions":-2},{"number":"4","revision":"19815442328f15b5cf5096d3a24f29862cb6b47c","parents":["9a212cf317ce1d7fed4fcc798229efeda6ad43f2"],"ref":"refs/changes/52/3052/4","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1512695166,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512601130,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512685295,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1512695634,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/libipmi/common/ipmi_misc.c","type":"MODIFIED","insertions":33,"deletions":-1},{"file":"usr/src/lib/libipmi/common/libipmi.h","type":"MODIFIED","insertions":55,"deletions":-1},{"file":"usr/src/lib/libipmi/common/mapfile-vers","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":93,"sizeDeletions":-2}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}]}