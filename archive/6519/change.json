{"project":"joyent/sdc-designation","branch":"master","topic":"MANTA-2843","id":"I02297184bba569694db1883d820eee478433bc75","number":"6519","subject":"MANTA-2843 Manta zones lacking CPU cap thwart provisioning Reviewed by: Todd Whiteman \u003ctodd.whiteman@joyent.com\u003e Approved by: Todd Whiteman \u003ctodd.whiteman@joyent.com\u003e","owner":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"url":"https://cr.joyent.us/6519","commitMessage":"MANTA-2843 Manta zones lacking CPU cap thwart provisioning\nReviewed by: Todd Whiteman \u003ctodd.whiteman@joyent.com\u003e\nApproved by: Todd Whiteman \u003ctodd.whiteman@joyent.com\u003e\n","createdOn":1561724792,"lastUpdated":1562684969,"open":false,"status":"MERGED","comments":[{"timestamp":1561724792,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 1."},{"timestamp":1561724794,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit f9f5b7fec54474fedf67df20bd1ae1e052f876c2\n    \n    copyright\n    \n    commit 45ae1cd559a987ce02df95d91bca7247e9cf4120\n    \n    m"},{"timestamp":1561724824,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1561724872,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1: Code-Review-1"},{"timestamp":1561726687,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Topic set to MANTA-2843"},{"timestamp":1562595535,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1: -Code-Review"},{"timestamp":1562612073,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1562612642,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1562613455,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1562616351,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nAlso, please bump the package.json (patch level) version."},{"timestamp":1562617397,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 2."},{"timestamp":1562617399,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit fb82a575c75a9c9a0798b30476b34eff4aad5916\n    \n    m"},{"timestamp":1562617431,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562617691,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 3."},{"timestamp":1562617692,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 4f4974becae7a5b85e408af98e4515fa45968327\n    \n    fix nit"},{"timestamp":1562617722,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562629941,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1562684850,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1562684969,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by John Levon"}],"currentPatchSet":{"number":"4","revision":"02297184bba569694db1883d820eee478433bc75","parents":["858790422cc58d439ec29c5ea403dc471e56fa89"],"ref":"refs/changes/19/6519/4","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1562684850,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562617722,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}},{"type":"SUBM","value":"1","grantedOn":1562684969,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"lib/validations.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":32,"deletions":-4},{"file":"test/common.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/validations.test.js","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":54,"sizeDeletions":-10},"patchSets":[{"number":"1","revision":"93ca6a131cb6168a9fdd069fd352d3ad0852576f","parents":["858790422cc58d439ec29c5ea403dc471e56fa89"],"ref":"refs/changes/19/6519/1","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1561724792,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561724824,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":313,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Perhaps a wordier description here, sample:\n  \"Whether to disallow mixing of instances that set cpu_caps with instances that do not set cpu caps on the same compute node.\""},{"file":"docs/index.md","line":313,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I don\u0027t think that would render very well, see:\n\nhttps://github.com/joyent/sdc-designation/blob/master/docs/index.md#defaults\n\nThe existing ones are already too long for the column width, and not very readable.\n\n(I don\u0027t quite understand why we duplicate all this in both sdc-cnapi and sdc-designation anyway...)"},{"file":"docs/index.md","line":313,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Renders and looks fine to me (in Firefox). Do you have a very narrow window?"},{"file":"lib/algorithms/hard-filter-capness.js","line":46,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Add:\n    assert.object(opts.defaults, \u0027opts.defaults\u0027);"},{"file":"test/algorithms/hard-filter-capness.test.js","line":106,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Nit - when an object needs to wrap, it is often cleaner to separate into multiple lines:\n\n  {\n    defaults: { filter_capness: false },\n    vm: {},\n    pkg: { cpu_cap: 100 }\n  }\n\nas this helps to visually see there are three entries (rather than two)."},{"file":"test/algorithms/hard-filter-capness.test.js","line":117,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"again"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/validations.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"test/common.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/validations.test.js","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":46,"sizeDeletions":-9},{"number":"2","revision":"20e3dbcf5c6782614d71881048bcedb3221d03c2","parents":["858790422cc58d439ec29c5ea403dc471e56fa89"],"ref":"refs/changes/19/6519/2","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1562617397,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562617431,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"lib/validations.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":32,"deletions":-4},{"file":"test/common.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/validations.test.js","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":54,"sizeDeletions":-10},{"number":"3","revision":"960babce149df170d850c0830cb1a464f7474bf8","parents":["858790422cc58d439ec29c5ea403dc471e56fa89"],"ref":"refs/changes/19/6519/3","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1562617691,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562617722,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"lib/validations.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":32,"deletions":-4},{"file":"test/common.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/validations.test.js","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":54,"sizeDeletions":-10},{"number":"4","revision":"02297184bba569694db1883d820eee478433bc75","parents":["858790422cc58d439ec29c5ea403dc471e56fa89"],"ref":"refs/changes/19/6519/4","uploader":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"createdOn":1562684850,"author":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562617722,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562629941,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}},{"type":"SUBM","value":"1","grantedOn":1562684969,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/algorithms/hard-filter-capness.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"lib/validations.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/hard-filter-capness.test.js","type":"MODIFIED","insertions":32,"deletions":-4},{"file":"test/common.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/validations.test.js","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":54,"sizeDeletions":-10}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}