{"project":"joyent/sdc-cloudapi","branch":"master","id":"Ib04b26e710a40794f8f7e87cf0cc905da38bd29f","number":"2984","subject":"PUBAPI-1451 Want UpdateNetworkIP Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Reviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e Reviewed by: Dave Eddy \u003cdave@daveeddy.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"url":"https://cr.joyent.us/2984","commitMessage":"PUBAPI-1451 Want UpdateNetworkIP\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\nReviewed by: Dave Eddy \u003cdave@daveeddy.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1511378892,"lastUpdated":1513712962,"open":false,"status":"MERGED","comments":[{"timestamp":1511378892,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 1."},{"timestamp":1511378922,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511795150,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\n(3 comments)\n\nOnly nits at first glance."},{"timestamp":1511811073,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1511811188,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 2."},{"timestamp":1511811217,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511971180,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2:\n\n(5 comments)\n\nSome more substance."},{"timestamp":1511983912,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 2:\n\n(5 comments)"},{"timestamp":1511983920,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 3."},{"timestamp":1511983949,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511986245,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1511987699,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1511993529,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\n(6 comments)"},{"timestamp":1512005293,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1512159597,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 4."},{"timestamp":1512159602,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 3:\n\n(7 comments)"},{"timestamp":1512159630,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1512754754,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1513377065,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(6 comments)"},{"timestamp":1513579379,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 4:\n\n(8 comments)"},{"timestamp":1513579735,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 5."},{"timestamp":1513579766,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513608112,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1513618678,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 5:\n\n(6 comments)"},{"timestamp":1513619544,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 6."},{"timestamp":1513619547,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 5:\n\n(7 comments)"},{"timestamp":1513619610,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513619987,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1513623121,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1513638621,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1\n\nNeeds a rebase ... across quite a few changes."},{"timestamp":1513702253,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1513702284,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing-1\n\n(4 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1513703124,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 8."},{"timestamp":1513703160,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513703547,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 8: Code-Review+1"},{"timestamp":1513706441,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 8: Code-Review+1"},{"timestamp":1513706597,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 8: Code-Review+1 Integration-Approval+1"},{"timestamp":1513712490,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 9."},{"timestamp":1513712528,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513712751,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Uploaded patch set 10."},{"timestamp":1513712825,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10:\n\n\"make check\" passed ok"},{"timestamp":1513712962,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Michael Zeller"}],"currentPatchSet":{"number":"10","revision":"b04b26e710a40794f8f7e87cf0cc905da38bd29f","parents":["35537b5ad7e72fe3a08823ad47a840c164aa9150"],"ref":"refs/changes/84/2984/10","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513712751,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513703160,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703547,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706441,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1513712962,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":127,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":326,"sizeDeletions":-11},"patchSets":[{"number":"1","revision":"a318092416886aebbc0e314d397f21f22ca6ef26","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/1","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1511378892,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511378922,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":8500,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"network\u0027s (?)"},{"file":"docs/index.md","line":8500,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":413,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"space?"},{"file":"lib/endpoints/networks.js","line":413,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":419,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"it\u0027s"},{"file":"lib/endpoints/networks.js","line":419,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"test/networks.test.js","type":"MODIFIED","insertions":82,"deletions":-4}],"sizeInsertions":251,"sizeDeletions":-6},{"number":"2","revision":"e9d2d7fd9251c549a7515b35c1fb6312904703d4","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/2","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1511811188,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511811217,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":8494,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Dumb question: Will this primitive eventually allow other properties besides \"reserved\" to be altered? The name seems awfully generic for just reserving/releasing IP addrs."},{"file":"docs/index.md","line":8494,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I think in the future there will be some things we can place in here.  Today \"reserved\" means taking the IP in and out of the provisioning pool.  I have talked with Cody about adding some other property to napi that actually means __reserved__ in the sense that when the network has more than one owner than the user that sets the IP aside should have exclusive access to it until it is freed. \n\nAnother thing that may eventually fall in here is the primaryIp stuff.  Which actually means make the NIC this ip is associated with primary.  But I don\u0027t think we have that all the way figured out yet."},{"file":"docs/index.md","line":8506,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"\"If {true,TRUE}, take the IP out....\""},{"file":"docs/index.md","line":8506,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"docs/index.md","line":8527,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Also InvalidArgument if \"managed\" is set?"},{"file":"docs/index.md","line":8527,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I am not sure what the best practice is here.  The code currently only looks for that field and ignores everything else you pass in.  Some other parts of the code use a schema and validate the input.  Is that something we think we need here?"},{"file":"docs/index.md","line":8527,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"I meant if \"managed\" is set on the object, not if it\u0027s passed-in that way.  Your code answers my question."},{"file":"lib/endpoints/networks.js","line":438,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Ahh, my document question is answered here, but can you update the docuement?"},{"file":"lib/endpoints/networks.js","line":438,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Will do."},{"file":"test/networks.test.js","line":594,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Should you also test reserved: false?  Maybe back-and-forth just to be sure?"},{"file":"test/networks.test.js","line":594,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Doesn\u0027t hurt to check that we can set it back the other way.  I will add it."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"test/networks.test.js","type":"MODIFIED","insertions":82,"deletions":-4}],"sizeInsertions":251,"sizeDeletions":-6},{"number":"3","revision":"67a262f1c4c6879ae3f37575108507abb5a99412","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/3","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1511983920,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511983949,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512005293,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511987699,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"docs/index.md","line":8500,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"it\u0027s"},{"file":"docs/index.md","line":8500,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"docs/index.md","line":8536,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps use the same UUID as in the \"CLI command\" example?"},{"file":"docs/index.md","line":8536,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":407,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Does this work with a body that passes `{reserved: false}`?\nPerhaps:\n\n```\nif (jsprim.hasKey(req.params, reserved)) {\n    ... MissingParameterError ...\n    return;\n}\n```\n\nand then validate its type. One problem here is that cloudapi\u0027s messy usage of `mapParams:true` for queryParser and bodyParser, we allow values from `req.params` to be from either. If the user did a query param `?reserved\u003dtrue|false` then the req.params.reserved is a string.\n\nWe should be strict here and just allow one of: `true, false, \u0027true\u0027, \u0027false\u0027`. If the given value is out side of those, we should error with InvalidArgumentError.\n\nThen we should have a `var reserved` that is a *boolean*: --`assert.bool(reserved)` -- so that we are clean in passing the value to napi.updateIP. Currently we are probably getting lucky because NAPI (or the napi client) is loosey-goosey about the \u0027reserved\u0027 type."},{"file":"lib/endpoints/networks.js","line":407,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"For now I am going to use \"Object.prototype.hasOwnProperty\" since cloudapi\u0027s jsprim is super old.  I can push another patch set once I verify upgrading jsprim isn\u0027t an issue."},{"file":"lib/endpoints/networks.js","line":411,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This prolly would work better above the conditional. I.e.:\n\nvar reserved \u003d req.params.reserved;\nif (!reserved) {\n..."},{"file":"lib/endpoints/networks.js","line":411,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Changed around because of Trent\u0027s comment anyways.\nWas getting lucky before because of the string evaluating to truthy."},{"file":"lib/endpoints/networks.js","line":422,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Will UpdateNetworkIP eventually be about updating more than just the \u0027reserved\u0027 field? If so, it might be better to just say `\"cannot update an IP on a public network: \" + networkUuid`.\n\nThoughts?"},{"file":"lib/endpoints/networks.js","line":422,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I would say there is definitely a possibility.  I have discussed with Cody a way to truly *reserve* an IP, in the sense that a network co-owner couldn\u0027t effect it at all.\n\nSo I think your suggestion makes sense."},{"file":"lib/endpoints/networks.js","line":439,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Same point as above about making error messages about being allowed to \"update\" rather than specifically which field."},{"file":"lib/endpoints/networks.js","line":439,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":445,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Let\u0027s say \"account\" to not get into \"is this about an RBAC v1 subuser\" discussion."},{"file":"lib/endpoints/networks.js","line":445,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"test/networks.test.js","type":"MODIFIED","insertions":104,"deletions":-4}],"sizeInsertions":273,"sizeDeletions":-6},{"number":"4","revision":"8ec48869597addc2acc0804a5c2d1231a6ecf70c","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/4","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1512159597,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512159630,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":761,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Thanks for this update1 Can we change tabs to spaces, please?"},{"file":"docs/index.md","line":761,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"docs/index.md","line":910,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit (okay if you skip it because we\u0027ve been far from religious on this):  Add a \"## 8.4.0\" section and mention the new ListNetworkIPs and GetNetworkIP and UpdateNetworkIP endpoints.  Then also bump the version in package.json."},{"file":"docs/index.md","line":910,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done.  Unless you want to wait to bump the version once CreateMachine and AddNic\u0027s gets updated."},{"file":"lib/endpoints/networks.js","line":418,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This isn\u0027t exactly what I mean. IIUC using a query param cannot work with the code this way because \"req.params.reserved\" will be a *string* (e.g. \"true\" or \"false\"). I think we should allow string \"true\" and string \"false\". Thoughts?"},{"file":"lib/endpoints/networks.js","line":418,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I originally was going to allow a string or a boolean, but I thought you wanted to allow only a boolean.  I will change it back so that the value gets mapped accordingly."},{"file":"lib/endpoints/networks.js","line":423,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"validated*"},{"file":"lib/endpoints/networks.js","line":423,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":427,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"If `net` is an object it may be best to `assert.object`."},{"file":"lib/endpoints/networks.js","line":427,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":432,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\"IP\" ?"},{"file":"lib/endpoints/networks.js","line":432,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":455,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\"IP\" ?"},{"file":"lib/endpoints/networks.js","line":455,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":475,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"`translateErr` should be used in the immediate callback from  NAPI client calls above, because this will be attempting to translate an error from line 454 (`new InvalidArgumentError`) which is not from NAPI."},{"file":"lib/endpoints/networks.js","line":475,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Oh right, thanks."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":86,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":104,"deletions":-2},{"file":"test/networks.test.js","type":"MODIFIED","insertions":104,"deletions":-4}],"sizeInsertions":294,"sizeDeletions":-10},{"number":"5","revision":"69ce9f1d88da84df67628e9406b01613dd6762ce","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/5","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513579735,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513579766,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":751,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"~/.ssh/id_rsa changed to ~/.ssh/coal_test_user_rsa - was that intentional?"},{"file":"docs/index.md","line":751,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I don\u0027t think it matters but I set it back to whats currently in cloudapi docs"},{"file":"docs/index.md","line":760,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Should this be \"laptop_test\"?"},{"file":"docs/index.md","line":760,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"set back to previous value to match the above comment."},{"file":"lib/endpoints/networks.js","line":398,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"add a second argument to this call\n\n assert.ok(napi, \u0027napi\u0027);"},{"file":"lib/endpoints/networks.js","line":398,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":404,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"should these be asserted?"},{"file":"lib/endpoints/networks.js","line":404,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"I don\u0027t think we need to because they come from the restify handler `path: \u0027/:account/networks/:id/ips/:ip_address\u0027`\n\nA quick glance at a few other endpoints doesn\u0027t show the params passed in this way being asserted.  Anyone else have opinions?"},{"file":"lib/endpoints/networks.js","line":424,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"These case statements should be on the same level of indentation as their switch statement"},{"file":"lib/endpoints/networks.js","line":424,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":439,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"For sanity\u0027s sake, I would add an assert here for reserved\n\n assert.bool(reserved, \u0027reserved\u0027);"},{"file":"lib/endpoints/networks.js","line":439,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"},{"file":"lib/endpoints/networks.js","line":472,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Missed Trent\u0027s suggestion of \"IP\"?"},{"file":"lib/endpoints/networks.js","line":472,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":121,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":320,"sizeDeletions":-11},{"number":"6","revision":"77300c2346a6ca9678b0c9d64a847ea69068c709","parents":["945d2921b9d3d4a91fec80c08cd339c8d0312af0"],"ref":"refs/changes/84/2984/6","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513619544,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513619610,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513638621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513638621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513619987,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513623121,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":123,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":322,"sizeDeletions":-11},{"number":"7","revision":"00900a73763a338d82891e7380d8fb37934ac43a","parents":["35537b5ad7e72fe3a08823ad47a840c164aa9150"],"ref":"refs/changes/84/2984/7","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513702253,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1513702284,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513638621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513638621,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513619987,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513623121,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"lib/endpoints/networks.js","line":454,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: missing semicolon"},{"file":"lib/endpoints/networks.js","line":456,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: function getIP does not always return a value"},{"file":"lib/endpoints/networks.js","line":465,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: function _updateIp does not always return a value"},{"file":"lib/endpoints/networks.js","line":479,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: function updateIp does not always return a value"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":123,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":322,"sizeDeletions":-11},{"number":"8","revision":"caeb5caa2c82a0e4c599124140434dc894de7820","parents":["35537b5ad7e72fe3a08823ad47a840c164aa9150"],"ref":"refs/changes/84/2984/8","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513703124,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513703160,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703547,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706441,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":127,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":326,"sizeDeletions":-11},{"number":"9","revision":"69f6cf0197d3c2ea7ffb70b33c0b89330a3a336c","parents":["01d386de765e6ffca8267fcee0ded9c44f9c4ef0"],"ref":"refs/changes/84/2984/9","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513712490,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513712528,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/machines.js","type":"MODIFIED","insertions":47,"deletions":-20}],"sizeInsertions":47,"sizeDeletions":-20},{"number":"10","revision":"b04b26e710a40794f8f7e87cf0cc905da38bd29f","parents":["35537b5ad7e72fe3a08823ad47a840c164aa9150"],"ref":"refs/changes/84/2984/10","uploader":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"createdOn":1513712751,"author":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513703160,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513706597,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703547,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1513712962,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513706441,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":92,"deletions":-4},{"file":"lib/endpoints/networks.js","type":"MODIFIED","insertions":127,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/networks.test.js","type":"MODIFIED","insertions":106,"deletions":-4}],"sizeInsertions":326,"sizeDeletions":-11}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}]}