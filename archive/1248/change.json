{"project":"joyent/illumos-joyent","branch":"master","id":"I278a073294ad5b2a41ca18aee0abb62fba8c02b6","number":"1248","subject":"OS-5882 epoll fails to wake on certain edge-triggered conditions OS-5884 epoll should not emit POLLNVAL OS-5894 recursive epoll should emit EPOLLRDNORM Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e App","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/1248","commitMessage":"OS-5882 epoll fails to wake on certain edge-triggered conditions\nOS-5884 epoll should not emit POLLNVAL\nOS-5894 recursive epoll should emit EPOLLRDNORM\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1484342168,"lastUpdated":1487024702,"open":false,"status":"MERGED","comments":[{"timestamp":1484342168,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1484348974,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\nThis looks good to me, nice job!\n\nI have one general question. I see that in the old code, for some drivers, there are conditions where *phpp would be set to NULL, but then other drivers never did that. I am not sure that setting to NULL is ever necessary based on the inconsistent behavior. Is that a fair assumption? Some of the comments explicitly state *phpp will be set to NULL for a certain condition. It might be worth fixing those comments if that is not really necessary."},{"timestamp":1484766929,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1484766965,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\nGenerated webrev to make manpage review easier:\nhttps://us-east.manta.joyent.com/patrick.mooney/public/webrev/OS-5882/index.html"},{"timestamp":1484773703,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1484774505,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3."},{"timestamp":1484774546,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(1 comment)\n\nThe webrev has been updated in place."},{"timestamp":1484779150,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1484956230,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1485121695,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(4 comments)\n\nThere\u0027s an important point about the edge-triggered nature of things that I realize I stumbled across here as a couple of different things handle this in different ways. Importantly a driver must not latch its pollwakeup reasons in the face of edge triggered wake ups. While this is generally the case for most drivers, I noticed that av1394 and bpf are opposite examples here. Both which latch activity based on the flag, but we\u0027re taking different behaviors here.\n\nWe should probably go through and audit all the pollwakeups and make sure that the manual page is clear that drivers need to _always_ call pollwakeup, regardless if they think they do or don\u0027t."},{"timestamp":1485275997,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\n(6 comments)"},{"timestamp":1485988230,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4."},{"timestamp":1486150942,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 4:\n\n(1 comment)\n\nLooks good, just one small question on one of the comments."},{"timestamp":1486151210,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1486153847,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5."},{"timestamp":1486159073,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1486489825,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5: Integration-Approval+1\n\n(2 comments)"},{"timestamp":1486489832,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Removed the following votes:\n\n* Integration-Approval+1 by Robert Mustacchi \u003crm@joyent.com\u003e\n"},{"timestamp":1486584263,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1486584286,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 6."},{"timestamp":1486643144,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1486668720,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1486742990,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6:\n\nThe primary test-vector for this change was edge-triggered epoll on an eventfd resource going from only-writable to writable-and-readable (As discovered in SOLENG-15).  This and numerous other cases have been written into an epoll test suite, which will be merged later, pending clean-up for the gate.  Results of the test suite report the noted issues (failed POLLET wakeups and nested epoll emitting EPOLLRDNORM) being fixed and no new regressions appearing.  There are a few failing tests, since the suite has been expanded, but they are covered by other newly-created tickets.\n\nThe POLLET fixes to other drivers scattered throughout the system make for a more difficult testing situation.  Without access to such devices, confidence in the changes has been established by code review only."},{"timestamp":1487014514,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6:\n\nRunning through the node.js test suite, there don\u0027t appear to be any regressions."},{"timestamp":1487017498,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6:\n\nI ran though the nginx-tests suite, which while noisy, did not yield regressions over ub14.04 running in KVM."},{"timestamp":1487020537,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1487022229,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1487022953,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1487024702,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"8","revision":"278a073294ad5b2a41ca18aee0abb62fba8c02b6","parents":["58139cb77120429064b87fbbecc56d459c914e7f"],"ref":"refs/changes/48/1248/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1487022953,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486643144,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486668720,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487020537,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1487024702,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":18,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":16,"deletions":-10},{"file":"usr/src/uts/common/io/bpf/net/bpfdesc.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":393,"sizeDeletions":-334},"patchSets":[{"number":"1","revision":"82d43551d87470a7f76c2555aee4aac56fbad665","parents":["89604c6d5bf9b0d8361322d21c4aa656db64c425"],"ref":"refs/changes/48/1248/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1484342168,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":56,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":4,"deletions":-7},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":319,"sizeDeletions":-290},{"number":"2","revision":"14866fc7f4fd88a8229133d7fc69de0b89e7b3db","parents":["d5b602f5cc96d493c2cbc1851eefbc5b297e6576"],"ref":"refs/changes/48/1248/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1484766929,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/man/man9e/chpoll.9e","line":196,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"change to \"be\""},{"file":"usr/src/man/man9e/chpoll.9e","line":196,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I reworded the entire sentence."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":12,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":56,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":4,"deletions":-7},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":331,"sizeDeletions":-294},{"number":"3","revision":"eb6348790f4ec42f98e82dec514b0fe985943772","parents":["fc435556d467045ee91d32e2cfc87544660ff9b7"],"ref":"refs/changes/48/1248/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1484774505,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/man/man9e/chpoll.9e","line":198,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I was a little thrown off on this part of the sentence since it is not immediately clear what \"if possible\" means and the man page doesn\u0027t really help clarify that. Maybe noting this is driver-dependent here would be  good enough to set people on track if they need help."},{"file":"usr/src/man/man9e/chpoll.9e","line":198,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I agree. I would probably change this to something like, the chpoll entry point must always set phpp and prepare to call pollwakeup()."},{"file":"usr/src/man/man9e/chpoll.9e","line":198,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027ll work on rewording this."},{"file":"usr/src/uts/common/fs/fs_subr.c","line":430,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"We never appear to call pollwakeup on this pollhead. Is that a problem for edge triggeredness?"},{"file":"usr/src/uts/common/fs/fs_subr.c","line":430,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"You raise a good point here.  After further investigation, it appears that Linux epoll tosses EPERM during any attempt to epoll on regular files.  In this context, it would make sense to do so only when POLLET is asserted, so as to preserve the non-ET behavior of devpoll."},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","line":5776,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Like Robert pointed out in fspoll(), tossing EPERM would be appropriate here when POLLET is present."},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","line":369,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think it makes sense to leave this as conditional on POLLIN. Can you confirm my reasoning? Basically POLLET merely mean we should yield the pollhead, but we shouldn\u0027t call pollwakeup unless we still have a request for that original event, is that right? In other words, just because we get POLLET on its own, doesn\u0027t mean that we should trigger events. Is that right?"},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","line":369,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"We should trigger on relevant events.  If POLLIN is absent from the events of interest, it\u0027s acceptable that we never call pollwakeup() since that\u0027s the only event we would emit.\n\nI think this logic correctly handles that."},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","line":1100,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Nothing ever calls pollwakeup() on this pollhead. Is that a problem?"},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","line":1100,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027ll reexamine this driver.  Without pollwakeup(), it might be sensible to emit EPERM for those using POLLET."},{"file":"usr/src/uts/common/io/bpf/bpf.c","line":1425,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is it correct to start the read timeout if POLLIN/POLLRDNORM aren\u0027t specified?"},{"file":"usr/src/uts/common/io/bpf/bpf.c","line":1425,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps not.  I\u0027ll investigate further."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":12,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":56,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":4,"deletions":-7},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":331,"sizeDeletions":-294},{"number":"4","revision":"7b56e5b21d44f6b0c3b6a7eb0f608770a9599597","parents":["97a9d4eedae418e2f8797e1add2f1139643a7932"],"ref":"refs/changes/48/1248/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1485988230,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","line":1088,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Since you removed the pollhead from the struct it seems that this comment might be confusing to someone coming to this code for the first time. Maybe just removing this portion of the comment would be fine to avoid any confusion?"},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","line":1088,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Sure, I\u0027ll clean this up."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":381,"sizeDeletions":-323},{"number":"5","revision":"4f540b5267515ab82ec0f668ad62995553283caf","parents":["1b4b813ed495a619f8cfe67a9dd3105c38ffe3ce"],"ref":"refs/changes/48/1248/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1486153847,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486159073,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"comments":[{"file":"usr/src/uts/common/fs/fs_subr.c","line":427,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is EPERM really what Linux returns for this?"},{"file":"usr/src/uts/common/fs/fs_subr.c","line":427,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"EPERM is what is returned by epoll_ctl() when attempting to add an fd which is not supported by epoll.  For excluding narrow cases like the lack of POLLET support, it seems like a decent way to follow the expected semantics."},{"file":"usr/src/uts/common/io/bpf/bpf.c","line":1433,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is it correct for us to issue a pollhead when we never call pollwakeup? In dcf and others you\u0027re not doing this to indicate that it\u0027s not cacheable."},{"file":"usr/src/uts/common/io/bpf/bpf.c","line":1433,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027ll rip the unfinished pollhead code out of bpf."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":381,"sizeDeletions":-323},{"number":"6","revision":"6d3a833783597b2fa590d14f12e2d9c4aec2805c","parents":["a9a5731324812252a67cf8da58a97d8818f69ebb"],"ref":"refs/changes/48/1248/6","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1486584286,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486668720,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487020537,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486643144,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":18,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":16,"deletions":-10},{"file":"usr/src/uts/common/io/bpf/net/bpfdesc.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":393,"sizeDeletions":-334},{"number":"7","revision":"6a2b83bb332aaa9b43b8ec1cfb2b38d938e9da49","parents":["58139cb77120429064b87fbbecc56d459c914e7f"],"ref":"refs/changes/48/1248/7","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1487022229,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486668720,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487020537,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486643144,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":18,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":16,"deletions":-10},{"file":"usr/src/uts/common/io/bpf/net/bpfdesc.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":393,"sizeDeletions":-334},{"number":"8","revision":"278a073294ad5b2a41ca18aee0abb62fba8c02b6","parents":["58139cb77120429064b87fbbecc56d459c914e7f"],"ref":"refs/changes/48/1248/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1487022953,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486668720,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487020537,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486643144,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1487024702,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"usr/src/man/man9e/chpoll.9e","type":"MODIFIED","insertions":18,"deletions":-4},{"file":"usr/src/uts/common/crypto/api/kcf_random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/fs_subr.c","type":"MODIFIED","insertions":21,"deletions":-2},{"file":"usr/src/uts/common/fs/ufs/ufs_vnops.c","type":"MODIFIED","insertions":64,"deletions":-100},{"file":"usr/src/uts/common/inet/sockmods/socksdp.c","type":"MODIFIED","insertions":11,"deletions":-14},{"file":"usr/src/uts/common/io/1394/targets/av1394/av1394_async.c","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"usr/src/uts/common/io/1394/targets/dcam1394/dcam.c","type":"MODIFIED","insertions":23,"deletions":-36},{"file":"usr/src/uts/common/io/bpf/bpf.c","type":"MODIFIED","insertions":16,"deletions":-10},{"file":"usr/src/uts/common/io/bpf/net/bpfdesc.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/io/devpoll.c","type":"MODIFIED","insertions":126,"deletions":-27},{"file":"usr/src/uts/common/io/eventfd.c","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/io/ib/clients/of/sol_ucma/sol_ucma.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/ib/clients/of/sol_umad/sol_umad.c","type":"MODIFIED","insertions":13,"deletions":-25},{"file":"usr/src/uts/common/io/ib/clients/of/sol_uverbs/sol_uverbs_event.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/io/inotify.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/uts/common/io/mem.c","type":"MODIFIED","insertions":5,"deletions":-4},{"file":"usr/src/uts/common/io/random.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/rsm/rsm.c","type":"MODIFIED","insertions":11,"deletions":-13},{"file":"usr/src/uts/common/io/signalfd.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/io/srn.c","type":"MODIFIED","insertions":6,"deletions":-4},{"file":"usr/src/uts/common/io/vnd/vnd.c","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"usr/src/uts/common/os/streamio.c","type":"MODIFIED","insertions":9,"deletions":-20},{"file":"usr/src/uts/common/sys/1394/targets/dcam1394/dcam.h","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/common/xen/io/evtchn_dev.c","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"usr/src/uts/common/xen/io/xpvtap.c","type":"MODIFIED","insertions":5,"deletions":-7},{"file":"usr/src/uts/intel/io/heci/heci_main.c","type":"MODIFIED","insertions":12,"deletions":-12},{"file":"usr/src/uts/intel/io/ipmi/ipmi_main.c","type":"MODIFIED","insertions":3,"deletions":-5}],"sizeInsertions":393,"sizeDeletions":-334}],"allReviewers":[{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}