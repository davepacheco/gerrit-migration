{"project":"joyent/sdc-imgapi","branch":"master","id":"I3ccdabddafbb96833769b28fa249639213925e34","number":"3590","subject":"TRITON-53 x-account image clone Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/3590","commitMessage":"TRITON-53 x-account image clone\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1520880306,"lastUpdated":1530145587,"open":false,"status":"MERGED","comments":[{"timestamp":1520880306,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1520880309,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 1ca0475ec7c116d7284f930ab4e8c75ba29869d0\n    \n    TRITON-53 x-account image clone"},{"timestamp":1520880335,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521133742,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1521133744,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 7486ddb4542444e73d1f629861c29fe2398be8c5\n    \n    follow all origin images\n    \n    commit b7277c438a0b31f0dec4658bae276a618ca7dd8b\n    \n    update comments"},{"timestamp":1521133773,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1523388588,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3."},{"timestamp":1523388590,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 06ccd8f4deecf82c4f8c962fd78e7faeb3b45215\n    \n    follow all origin images\n    \n    commit 4bad5374bd7944d4dba27a7fd596cdd34962916c\n    \n    update comments\n    \n    commit 58f1681fe31291427f6f38b521302de35bc6b256\n    \n    TRITON-53 x-account image clone"},{"timestamp":1523388618,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1523454512,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1523476556,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 4."},{"timestamp":1523476557,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 0aabc96f4faf73f834d60fb84e41ced360cd8b88\n    \n    typo fix for docs"},{"timestamp":1523476577,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1523476585,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1524489545,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4:\n\n(16 comments)"},{"timestamp":1524489578,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4:\n\nAlso: tests!"},{"timestamp":1524761629,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\n(16 comments)"},{"timestamp":1524761667,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5."},{"timestamp":1524761668,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 61717d3ef7a644d3d5636c5aafe81f1e5178c8b7\n    \n    cr updates\n    \n    commit 0d02c5ea96aa70cc2471991ed3206eeef5b6ee7e\n    \n    typo fix for docs\n    \n    commit 61c90cb8ec3223db41f31d92321a3b103cfa59c2\n    \n    follow all origin images\n    \n    commit 558740843f4d510982b3b9385ac5eb17b1e59c54\n    \n    update comments\n    \n    commit 5617b2b226ae94ccaf5ad574cf60cce03450a139\n    \n    TRITON-53 x-account image clone"},{"timestamp":1524761697,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1524783590,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 6."},{"timestamp":1524783592,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit b7951328e4c76692e4c4479ddbc94c62eb7f7856\n    \n    fix return being in the wrong line"},{"timestamp":1524783621,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526291628,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6:\n\n(1 comment)\n\nThe code LGTM. The only thing left are tests.\n\nAlso, I\u0027d get an extra pair of eyeballs on this code. I\u0027ll give a CR+1 once there are tests, but I\u0027m uncomfortable giving IA for imgapi."},{"timestamp":1528227805,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 7."},{"timestamp":1528227806,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 6210d1ba739cce5a14a2ddffe9b193adab3678d6\n    \n    add tests\n    \n    commit ccf70a2ea1f34323109c3f8ce08fa1c364793e13\n    \n    fix return being in the wrong line\n    \n    commit 35e0f625f6c8168878311ffc335fcff638e7d97c\n    \n    cr updates\n    \n    commit 924be0192bfca4c577b3020b9c94f6e641bfab87\n    \n    typo fix for docs\n    \n    commit d3fcfeb6048ce0b2b0e27b89f7fdf65cd8bdfcc1\n    \n    follow all origin images\n    \n    commit ca24283241b634dec3e5f6fc3511378bbd9783f0\n    \n    update comments\n    \n    commit cca8246aa5ad4c7718e6da0f9aa0c54c1d106439\n    \n    TRITON-53 x-account image clone"},{"timestamp":1528227835,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1528228234,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 8."},{"timestamp":1528228236,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 32b6fda9563a72c81fa1d86a90cb4789027ef87c\n    \n    fix whitespace"},{"timestamp":1528228265,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528828792,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 8: Code-Review+1\n\nLGTM.\n\nI leave IA for someone with deeper understanding of imgapi."},{"timestamp":1528920862,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 9."},{"timestamp":1528920863,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit 860c1078075ed800465b7c907a97457890959772\n    \n    do not remove user from the image.acl after cloning"},{"timestamp":1528920892,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529605303,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 10."},{"timestamp":1529605305,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit 9a4d19e1b62f3ae5eab619589936eab3f46c63db\n    \n    do not remove user from the image.acl after cloning\n    \n    commit 269423a5acb4e14c11d8b8d81fbf2ac58bb2bf8c\n    \n    fix whitespace\n    \n    commit 44d6819933f9eb89fd7e2f5ebaa6d7df043b1ba8\n    \n    add tests\n    \n    commit a5b8e03d3957aa5abd64e615c7ae26d0bd4b5f34\n    \n    fix return being in the wrong line\n    \n    commit b665cad33b2c4838460282d8d0392366b7bb9dbc\n    \n    cr updates\n    \n    commit 6034a6db41926f314f0b2db7ff1f0e3582d39403\n    \n    typo fix for docs\n    \n    commit 1630d0ff08f03b25052c53aa1cb66929a3191c86\n    \n    follow all origin images\n    \n    commit d5c9480107258a79c092e1640709fb169a2f0a17\n    \n    update comments\n    \n    commit 6994c9a299b9f5184ea830439819f70a8381e45f\n    \n    TRITON-53 x-account image clone"},{"timestamp":1529605332,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530055089,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 10:\n\n(12 comments)"},{"timestamp":1530122472,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\n(12 comments)"},{"timestamp":1530122483,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 11."},{"timestamp":1530122484,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 3097ade2e48ac25cfcb1f29adeddd5f873ac5d28\n    \n    remove bodyParser - not needed as no body is required\n    \n    commit bf190250caba118f7a45890012faa4461cabfeba\n    \n    add \u0027cleanup\u0027 to cleanup error message\n    \n    commit 3970cf170102e2e4b42b0fb8800c3bdf5386edf5\n    \n    use ctx.originImage instead of separate function variable\n    \n    commit f691685d70b844e6bd1b04b5f08cb5282901c013\n    \n    update clone image comment\n    \n    commit b2d853fb0f4356181b47c6a12b497eccfcf5858d\n    \n    add constants.MAX_ORIGIN_DEPTH\n    \n    commit c32cf0279cc392724321e3e3a083f1aec8c4c293\n    \n    remove answered comment/question on what image types are supported\n    \n    commit d60ccd56c088fbebdcc62e1ced326f1e95799783\n    \n    ensure cloneImage can only called in \u0027dc\u0027 mode\n    \n    commit 8d5cc0bc29fb5f14c053c51e95c262d6fc86302a\n    \n    rename ImageNotShared to ImageNotSharedError\n    \n    commit 150dfa56c86de4d2cd5f7feb867e8697e065bb20\n    \n    replace apiDeleteImage image removal parts with an image.delete() call"},{"timestamp":1530122514,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530133088,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 11: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1530133426,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 12: Commit message was updated."},{"timestamp":1530133491,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 13."},{"timestamp":1530133492,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit 120e8a83e1e1f4811965929531eb9cb649e1febb\n    \n    remove origin image check against state.unactivated - should never occur"},{"timestamp":1530133503,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\n(1 comment)"},{"timestamp":1530133521,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530134185,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 13: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1530136756,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\n(1 comment)"},{"timestamp":1530140681,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 10:\n\n(1 comment)"},{"timestamp":1530142965,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\n(1 comment)"},{"timestamp":1530143424,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 14."},{"timestamp":1530143425,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 14:\n\nNew commits:\n    \n    commit f0735591f204b96bddae7121b9c13c8c88243ae0\n    \n    move image.activated assert into a validation check"},{"timestamp":1530143454,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530145247,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 14: Code-Review+1 Integration-Approval+1"},{"timestamp":1530145587,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"14","revision":"3ccdabddafbb96833769b28fa249639213925e34","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/14","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1530143424,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530143454,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530145247,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530145247,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1530145587,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/constants.js","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":332,"deletions":-63},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-68},"patchSets":[{"number":"1","revision":"61a4347f366e0441a1eb12dded3b85863939c1ce","parents":["c439c8880efe13ab63b082603121675a0be93a84"],"ref":"refs/changes/90/3590/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1520880306,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1520880335,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":61,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":308,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":485,"sizeDeletions":-8},{"number":"2","revision":"ceab9c0b1012ff8ed023d82333139eafa9ff2372","parents":["c439c8880efe13ab63b082603121675a0be93a84"],"ref":"refs/changes/90/3590/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1521133742,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521133773,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":61,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":320,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":498,"sizeDeletions":-8},{"number":"3","revision":"45d28cd81f3b288d9397a3a51157909f0bb4c357","parents":["8c681864a96e97adf7b6cdd08618783772751b13"],"ref":"refs/changes/90/3590/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1523388588,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1523388618,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":1908,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Typo."},{"file":"docs/index.md","line":1908,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":61,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":320,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":498,"sizeDeletions":-8},{"number":"4","revision":"7faab0752344c5c3f7b7167c649b5c02410dabb6","parents":["8c681864a96e97adf7b6cdd08618783772751b13"],"ref":"refs/changes/90/3590/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1523476556,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1523476585,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":1907,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I\u0027d move this sentence further down; the first and third sentences work better together."},{"file":"docs/index.md","line":1907,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"docs/index.md","line":1908,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This fragment is confusing.\n\nI\u0027d suggest:\n\nThe newly-cloned image\u0027s `owner` will be set to the `account` param, and have an empty ACL."},{"file":"docs/index.md","line":1908,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"docs/index.md","line":1911,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"with account?\n\nwith that account?\n\nwith the `account` param?\n\nThis is confusing."},{"file":"docs/index.md","line":1911,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Updated to use `account` param."},{"file":"docs/index.md","line":1917,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"The owner\n\nor at least\n\nThe account\n\nIt\u0027s unfortunate that there\u0027s a blend of owner/account throughout the codebase."},{"file":"docs/index.md","line":1917,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":325,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Although most methods in this file don\u0027t assert() their args, I\u0027d recommend improving it by adding assertions to the three new methods in this commit."},{"file":"lib/images.js","line":325,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3974,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Sadly it\u0027ll wrap the line, but still: name this function."},{"file":"lib/images.js","line":3974,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3987,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Extra brackets not needed here, and I think it makes it a tad harder to read.\n\nYour call."},{"file":"lib/images.js","line":3987,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Agreed - fixed."},{"file":"lib/images.js","line":4049,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Name this."},{"file":"lib/images.js","line":4049,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":4107,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Is this desirable?\n\nAnd even if it is: if a user sets an ACL, do we want other users to modify that ACL when cloning?"},{"file":"lib/images.js","line":4107,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"The word \u0027clone\u0027 does mean to make a copy - so I get your point about it not wanting to modify the original.\n\nI was leaning towards it being desirable, as I found it was confusing as a user to see all the duplicate images after cloning.\n\nCurrently, if user A has shared an image with user B (i.e. user B is on the image ACL), currently we don\u0027t have a way for user B to remove themselves from that image ACL, only user A can make that change - so this cloning behaviour was helpful in that regard - but perhaps what would be better is to address the image ACL removal problem.\n\nI had thought about making a separate follow-up feature change to allow user B to remove themselves from an image ACL, where user B issued a delete on the image (this could be under the \"triton image unshare\" cli command or \"triton image delete\" cli command).\n\nWith image ACL removal in place, it would likely be better then for clone to not remove the user from the original ACL, or better yet, to have a --unshare-on-success cli option which could invoke the ACL removal after a successful clone operation.\n\nWhat do you think about this idea?"},{"file":"lib/images.js","line":4107,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Works for me. Still not a fan of the changing of ACLs of an image belonging to someone else, but your reasoning makes sense."},{"file":"lib/images.js","line":4112,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Name this."},{"file":"lib/images.js","line":4112,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":159,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I\u0027d name this function."},{"file":"lib/storage.js","line":159,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":495,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Name this function \"copyFileBetweenImages\""},{"file":"lib/storage.js","line":495,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done - used \"localCopyFileBetweenImages\" and \"mantaCopyFileBetweenImages\" (two functions cannot use the same name)."},{"file":"lib/storage.js","line":507,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Name function."},{"file":"lib/storage.js","line":507,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":546,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I think it might be better off simply passing the done func, like with the \u0027error\u0027 cases."},{"file":"lib/storage.js","line":546,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/storage.js","line":866,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Name this func copyFileBetweenImages"},{"file":"lib/storage.js","line":866,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done - used \"localCopyFileBetweenImages\" and \"mantaCopyFileBetweenImages\" (two functions cannot use the same name)."},{"file":"lib/storage.js","line":880,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Although the func is fairly trivial, I\u0027d still name this one."},{"file":"lib/storage.js","line":880,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":61,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":320,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":498,"sizeDeletions":-8},{"number":"5","revision":"a065c6c1cd3eea4bed06de66c5bc3b83ae229a09","parents":["806153bd3df17bbe12a82872ca3517e00f56674d"],"ref":"refs/changes/90/3590/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1524761667,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524761697,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":333,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":510,"sizeDeletions":-9},{"number":"6","revision":"fea378394f1c549ca9856120aa352ec9e310d126","parents":["806153bd3df17bbe12a82872ca3517e00f56674d"],"ref":"refs/changes/90/3590/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1524783590,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1524783621,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":334,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":511,"sizeDeletions":-9},{"number":"7","revision":"dcc4ea76e868ced5bb253744252fda326ef77871","parents":["2bc6b57da32e8ba5a1791cd07d9fda5522f4cccb"],"ref":"refs/changes/90/3590/7","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1528227805,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1528227835,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"test/image-clone.dc-test.js","line":15,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"indent of 1 space(s) instead of 4"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":334,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":181,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":704,"sizeDeletions":-9},{"number":"8","revision":"574bf8d5f341467d7fb8f58c8579296449064866","parents":["2bc6b57da32e8ba5a1791cd07d9fda5522f4cccb"],"ref":"refs/changes/90/3590/8","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1528228234,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528228265,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528828792,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":334,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":181,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":704,"sizeDeletions":-9},{"number":"9","revision":"b8a3d4ddca50cf946397a68b47d578db6fc20c00","parents":["2bc6b57da32e8ba5a1791cd07d9fda5522f4cccb"],"ref":"refs/changes/90/3590/9","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1528920862,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528920892,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":328,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":691,"sizeDeletions":-9},{"number":"10","revision":"6ab6e80b66f0aec1a4679b46ebd876a631bf3bbb","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/10","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1529605303,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529605332,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":627,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Use \"ImageNotSharedError\" perhaps, like all the other Error class names?"},{"file":"lib/errors.js","line":627,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":577,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Might be good to have apiDeleteImage\u0027s last few pipeline functions change to use this. Could be separate work, though."},{"file":"lib/images.js","line":577,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, that was the plan - a common function the other API endpoints could use. I actually thought I\u0027d done that already, but guess not... done now."},{"file":"lib/images.js","line":584,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"typo"},{"file":"lib/images.js","line":584,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3933,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is this a way for a user to crash IMGAPI?"},{"file":"lib/images.js","line":3933,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, it could be - I\u0027ll move that into a validation check below."},{"file":"lib/images.js","line":3936,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Either here or in the `server.post` chain of handlers, let\u0027s guard on `req._app.mode \u003d\u003d\u003d \u0027dc\u0027`. Then update the docs that this endpoint only exists for \"dc\"-mode IMGAPIs (i.e. not for images.jo and updates.jo)."},{"file":"lib/images.js","line":3936,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done - I also changed it so the cloneImage endpoint is only created when the server is in \u0027dc\u0027 mode."},{"file":"lib/images.js","line":3961,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I can\u0027t think of any reason to deny cloning for the other types. I can\u0027t imagine regular users will ever have access to a type\u003dother image."},{"file":"lib/images.js","line":3961,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3984,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps move this to lib/constants.js."},{"file":"lib/images.js","line":3984,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Probably better to use the `img.activated` boolean param.\n\nHrm, actually... this is checking *origin* images:\n1. Is there anything in CloneImage that is guarding against cloning an unactivated, creating or failed image.state?\n2. It shouldn\u0027t be possible to *have* an unactivated origin image."},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"1. Doesn\u0027t the reqGetImage handler do the activated state checking (i.e. when this account is on the acl list - not the owner). Note that there is also an assert on req._image.activated at the beginning of this function.\n\n2. So just remove it? Or make it an assert? I\u0027m sure operators will never change the state manually ;)"},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"1. You are right about reqGetImage handling that for images not owned by `account`. How about an assert near the top of the function that `assert.notEqual(req._image.owner, account, \u0027cannot clone one\\\u0027s own image\u0027);`?\n\n2. Just removing it is fine. We can cross that road if we ever come to such a case."},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"1. For image owner - this is already caught by this validation check in the cloneImage function:\n\n    if (!req._image.acl || req._image.acl.indexOf(account) \u003d\u003d\u003d -1) {\n        next(new errors.ImageNotSharedError(null, account, image.uuid));\n        return;\n    }\n\nand there are test cases for this (trying to clone one\u0027s own image, or cloning a public image).\n\n\n2. done"},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could I not add myself to the ACL and mess this up? ;)"},{"file":"lib/images.js","line":3995,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"You could - but the worst case is you get a cloned image, so meh :P"},{"file":"lib/images.js","line":4026,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps \"Clone each image, but disable all the top-level image.\"? Specifically, I think \"unactivated\" was meant to be \"disabled\"."},{"file":"lib/images.js","line":4026,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I think that comment was meant for the \u0027create\u0027 step below - to leave the new image in the \u0027unactivated\u0027 state and then activate it after the addFile completed... but that doesn\u0027t really warrant a specific comment (as that is just how regular images are created/activated)."},{"file":"lib/images.js","line":4069,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: could probably put this var on `subctx`, but no biggie."},{"file":"lib/images.js","line":4069,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":4095,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps include \"cleanup\" somewhere in this message so it is clearer when reading that it is about cleaning up for a failed clone."},{"file":"lib/images.js","line":4095,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Changed to \"clone cleanup failure: unable to delete...\""},{"file":"lib/images.js","line":4486,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Why this body parse if the only input param is \"account\" that has to be a *query* param (per the docs at least)?"},{"file":"lib/images.js","line":4486,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Copy paste... I\u0027ll remove it."},{"file":"test/image-clone.dc-test.js","line":39,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Was there a particular reason to not follow the franken-tap4nodeunit style in the other test files? :)"},{"file":"test/image-clone.dc-test.js","line":39,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, I think it was the franken part... ;)"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":60,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":328,"deletions":-6},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":692,"sizeDeletions":-9},{"number":"11","revision":"e576993930e4240adb8e75866e0c8eddf73df95f","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/11","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1530122483,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530122514,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530133088,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530133088,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/constants.js","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":334,"deletions":-63},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":708,"sizeDeletions":-68},{"number":"12","revision":"e1254383292d358c568b26b6d495797512218423","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/12","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1530133426,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530122514,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530133088,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530133088,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/constants.js","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":334,"deletions":-63},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":708,"sizeDeletions":-68},{"number":"13","revision":"5626578a0469d156f540a7c26ead9af15276b254","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/13","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1530133491,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530133521,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530134185,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530134185,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/constants.js","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":327,"deletions":-63},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":701,"sizeDeletions":-68},{"number":"14","revision":"3ccdabddafbb96833769b28fa249639213925e34","parents":["99b4534c0c662495ab9cac2f5e574fa86f391b77"],"ref":"refs/changes/90/3590/14","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1530143424,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530143454,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530145247,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530145247,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1530145587,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":62,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/constants.js","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":17,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":332,"deletions":-63},{"file":"lib/storage.js","type":"MODIFIED","insertions":94,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/dc-test-images.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/image-clone.dc-test.js","type":"ADDED","insertions":174,"deletions":0},{"file":"test/reload-test-data.sh","type":"MODIFIED","insertions":8,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-68}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}