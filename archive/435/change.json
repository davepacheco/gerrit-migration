{"project":"joyent/smartos-live","branch":"master","id":"I8585edcbc12f231289f751b1567e206b1991c49a","number":"435","subject":"FWAPI-250 fwadm(1M) fails to flush logs correctly Reviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e Approved by: Alex Wilson \u003calex.wilson@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/435","commitMessage":"FWAPI-250 fwadm(1M) fails to flush logs correctly\nReviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e\nApproved by: Alex Wilson \u003calex.wilson@joyent.com\u003e\n","createdOn":1473360864,"lastUpdated":1473458504,"open":false,"status":"MERGED","comments":[{"timestamp":1473360864,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1473360909,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1473366944,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1473370361,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1473370399,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1473370482,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1473373497,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1\n\nTrusting you on having tested it out. :)"},{"timestamp":1473457739,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1473458427,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1473458495,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Commit message was updated."},{"timestamp":1473458504,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"4","revision":"64998c0b5a7c33287eb7dd118fef4aea42e5a6f3","parents":["043b9635a105a896e932517a44f96d19f8211d32"],"ref":"refs/changes/35/435/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1473458495,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1473370399,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1473373497,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1473458427,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"SUBM","value":"1","grantedOn":1473458503,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/fw/lib/util/log.js","type":"MODIFIED","insertions":34,"deletions":-30}],"sizeInsertions":34,"sizeDeletions":-30},"patchSets":[{"number":"1","revision":"e97706db5624b5e9746d6b84aac3bc7e46f87cce","parents":["90833f160a66fd1cc29a97fe04bdd42f7359815a"],"ref":"refs/changes/35/435/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1473360864,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1473360909,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/fw/lib/util/log.js","line":460,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"If an OpenOnErrorFileStream is using write2 (i.e. there has been an error), doesn\u0027t this hang because it doesn\u0027t handle a \u0027cb\u0027 argument."},{"file":"src/fw/lib/util/log.js","line":460,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Thanks for pointing that out! I had misread what .write gets changed to, and thought that it was changed directly to the file stream\u0027s .write() method. I\u0027ve updated write2(), and tested out what happens when an error is logged onto the OpenOnErrorFileStream."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/fw/lib/util/log.js","type":"MODIFIED","insertions":27,"deletions":-26}],"sizeInsertions":27,"sizeDeletions":-26},{"number":"2","revision":"7d4728876b7de8e31951fa027642a2ee699d1800","parents":["03d0bd998b50db2ad51eb5fbc2f8704a4683758d"],"ref":"refs/changes/35/435/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1473370361,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1473370399,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1473373497,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/fw/lib/util/log.js","type":"MODIFIED","insertions":34,"deletions":-30}],"sizeInsertions":34,"sizeDeletions":-30},{"number":"3","revision":"8585edcbc12f231289f751b1567e206b1991c49a","parents":["043b9635a105a896e932517a44f96d19f8211d32"],"ref":"refs/changes/35/435/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1473457739,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1473458427,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1473370399,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1473373497,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/fw/lib/util/log.js","type":"MODIFIED","insertions":34,"deletions":-30}],"sizeInsertions":34,"sizeDeletions":-30},{"number":"4","revision":"64998c0b5a7c33287eb7dd118fef4aea42e5a6f3","parents":["043b9635a105a896e932517a44f96d19f8211d32"],"ref":"refs/changes/35/435/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1473458495,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1473458503,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1473458427,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1473370399,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1473373497,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/fw/lib/util/log.js","type":"MODIFIED","insertions":34,"deletions":-30}],"sizeInsertions":34,"sizeDeletions":-30}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}