{"project":"joyent/sdcadm","branch":"master","topic":"MANTA-3992","id":"Icff9ef095a9a489020c41e49c88ebe90dce30922","number":"5163","subject":"TRITON-1694 create Triton Grafana image TRITON-1656 Want new EnsureNicOnInstances procedure in sdcadm Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"url":"https://cr.joyent.us/5163","commitMessage":"TRITON-1694 create Triton Grafana image\nTRITON-1656 Want new EnsureNicOnInstances procedure in sdcadm\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1543521838,"lastUpdated":1559776437,"open":false,"status":"MERGED","comments":[{"timestamp":1543521838,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 1."},{"timestamp":1543521877,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543522100,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 1:\n\nNote: this is out concurrently with https://cr.joyent.us/#/c/5015 and omits the improvements Trent has made there."},{"timestamp":1544473344,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Code-Review+1\n\n(2 comments)\n\nLGTM (I haven\u0027t tried it myself yet. Looking at the grafana repo changes first.)"},{"timestamp":1544482470,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 2."},{"timestamp":1544482511,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544482544,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1544482895,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 3."},{"timestamp":1544482933,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544489083,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)\n\nI\u0027ll come back for IA after I\u0027ve had a chance to play with it."},{"timestamp":1544492315,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 4."},{"timestamp":1544492355,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545859718,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Topic set to MANTA-3992"},{"timestamp":1546549571,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 4:\n\nIn reviewing triton-grafana, alexw raised the question of whether sdcadm should write PROMETHEUS_SERVICE and prometheus_domain properties to sapi (like most other services do), so the grafana zone can look these up rather than construct their values manually."},{"timestamp":1546550058,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n\u003e In reviewing triton-grafana, alexw raised the question of whether sdcadm should write PROMETHEUS_SERVICE and prometheus_domain properties to sapi (like most other services do), so the grafana zone can look these up rather than construct their values manually.\n\nI suppose. I can\u0027t claim that we can drop the \"FOO_SERVICE\" and \"foo_domain\" metadata vars authoritatively because I haven\u0027t hunted them all down. \n\nHowever, is there a need? The local DC prometheus should, by design, always be `prometheus.$datacenter_name.$dns_domain`.  Or perhaps \"PROMETHEUS_SERVICE\" helps provide the protocol (https) and port? (It doesn\u0027t look like current _domain and _SERVICE vars include protocol and port.)\n\nAn ulterior motive for having these domain names be static is that we can move closer to the point of a given service instance needing less config to function. Someday removing 50 \u0027sdc\u0027 SAPI app metadata vars would be nice:\n\n```\n[root@headnode (nightly-1) ~]# sdc-sapi /applications?name\u003dsdc | json -H 0.metadata | grep \"_domain\" | wc -l\n      22\n[root@headnode (nightly-1) ~]# sdc-sapi /applications?name\u003dsdc | json -H 0.metadata | grep \"_SERVICE\" | wc -l\n      35\n```"},{"timestamp":1546551875,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 4:\n\n\u003e \u003e In reviewing triton-grafana, alexw raised the question of whether\n \u003e sdcadm should write PROMETHEUS_SERVICE and prometheus_domain\n \u003e properties to sapi (like most other services do), so the grafana\n \u003e zone can look these up rather than construct their values manually.\n \u003e \n \u003e I suppose. I can\u0027t claim that we can drop the \"FOO_SERVICE\" and\n \u003e \"foo_domain\" metadata vars authoritatively because I haven\u0027t hunted\n \u003e them all down.\n \u003e \n \u003e However, is there a need? The local DC prometheus should, by\n \u003e design, always be `prometheus.$datacenter_name.$dns_domain`.  Or\n \u003e perhaps \"PROMETHEUS_SERVICE\" helps provide the protocol (https) and\n \u003e port? (It doesn\u0027t look like current _domain and _SERVICE vars\n \u003e include protocol and port.)\n \u003e \n \u003e An ulterior motive for having these domain names be static is that\n \u003e we can move closer to the point of a given service instance needing\n \u003e less config to function. Someday removing 50 \u0027sdc\u0027 SAPI app\n \u003e metadata vars would be nice:\n \u003e \n \u003e ```\n \u003e [root@headnode (nightly-1) ~]# sdc-sapi /applications?name\u003dsdc |\n \u003e json -H 0.metadata | grep \"_domain\" | wc -l\n \u003e 22\n \u003e [root@headnode (nightly-1) ~]# sdc-sapi /applications?name\u003dsdc |\n \u003e json -H 0.metadata | grep \"_SERVICE\" | wc -l\n \u003e 35\n \u003e ```\n\nThis all makes sense - I\u0027m fine leaving it the way it is. Just something to think about, I suppose."},{"timestamp":1559236416,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 5."},{"timestamp":1559236453,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1559236476,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 5:\n\nPS5 is a comprehensive update. See TRITON-1656 ticket for testing notes."},{"timestamp":1559770908,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\n(4 comments)"},{"timestamp":1559773952,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 6."},{"timestamp":1559773965,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 6:\n\n(2 comments)"},{"timestamp":1559773991,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1559774210,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 5:\n\nTesting notes for new patchset: ran through all of the affected subcommands to make sure nothing broke with the new changes"},{"timestamp":1559775984,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1559776428,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1559776437,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Isaac Davis"}],"currentPatchSet":{"number":"7","revision":"c59a4d581d1f04888524dc2f70f24b92d50bbf44","parents":["f6730ba615dde2b3c1421bbba3bf755b25197490"],"ref":"refs/changes/63/5163/7","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1559776428,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559773991,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1559776437,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":24,"deletions":-10},{"file":"lib/common.js","type":"MODIFIED","insertions":40,"deletions":-2},{"file":"lib/post-setup/common-external-nics.js","type":"MODIFIED","insertions":30,"deletions":-41},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":155,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/download-images.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/procedures/ensure-nic-on-instances.js","type":"ADDED","insertions":406,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":260,"deletions":-187},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":934,"sizeDeletions":-251},"patchSets":[{"number":"1","revision":"b8e6abe612cd3b037e2184eebf01f33f1c7f48b8","parents":["8ab102cf02618886a6a2c10e6ab18fb27a1589ba"],"ref":"refs/changes/63/5163/1","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1543521838,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543521877,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1544473344,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/post-setup/grafana.js","line":120,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I\u0027m assuming this was copied from the \u0027sdcadm post-setup prom\u0027 CR."},{"file":"lib/post-setup/grafana.js","line":120,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Correct. Do we need it here or is it unnecessary?"},{"file":"lib/post-setup/grafana.js","line":120,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Cool. That just means I don\u0027t need to read it carefully. :)"},{"file":"lib/sdcadm.js","line":3718,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is there some other reasonable unauthed endpoint we could expect a 200 from?  Note that there are other services missing from this list as well."},{"file":"lib/sdcadm.js","line":3718,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"It turns out there is - I\u0027ve just updated the triton-grafana CR to have nginx proxy \u0027/ping\u0027 to that endpoint."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":470,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":481,"sizeDeletions":-3},{"number":"2","revision":"2a04ca9559af0ba0389ea6511405e859fa1a77d5","parents":["8ab102cf02618886a6a2c10e6ab18fb27a1589ba"],"ref":"refs/changes/63/5163/2","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1544482470,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544482511,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":470,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":481,"sizeDeletions":-4},{"number":"3","revision":"92d2ffc12354fb2320a4a5f723ae001ad39f744b","parents":["8ab102cf02618886a6a2c10e6ab18fb27a1589ba"],"ref":"refs/changes/63/5163/3","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1544482895,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544482933,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1544489083,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":470,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":481,"sizeDeletions":-3},{"number":"4","revision":"949685f45dd61ebfda8a53a6628a655a92c456ef","parents":["8ab102cf02618886a6a2c10e6ab18fb27a1589ba"],"ref":"refs/changes/63/5163/4","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1544492315,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544492355,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":470,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":482,"sizeDeletions":-3},{"number":"5","revision":"78c065695424a1bead0e33d04ffedda9bf9f80a3","parents":["f6730ba615dde2b3c1421bbba3bf755b25197490"],"ref":"refs/changes/63/5163/5","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1559236416,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559236453,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/post-setup/common-external-nics.js","line":17,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"If the length bugs you, there isn\u0027t a need to have \"ServiceInstance\" instead of just \"Instance\". I\u0027m guessing you are copying \"create-service-instance-v1.js\" here. I think that one is unnecessary as well.\n\nHowever, it doesn\u0027t harm at all to have the \"Service\" prefix."},{"file":"lib/post-setup/common-external-nics.js","line":17,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Yeah, it\u0027s long enough to bother me. I shortened it as you suggest."},{"file":"lib/procedures/ensure-nic-on-service-instances.js","line":322,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I\u0027m a bit worried this could be a lot... e.g. in JPC where there can be many fabric networks. Do you know if it is possible to limit this somehow?\n\n- limit to non-fabric networks?\n- else, limit to networks owned by \u0027admin\u0027 and \u0027poseidon\u0027?"},{"file":"lib/procedures/ensure-nic-on-service-instances.js","line":322,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Good point - looks like there\u0027s an option to exclude fabric networks, so I added that."},{"file":"lib/sdcadm.js","line":2749,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"For the record \"udpate\" is nice to say out loud. Sadly `npm udpate` does not work. ;)"},{"file":"lib/sdcadm.js","line":4202,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Thanks for improving this code. This has been a wart for a while.\n\nThat these funcs exist on SdcAdm comes from the old simpler days when basically all \"smarts\" were on the SdcAdm class/object. I think eventually these two could go to lib/steps/nics.js or something. However, that definitely should be on a separate change if we bother."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":24,"deletions":-10},{"file":"lib/common.js","type":"MODIFIED","insertions":40,"deletions":-2},{"file":"lib/post-setup/common-external-nics.js","type":"MODIFIED","insertions":30,"deletions":-41},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":155,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/download-images.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/procedures/ensure-nic-on-service-instances.js","type":"ADDED","insertions":404,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":260,"deletions":-187},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":932,"sizeDeletions":-251},{"number":"6","revision":"cff9ef095a9a489020c41e49c88ebe90dce30922","parents":["f6730ba615dde2b3c1421bbba3bf755b25197490"],"ref":"refs/changes/63/5163/6","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1559773952,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559773991,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":24,"deletions":-10},{"file":"lib/common.js","type":"MODIFIED","insertions":40,"deletions":-2},{"file":"lib/post-setup/common-external-nics.js","type":"MODIFIED","insertions":30,"deletions":-41},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":155,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/download-images.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/procedures/ensure-nic-on-instances.js","type":"ADDED","insertions":406,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":260,"deletions":-187},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":934,"sizeDeletions":-251},{"number":"7","revision":"c59a4d581d1f04888524dc2f70f24b92d50bbf44","parents":["f6730ba615dde2b3c1421bbba3bf755b25197490"],"ref":"refs/changes/63/5163/7","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1559776428,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1559773991,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1559775984,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1559776437,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":0},{"file":"etc/defaults.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/cli/do_update_other.js","type":"MODIFIED","insertions":24,"deletions":-10},{"file":"lib/common.js","type":"MODIFIED","insertions":40,"deletions":-2},{"file":"lib/post-setup/common-external-nics.js","type":"MODIFIED","insertions":30,"deletions":-41},{"file":"lib/post-setup/grafana.js","type":"ADDED","insertions":155,"deletions":0},{"file":"lib/post-setup/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/procedures/download-images.js","type":"MODIFIED","insertions":6,"deletions":-5},{"file":"lib/procedures/ensure-nic-on-instances.js","type":"ADDED","insertions":406,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":260,"deletions":-187},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":934,"sizeDeletions":-251}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}