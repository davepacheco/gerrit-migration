{"project":"joyent/manatee","branch":"master","id":"Ic525bc705fff52644471bd5c9ab7286ca368dbfb","number":"2146","subject":"MANTA-3323: initdb(1) with explicit locale and encoding","owner":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"url":"https://cr.joyent.us/2146","commitMessage":"MANTA-3323: initdb(1) with explicit locale and encoding\n\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1498242516,"lastUpdated":1498588232,"open":false,"status":"MERGED","comments":[{"timestamp":1498242516,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 1."},{"timestamp":1498242990,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1498244224,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 2."},{"timestamp":1498244444,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1498245016,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 3."},{"timestamp":1498250662,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1498359209,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 4."},{"timestamp":1498359238,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n ./deps/javascriptlint/build/install/jsl --nologo --nosummary --conf\u003d./tools/jsl.node.conf ./sitter.js ./backupserver.js ./snapshotter.js ./lib/postgresMgr.js ./lib/zfsClient.js ./lib/adm.js ./lib/backupServer.js ./lib/shard.js ./lib/backupSender.js ./lib/backupQueue.js ./lib/confParser.js ./lib/snapShotter.js ./lib/zookeeperMgr.js ./lib/statusServer.js ./test/confParser.test.js ./test/zookeeperMgr.test.js ./test/tst.manateeAdm.js ./test/testManatee.js ./test/integ.test.js ./test/tst.manateeAdmUsage.js ./test/postgresMgrRepl.js bin/manatee-adm tools/mksitterconfig\n /tmp/repo/sitter.js\n /tmp/repo/backupserver.js\n /tmp/repo/snapshotter.js\n /tmp/repo/lib/postgresMgr.js\n /tmp/repo/lib/zfsClient.js\n /tmp/repo/lib/adm.js\n /tmp/repo/lib/backupServer.js\n /tmp/repo/lib/shard.js\n /tmp/repo/lib/backupSender.js\n /tmp/repo/lib/backupQueue.js\n /tmp/repo/lib/confParser.js\n /tmp/repo/lib/snapShotter.js\n /tmp/repo/lib/zookeeperMgr.js\n /tmp/repo/lib/statusServer.js\n /tmp/repo/test/confParser.test.js\n /tmp/repo/test/zookeeperMgr.test.js\n /tmp/repo/test/tst.manateeAdm.js\n /tmp/repo/test/testManatee.js\n /tmp/repo/test/integ.test.js\n /tmp/repo/test/tst.manateeAdmUsage.js\n /tmp/repo/test/postgresMgrRepl.js\n /tmp/repo/bin/manatee-adm\n /tmp/repo/tools/mksitterconfig\n json --validate -f etc/sitter.json\n json --validate -f etc/backupserver.json\n json --validate -f etc/snapshotter.json\n json --validate -f test/etc/sitter.json\n json --validate -f test/etc/backupserver.json\n json --validate -f test/etc/snapshotter.json\n json --validate -f test/etc/mdata.json\n json --validate -f test/etc/sample-sitter.json\n json --validate -f package.json\n ./deps/jsstyle/jsstyle -f ./tools/jsstyle.conf ./sitter.js ./backupserver.js ./snapshotter.js ./lib/postgresMgr.js ./lib/zfsClient.js ./lib/adm.js ./lib/backupServer.js ./lib/shard.js ./lib/backupSender.js ./lib/backupQueue.js ./lib/confParser.js ./lib/snapShotter.js ./lib/zookeeperMgr.js ./lib/statusServer.js ./test/confParser.test.js ./test/zookeeperMgr.test.js ./test/tst.manateeAdm.js ./test/testManatee.js ./test/integ.test.js ./test/tst.manateeAdmUsage.js ./test/postgresMgrRepl.js bin/manatee-adm tools/mksitterconfig\n Unescaped left brace in regex is deprecated, passed through in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at ./deps/jsstyle/jsstyle line 654.\n ./lib/postgresMgr.js: 1504: line \u003e 80 characters\n Makefile.targ:209: recipe for target \u0027check-jsstyle\u0027 failed\n gmake: *** [check-jsstyle] Error 1"},{"timestamp":1498514876,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 5."},{"timestamp":1498514910,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1498516232,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1498587558,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1498587574,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1498587604,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1498587790,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1498588193,"reviewer":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1498588232,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Sean Chittenden"}],"currentPatchSet":{"number":"7","revision":"c525bc705fff52644471bd5c9ab7286ca368dbfb","parents":["5e4ab2c6cc25849cce78c35a4f5cef5a74a26a69"],"ref":"refs/changes/46/2146/7","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498588193,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1498514910,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498516232,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498587558,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587574,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587604,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1498588232,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":8,"deletions":-10}],"sizeInsertions":8,"sizeDeletions":-10},"patchSets":[{"number":"1","revision":"261bc139226ec5639f354ef73ed100578db39c96","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/1","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498242516,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"/COMMIT_MSG","line":7,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"We should file a ticket, and update the commit message here to be its subject."},{"file":"lib/postgresMgr.js","line":1503,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"While we\u0027re updating this, I think that it would be good to switch from using child_process.exec() to using forkexec.forkExecWait() here instead. For an example of what I\u0027m thinking, see:\n\nhttps://github.com/joyent/node-moray-sandbox/blob/51135084e3f930d62c4f7cf309b840ca37ed2c3b/lib/sandbox.js#L100"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},{"number":"2","revision":"458485b11c15108dcc4c1f76f0ec9fe5d4d5cf44","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/2","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498244224,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"lib/postgresMgr.js","line":1512,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"You can replace this with the \"info\" object."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":6,"deletions":-4}],"sizeInsertions":6,"sizeDeletions":-4},{"number":"3","revision":"ae0647008285e51705c568945e7c72a6436a4e70","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/3","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498245016,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1498250662,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/postgresMgr.js","line":1504,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: cmd"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":7,"deletions":-10}],"sizeInsertions":7,"sizeDeletions":-10},{"number":"4","revision":"66873e1fa3b07acdddab8579121caafae73164de","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/4","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498359209,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1498359238,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":7,"deletions":-10}],"sizeInsertions":7,"sizeDeletions":-10},{"number":"5","revision":"02b9612cc8e35ad729f1c8f35eb4b80886e170c4","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/5","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498514876,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498516232,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587604,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1498514910,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498587558,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587574,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":8,"deletions":-10}],"sizeInsertions":8,"sizeDeletions":-10},{"number":"6","revision":"82d3d4610c3036c37b025dfd954d63b2dc220459","parents":["39e68e7347acadc4e9647b614f900acc653abd73"],"ref":"refs/changes/46/2146/6","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498587790,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498516232,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587604,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1498514910,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498587558,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587574,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":8,"deletions":-10}],"sizeInsertions":8,"sizeDeletions":-10},{"number":"7","revision":"c525bc705fff52644471bd5c9ab7286ca368dbfb","parents":["5e4ab2c6cc25849cce78c35a4f5cef5a74a26a69"],"ref":"refs/changes/46/2146/7","uploader":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"createdOn":1498588193,"author":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498516232,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587604,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1498514910,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1498587558,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1498587574,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}},{"type":"SUBM","value":"1","grantedOn":1498588232,"by":{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/postgresMgr.js","type":"MODIFIED","insertions":8,"deletions":-10}],"sizeInsertions":8,"sizeDeletions":-10}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Sean Chittenden","email":"sean.chittenden@joyent.com","username":"seanc"}]}