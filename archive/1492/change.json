{"project":"joyent/smartos-live","branch":"master","id":"I49f443b7af733f47aaa5fb964ee7ead067fcd441","number":"1492","subject":"OS-5954 need javascript queue with pause, fast-forward, and resume functionality Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e","owner":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"url":"https://cr.joyent.us/1492","commitMessage":"OS-5954 need javascript queue with pause, fast-forward, and resume functionality\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n","createdOn":1486758157,"lastUpdated":1513703878,"open":false,"status":"ABANDONED","comments":[{"timestamp":1486758157,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 1."},{"timestamp":1486758160,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 11c60c6128020f6fe8e654330c5dd266de15834c\n    \n    initial commit"},{"timestamp":1486758194,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487788181,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1487788184,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 886abb97018e59251adfad617de6a11aa6b24ce4\n    \n    initial commit"},{"timestamp":1487788218,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1487788807,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 3."},{"timestamp":1487788811,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit d8ebc4acc55cccb149223e7e2391b607c0bb0d90\n    \n    docs, cleanup, create job id when enqueued"},{"timestamp":1487788849,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1491507933,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3:\n\n(18 comments)"},{"timestamp":1491589416,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\n(17 comments)"},{"timestamp":1491843864,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 4."},{"timestamp":1491843868,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 34e9feeef2cf0fc172245e25233b9be0197a850c\n    \n    change based on julien review"},{"timestamp":1491843908,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1491844163,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 5."},{"timestamp":1491844167,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit e04a1e71e13687d7844bab5f18f50d0f6dbee048\n    \n    emit an error event instead of async throw"},{"timestamp":1491844207,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1491926491,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 6."},{"timestamp":1491926494,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit b8a0ae2bc232c4df3c1c9896b4493360ed1bb495\n    \n    prettyPrint hrtimers"},{"timestamp":1491926528,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1491941870,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 6:\n\n(9 comments)"},{"timestamp":1492100014,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1492101262,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6:\n\n(7 comments)"},{"timestamp":1492458027,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 7."},{"timestamp":1492458031,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit a0804b077f4f1db1fbeae7e28e25504be4424f04\n    \n    use hrtimers for everything in queue"},{"timestamp":1492458067,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492459307,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 8."},{"timestamp":1492459310,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 24ff85e85ee995133e6da6500969cd756f336c6f\n    \n    %s not %d for new relative function"},{"timestamp":1492459355,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492720259,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 9."},{"timestamp":1492720262,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit c90745d37699049526371631d483475eb1181817\n    \n    use an hrtime comparator function"},{"timestamp":1492720298,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492800983,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 9:\n\n(2 comments)"},{"timestamp":1492804642,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 9:\n\n(3 comments)"},{"timestamp":1493134312,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\n(4 comments)"},{"timestamp":1493138107,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 10."},{"timestamp":1493138111,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit 473a4744b8945a52cd772722a74dfb837f76ad2c\n    \n    changes based on julien review"},{"timestamp":1493138147,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493145277,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 9:\n\n(2 comments)"},{"timestamp":1493308744,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 9:\n\n(1 comment)"},{"timestamp":1493308760,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 11."},{"timestamp":1493308764,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 8da21b28e4997e7fd38207771f8dcf8dcbc89d70\n    \n    test change based on julien review"},{"timestamp":1493308799,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493318501,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 11: Code-Review+1\n\n(2 comments)"},{"timestamp":1493323012,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 11:\n\n(2 comments)"},{"timestamp":1493323025,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 12."},{"timestamp":1493323028,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit 740ebf0f6b6b0fca0b318fe699df19cc3890c377\n    \n    nits based on julien review"},{"timestamp":1493323063,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493325036,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 13."},{"timestamp":1493325040,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit 1a8bdfd2f4c693f60a2da0bfbec1af6166d9216e\n    \n    add queue.js to make check"},{"timestamp":1493325080,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493397617,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 13: Code-Review+1"},{"timestamp":1493655193,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 14: Commit message was updated."},{"timestamp":1507153122,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 15."},{"timestamp":1507153125,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 15:\n\nNew commits:\n    \n    commit f57a7499add8e72a8e6014709391a5d50e29801c\n    \n    use hrtime library\n    \n    commit 329d720fc871f65b8e86db336d0b85d2fcbd2156\n    \n    add queue.js to make check\n    \n    commit 4e950004896cc777353136d309d63375d6244acc\n    \n    nits based on julien review\n    \n    commit f07b4c60d6a43d64e9d89a64d21c90d5304cc4fb\n    \n    test change based on julien review\n    \n    commit 74d74346090e269ca8f214afd7aab8b1d61b0a9e\n    \n    changes based on julien review\n    \n    commit 90f22410cccb0b62308ea43cb413ec2a677db215\n    \n    use an hrtime comparator function\n    \n    commit 214b3e9e35621ab583867eed83ff880d744402f2\n    \n    %s not %d for new relative function\n    \n    commit 9c459f063b8ca7ae1d9eefc3ed24664bb6a05312\n    \n    use hrtimers for everything in queue\n    \n    commit 59d55382a0b969e08ebd251063e0ba511981881e\n    \n    prettyPrint hrtimers\n    \n    commit fccfb6144a84fe9900fc0fd44140b9972b976c78\n    \n    emit an error event instead of async throw\n    \n    commit 93685f7f8a35006b01fb9b7b8452230978e91488\n    \n    change based on julien review\n    \n    commit 1b90da40127cae58bfab9a8e6587faed24d73b61\n    \n    docs, cleanup, create job id when enqueued\n    \n    commit d0d7e21be3bc0e6df3f2b8429cc2e128194516a6\n    \n    initial commit"},{"timestamp":1507153168,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513703878,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Abandoned\n\nin OS-2647"}],"currentPatchSet":{"number":"15","revision":"49f443b7af733f47aaa5fb964ee7ead067fcd441","parents":["85545cdfed4dc84ad7968b2c3a6f2017733899f2"],"ref":"refs/changes/92/1492/15","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1507153122,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507153168,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":509,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":757,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"957e354b81fa3fcdf52353b75d028d60c480b847","parents":["a6518ae5c88afd42324ce0c92a809adf798249ba"],"ref":"refs/changes/92/1492/1","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1486758157,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486758194,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":479,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":713,"sizeDeletions":0},{"number":"2","revision":"871fe73602b9ee7185330a3d33946c9e2cade063","parents":["57c424e145e378f68aab66002f5363bc02e6c198"],"ref":"refs/changes/92/1492/2","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1487788181,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486758194,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":479,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":713,"sizeDeletions":0},{"number":"3","revision":"07f5c86a67241a77d66987e5d0b45a36bb15fdfe","parents":["57c424e145e378f68aab66002f5363bc02e6c198"],"ref":"refs/changes/92/1492/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1487788807,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487788849,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/queue.js","line":57,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: We should name all functions (and particularly callback functions, since their name can\u0027t be inferred), and the example should reflect that.\n\nnit: renaming \"extras\" to \"opts\" or \"options\" seems like it would be more consistent with the rest of the code base."},{"file":"src/vm/node_modules/queue.js","line":57,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I\u0027ll add the callback function name.\n\nI wanted to name it something that lets the caller know that they are given this object to use when their task is being run, and it is not options they are expected to give.  I\u0027m open to names other than \"extras\", but \"opts\" or similar makes it seem like these are options, when in reality these are variables given to the task when it is executed."},{"file":"src/vm/node_modules/queue.js","line":106,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: callback needs a name."},{"file":"src/vm/node_modules/queue.js","line":106,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":129,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"It looks like \"opts\" is optional, but \"opts.log\" is not? I\u0027m not sure I understand the contract of this function for input parameters.\n\nIs \"opts.log\" expected to be any value that evaluates to a boolean value, or is it expected to be an object? If the latter, shouldn\u0027t this be \"assert.object(opts.log, \u0027opts.log\u0027);\n\nAlso, if \"opts\" is not optional, I would suggest removing the following statement that is present above:\n\nopts \u003d opts || {}"},{"file":"src/vm/node_modules/queue.js","line":129,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"haha, you don\u0027t understand this because i completely messed it up :p.\n\nopts should not be optional, and opts.log should be a bunyan logger... will fix!"},{"file":"src/vm/node_modules/queue.js","line":136,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Does the use of wall clock time make this vulnerable to time drift? If so, is it worth it to perform time comparisons using a monotonic clock, and only use wall clock time if we need to provide timestamps that are convenient for humans to read (e.g from logs)?"},{"file":"src/vm/node_modules/queue.js","line":136,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I hadn\u0027t thought of the time drift problem.\n\nFor the paused_data specifically this won\u0027t be a problem, as this variable is only ever meant for human consumption - no logic uses this timestamp."},{"file":"src/vm/node_modules/queue.js","line":139,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Isn\u0027t \"opts.workers\" a number already? If so, there\u0027s no need to use \"parseInt\".\n\nnit: maybe rename \"workers\" to \"nbWorkers\"?"},{"file":"src/vm/node_modules/queue.js","line":139,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"it is... i have no idea how this got here."},{"file":"src/vm/node_modules/queue.js","line":151,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should we assert on the type and form (type of properties, etc.) of \"job\" and \"cb\"?"},{"file":"src/vm/node_modules/queue.js","line":151,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":164,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should this timeout be unrefed with \".unref()\" to prevent consumers of this library from having their event loop held open due to this library\u0027s internals?"},{"file":"src/vm/node_modules/queue.js","line":164,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I\u0027m not sure.  This timeout is cleared when the job finishes - so if the timeout still exists it means there is an existing job still in the queue."},{"file":"src/vm/node_modules/queue.js","line":164,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"OK, what I mean is let\u0027s say there\u0027s a program using this queue module that listens on a socket and queue tasks coming in from clients connected to that socket.\n\nAt some point the program determines it\u0027s done and stops listening on that socket. It won\u0027t be able to exit until the currently started tasks either complete or time out.\n\nIdeally the program would be in better control of when it can exit, by deciding whether it needs to wait for these tasks to complete or not, and by providing its own mechanisms to do so.\n\nI think it\u0027s not a major concern for now though, so if you feel strongly either way, that\u0027s fine with me."},{"file":"src/vm/node_modules/queue.js","line":164,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Oh, I understand now, thanks.\n\nI basically just took for granted that the programs I was writing this module for are meant to run indefinitely.\n\nIn this case though, it seems like the addition of a .stop() method whose job it is to remove all jobs and clear all timers would make the most sense.  I don\u0027t have a use for that personally, so I would say that could be potentially added in the future.  In that case, it still seems like it makes sense to not unref the timers, but have the .stop() function handle it."},{"file":"src/vm/node_modules/queue.js","line":164,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Sounds good to me."},{"file":"src/vm/node_modules/queue.js","line":168,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Throwing an error asynchronously here means that the error could not be handled by the consumer of this library. It seems to me that this decision should not be made by the library.\n\nInstead of throwing an error, would it make sense to emit \u0027error\u0027 events? These \nevents could be handled by the consumer of this queue if they determine that they can be handled, or ignored (and have the process exit or crash) if they determine they cannot be handled."},{"file":"src/vm/node_modules/queue.js","line":168,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Good catch - this timeout logic was added by me in haste trying to pin down a bug a while back... I think emitting an event would be the best course of action here."},{"file":"src/vm/node_modules/queue.js","line":196,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"What does a \"description\" look like in practice? Can we get to a state where two tasks actually need to be run but they have identical descriptions?"},{"file":"src/vm/node_modules/queue.js","line":196,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"perhaps \"description\" isn\u0027t the best term for this, but an example with vminfod is\n\n zone event seen for zone \u003cuuid\u003e\n\nor\n\n zfs event seen for zones/\u003cuuid\u003e - zfs set quota\u003d10\n\nThe descriptions are only as unique as the caller chooses to make them."},{"file":"src/vm/node_modules/queue.js","line":226,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is it possible to queue a task while the queue is unpaused, then have the queue pause, and finally queue a task with the same description in the paused queue? If so, wouldn\u0027t that result in these two tasks being run even if \"self.dedup\" is true?"},{"file":"src/vm/node_modules/queue.js","line":226,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Pausing the queue is an asynchronous operation (due to the nature of vasync).  When .pause() is called, it runs through all the tasks currently in the queue beforing calling back.  During this time, it is possible for a task to be enqueued in the \"paused_queue\" that is going to be processed.\n\nThis is unfortunate... and I may be able to come up with a fix for this."},{"file":"src/vm/node_modules/queue.js","line":226,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Did you end up finding a solution for this?"},{"file":"src/vm/node_modules/queue.js","line":226,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I\u0027m going to push a tentative change next for this that I believe solves this issue."},{"file":"src/vm/node_modules/queue.js","line":265,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Typo enque -\u003e enqueue.\n\nI think we should try to describe what this function without mentioning the vasync queue, as it seems to me it should be an implementation detail. It might seem like nit picking, but the goal would be to make sure that this is not a leaky abstraction."},{"file":"src/vm/node_modules/queue.js","line":265,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Agreed, that makes sense to me."},{"file":"src/vm/node_modules/queue.js","line":268,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"The event + callback model seems a bit odd, and maybe confusing. Why not just use a callback and not emit a drain event?"},{"file":"src/vm/node_modules/queue.js","line":268,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"This line will be removed - this is referring to the \u0027drain\u0027 event emitted by the vasync queue."},{"file":"src/vm/node_modules/queue.js","line":296,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Same comment as above regarding unrefing the timer instance."},{"file":"src/vm/node_modules/queue.js","line":296,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I don\u0027t really understand why this should be unreffed.  If the queue is being paused, then work is still going on and the process won\u0027t exit.  If the queue is fully drained this timeout will be cleared."},{"file":"src/vm/node_modules/queue.js","line":296,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"See my comment for the same use case above. This is about letting the program using this module control when it can exit, rather than make the module prevent it from exiting by keeping a libuv handle open."},{"file":"src/vm/node_modules/queue.js","line":337,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is there a reason why we clear the \"paused_queue\" array using this method instead of just assigning the empty array ([]) to it?"},{"file":"src/vm/node_modules/queue.js","line":337,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"No, I\u0027ve always just cleared arrays using this way.  I can make the change though as setting it to [] more clearly shows intent."},{"file":"src/vm/node_modules/queue.js","line":345,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"The comment doesn\u0027t mention when the callback function \"cb\" is called, and with what parameters.\n\nIt also doesn\u0027t document the \"opts\" parameter, nor the return value."},{"file":"src/vm/node_modules/queue.js","line":345,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":462,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"This function lacks comments and runtime type checking of its input parameters. Same comment as before regarding the time of clock used. When computing time differences, I would suggest using a monotonic clock (with e.g process.hrtime()) rather than a wall clock."},{"file":"src/vm/node_modules/queue.js","line":462,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I\u0027m going to look into this"},{"file":"src/vm/tests/test-queue.js","line":1,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Why isn\u0027t the CDDL header needed?"},{"file":"src/vm/tests/test-queue.js","line":23,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is nodeunit the existing test harness for JS code that ships with the platform? Otherwise I would think we want to use something that doesn\u0027t have the same drawbacks, such as tape."},{"file":"src/vm/tests/test-queue.js","line":23,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"It is the existing harness... it\u0027s awful and no one likes it... there is a project/ticket to replace it... i welcome that day!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":481,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":715,"sizeDeletions":0},{"number":"4","revision":"2469e71e8c080c55ca3793571f3a20c69d0cb858","parents":["6b833549a5739a30c623198e9029765e2b1fa3ff"],"ref":"refs/changes/92/1492/4","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1491843864,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1491843908,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":559,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":793,"sizeDeletions":0},{"number":"5","revision":"59946b79db1d334465437d1af3a71e77e5eef2a8","parents":["6b833549a5739a30c623198e9029765e2b1fa3ff"],"ref":"refs/changes/92/1492/5","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1491844163,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1491844207,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":565,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":799,"sizeDeletions":0},{"number":"6","revision":"0f3f8b71aaf45eadae72eb701cf30646adf1879f","parents":["6b833549a5739a30c623198e9029765e2b1fa3ff"],"ref":"refs/changes/92/1492/6","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1491926491,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1491926528,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/queue.js","line":118,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: extra space probably not needed and not consistent."},{"file":"src/vm/node_modules/queue.js","line":118,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I don\u0027t even know how that happened! I\u0027d go a step further and even say it\u0027s ugly :) changing."},{"file":"src/vm/node_modules/queue.js","line":165,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: that function would ideally have a name."},{"file":"src/vm/node_modules/queue.js","line":165,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":366,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Typo: two periods instead of one?"},{"file":"src/vm/node_modules/queue.js","line":366,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":391,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Shouldn\u0027t this use \"created_at\" (from a monotonic clock) rather than \"created_at_date\" to avoid time drift issues?"},{"file":"src/vm/node_modules/queue.js","line":391,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"As this function is written, it expects the \"time\" given by the user to be a javascript date object.   I\u0027ll make the change so this function will expect an hrtime."},{"file":"src/vm/node_modules/queue.js","line":499,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit, from now -\u003e from \"now\", otherwise it\u0027s not clear whether the diff is computed from the current time, or from the value of the variable \"now\"."},{"file":"src/vm/node_modules/queue.js","line":499,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"good call."},{"file":"src/vm/node_modules/queue.js","line":557,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"It seems this potentially has a lesser precision than it could (should?) have.\n\nE.g, if  hrtime[0] \u003d\u003d\u003d 0 and hrtime[1] \u003d\u003d\u003d 999 * 1e3, that is 0ms and 999 microseconds, or 0.999ms then hrtimeToMs(hrtime) would return 0ms, when it is actualy much closer to 1ms.\n\nFor instance, the function \"hrtimeDeltaMs\" below, would return a value of \"1ms\" when computing the difference between 1ms and 0.999ms.\n\nIt\u0027s fine if we don\u0027t use hrtimeToMs to compute time differences that need to have a sub-millisecond precision, e.g displaying time from a monotonic clock in a way that is easier to read.\n\nHowever, even if just for readability purposes, I think it\u0027s worth it to think about the needed precision. Is it ok to output that a task started \"0ms ago\" even though it started \"0.999ms ago\"?\n\nSo maybe return a floating point value would make sense here, maybe not.\n\nIn any case, I think it\u0027d be helpful to make the limitations of this function clear in the comments, and call out that this should be used when computing time differences unless the user is aware of the precision tradeoffs."},{"file":"src/vm/node_modules/queue.js","line":557,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"You know, I converted it all to milliseconds so it would fit in perfectly with the \"relative\" function that was written for the resolution of JavaScript Date objects.\n\nI\u0027m going to rework a bunch of these functions to use the full nanosecond resolution (we have it, might as well use it!)"},{"file":"src/vm/node_modules/queue.js","line":564,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: assert on the type of hr1 and hr2."},{"file":"src/vm/node_modules/queue.js","line":564,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":573,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":807,"sizeDeletions":0},{"number":"7","revision":"c0d024a0d8a5311c42c71a63742b4aa0b0173ef0","parents":["37fa0b13a2503039ea0e9ba785f1951785d941ad"],"ref":"refs/changes/92/1492/7","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1492458027,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492458067,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":602,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":836,"sizeDeletions":0},{"number":"8","revision":"0aa17d8a8eb3f780834e8bc3934f0095dfbbfdf0","parents":["db036c27db1e6d72366c8b7edb33377b7b361de7"],"ref":"refs/changes/92/1492/8","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1492459307,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492459355,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":602,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":836,"sizeDeletions":0},{"number":"9","revision":"9f4439081efa17aa44a3c3ae26e938d47640de81","parents":["db036c27db1e6d72366c8b7edb33377b7b361de7"],"ref":"refs/changes/92/1492/9","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1492720259,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492720298,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/queue.js","line":225,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should we also assert on \"cb\" being a function?"},{"file":"src/vm/node_modules/queue.js","line":225,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/tests/test-queue.js","line":6,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should this list be alphabetized? I don\u0027t know if that\u0027s the style recommendation for this code base, but that\u0027s what we do in other repos."},{"file":"src/vm/tests/test-queue.js","line":6,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Yes, but the common convention I\u0027ve seen (with exceptions) in the code base is to sort the capital letters above the non-capital letters (default `sort(1)` order)"},{"file":"src/vm/tests/test-queue.js","line":6,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Sounds good!"},{"file":"src/vm/tests/test-queue.js","line":63,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"If the queue was never paused, this test would still succeed, wouldn\u0027t it?"},{"file":"src/vm/tests/test-queue.js","line":63,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"That\u0027s correct.  Should I set a short timeout before unpausing the queue to verify that all 100 tasks are still enqueued? I think that may deal with this situation."},{"file":"src/vm/tests/test-queue.js","line":63,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I think that would fix it, and maybe also check in the callback for each task that it\u0027s called _after_ the timeout expired?"},{"file":"src/vm/tests/test-queue.js","line":63,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":631,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":232,"deletions":0}],"sizeInsertions":865,"sizeDeletions":0},{"number":"10","revision":"d26acd73c84d39dda73a214e9fa9b5618512838b","parents":["b7272e9a8d0bc947e9e85b9ebae9237a8024a55d"],"ref":"refs/changes/92/1492/10","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1493138107,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493138147,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":640,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":235,"deletions":0}],"sizeInsertions":877,"sizeDeletions":0},{"number":"11","revision":"6b1fb9577cb10a3ee3c89e083029c7569cac3ee2","parents":["b7272e9a8d0bc947e9e85b9ebae9237a8024a55d"],"ref":"refs/changes/92/1492/11","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1493308760,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493308799,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493318501,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"comments":[{"file":"src/vm/node_modules/queue.js","line":100,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: For Example -\u003e For example"},{"file":"src/vm/node_modules/queue.js","line":100,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"src/vm/node_modules/queue.js","line":625,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: capitalize \"Pretty\"."},{"file":"src/vm/node_modules/queue.js","line":625,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":640,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":887,"sizeDeletions":0},{"number":"12","revision":"1f4521956b65cbed97cacb79991137668031020c","parents":["b7272e9a8d0bc947e9e85b9ebae9237a8024a55d"],"ref":"refs/changes/92/1492/12","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1493323025,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493323063,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":640,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":887,"sizeDeletions":0},{"number":"13","revision":"0f62728e373e0b8c0d8a8f6823880e7ea773f2ca","parents":["b7272e9a8d0bc947e9e85b9ebae9237a8024a55d"],"ref":"refs/changes/92/1492/13","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1493325036,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493325080,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493397617,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":640,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":888,"sizeDeletions":0},{"number":"14","revision":"97e9d5599b4ae630f42d8b5fa964070c7785ec6f","parents":["b7272e9a8d0bc947e9e85b9ebae9237a8024a55d"],"ref":"refs/changes/92/1492/14","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1493655193,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493325080,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493397617,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":640,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":888,"sizeDeletions":0},{"number":"15","revision":"49f443b7af733f47aaa5fb964ee7ead067fcd441","parents":["85545cdfed4dc84ad7968b2c3a6f2017733899f2"],"ref":"refs/changes/92/1492/15","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1507153122,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507153168,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"src/manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/node_modules/queue.js","type":"ADDED","insertions":509,"deletions":0},{"file":"src/vm/tests/test-queue.js","type":"ADDED","insertions":245,"deletions":0}],"sizeInsertions":757,"sizeDeletions":0}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}