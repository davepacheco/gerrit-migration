{"project":"joyent/sdc-imgapi","branch":"master","id":"I75a8380ff33590eecd53df26758f52106138e32c","number":"2020","subject":"IMGAPI-628 imgapi-standalone-rotate-key Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e","owner":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"url":"https://cr.joyent.us/2020","commitMessage":"IMGAPI-628 imgapi-standalone-rotate-key\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1496264045,"lastUpdated":1496356699,"open":false,"status":"MERGED","comments":[{"timestamp":1496264045,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 1."},{"timestamp":1496264046,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 48377eb00fad2e22820c88e2c1fa626847346672\n    \n    first stab"},{"timestamp":1496264072,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1496265316,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 2."},{"timestamp":1496265317,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 1129d6d04139c642a9b175454b70e07144a5535c\n    \n    correct this script name"},{"timestamp":1496265349,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1496268204,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 3."},{"timestamp":1496268206,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 4b3167d01418ce3bb507cc8801b5875eb2159106\n    \n    fix buglet in redeploy dev script"},{"timestamp":1496268233,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1496336011,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3: Code-Review+1\n\n(4 comments)"},{"timestamp":1496355514,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 4."},{"timestamp":1496355515,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 2c0084105a7e4af1dbbeeff3657f488f47e7bc2f\n    \n    update based on CR feedback"},{"timestamp":1496355562,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1496356110,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1496356690,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1496356699,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Trent Mick"}],"currentPatchSet":{"number":"5","revision":"75a8380ff33590eecd53df26758f52106138e32c","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/5","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496356690,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496355562,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1496356699,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":82,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":233,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0},{"file":"tools/redeploy-staging-updatesjo.sh","type":"MODIFIED","insertions":5,"deletions":-2}],"sizeInsertions":409,"sizeDeletions":-33},"patchSets":[{"number":"1","revision":"5d5abaa1b8299847a75365c9ef5882b3a236ebe0","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/1","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496264045,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496264072,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":81,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":231,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":401,"sizeDeletions":-31},{"number":"2","revision":"92b372947c3ae7ad2265eb685d9404882c80eb34","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/2","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496265316,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496265349,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":81,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":231,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":401,"sizeDeletions":-31},{"number":"3","revision":"68d22b17e3819cfbe53f9748ffe23b4a036a08cb","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/3","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496268204,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496268233,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1496336011,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"bin/imgapi-manta-setup","line":382,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Is this intentionally indented twice? I don\u0027t see precedent to compare."},{"file":"bin/imgapi-standalone-rotate-key","line":52,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Not that you need to change this (it\u0027s fine as-is), but FYI in bash you can also do:\n\n```\nfor i in {1..9}; do\n```"},{"file":"bin/imgapi-standalone-rotate-key","line":205,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"if ${configManta} does not have a \u0027key\u0027 parameter, this will end up being:\n\n```\nrm -f ~/.ssh/*\n```\n\nwhich doesn\u0027t seem great. It seems like it\u0027d be good to ensure that ${oldPrivKeyPath} is non-empty before running this."},{"file":"tools/redeploy-staging-updatesjo.sh","line":208,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Definitely sad."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":81,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":231,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0},{"file":"tools/redeploy-staging-updatesjo.sh","type":"MODIFIED","insertions":5,"deletions":-2}],"sizeInsertions":406,"sizeDeletions":-33},{"number":"4","revision":"13988fde5248fa4b7665315f6464498773a4048d","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/4","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496355514,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496355562,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":82,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":233,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0},{"file":"tools/redeploy-staging-updatesjo.sh","type":"MODIFIED","insertions":5,"deletions":-2}],"sizeInsertions":409,"sizeDeletions":-33},{"number":"5","revision":"75a8380ff33590eecd53df26758f52106138e32c","parents":["ec75a83661a4cadb0373307e44dacfef2ac6f1cb"],"ref":"refs/changes/20/2020/5","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1496356690,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1496355562,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1496356699,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1496356110,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/imgapi-manta-setup","type":"MODIFIED","insertions":82,"deletions":-26},{"file":"bin/imgapi-standalone-rotate-key","type":"ADDED","insertions":233,"deletions":0},{"file":"boot/standalone/new-inst-key.sh","type":"ADDED","insertions":35,"deletions":0},{"file":"boot/standalone/setup.sh","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":44,"deletions":0},{"file":"tools/redeploy-staging-updatesjo.sh","type":"MODIFIED","insertions":5,"deletions":-2}],"sizeInsertions":409,"sizeDeletions":-33}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}