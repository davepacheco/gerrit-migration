{"project":"joyent/sdc-volapi","branch":"master","id":"If47da33f8dcdc2763418b45e4d7b7002bb796253","number":"3221","subject":"VOLAPI-82 volume names should be limited in size Reviewed by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e Approved by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e","owner":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"url":"https://cr.joyent.us/3221","commitMessage":"VOLAPI-82 volume names should be limited in size\nReviewed by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e\nApproved by: Josh Wilsdon \u003cjwilsdon@joyent.com\u003e\n","createdOn":1516063788,"lastUpdated":1516140692,"open":false,"status":"MERGED","comments":[{"timestamp":1516063788,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 1."},{"timestamp":1516063815,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516063927,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 2."},{"timestamp":1516063954,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516139398,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\n(2 comments)\n\nSo much winning here."},{"timestamp":1516140571,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1516140680,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3: Commit message was updated."},{"timestamp":1516140692,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Julien Gilli"}],"currentPatchSet":{"number":"3","revision":"0a9d1dda203abe24115325f1d1d5782e73c0b05d","parents":["768e026f7b2c390fa12c08bf605fa1cd07e14a42"],"ref":"refs/changes/21/3221/3","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516140680,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516063954,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1516140692,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/README.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":33,"deletions":-59},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":72,"deletions":-140},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/validation/uuid.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":68,"deletions":-50},{"file":"test/integration/nfs-shared-volumes-creation-invalid-names.test.js","type":"ADDED","insertions":101,"deletions":0},{"file":"test/integration/nfs-shared-volumes-creation-name-generation.test.js","type":"MODIFIED","insertions":16,"deletions":-38}],"sizeInsertions":299,"sizeDeletions":-299},"patchSets":[{"number":"1","revision":"453dbc967dce208294171358668d4871ab5fd6fc","parents":["768e026f7b2c390fa12c08bf605fa1cd07e14a42"],"ref":"refs/changes/21/3221/1","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516063788,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516063815,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/README.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":32,"deletions":-58},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":71,"deletions":-139},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"lib/validation/uuid.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":67,"deletions":-49},{"file":"test/integration/nfs-shared-volumes-creation-invalid-names.test.js","type":"ADDED","insertions":101,"deletions":0},{"file":"test/integration/nfs-shared-volumes-creation-name-generation.test.js","type":"MODIFIED","insertions":15,"deletions":-37}],"sizeInsertions":293,"sizeDeletions":-293},{"number":"2","revision":"f47da33f8dcdc2763418b45e4d7b7002bb796253","parents":["768e026f7b2c390fa12c08bf605fa1cd07e14a42"],"ref":"refs/changes/21/3221/2","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516063927,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516063954,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"docs/api/README.md","line":96,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Would it be worth mentioning that these are 8-bit characters? With non-ASCII character sets, the number could be lower, right?"},{"file":"docs/api/README.md","line":96,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"For the record: we validate that volume names match `/^[a-zA-Z0-9][a-zA-Z0-9_\\.\\-]+$/;`, which does not match unicode characters that are not in the ASCII set. Would it help if we mentioned that here?"},{"file":"test/integration/nfs-shared-volumes-creation-invalid-names.test.js","line":26,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Should we add a test just to confirm the behavior with a string of non-English text?\n\nDoes the name \u0027リュウグウノオトヒメノモトユイノキリハズシ\u0027 count as 21 characters or 63?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/README.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":33,"deletions":-59},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":72,"deletions":-140},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/validation/uuid.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":68,"deletions":-50},{"file":"test/integration/nfs-shared-volumes-creation-invalid-names.test.js","type":"ADDED","insertions":101,"deletions":0},{"file":"test/integration/nfs-shared-volumes-creation-name-generation.test.js","type":"MODIFIED","insertions":16,"deletions":-38}],"sizeInsertions":299,"sizeDeletions":-299},{"number":"3","revision":"0a9d1dda203abe24115325f1d1d5782e73c0b05d","parents":["768e026f7b2c390fa12c08bf605fa1cd07e14a42"],"ref":"refs/changes/21/3221/3","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1516140680,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516063954,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516139398,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1516140692,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/README.md","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":33,"deletions":-59},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":72,"deletions":-140},{"file":"lib/validation/predicate.js","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"lib/validation/uuid.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/validation/volumes.js","type":"MODIFIED","insertions":68,"deletions":-50},{"file":"test/integration/nfs-shared-volumes-creation-invalid-names.test.js","type":"ADDED","insertions":101,"deletions":0},{"file":"test/integration/nfs-shared-volumes-creation-name-generation.test.js","type":"MODIFIED","insertions":16,"deletions":-38}],"sizeInsertions":299,"sizeDeletions":-299}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}]}