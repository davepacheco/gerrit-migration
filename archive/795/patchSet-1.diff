commit f56628284f2d505c7cd62204c6ff496991f54527 (refs/changes/95/795/1)
Author: Cody Peter Mello <cody.mello@joyent.com>
Date:   2016-10-27T18:31:00+00:00 (2 years, 11 months ago)
    
    NAPI-369 Can't use URL /networks/admin/ips

diff --git a/lib/endpoints/networks/common.js b/lib/endpoints/networks/common.js
index a611dae..3e850bb 100644
--- a/lib/endpoints/networks/common.js
+++ b/lib/endpoints/networks/common.js
@@ -38,15 +38,23 @@ function ensureNetworkExists(netKey, req, res, next) {
     mod_net.get(opts, function (err, net) {
         if (err) {
             if (err.name === 'InvalidParamsError') {
-                return next(new mod_restify.ResourceNotFoundError(err,
+                next(new mod_restify.ResourceNotFoundError(err,
                     'network not found'));
+                return;
             }
-            return next(err);
+            next(err);
+            return;
         }
 
+        /*
+         * We copy the actual UUID over the original value, in case it was one
+         * of the allowed symbolic names, like "admin".
+         */
+        req.params[netKey] = net.uuid;
+
         req.params.network = net;
         req._network = net;
-        return next();
+        next();
     });
 }
 
