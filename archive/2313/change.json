{"project":"joyent/node-docker-registry-client","branch":"master","id":"Ifb8d0f6c448ffbcb7047665d03192d5f1a9edd54","number":"2313","subject":"DOCKER-524 Implement docker push Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/2313","commitMessage":"DOCKER-524 Implement docker push\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1501624766,"lastUpdated":1518024030,"open":false,"status":"MERGED","comments":[{"timestamp":1501624766,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1501624768,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit edff8c91fa8b826815196a4550e3287a234d6ccb\n    \n    update copyright year\n    \n    commit 80fee89d58d8e71eb5df8ac05cb8b9a1efc11053\n    \n    remove old comment\n    \n    commit 27efa72cad88c916b705d57bcb55ac43471928b8\n    \n    update amazon ecr tests to use newer schemaVersion\u003d2 manifests\n    \n    commit b6a1b9f0cae7af5070544a7554971e1497d395c3\n    \n    v2.2 manifests do not need to have layers, it can just have a config, whilst\n    the v2.1 manifests must have at least one layer (i.e. the config layer)\n    \n    commit fb2b8c69b5d7487c144e66a99bc0f9e32bf49c4b\n    \n    add Google container registry private tests\n    \n    commit 085c7b5ae77b46fedb595a237f8e65f13c1886b8\n    \n    update error handling of registry requests\n    \n    commit 598a41b2189b22df69a13532c8d20a0e57f1c98f\n    \n    Better error handling of docker registry errors.\n    \n    commit 8952b2fbe6bb8015c18c1c76344572d065b46869\n    \n    bump version and changelog\n    \n    commit 6d63de89cbe76cc10c27172fc5b863b330ecf357\n    \n    Add Amazon ecr push tests\n    \n    commit 1b95342e140fba485f29f3e57cdb4127fb55dc2d\n    \n    DOCKER-524 Implement docker push"},{"timestamp":1501624798,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511826713,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1511826714,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 20dad171f32de161798b1cccbb6d747e29108111\n    \n    update gcr to use a v2 repository\n    \n    commit e1979f0bd85bfc2d85f3c25304ffc53a2e11ce68\n    \n    remove unused blobDigest, use the manifest digest instead\n    \n    commit 400f270ffa36693b435aa30495fcc545aa07e795\n    \n    update copyright year\n    \n    commit 6b47a3f669ae1987119f37b11cfcdd54b3e24868\n    \n    remove old comment\n    \n    commit 609bf79cd39683a3b69071091519d652d710e96a\n    \n    update amazon ecr tests to use newer schemaVersion\u003d2 manifests\n    \n    commit 68a3201d7fa53cbbdfd3f8948748bb613c3a5f1c\n    \n    add Google container registry private tests\n    \n    commit 1f7bf26538cd978d3c7e7574181efbb96f6c96e6\n    \n    update error handling of registry requests\n    \n    commit 59541a2845bb6c6af3d1baca128f2886e34d7a4e\n    \n    Better error handling of docker registry errors.\n    \n    commit 1d00681a52894c697e1f514cfcf3d0e8cf6d5f90\n    \n    bump version and changelog\n    \n    commit fa00df3fe717e033518fb47e7f6a2f4c48a6f6ed\n    \n    Add Amazon ecr push tests\n    \n    commit 9d037302dbe4e34876a06f29edfb190e0085099b\n    \n    DOCKER-524 Implement docker push"},{"timestamp":1511826738,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511827756,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nTests are passing (except for jfrog-artifactory because my trial has expired and I cannot test it)."},{"timestamp":1517427590,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3."},{"timestamp":1517427591,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 20028ee0c41f6bc294d6d67720d7049847f62651\n    \n    update gcr to use a v2 repository\n    \n    commit 66bfcafc9c05106ed2fcf0f18923ab925ed8b93e\n    \n    remove unused blobDigest, use the manifest digest instead\n    \n    commit e6dd3fa66f02ab19b0617c86018951cbcabbe81e\n    \n    update copyright year\n    \n    commit 08162e457ed17136d54eea19fc056178f584e33d\n    \n    remove old comment\n    \n    commit 44c2aa3e8c5d928ef7c16564f8adf3862d787cbb\n    \n    update amazon ecr tests to use newer schemaVersion\u003d2 manifests\n    \n    commit 920d8d78a7777d6aee4e5f7fb3de7bc38435f75a\n    \n    add Google container registry private tests\n    \n    commit 1e25a83f64ae01fc7bb9ac40d8eb171e5342bf5e\n    \n    update error handling of registry requests\n    \n    commit 877a74e38e0e31704734e0811def8264971b3c2a\n    \n    Better error handling of docker registry errors.\n    \n    commit f49d0152705e5bbba5822ef069d46ade303a4803\n    \n    bump version and changelog\n    \n    commit aca20203b5ea0aed31878b89c083818ec0443d37\n    \n    Add Amazon ecr push tests\n    \n    commit 471a9b1f3ea270816c54c6fce159157c360a1005\n    \n    DOCKER-524 Implement docker push"},{"timestamp":1517427616,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517960708,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\n(4 comments)"},{"timestamp":1517961115,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\n(4 comments)"},{"timestamp":1517961124,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 4."},{"timestamp":1517961125,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit f021634cbecf9532bf40bb3c84c512cb3a248724\n    \n    fix log.trace call, remove duplicate maxSchemaVersion lines"},{"timestamp":1517961150,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1517966578,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1518024017,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1518024030,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"5","revision":"fb8d0f6c448ffbcb7047665d03192d5f1a9edd54","parents":["136fc82a3ef5f771a6771b92a6fc858953ecefeb"],"ref":"refs/changes/13/2313/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1518024017,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517961150,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1518024030,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":382,"deletions":-14},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":48,"deletions":-6},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":41,"deletions":-2},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":28,"deletions":-27},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1048,"sizeDeletions":-51},"patchSets":[{"number":"1","revision":"5bd3b5b8a1609658903ccf2275621d536c7fb146","parents":["b66d1a442da2a3a6bdad4bcb018acc795b99a165"],"ref":"refs/changes/13/2313/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1501624766,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1501624798,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":380,"deletions":-36},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":75,"deletions":-32},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":73,"deletions":-31},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1079,"sizeDeletions":-104},{"number":"2","revision":"f4bdd3d5052ab1365aeb090c0b893ba945104dbb","parents":["09242aa896b9511d91715d964d0d5ae3bc331d09"],"ref":"refs/changes/13/2313/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1511826713,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511826738,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":384,"deletions":-16},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":49,"deletions":-6},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":41,"deletions":-1},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":29,"deletions":-27},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1053,"sizeDeletions":-53},{"number":"3","revision":"79127f4c3bce908340fc663527ab2e7ddb62dec5","parents":["136fc82a3ef5f771a6771b92a6fc858953ecefeb"],"ref":"refs/changes/13/2313/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1517427590,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517427616,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/docker-json-client.js","line":95,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"that should still have the *function call* to res.log.trace. `log.trace()` without args is the way to see if trace-level is enabled on the logger."},{"file":"lib/docker-json-client.js","line":95,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"test/v2.amazonecr.test.js","line":103,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"dupe"},{"file":"test/v2.amazonecr.test.js","line":103,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Good spot - probably from my bad rebase."},{"file":"test/v2.dockerioprivate.test.js","line":69,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"duplicate maxSchemaVersion"},{"file":"test/v2.dockerioprivate.test.js","line":69,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"test/v2.gcrio.test.js","line":36,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"maxSchemaVersion in there twice, FWIW."},{"file":"test/v2.gcrio.test.js","line":36,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":382,"deletions":-14},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":49,"deletions":-6},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":42,"deletions":-2},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":28,"deletions":-26},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1051,"sizeDeletions":-51},{"number":"4","revision":"7e72398298ecd835f6ea75a76fbe0d66fcf16b38","parents":["136fc82a3ef5f771a6771b92a6fc858953ecefeb"],"ref":"refs/changes/13/2313/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1517961124,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517961150,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":382,"deletions":-14},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":48,"deletions":-6},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":41,"deletions":-2},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":28,"deletions":-27},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1048,"sizeDeletions":-51},{"number":"5","revision":"fb8d0f6c448ffbcb7047665d03192d5f1a9edd54","parents":["136fc82a3ef5f771a6771b92a6fc858953ecefeb"],"ref":"refs/changes/13/2313/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1518024017,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517961150,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1517966578,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1518024030,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"examples/v2/putManifest.js","type":"ADDED","insertions":82,"deletions":0},{"file":"examples/v2/uploadBlob.js","type":"ADDED","insertions":93,"deletions":0},{"file":"lib/docker-json-client.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":16,"deletions":0},{"file":"lib/registry-client-v2.js","type":"MODIFIED","insertions":382,"deletions":-14},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/v2.amazonecr.test.js","type":"MODIFIED","insertions":48,"deletions":-6},{"file":"test/v2.dockerioprivate.test.js","type":"MODIFIED","insertions":41,"deletions":-2},{"file":"test/v2.gcrio.test.js","type":"MODIFIED","insertions":28,"deletions":-27},{"file":"test/v2.gcrioprivate.test.js","type":"ADDED","insertions":352,"deletions":0}],"sizeInsertions":1048,"sizeDeletions":-51}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}