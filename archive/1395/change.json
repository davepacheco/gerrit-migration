{"project":"joyent/sdc-imgapi","branch":"master","id":"If71f1e97b49e69830aa64d45e3ab5ef141ae3357","number":"1395","subject":"DOCKER-893 Improve docker pull reliability Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/1395","commitMessage":"DOCKER-893 Improve docker pull reliability\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1485989718,"lastUpdated":1487896088,"open":false,"status":"MERGED","comments":[{"timestamp":1485989718,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1485989719,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit b1872e079598d2af3981c8807c795e4c887f916d\n    \n    DOCKER-893 Improve docker pull reliability"},{"timestamp":1485989751,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485989870,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNote: In order to test this I had to tweak the docker-registry-client blob stream to randomly \"pause\", which would induce a timeout."},{"timestamp":1486169028,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1486169056,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1486673945,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3."},{"timestamp":1486673947,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 2b4ab61fb94ae51d5cc81a3a547aa58a07342c64\n    \n    Part 2: when an image download fails, keep the downloaded layer info around, in\n    case the image is downloaded again, as we don\u0027t need to download the same bits\n    over and over"},{"timestamp":1486673979,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486772250,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\n(3 comments)"},{"timestamp":1487635095,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 4."},{"timestamp":1487635096,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 0c948dff5e36177c501231cdb0f8a4bc6412f812\n    \n    esnure docker registry client errors are wrapped in an IMGAPI error\n    \n    commit 14c2c1a48c2ee5e9e3f71e2984d3e291ad4ac1a0\n    \n    Use same `addImageFileAttempts` name for logging\n    \n    commit 09fd3d692272c0b009456c06852802415b228ecb\n    \n    Update error code documentation\n    \n    commit bfbd69912b59ae2b976a1681b0356e9223dd5354\n    \n    Part 2: when an image download fails, keep the downloaded layer info around, in\n    case the image is downloaded again, as we don\u0027t need to download the same bits\n    over and over\n    \n    commit 8fac52f74263e8ebe22c7cc0237f4a40132dda83\n    \n    DOCKER-893 Improve docker pull reliability"},{"timestamp":1487635123,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing-1\n\n(2 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1487635215,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\n(3 comments)"},{"timestamp":1487635716,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5."},{"timestamp":1487635717,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit e0744bacb435e772d2983069f0888b38e506a5a7\n    \n    esnure docker registry client errors are wrapped in an IMGAPI error\n    \n    commit 14c2c1a48c2ee5e9e3f71e2984d3e291ad4ac1a0\n    \n    Use same `addImageFileAttempts` name for logging\n    \n    commit 09fd3d692272c0b009456c06852802415b228ecb\n    \n    Update error code documentation\n    \n    commit bfbd69912b59ae2b976a1681b0356e9223dd5354\n    \n    Part 2: when an image download fails, keep the downloaded layer info around, in\n    case the image is downloaded again, as we don\u0027t need to download the same bits\n    over and over\n    \n    commit 8fac52f74263e8ebe22c7cc0237f4a40132dda83\n    \n    DOCKER-893 Improve docker pull reliability"},{"timestamp":1487635750,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487720480,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\n(4 comments)"},{"timestamp":1487801401,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 6."},{"timestamp":1487801402,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit ac20d68b67e7b10b80f01ec533cb374534a97f37\n    \n    wrap docker registry client errors, cleanup wrapDrcError function\n    \n    commit 6f26e31b2e0076a3752221a71933bbb7eab45362\n    \n    Assert stream.connection, use MAX_IMAGE_FILE_DOWNLOAD_ATTEMPTS constant."},{"timestamp":1487801435,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487806818,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 7."},{"timestamp":1487806820,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 7f9f0b34788716cfe7ca8f842334e721aae4e731\n    \n    fix scoping of addImageFileAttempts variable\n    \n    commit 6c9334d2a4b28ab9b15f36c099eda81147b106fc\n    \n    use DownloadError"},{"timestamp":1487806851,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487808349,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 8."},{"timestamp":1487808350,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit fd8155e287f1835d682a11f83a1f783a1c584c80\n    \n    add log entry when not retrying a download"},{"timestamp":1487808376,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487808592,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 9."},{"timestamp":1487808593,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit ece2375c2973e3bfbfd3f10a1722fed40fd00e34\n    \n    change DOCKER_READ_STREAM_TIMEOUT to 15 seconds"},{"timestamp":1487808619,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487814847,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 9: Code-Review+1 Integration-Approval+1"},{"timestamp":1487895249,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 10."},{"timestamp":1487895250,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit 9ae15fec1e1e0c9ae2f4a3027de39bb53877c6e7\n    \n    add NotFoundError"},{"timestamp":1487895276,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487895750,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 10: Code-Review+1 Integration-Approval+1"},{"timestamp":1487896088,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"10","revision":"f71f1e97b49e69830aa64d45e3ab5ef141ae3357","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/10","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487895249,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487895276,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487895750,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487895750,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1487896088,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":40,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":126,"deletions":-12}],"sizeInsertions":169,"sizeDeletions":-12},"patchSets":[{"number":"1","revision":"a637d1f0e5e0a820cb5b46665f5f73036597e20b","parents":["f6c069cfb438086206ef34206e322e8dab18973a"],"ref":"refs/changes/95/1395/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1485989718,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485989751,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":78,"deletions":-2}],"sizeInsertions":78,"sizeDeletions":-2},{"number":"2","revision":"6d3eaa4dcd4b9199a930d5238ab6231ccb3dc755","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1486169028,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485989751,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":78,"deletions":-2}],"sizeInsertions":78,"sizeDeletions":-2},{"number":"3","revision":"91b0352471f02cc7c1ea7e2f1c4762326d1ab6b7","parents":["f6c069cfb438086206ef34206e322e8dab18973a"],"ref":"refs/changes/95/1395/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1486673945,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486673979,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/images.js","line":2662,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"When would we not have a stream.connection?"},{"file":"lib/images.js","line":2662,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"If the stream is not a socket stream (i.e. not a restify response) - Stream API doesn\u0027t define a connection, so it felt misleading to assume it does - I could change that to an assert?"},{"file":"lib/images.js","line":2662,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"What do you think? I think every code path to here we expect to have a socket stream, right? I\u0027d be fine with an assert."},{"file":"lib/images.js","line":2708,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Call that \u0027addImageFileAttempts\u0027, no reason to not have the record field match the code."},{"file":"lib/images.js","line":2708,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/images.js","line":3684,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Discussed in chat with Todd. Conclusion:\n\nHere is what I think is cleanest:\n\n- the spec for https://mo.joyent.com/docs/imgapi/master/#AdminImportDockerImage is that the error.code values are those from https://mo.joyent.com/docs/imgapi/master/#errors    I.e. \"Download\" for this one\n- we actually mention that in the doc for that endpoint\n- we change sdc-docker to check both (with a comment on the DownloadError that it is for older and looser IMGAPI versions)\n- we update the IMGAPI code to wrap incoming drc errors so that, at least for this one, we get \"Download\""},{"file":"lib/images.js","line":3684,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I\u0027ve updated, take a look at the new code - not 100% happy with it, so suggestions welcome for changes."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":120,"deletions":-3}],"sizeInsertions":120,"sizeDeletions":-3},{"number":"4","revision":"56edf404ceca58a03d65ab6961072de29fe17e84","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487635095,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1487635123,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":538,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"missing space before left brace"},{"file":"lib/errors.js","line":546,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"improper boolean continuation"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":116,"deletions":-10}],"sizeInsertions":151,"sizeDeletions":-10},{"number":"5","revision":"da1f2fc93b782efaec92062830aa6823e4a093eb","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487635716,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487635750,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":602,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"remove debugging code"},{"file":"lib/images.js","line":2694,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"might be nice to call this out to a constant"},{"file":"lib/images.js","line":3669,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"It would mean more code changes *now*, but one idea would to have the wrapping of errors happen at the code spot where they are created. Then a \"wrapErrorFromDrc\" would always be close to where a \"drcClient.FOO\" call is made, and it would only need to deal with errors documented to come from DRC, perhaps just wrapping them all? most? in errors.RemoteSourceError.\n\nThen perhaps we could get to a place where it is a bug if the `err` that gets here isn\u0027t an instance of one of the error classes in our ./errors.js. If it were easy to check that inheritance, then we could have a guard here on that and only wrap those that aren\u0027t already one of those error instances. I\u0027m not sure that is easy to check on tho."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":32,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":116,"deletions":-10}],"sizeInsertions":151,"sizeDeletions":-10},{"number":"6","revision":"51211f5b4e0dae6b2d2df86f2476d150b16ea54b","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487801401,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487801435,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":37,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":123,"deletions":-12}],"sizeInsertions":163,"sizeDeletions":-12},{"number":"7","revision":"fc595c6a5828a8d0c0964917ea8ff47e9e117c24","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/7","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487806818,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487806851,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":37,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":123,"deletions":-12}],"sizeInsertions":163,"sizeDeletions":-12},{"number":"8","revision":"dac42cf58b4c9812eb5d5c0fba09a40d4773d2a9","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/8","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487808349,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487808376,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":37,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":126,"deletions":-12}],"sizeInsertions":166,"sizeDeletions":-12},{"number":"9","revision":"b5ae9784a98aaa8ae0f6b36c89eb6b70fae18194","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/9","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487808592,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487808619,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487814847,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487814847,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":37,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":126,"deletions":-12}],"sizeInsertions":166,"sizeDeletions":-12},{"number":"10","revision":"f71f1e97b49e69830aa64d45e3ab5ef141ae3357","parents":["60af6b1a3c304e8704d7f21a354bad89b629d897"],"ref":"refs/changes/95/1395/10","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1487895249,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487895276,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487895750,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487895750,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1487896088,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":40,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":126,"deletions":-12}],"sizeInsertions":169,"sizeDeletions":-12}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}