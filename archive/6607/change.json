{"project":"joyent/sdc-cn-agent","branch":"master","id":"I3ddd65a35e6bc3d30c3755bf4ca671b6c3c7f1a8","number":"6607","subject":"TRITON-1749 sdc-migrate zfs quotas are perturbed by flexible disk Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Reviewed by: Ryan Kitchen \u003cryan.kitchen@joyent.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"url":"https://cr.joyent.us/6607","commitMessage":"TRITON-1749 sdc-migrate zfs quotas are perturbed by flexible disk\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nReviewed by: Ryan Kitchen \u003cryan.kitchen@joyent.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1563302970,"lastUpdated":1563405680,"open":false,"status":"MERGED","comments":[{"timestamp":1563302970,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 1."},{"timestamp":1563302971,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit d57a2ba6178e657506cb15e1c789a38041d94d1b\n    \n    use \u0027reservation\u0027 value rather than \u0027used\u0027 when restoring quota"},{"timestamp":1563303008,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1563304305,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1563304634,"reviewer":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1563380426,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 2."},{"timestamp":1563380427,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 0115a0d83564b7a49d0889b2c3d0ddba9c1c6d33\n    \n    refine wording"},{"timestamp":1563380467,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1563381796,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1563383028,"reviewer":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1563405347,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1563405655,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1563405663,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1563405680,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Orlando Vazquez"}],"currentPatchSet":{"number":"4","revision":"3ddd65a35e6bc3d30c3755bf4ca671b6c3c7f1a8","parents":["8af2265b65333895f8232a8d64e628f3852581bc"],"ref":"refs/changes/07/6607/4","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1563405663,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563380467,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563381796,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563383028,"by":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563405655,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1563405680,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/backends/smartos/tasks/machine_migrate.js","type":"MODIFIED","insertions":8,"deletions":-5}],"sizeInsertions":8,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"e1208547eba3d20630d1a116b670ef3751f3ef2f","parents":["8af2265b65333895f8232a8d64e628f3852581bc"],"ref":"refs/changes/07/6607/1","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1563302970,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563303008,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563304634,"by":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"}}],"comments":[{"file":"lib/backends/smartos/tasks/machine_migrate.js","line":296,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Let\u0027s add some justification as to why reservation is the right property.  Maybe this:\n\nFor bhyve, quota and reservation typically have the same value.  Earlier we relaxed the quota to allow snapshots to take extra space.  Now restore quota to its previous value, which is found in reservation."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backends/smartos/tasks/machine_migrate.js","type":"MODIFIED","insertions":5,"deletions":-5}],"sizeInsertions":5,"sizeDeletions":-5},{"number":"2","revision":"d7af2b3f79e35a43472e583fc289e254bff99f45","parents":["8af2265b65333895f8232a8d64e628f3852581bc"],"ref":"refs/changes/07/6607/2","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1563380426,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563380467,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563381796,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563383028,"by":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/backends/smartos/tasks/machine_migrate.js","type":"MODIFIED","insertions":8,"deletions":-5}],"sizeInsertions":8,"sizeDeletions":-5},{"number":"3","revision":"9698efaeb87ee0c3acfd2ed7822a022a7c9bec97","parents":["8af2265b65333895f8232a8d64e628f3852581bc"],"ref":"refs/changes/07/6607/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1563405347,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563380467,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563405655,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563381796,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563383028,"by":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/backends/smartos/tasks/machine_migrate.js","type":"MODIFIED","insertions":8,"deletions":-5}],"sizeInsertions":8,"sizeDeletions":-5},{"number":"4","revision":"3ddd65a35e6bc3d30c3755bf4ca671b6c3c7f1a8","parents":["8af2265b65333895f8232a8d64e628f3852581bc"],"ref":"refs/changes/07/6607/4","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1563405663,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563380467,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1563405655,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1563405680,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563381796,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1563383028,"by":{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/backends/smartos/tasks/machine_migrate.js","type":"MODIFIED","insertions":8,"deletions":-5}],"sizeInsertions":8,"sizeDeletions":-5}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Ryan Kitchen","email":"ryan.kitchen@joyent.com","username":"joyfulrabbit"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}