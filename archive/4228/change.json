{"project":"joyent/moray","branch":"master","topic":"MORAY-295","id":"Ic668abd712b23c18561f44486f1b32803ca04801","number":"4228","subject":"MORAY-295 Add support for filtering subnets by contained addresses MORAY-471 Filtering on arrays is broken for non-equality tests MORAY-327 Add support for \"numrange\" and \"daterange\" types MORAY-476 Add support for \"date\", \"mac\", and \"uuid\" types MORAY-47","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/4228","commitMessage":"MORAY-295 Add support for filtering subnets by contained addresses\nMORAY-471 Filtering on arrays is broken for non-equality tests\nMORAY-327 Add support for \"numrange\" and \"daterange\" types\nMORAY-476 Add support for \"date\", \"mac\", and \"uuid\" types\nMORAY-477 Float values put into \"number\" fields get truncated to integers\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\nApproved by: Dan McDonald \u003cdanmcd@joyent.com\u003e\n","createdOn":1529032592,"lastUpdated":1529694294,"open":false,"status":"MERGED","comments":[{"timestamp":1529032592,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1529032647,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529108971,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1529109022,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529345382,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1529345433,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529345586,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Topic set to MORAY-295"},{"timestamp":1529369890,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1529369938,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529428367,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1529428417,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529505329,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1529693456,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1529693487,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5: -Integration-Approval\n\nOne question.  I just want to make sure I understand... there\u0027s no right or wrong answer.\n\nInternal to Moray, IPv4 address a.b.c.d and IPv6 address ::ffff:a.b.c.d are stored the same internally (thanks to the ipv6 parser), and the caller does not need to normalize to one form or the other if it accepts both as equal inputs?"},{"timestamp":1529693900,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n\u003e Internal to Moray, IPv4 address a.b.c.d and IPv6 address ::ffff:a.b.c.d are stored the same internally (thanks to the ipv6 parser), and the caller does not need to normalize to one form or the other if it accepts both as equal inputs?\n\nNope, they\u0027re stored as they\u0027re inserted. So if you write a.b.c.d, you get a.b.c.d back. If you store ::ffff:a.b.c.d, then that\u0027s what you get back."},{"timestamp":1529694054,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1\n\n\u003e Nope, they\u0027re stored as they\u0027re inserted. So if you write a.b.c.d,\n \u003e you get a.b.c.d back. If you store ::ffff:a.b.c.d, then that\u0027s what\n \u003e you get back.\n\nSo it *is* up to the caller/sender/whatever to normalize if caller/sender/whatever wants it all in one form.\n\nLike I said, there\u0027s no right/wrong answer, so long as the behavior is clearly understood.  (If there\u0027s documentation, make sure this phenomenon is documented in a separate bug/commit/push?)"},{"timestamp":1529694212,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1529694244,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1529694251,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"},{"timestamp":1529694294,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"7","revision":"b56907cd13edffc84ede4f266c0a5d506a284000","parents":["89b0a67d084475e530b734496bc9e1638d8f8ddc"],"ref":"refs/changes/28/4228/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529694244,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529428417,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529505329,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"SUBM","value":"1","grantedOn":1529694251,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":372,"deletions":-119},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":562,"sizeDeletions":-129},"patchSets":[{"number":"1","revision":"8d87dbbe80dc233271d5710c6775c61b752d206f","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529032592,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529032647,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":334,"deletions":-74},{"file":"lib/pg.js","type":"MODIFIED","insertions":51,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":531,"sizeDeletions":-84},{"number":"2","revision":"f794c9406052a730d6b11858e237eb42adc5576f","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529108971,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529109022,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":356,"deletions":-112},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":546,"sizeDeletions":-122},{"number":"3","revision":"e1b72762edd88060163dc58a9a262dee19ff8ebf","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529345382,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529345433,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":356,"deletions":-118},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":546,"sizeDeletions":-128},{"number":"4","revision":"0bd6ae1e03918383d3b5fabf5bd21aa05200e662","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529369890,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529369938,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":363,"deletions":-119},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":553,"sizeDeletions":-129},{"number":"5","revision":"c668abd712b23c18561f44486f1b32803ca04801","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529428367,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529428417,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529505329,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":372,"deletions":-119},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":562,"sizeDeletions":-129},{"number":"6","revision":"d8bf73e99806f71a527cd050da439557795302b2","parents":["1230c10ec05aa24a54d7d9d0dd19659814aa0ca7"],"ref":"refs/changes/28/4228/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529694212,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529428417,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529505329,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":372,"deletions":-119},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":562,"sizeDeletions":-129},{"number":"7","revision":"b56907cd13edffc84ede4f266c0a5d506a284000","parents":["89b0a67d084475e530b734496bc9e1638d8f8ddc"],"ref":"refs/changes/28/4228/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529694244,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"SUBM","value":"1","grantedOn":1529694251,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529428417,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529505329,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1529694054,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"lib/buckets/common.js","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":372,"deletions":-119},{"file":"lib/pg.js","type":"MODIFIED","insertions":44,"deletions":0},{"file":"lib/types.js","type":"MODIFIED","insertions":144,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":562,"sizeDeletions":-129}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}