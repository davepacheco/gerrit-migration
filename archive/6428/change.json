{"project":"joyent/illumos-joyent","branch":"master","id":"Ide37b27aa9332f8b33b7b4041b3bdaa6894dcde9","number":"6428","subject":"OS-7835 bhyve modules should have mapfiles Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/6428","commitMessage":"OS-7835 bhyve modules should have mapfiles\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\n","createdOn":1560364734,"lastUpdated":1560525376,"open":false,"status":"MERGED","comments":[{"timestamp":1560364734,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1560365575,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1560366112,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1560367764,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1560448579,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1560449045,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1560450899,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\nTest notes in the ticket"},{"timestamp":1560517340,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1560517578,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1560523787,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1560523867,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1560525376,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"4","revision":"de37b27aa9332f8b33b7b4041b3bdaa6894dcde9","parents":["3812225f415409fb9a9021dfb89e3e794b0a1e52"],"ref":"refs/changes/28/6428/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560523867,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560449045,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517340,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"SUBM","value":"1","grantedOn":1560525376,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/Makefile.targ","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/viona/viona.mapfile","type":"ADDED","insertions":41,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.mapfile","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/i86pc/ppt/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/viona/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/vmm/Makefile","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":163,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"ea6f02e91034e3634fad39398c93a9507bc57d20","parents":["e6de8afafa8b73b0636044f094ba810178b0a271"],"ref":"refs/changes/28/6428/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560364734,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The following are some globals that I\u0027m not sure if they\u0027re meant to be tunables or not.\n\n* vmm_alloc_hash_nchains\n* vmm_alloc_hash_size\n* cpu_high\n* cpu_exthigh\n* cpu_id\n* cpu_vendor\n* ivhd_devs\n* ivhd_count"},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","line":0,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"None are really meant to be tunable like that."},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, thanks for confirming."},{"file":"usr/src/uts/i86pc/ppt/Makefile","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Maybe we should use a different variable then instead of overriding? Or is intentional to override? The -zdefs Makefile.mapfile uses MAPFILES though and because including that turns on -zdefs, that might not be useful."},{"file":"usr/src/uts/i86pc/ppt/Makefile","line":36,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m open to different approaches on this.  Initially, I defined it above the include (Like in uts/common modules) but was surprised by the definition in Makefile.i86pc.  Dragging in additional includes sounds like it could get complicated in a hurry."},{"file":"usr/src/uts/i86pc/ppt/Makefile","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It looks like the above is always just defining the unix mapfile though it\u0027s not always actually used in all of the components and only the few that specify and manually include the MAPFILE. Maybe we should change it\u0027s scope or call it something less generic? I think that\u0027d make it a little clearer. When I first saw this I was worried we were omitting the standard mapfiles that would have been an analogue for when we\u0027re in usr/src/lib. But that\u0027s not the case this time."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.mapfile","type":"ADDED","insertions":41,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.mapfile","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/i86pc/ppt/Makefile","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/i86pc/viona/Makefile","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/i86pc/vmm/Makefile","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":167,"sizeDeletions":-3},{"number":"2","revision":"d3542e8e8e7b31e07664148134df8684e7d375a1","parents":["1f79f23316512a7271211767a997ac719da76e1e"],"ref":"refs/changes/28/6428/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560448579,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560449045,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517340,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/Makefile.targ","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/viona/viona.mapfile","type":"ADDED","insertions":41,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.mapfile","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/i86pc/ppt/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/viona/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/vmm/Makefile","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":163,"sizeDeletions":-5},{"number":"3","revision":"8194a15e491951048da5d1058fc39bf1c2054321","parents":["3812225f415409fb9a9021dfb89e3e794b0a1e52"],"ref":"refs/changes/28/6428/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560523787,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560449045,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517340,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/Makefile.targ","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/viona/viona.mapfile","type":"ADDED","insertions":41,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.mapfile","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/i86pc/ppt/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/viona/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/vmm/Makefile","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":163,"sizeDeletions":-5},{"number":"4","revision":"de37b27aa9332f8b33b7b4041b3bdaa6894dcde9","parents":["3812225f415409fb9a9021dfb89e3e794b0a1e52"],"ref":"refs/changes/28/6428/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560523867,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560449045,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1560525376,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1560517578,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560517340,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/Makefile.targ","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/viona/viona.mapfile","type":"ADDED","insertions":41,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/io/ppt.mapfile","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/i86pc/ppt/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/viona/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/vmm/Makefile","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":163,"sizeDeletions":-5}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}