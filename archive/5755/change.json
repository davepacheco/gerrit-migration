{"project":"joyent/manta-muskie","branch":"master","id":"I1853eeb5e98b0ce26b9c336c17a05e2f614f8dfa","number":"5755","subject":"MANTA-3519 Relocate picker unit test Reviewed by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e Approved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e","owner":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"url":"https://cr.joyent.us/5755","commitMessage":"MANTA-3519 Relocate picker unit test\nReviewed by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e\nApproved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e\n","createdOn":1552324851,"lastUpdated":1552497991,"open":false,"status":"MERGED","comments":[{"timestamp":1552324851,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 1."},{"timestamp":1552324857,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit f56d8bfc141fe269fb2e5e300a319669f78a3a6e\n    \n    MANTA-3519 move picker test from lib to test\n    The test was pretty bit rotted, so I had to change it match the\n    current picker constructor, and the local unit tests. Not knowing the\n    TYPEs of the arguments to `sortAndStoreDcs` having bin/mpicker to crib\n    from was invaluable.\n    This test doesn\u0027t actually assert anything yet, it looks like it was\n    written to be run manually and have the report eye-balled by a\n    human. I think adding a back-of-envelope style normality test for the\n    distribution of picked targets would be doable."},{"timestamp":1552389896,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 2."},{"timestamp":1552389900,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit f410eb502dabe88c8c16e3e2de023fbc024946be\n    \n    MANTA-3519 test for normal distribution in picker\n    The test that was lifted from lib/picker.js didn\u0027t have any actual\n    assertions. It looks like it was meant to be run manually to eye-ball\n    the result. This change adds a rough (sadly non-deterministic)\n    assertion that the sharks picked by picker follow a normal\n    distribution.\n    I left the `report` function in place as it will make deciding WHY the\n    test failed (i.e. black swan event) when the test can be manually\n    re-run to confirm.\n    Ideally I\u0027d use property based testing, and something like the EQC\n    ?SOMETIMES macro here."},{"timestamp":1552390538,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 3."},{"timestamp":1552390542,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 85c34fdf088e218c2d393840816ac2144465b0f1\n    \n    MANTA-3519 only report on test failure\n    And fix some typos/remove redundant comment"},{"timestamp":1552402909,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 4."},{"timestamp":1552402916,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 8df52ea4c0b0bebd75b90a552bef49a7d10ab91b\n    \n    MANTA-3519 lint and style changes"},{"timestamp":1552452645,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 4: Code-Review+1\n\n(1 comment)\n\nThe code looks good. I tried them for myself and they pass as expected. I do notice that the automated CI has not weighed in on this. Probably worth checking with Alex to see about unsticking the CI for this repo and making sure it\u0027s happy."},{"timestamp":1552494933,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 5."},{"timestamp":1552494937,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 0d05990d2c2f24279e6b9d75d6e5a5b793597ccd\n    \n    MANTA-3519 clarify reference to eqc ?SOMETIMES\n    Addressing review comments"},{"timestamp":1552496031,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1552497634,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1552497759,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1552497791,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"},{"timestamp":1552497830,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1552497943,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 8."},{"timestamp":1552497959,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 9: Patch Set 8 was rebased"},{"timestamp":1552497968,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Russell Brown"},{"timestamp":1552497974,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"},{"timestamp":1552497991,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"9","revision":"329dd7719e25c4edfb0c1a7729a8e825cb2802fd","parents":["688e22b06e24b93200c5202d59a241dfdc58a672"],"ref":"refs/changes/55/5755/9","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552497959,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1552497968,"by":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566},"patchSets":[{"number":"1","revision":"0a6ea3865a2b3cafc4c861aeaea7111caadac11d","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/1","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552324851,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-129},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":125,"deletions":0}],"sizeInsertions":197,"sizeDeletions":-564},{"number":"2","revision":"2869c45f5b3e15b0e9b6062e777e2a7527050447","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/2","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552389896,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-129},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":285,"sizeDeletions":-564},{"number":"3","revision":"ef47a4367202c7d932c07cc5479a1ada36e15706","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/3","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552390538,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-129},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":217,"deletions":0}],"sizeInsertions":289,"sizeDeletions":-564},{"number":"4","revision":"b5b7e808aaf8261c5f49458108d5b3e51dcf628e","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/4","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552402909,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552452645,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"comments":[{"file":"test/picker.test.js","line":91,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"I might suggest a bit more detail (or just a docs link) about the ?SOMETIMES macro and/or to explicitly reference Erlang quickcheck since not all things called quickcheck have that. This will also help those who come across this comment who don\u0027t understand the reference."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":218,"deletions":0}],"sizeInsertions":290,"sizeDeletions":-566},{"number":"5","revision":"ee0e2a7090d189e6b20c410f08b79d64e61fd9b1","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/5","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552494933,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566},{"number":"6","revision":"6b9bf8f46c2b162f4a05d0ebd551adf1e048fdec","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/6","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552497634,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566},{"number":"7","revision":"c1091933094e7cf0f7a6989712a0443bfeb162cd","parents":["688e22b06e24b93200c5202d59a241dfdc58a672"],"ref":"refs/changes/55/5755/7","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552497759,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566},{"number":"8","revision":"1853eeb5e98b0ce26b9c336c17a05e2f614f8dfa","parents":["02bcc8b6a2e7f0cd2cf8eeae445215df54c0f9ba"],"ref":"refs/changes/55/5755/8","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552497943,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566},{"number":"9","revision":"329dd7719e25c4edfb0c1a7729a8e825cb2802fd","parents":["688e22b06e24b93200c5202d59a241dfdc58a672"],"ref":"refs/changes/55/5755/9","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1552497959,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496031,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552497830,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1552497968,"by":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/picker.js","type":"MODIFIED","insertions":4,"deletions":-131},{"file":"test/picker.records.json","type":"ADDED","insertions":68,"deletions":0},{"file":"test/picker.stub.json","type":"DELETED","insertions":0,"deletions":-435},{"file":"test/picker.test.js","type":"ADDED","insertions":220,"deletions":0}],"sizeInsertions":292,"sizeDeletions":-566}],"allReviewers":[{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}]}