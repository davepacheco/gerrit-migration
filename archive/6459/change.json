{"project":"joyent/sdc-adminui","branch":"master","id":"I9da2d64fa47af55ee89c9f4ba408f986d3b68811","number":"6459","subject":"TRITON-1649 Add \"flexible_disk\" to AdminUI packages UI Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/6459","commitMessage":"TRITON-1649 Add \"flexible_disk\" to AdminUI packages UI\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\n","createdOn":1560860184,"lastUpdated":1561657405,"open":false,"status":"MERGED","comments":[{"timestamp":1560860184,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1560860189,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 3dc1f4da7f3e15b326bbffd3e234bd8f61d304bf\n    \n    TRITON-1649 Add flexible_disk to AdminUI packages UI"},{"timestamp":1560860221,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1560860324,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1560860329,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit c4763ebf9c735a33c47b3ceb8f20a3d448c7446f\n    \n    TRITON-1649 Add flexible_disk to AdminUI packages UI"},{"timestamp":1560860344,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nAdded testing screenshots to the JIRA issue"},{"timestamp":1560860364,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1561063212,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\n(10 comments)"},{"timestamp":1561653964,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1561653969,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 9cd22b2f0935e6bc1dd84ddceb43602d92f82146\n    \n    TRITON-1649 Add flexible_disk to AdminUI packages UI"},{"timestamp":1561654002,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1561654006,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(7 comments)\n\nSome suggestions applied, some explanations given to those which cannot be taken due to \"the dynamic nature of web applications\" ;-)"},{"timestamp":1561654094,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1561654099,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 8f91e24ac44b8b1f21eb85e5d08bd49d2046f5d3\n    \n    TRITON-1649 Add flexible_disk to AdminUI packages UI"},{"timestamp":1561654129,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1561654913,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1561657093,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1561657397,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1561657405,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"5","revision":"9da2d64fa47af55ee89c9f4ba408f986d3b68811","parents":["4d5c9a10231bb7cfcf216064a7f7ff6e06d40822"],"ref":"refs/changes/59/6459/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1561657397,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561654002,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561654913,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561657093,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"SUBM","value":"1","grantedOn":1561657405,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":26,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":278,"sizeDeletions":-101},"patchSets":[{"number":"1","revision":"9579c9fd7decfa64edeef63b9a341c9e6e7f4467","parents":["ef79c2b2a11b539c4d46a1a0a54c4f31a887cfad"],"ref":"refs/changes/59/6459/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1560860184,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1560860221,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"www/js/views/packages-form.js","line":36,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: trailing_comma"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"tools/rsync-to","type":"ADDED","insertions":76,"deletions":0},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":352,"sizeDeletions":-101},{"number":"2","revision":"cb8f613ca0745ccc94b3c3c8ab0dc0d571dfb208","parents":["ef79c2b2a11b539c4d46a1a0a54c4f31a887cfad"],"ref":"refs/changes/59/6459/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1560860324,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1560860364,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/packages.js","line":42,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Do we need to check the type of params.flexible_disk and params.disks?"},{"file":"lib/packages.js","line":42,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"None of the other parameters is being validated. AFAIK AdminUI will display whatever the error message it gets from PAPI, which is where validation is performed so I\u0027ll probably go for that approach too."},{"file":"tools/rsync-to","line":1,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems odd to add this file but nothing in the repo references it.  Maybe an update to README.md is needed."},{"file":"tools/rsync-to","line":1,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I\u0027m gonna remove this file. It\u0027s possibly more convenient to build straight into the AdminUI zone from whatever the server we\u0027re trying to deploy to in order to avoid node modules mismatch."},{"file":"tools/rsync-to","line":22,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"set PATH"},{"file":"tools/rsync-to","line":31,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Check $# before using, print usage message if not set."},{"file":"tools/rsync-to","line":42,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"never used"},{"file":"www/js/tpl/package.hbs","line":104,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Seems as though lines 105 - 125 should only be active when brand is bhyve.  Maybe:\n\n{{#ifeq brand \"bhyve\"}}"},{"file":"www/js/tpl/package.hbs","line":104,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done. I \"invented\" `ifeq` at a later development stage :-)"},{"file":"www/js/tpl/package.hbs","line":113,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems this should only be displayed when the brand is bhyve and as such there should be no need for this text."},{"file":"www/js/tpl/package.hbs","line":113,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"www/js/tpl/packages-form.hbs","line":235,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"hmm, it seems this should be the first in the list (alphabetically and strategically)."},{"file":"www/js/tpl/packages-form.hbs","line":235,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"www/js/tpl/packages-form.hbs","line":241,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems that this should be after the spot where flexible_disk is checked, then this div should be wrapped in\n\n{{#if flexible_disk}}"},{"file":"www/js/tpl/packages-form.hbs","line":241,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"We cannot do that since flexible disk checkbox can be checked/unchecked during the edition/creation of a package so things will change and we want the disks to be available and \"enabled\" when appropriate.\n\nWhat we\u0027re doing here is to pay attention to disks contents only when necessary and disable (read-only) the disks fields when the brand is not bhyve."},{"file":"www/js/tpl/packages-form.hbs","line":277,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"{{#ifeq brand \"bhyve\"}}"},{"file":"www/js/tpl/packages-form.hbs","line":277,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same reasoning than before: the brand value can be modified during the form editing. We need to selectively \"enable/disable\" the checkbox depending on that value, which is what we do at packages-form.js file, concretely at `checkBrandSpecifics`"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"tools/rsync-to","type":"ADDED","insertions":76,"deletions":0},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":24,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":352,"sizeDeletions":-101},{"number":"3","revision":"218e37f6b6914174735b97767df682ec76c1106d","parents":["ef79c2b2a11b539c4d46a1a0a54c4f31a887cfad"],"ref":"refs/changes/59/6459/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1561653964,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561654002,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":26,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":278,"sizeDeletions":-101},{"number":"4","revision":"5119062defc9f6dde5dcc9d8dd997f056527484e","parents":["4d5c9a10231bb7cfcf216064a7f7ff6e06d40822"],"ref":"refs/changes/59/6459/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1561654094,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561654002,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561654913,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561657093,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":26,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":278,"sizeDeletions":-101},{"number":"5","revision":"9da2d64fa47af55ee89c9f4ba408f986d3b68811","parents":["4d5c9a10231bb7cfcf216064a7f7ff6e06d40822"],"ref":"refs/changes/59/6459/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1561657397,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1561654002,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1561657405,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561654913,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561657093,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":18,"deletions":0},{"file":"less/package.less","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/packages.js","type":"MODIFIED","insertions":61,"deletions":-31},{"file":"www/js/tpl/package.hbs","type":"MODIFIED","insertions":26,"deletions":-1},{"file":"www/js/tpl/packages-form.hbs","type":"MODIFIED","insertions":37,"deletions":-6},{"file":"www/js/views/package.js","type":"MODIFIED","insertions":45,"deletions":-26},{"file":"www/js/views/packages-form.js","type":"MODIFIED","insertions":74,"deletions":-22},{"file":"www/js/views/packages.js","type":"MODIFIED","insertions":13,"deletions":-11}],"sizeInsertions":278,"sizeDeletions":-101}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}