{"project":"joyent/sdc-vm-agent","branch":"master","id":"I22dd5e1fdac26cc0d499632e3fcb31c9e2ca2cde","number":"4715","subject":"TRITON-699 Remove JSStyle and Javascriptlint from net-agent TRITON-700 vm-agent can be less special and use the joyent eslint plugin Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Trent Mick \u003ctrentm@gma","owner":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"url":"https://cr.joyent.us/4715","commitMessage":"TRITON-699 Remove JSStyle and Javascriptlint from net-agent\nTRITON-700 vm-agent can be less special and use the joyent eslint plugin\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1534529047,"lastUpdated":1535121055,"open":false,"status":"MERGED","comments":[{"timestamp":1534529047,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Uploaded patch set 1."},{"timestamp":1534529070,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1534529099,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Patch Set 1:\n\nFrom CoaL\n\n\n- SmartOS (build: 20180510T023304Z)\nYou have new mail.\n[root@headnode (single-dc) ~]# cd /opt/smartdc/agents/lib/node_modules/vm-agent\n[root@headnode (single-dc) /opt/smartdc/agents/lib/node_modules/vm-agent]# ./runtests \nTo run this test you must create the file:\n\n    /lib/sdc/.sdc-test-no-production-data\n\nafter ensuring you have no production data on this machine.\n[root@headnode (single-dc) /opt/smartdc/agents/lib/node_modules/vm-agent]# touch /lib/sdc/.sdc-test-no-production-data\n[root@headnode (single-dc) /opt/smartdc/agents/lib/node_modules/vm-agent]# ./runtests \nTAP version 13\n# find SmartOS image\nok 1 load images from imgadm\nok 2 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 3 find SmartOS Image\n# load existing VMs\nok 4 vmadm lookup\n# starting FsWatcher\nok 5 created FsWatcher\n# create VM\nok 6 create VM\nok 7 VM has uuid: c3e720f7-a247-4052-8b07-e88457fe1748\nok 8 Watcher saw expected create (0 ms)\n# put metadata using mdata-put\nok 9 mdata-put\nok 10 Watcher saw expected modify (0 ms)\n# delete VM\nok 11 deleted VM c3e720f7-a247-4052-8b07-e88457fe1748\nok 12 Watcher saw expected delete (0 ms)\n# stop FsWatcher\nok 13 stopped watcher\n# check SmartOS VM\u0027s events\nok 14 saw: create,modify,modify,modify,modify,modify,modify,delete\n\n1..14\n# tests 14\n# pass  14\n\n# ok\n\nTAP version 13\n# find SmartOS image\nok 1 load images from imgadm\nok 2 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 3 find SmartOS Image\n# load existing VMs\nok 4 vmadm lookup\n# starting PeriodicWatcher\nok 5 created PeriodicWatcher\n# create VM\nok 6 create VM\nok 7 VM has uuid: 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 8 Watcher saw expected create (0 ms)\n# stop VM\nok 9 stop VM\nok 10 Watcher saw expected modify (0 ms)\n# start VM\nok 11 start VM\nok 12 Watcher saw expected modify (0 ms)\n# modify quota using ZFS\nok 13 update quota\nok 14 Watcher saw expected modify (1500 ms)\n# put metadata using mdata-put\nok 15 mdata-put\nok 16 Watcher saw expected modify (2300 ms)\n# create snapshot\nok 17 created snapshot for VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 18 Watcher saw expected modify (700 ms)\n# delete snapshot\nok 19 deleted snapshot for VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 20 Watcher saw expected modify (1100 ms)\n# set do_not_inventory\nok 21 set do_not_inventory for VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 22 Watcher saw expected modify (1000 ms)\n# unset do_not_inventory\nok 23 unset do_not_inventory for VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 24 Watcher saw expected modify (1000 ms)\n# reboot VM\nok 25 rebooted VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 26 Watcher saw expected modify (1300 ms)\n# delete VM\nok 27 deleted VM 560233d4-686a-6d1b-aaf2-a473dce60f84\nok 28 Watcher saw expected delete (1000 ms)\n# create KVM VM\nok 29 create VM\nok 30 VM has uuid: 4da1b9eb-9128-ef8f-ae28-9b2da6957b01\nok 31 Watcher saw expected create (500 ms)\n# add KVM VM disk\nok 32 add disk to VM 4da1b9eb-9128-ef8f-ae28-9b2da6957b01\nok 33 Watcher saw expected modify (1400 ms)\n# modify KVM VM disk\nok 34 modify disk on VM 4da1b9eb-9128-ef8f-ae28-9b2da6957b01\nok 35 Watcher saw expected modify (400 ms)\n# remove KVM VM disk\nok 36 delete disk on VM 4da1b9eb-9128-ef8f-ae28-9b2da6957b01\nok 37 Watcher saw expected modify (1100 ms)\n# delete KVM VM\nok 38 deleted VM 4da1b9eb-9128-ef8f-ae28-9b2da6957b01\nok 39 Watcher saw expected delete (1800 ms)\n# stop PeriodicWatcher\nok 40 stopped watcher\n# check KVM VM\u0027s events\nok 41 saw: create,modify,modify,modify,modify,delete\n\n1..41\n# tests 41\n# pass  41\n\n# ok\n\nTAP version 13\n# cmpVm\nok 1 cmpVm(): empty objects\nok 2 cmpVm(): unbalanced: empty b\nok 3 cmpVm(): unbalanced: empty a\nok 4 cmpVm(): same key, diff value\nok 5 cmpVm(): diff boolean\nok 6 cmpVm(): same boolean\n# compareVms\nok 7 1 VM created\nok 8 Correct VM was \"created\"\nok 9 1 VM deleted\nok 10 Correct VM was \"deleted\"\nok 11 1 VM modified\nok 12 Correct VM was \"modified\"\nok 13 RAM was correct on modified VM\n\n1..13\n# tests 13\n# pass  13\n\n# ok\n\nTAP version 13\n# Startup VmAgent with VM missing from VMAPI\nok 1 new CN 023498de-0a0d-4f57-b72f-de9472ae5a42\nok 2 updateServerVms payload has 1 VM\nok 3 \"PUT /vms\" includes missing VM\n# Startup VmAgent with VM missing from vmadm\nok 4 new CN 7a5904cc-88fc-4c17-bbb1-248fd1718ec2\nok 5 updateServerVms payload has 1 VM\nok 6 \"PUT /vms\" trying to destroy VM\n# VmAgent with vmapi/vmadm initially empty, apply changes\nok 7 new CN 24551eed-138e-4f25-8e79-823c556897db\nok 8 vmadm.lookup should not have \"fields\"\nok 9 created VM c0821724-d1e3-417e-8b8a-4646e2e29813\nok 10 received PUT /vms/c0821724-d1e3-417e-8b8a-4646e2e29813 (0)\nok 11 created VM c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d\nok 12 received PUT /vms/c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d (1)\nok 13 created VM 143146c6-9c2d-4b20-b5d7-00a92b681f63\nok 14 received PUT /vms/143146c6-9c2d-4b20-b5d7-00a92b681f63 (2)\nok 15 created VM 45c74938-8da3-47c3-977d-d68fa3586cec\nok 16 received PUT /vms/45c74938-8da3-47c3-977d-d68fa3586cec (3)\nok 17 modified VM quota\u003d1000\nok 18 received PUT /vms/c0821724-d1e3-417e-8b8a-4646e2e29813\nok 19 saw expected modification: quota\u003d1000\nok 20 modified VM cpu_cap\u003d800\nok 21 received PUT /vms/c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d\nok 22 saw expected modification: cpu_cap\u003d800\nok 23 modified VM cpu_cap\u003dundefined\nok 24 received PUT /vms/c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d\nok 25 expected field to be removed: cpu_cap\nok 26 modified VM customer_metadata\u003d[object Object]\nok 27 received PUT /vms/c0821724-d1e3-417e-8b8a-4646e2e29813\nok 28 saw expected modification: customer_metadata\u003d{\"hello\":\"world\"}\nok 29 deleted VM 45c74938-8da3-47c3-977d-d68fa3586cec\nok 30 received PUT /vms/45c74938-8da3-47c3-977d-d68fa3586cec should not be in vmadm list\nok 31 state should be destroyed\nok 32 zone_state should be destroyed\nok 33 deleted VM 143146c6-9c2d-4b20-b5d7-00a92b681f63\nok 34 received PUT /vms/143146c6-9c2d-4b20-b5d7-00a92b681f63 should not be in vmadm list\nok 35 state should be destroyed\nok 36 zone_state should be destroyed\nok 37 deleted VM c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d\nok 38 received PUT /vms/c9cd47f7-c92f-42e4-b6dc-4fb785fe5c4d should not be in vmadm list\nok 39 state should be destroyed\nok 40 zone_state should be destroyed\nok 41 deleted VM c0821724-d1e3-417e-8b8a-4646e2e29813\nok 42 received PUT /vms/c0821724-d1e3-417e-8b8a-4646e2e29813 should not be in vmadm list\nok 43 state should be destroyed\nok 44 zone_state should be destroyed\nok 45 All VMs are gone\n# VmAgent retries when VMAPI returning errors\nok 46 new CN 254f1ae9-74ca-42b4-a7f6-71a11420f6d3\nok 47 vmapi.getVms() called (1)\nok 48 vmapi.getVms() called (2)\nok 49 delta increasing: 501 \u003e 0\nok 50 vmapi.getVms() called (3)\nok 51 delta increasing: 999 \u003e 501\nok 52 vmapi.getVms() called (4)\nok 53 delta increasing: 2000 \u003e 999\nok 54 vmapi.getVms() called (5)\nok 55 delta increasing: 3993 \u003e 2000\nok 56 vmapi.getVms() called (6)\nok 57 delta increasing: 8000 \u003e 3993\nok 58 attempts (6) should be \u003e 5 when we see vmapi.updateServerVms()\nok 59 updateServerVms payload has 1 VM\nok 60 \"PUT /vms\" includes missing VM\n# VmAgent retries when VMAPI errors on PUT /vms/\u003cuuid\u003e\nok 61 new CN 37f0d6a5-da58-4ac6-9676-fd6d8470c236\nok 62 updateServerVms payload has 1 VM\nok 63 \"PUT /vms\" includes initial VM\nok 64 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93\nok 65 modified VM bab0f6f3-dd44-4ba4-a037-145564ceae93 (state,zone_state) \u003d \"stopped,installed\"\nok 66 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93\nok 67 modified VM bab0f6f3-dd44-4ba4-a037-145564ceae93 (state,zone_state) \u003d \"running\"\nok 68 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 69 modified VM bab0f6f3-dd44-4ba4-a037-145564ceae93 (max_{swap,phys,locked} +\u003d 2)\nok 70 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 71 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 72 delta increasing: 516 \u003e 0\nok 73 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 74 delta increasing: 981 \u003e 516\nok 75 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 76 delta increasing: 1999 \u003e 981\nok 77 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93 -- ECONNREFUSED\nok 78 delta increasing: 3999 \u003e 1999\nok 79 saw PUT /vms/bab0f6f3-dd44-4ba4-a037-145564ceae93\nok 80 delta increasing: 8001 \u003e 3999\nok 81 saw actual update on only attempt 9\nok 82 all VM changes reflected in final PUT\nok 83 no more attempts past 9\n# VmAgent sends deletion events after PUT failures\nok 84 new CN 87bf42b5-9de8-45f4-ad13-d8d97fb59a6f\nok 85 updateServerVms payload has 1 VM\nok 86 \"PUT /vms\" includes missing VM\nok 87 deleted VM 15c874d9-6cc9-441a-8172-a777557f22a3\nok 88 PUT includes VM with only change [zone_]state\u003ddestroyed (1) -- InternalServerError\nok 89 PUT includes VM with only change [zone_]state\u003ddestroyed (2) -- InternalServerError\nok 90 PUT includes VM with only change [zone_]state\u003ddestroyed (3) -- InternalServerError\nok 91 PUT includes VM with only change [zone_]state\u003ddestroyed (4)\nok 92 expected 4 total attempts\n# Startup VmAgent with minimal VMs\nok 93 new CN 6de9dd5b-aacd-4aac-833c-755327d523d6\nok 94 updateServerVms payload has 1 VM\nok 95 update is not the existing VM\n\n1..95\n# tests 95\n# pass  95\n\n# ok\n\nTAP version 13\n# find SmartOS image\nok 1 load images from imgadm\nok 2 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 3 find SmartOS Image\n# Real vmadm, fake VMAPI\nok 4 new CN b45a0ebd-1c22-4e00-8b8f-e1eee6c91776\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 5 saw PUT /vms: (35)\nok 6 create VM\nok 7 new VM has uuid: 4ef5bc93-c796-4a68-87b0-44198802f962\nok 8 vmadm.update quota\u003d33\nok 9 modifier returned: success\nok 10 zfs set quota\u003d66: success\nok 11 modifier returned: success\nok 12 zlogin mdata-put hello\u003dworld: success\nok 13 modifier returned: success\nok 14 vmadm.update alias\u003dvm-agent_testvm-HACKED\nok 15 modifier returned: success\nok 16 stop VM\nok 17 modifier returned: success\nok 18 start VM\nok 19 modifier returned: success\nok 20 reboot VM\nok 21 modifier returned: success\nok 22 created snapshot for VM 4ef5bc93-c796-4a68-87b0-44198802f962\nok 23 modifier returned: success\nok 24 rollback snapshot for VM 4ef5bc93-c796-4a68-87b0-44198802f962\nok 25 modifier returned: success\nok 26 delete snapshot for VM 4ef5bc93-c796-4a68-87b0-44198802f962\nok 27 modifier returned: success\nok 28 applied modifiers\nok 29 delete VM: success\nok 30 pipeline complete\n# Real vmadm, fake VMAPI: 1 invalid VM\nok 31 new CN 9e5d9f99-d39b-4124-a577-68e504af0cb5\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 32 saw PUT /vms: (35)\nok 33 create broken VM\nok 34 new broken VM has uuid: 41e2545d-2700-46b8-940c-95c483660bf1\nok 35 create VM\nok 36 new VM has uuid: 1b7904b9-9c3d-4a58-827a-467184c24f99\nok 37 create VM\nok 38 new VM has uuid: 0648e0fe-2653-4b6e-ae72-8a41f43dca5b\nok 39 create VM\nok 40 new VM has uuid: 44a54d60-8a85-4675-b987-704eb268037b\nok 41 create VM\nok 42 new VM has uuid: 9dcf48ba-47b4-4bd3-9c5d-b55108ee588e\nok 43 create VM\nok 44 new VM has uuid: 8e70f092-18d3-481b-bec4-7478842c9c92\nok 45 broken VM should not be in VMAPI\nok 46 all non-broken VMs should be in VMAPI\nok 47 saw 3 update attempts for broken VM (was still trying)\nok 48 total updates for VM: 312\nok 49 cleared problem for broken VM\nok 50 found previously broken VM in VMAPI after problem was cleared\nok 51 delete VM 41e2545d-2700-46b8-940c-95c483660bf1: success\nok 52 delete VM 1b7904b9-9c3d-4a58-827a-467184c24f99: success\nok 53 delete VM 0648e0fe-2653-4b6e-ae72-8a41f43dca5b: success\nok 54 delete VM 44a54d60-8a85-4675-b987-704eb268037b: success\nok 55 delete VM 9dcf48ba-47b4-4bd3-9c5d-b55108ee588e: success\nok 56 delete VM 8e70f092-18d3-481b-bec4-7478842c9c92: success\nok 57 pipeline complete\n# Real vmadm, fake VMAPI: validate DNI\nok 58 create DNI VM\nok 59 new DNI VM has uuid: 1377e5dd-1e54-44b8-b553-767866eca120\nok 60 new CN 45abafc6-f214-4ce1-b245-4f0043e99580\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 61 saw PUT /vms: (35)\nok 62 should not find our DNI VM in PUT /vms\nok 63 VM update set do_not_inventory\u003dfalse\nok 64 VM update set do_not_inventory\u003dtrue\nok 65 waited for no updates\nok 66 should be no updates after re-adding DNI\nok 67 VM stop\nok 68 waited for no updates\nok 69 should be no updates after stopping VM with DNI set\nok 70 VM start\nok 71 waited for no updates\nok 72 should be no updates after starting VM with DNI set\nok 73 VM update set do_not_inventory\u003dfalse\nok 74 delete VM: success\nok 75 pipeline complete\n# Real vmadm, fake VMAPI: new DNI VM\nok 76 create DNI VM1\nok 77 new DNI VM1 has uuid: c021f173-2867-497f-989f-f2028b10a3f6\nok 78 new CN 477fc4e8-6394-4404-929e-399437ed9bd6\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 79 saw PUT /vms: (35)\nok 80 create DNI VM2\nok 81 new DNI VM2 has uuid: 6f72fa32-d815-4886-817c-66a5b8107c4a\nok 82 delete VM: success\nok 83 delete VM: success\nok 84 waited 5000 ms after delete\nok 85 no bad updates\nok 86 pipeline complete\n# VmAgent works after initial errors\nok 87 new CN f4696170-1c42-474a-8d26-7bb7175282b2\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 88 saw GET /vms [1] -- ECONNREFUSED\nok 89 saw GET /vms [2] -- ECONNREFUSED\nok 90 saw GET /vms [3] -- ECONNREFUSED\nok 91 saw GET /vms [4]\nok 92 saw PUT /vms: (35) [1] -- ServiceUnavailableError\nok 93 saw GET /vms [5]\nok 94 saw PUT /vms: (35) [2] -- ServiceUnavailableError\nok 95 saw GET /vms [6]\nok 96 saw PUT /vms: (35) [3] -- ServiceUnavailableError\nok 97 saw GET /vms [7]\nok 98 saw PUT /vms: (35) [4]\nok 99 VMAPI saw update for new VM.\nok 100 create VM\nok 101 new VM has uuid: 74379343-eab9-4bfc-b642-0318c7122336\nok 102 delete VM: success\nok 103 VMAPI saw destroy for VM\nok 104 pipeline complete\n\n1..104\n# tests 104\n# pass  104\n\n# ok\n\nTAP version 13\n# find SmartOS image\nok 1 load images from imgadm\nok 2 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 3 find SmartOS Image\n# load existing VMs\nok 4 vmadm lookup\n# determine best event source\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 5 determineEventSource err\nok 6 determineEventSource eventSource: default\n# starting VmWatcher\nok 7 created VmWatcher\n# create VM\nok 8 create VM\nok 9 VM has uuid: e64665da-ce54-c1a5-edd0-993fe4511e8e\nok 10 Watcher saw expected create (0 ms)\n# stop VM\nok 11 stop VM\nok 12 Watcher saw expected modify (0 ms)\n# start VM\nok 13 start VM\nok 14 Watcher saw expected modify (0 ms)\n# modify quota using ZFS\nok 15 update quota\nok 16 Watcher saw expected modify (0 ms)\n# put metadata using mdata-put\nok 17 mdata-put\nok 18 Watcher saw expected modify (0 ms)\n# delete VM\nok 19 deleted VM e64665da-ce54-c1a5-edd0-993fe4511e8e\nok 20 Watcher saw expected delete (0 ms)\n# stop VmWatcher\nok 21 stopped watcher\n# check SmartOS VM\u0027s events\nok 22 saw: create,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,modify,delete\n\n1..22\n# tests 22\n# pass  22\n\n# ok\n\nTAP version 13\n# determine best event source\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 1 event source err\nok 2 determineEventSource eventSource: default\nok 3 skipping tests: eventSource !\u003d\u003d vmadm-events\n\n1..3\n# tests 3\n# pass  3\n\n# ok\n\nTAP version 13\n# Setup VMAPI handle\nok 1 loaded vm-agent config file\nok 2 config has vmapi_url\nok 3 created VMAPI handle\n# PUT VM\nok 4 vmapi PUT dd8b3c73-4f1e-42d7-be08-261894e1e73d\n# GET VM\nok 5 vmapi GET dd8b3c73-4f1e-42d7-be08-261894e1e73d\nok 6 VMAPI VM matches UUID\n# Compare VMAPI VM to VMAPI_ALWAYS_SET_FIELDS\nok 7 VMAPI VM has expected fields added\n# DELETE VM\nok 8 vmapi PUT (to destroy) dd8b3c73-4f1e-42d7-be08-261894e1e73d\n# Close VMAPI handle\nok 9 closed VMAPI handle\n\n1..9\n# tests 9\n# pass  9\n\n# ok\n\nTAP version 13\n# find SmartOS image\nok 1 load images from imgadm\nok 2 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 3 find SmartOS Image\n# load existing VMs\nok 4 vmadm lookup\n# starting ZoneeventWatcher\nok 5 created ZoneeventWatcher [32539]\n# create VM\nok 6 create VM\nok 7 VM has uuid: 4278eedc-143f-4aed-addb-e8f08a7ffa7c\nok 8 expected no create event\n# start VM\nok 9 start VM\nok 10 Watcher saw expected modify (0 ms)\n# kill zoneevent (it should restart)\nok 11 PID changed 32539 \u003d\u003e 32689\n# stop VM\nok 12 stop VM\nok 13 Watcher saw expected modify (0 ms)\n# delete VM\nok 14 deleted VM 4278eedc-143f-4aed-addb-e8f08a7ffa7c\nok 15 expected no delete event\n# stop ZoneeventWatcher\nok 16 stopped watcher\n# check SmartOS VM\u0027s events\nok 17 saw: modify,modify\n\n1..17\n# tests 17\n# pass  17\n\n# ok\n\nTAP version 13\n# determine best event source\n{ stderr: \u0027Invalid command: \"events\".\u0027 }\nok 1 event source err\nok 2 determineEventSource eventSource: default\n# find SmartOS image\nok 3 load images from imgadm\nok 4 found SmartOS image_uuid: 18b094b0-eb01-11e5-80c1-175dac7ddf02\nok 5 find SmartOS Image\n# starting ZoneeventWatcher\nok 6 created ZoneeventWatcher [33016]\n# create VMs\nok 7 create VM: 43274d88-6c5a-eeea-e592-b17f1821cce9\nok 8 create VM: 40dcb597-f2d2-e6cf-f72e-cbd854ba6646\nok 9 create VM: 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22\nok 10 create VM: ce33b008-a044-cc30-e574-b8832baa7277\nok 11 create VM: 11cd7107-8f57-475d-c523-ffc0fc457ed3\nok 12 create VM: a80b11f8-7c92-c4ab-ee1b-baad7a0b5301\nok 13 create VM: 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a\nok 14 create VM: a57cc700-c2c1-6369-8dcb-c144ce67cd8c\nok 15 create VM: 4842d492-2ae1-c93e-84b5-8244e0830407\nok 16 create VM: f726ec25-c105-c7cc-aefc-c3aedcca0c4b\nok 17 VMs should have been created successfully\n# restart VMs\nok 18 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (2/1/13)\nok 19 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (2/1/13)\nok 20 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (3/2/20)\nok 21 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (2/1/13)\nok 22 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (2/1/13)\nok 23 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (2/1/13)\nok 24 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (2/1/13)\nok 25 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (2/1/13)\nok 26 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (2/1/13)\nok 27 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (2/1/13)\nok 28 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (2/1/13)\nok 29 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (3/2/20)\nok 30 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (3/2/20)\nok 31 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (3/2/20)\nok 32 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (3/2/20)\nok 33 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (4/3/27)\nok 34 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (3/2/20)\nok 35 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (4/3/27)\nok 36 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (3/2/20)\nok 37 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (4/3/27)\nok 38 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (3/2/20)\nok 39 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (3/2/20)\nok 40 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (4/3/27)\nok 41 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (3/2/20)\nok 42 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (5/4/34)\nok 43 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (4/3/27)\nok 44 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (5/4/34)\nok 45 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (4/3/27)\nok 46 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (5/4/34)\nok 47 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (4/3/27)\nok 48 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (4/3/27)\nok 49 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (5/4/34)\nok 50 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (4/3/27)\nok 51 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (5/4/34)\nok 52 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (5/4/34)\nok 53 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (6/5/41)\nok 54 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (5/4/34)\nok 55 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (4/3/27)\nok 56 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (6/5/41)\nok 57 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (6/5/41)\nok 58 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (6/5/41)\nok 59 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (6/5/41)\nok 60 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (7/6/48)\nok 61 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (5/4/34)\nok 62 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (5/4/34)\nok 63 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (7/6/48)\nok 64 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (6/5/41)\nok 65 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (7/6/48)\nok 66 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (6/5/41)\nok 67 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (5/4/34)\nok 68 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (8/7/55)\nok 69 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (7/6/48)\nok 70 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (7/6/48)\nok 71 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (8/7/55)\nok 72 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (6/5/41)\nok 73 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (7/6/48)\nok 74 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (6/5/41)\nok 75 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (9/8/62)\nok 76 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (9/8/62)\nok 77 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (7/6/48)\nok 78 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (8/7/55)\nok 79 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (8/7/55)\nok 80 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (7/6/48)\nok 81 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (6/5/41)\nok 82 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (8/7/55)\nok 83 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (7/6/48)\nok 84 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (8/7/55)\nok 85 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (10/9/69)\nok 86 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (8/7/55)\nok 87 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (9/8/62)\nok 88 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (8/7/55)\nok 89 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (7/6/48)\nok 90 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (10/9/69)\nok 91 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (8/7/55)\nok 92 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (9/8/62)\nok 93 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (9/8/62)\nok 94 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (9/8/62)\nok 95 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (9/8/62)\nok 96 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (10/9/69)\nok 97 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (10/9/69)\nok 98 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (9/8/62)\nok 99 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (10/9/69)\nok 100 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (9/8/62)\nok 101 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (8/7/55)\nok 102 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (11/10/76)\nok 103 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (10/10/75)\nok 104 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (11/10/76)\nok 105 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (10/9/72)\nok 106 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (11/10/76)\nok 107 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (10/9/69)\nok 108 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (10/9/69)\nok 109 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (10/9/69)\nok 110 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (9/8/62)\nok 111 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (12/11/83)\nok 112 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (12/11/83)\nok 113 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (12/11/83)\nok 114 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (12/11/83)\nok 115 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (11/10/76)\nok 116 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (10/9/69)\nok 117 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (11/10/76)\nok 118 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (12/11/83)\nok 119 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (11/10/76)\nok 120 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (12/11/83)\nok 121 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (13/12/90)\nok 122 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (13/12/90)\nok 123 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (10/9/69)\nok 124 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (13/12/90)\nok 125 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (12/12/89)\nok 126 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (10/9/70)\nok 127 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (10/10/76)\nok 128 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (11/11/82)\nok 129 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (13/12/90)\nok 130 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (12/11/83)\nok 131 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (14/13/97)\nok 132 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (13/12/90)\nok 133 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (14/13/97)\nok 134 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (12/11/83)\nok 135 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (12/11/83)\nok 136 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (14/13/97)\nok 137 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (14/13/97)\nok 138 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (14/13/97)\nok 139 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (13/12/90)\nok 140 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (14/13/97)\nok 141 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (15/14/104)\nok 142 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (13/12/90)\nok 143 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (15/14/104)\nok 144 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (15/14/104)\nok 145 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (14/13/97)\nok 146 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (13/12/90)\nok 147 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (15/14/104)\nok 148 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (13/12/90)\nok 149 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (15/14/104)\nok 150 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (16/15/111)\nok 151 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (15/14/104)\nok 152 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (15/14/104)\nok 153 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (16/15/111)\nok 154 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (16/15/111)\nok 155 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (14/13/97)\nok 156 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (14/13/97)\nok 157 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (14/13/97)\nok 158 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (16/15/111)\nok 159 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (17/16/118)\nok 160 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (16/15/111)\nok 161 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (17/16/118)\nok 162 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (17/16/118)\nok 163 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (16/15/111)\nok 164 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (15/14/104)\nok 165 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (16/15/111)\nok 166 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (15/14/104)\nok 167 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (17/16/118)\nok 168 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (18/17/125)\nok 169 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (17/16/118)\nok 170 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (15/14/104)\nok 171 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (18/17/125)\nok 172 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (17/16/118)\nok 173 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (16/15/111)\nok 174 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (18/17/125)\nok 175 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (18/17/125)\nok 176 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (17/16/118)\nok 177 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (16/15/111)\nok 178 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (18/17/125)\nok 179 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (16/15/111)\nok 180 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (19/18/132)\nok 181 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (19/18/132)\nok 182 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (19/18/132)\nok 183 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (17/16/118)\nok 184 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (18/17/125)\nok 185 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (20/19/139)\nok 186 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (20/19/139)\nok 187 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (19/18/132)\nok 188 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (18/17/125)\nok 189 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (19/18/132)\nok 190 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (19/18/132)\nok 191 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (21/20/146)\nok 192 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (20/19/139)\nok 193 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (18/17/125)\nok 194 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (17/16/118)\nok 195 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (19/18/132)\nok 196 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (20/19/139)\nok 197 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (20/19/139)\nok 198 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (21/20/146)\nok 199 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (21/20/146)\nok 200 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (17/16/118)\nok 201 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (20/19/139)\nok 202 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (18/17/125)\nok 203 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (19/18/132)\nok 204 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (22/21/153)\nok 205 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (21/20/146)\nok 206 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (20/19/139)\nok 207 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (20/19/139)\nok 208 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (21/20/146)\nok 209 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (21/20/146)\nok 210 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (18/17/125)\nok 211 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (22/21/153)\nok 212 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (19/18/132)\nok 213 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (22/21/153)\nok 214 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (23/22/160)\nok 215 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (23/22/160)\nok 216 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (23/22/160)\nok 217 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (20/19/139)\nok 218 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (21/20/146)\nok 219 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (22/21/153)\nok 220 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (22/21/153)\nok 221 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (21/20/146)\nok 222 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (24/23/167)\nok 223 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (22/21/153)\nok 224 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (24/23/167)\nok 225 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (22/21/153)\nok 226 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (19/18/132)\nok 227 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (21/20/146)\nok 228 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (22/21/153)\nok 229 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (23/22/160)\nok 230 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (24/23/167)\nok 231 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (23/22/160)\nok 232 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (23/22/160)\nok 233 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (23/22/160)\nok 234 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (24/23/167)\nok 235 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (25/24/174)\nok 236 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (20/19/139)\nok 237 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (25/24/174)\nok 238 reboot VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b (26/25/181)\nok 239 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (23/22/160)\nok 240 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (24/23/167)\nok 241 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (25/24/174)\nok 242 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (24/23/167)\nok 243 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (25/24/174)\nok 244 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (22/21/153)\nok 245 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (25/24/174)\nok 246 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (21/20/146)\nok 247 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (25/24/174)\nok 248 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (23/22/160)\nok 249 reboot VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a (26/25/181)\nok 250 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (24/23/167)\nok 251 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (24/23/167)\nok 252 reboot VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c (26/25/181)\nok 253 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (24/23/167)\nok 254 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (25/24/174)\nok 255 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (22/21/153)\nok 256 reboot VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646 (26/25/181)\nok 257 reboot VM 43274d88-6c5a-eeea-e592-b17f1821cce9 (26/25/181)\nok 258 reboot VM 11cd7107-8f57-475d-c523-ffc0fc457ed3 (26/25/181)\nok 259 reboot VM ce33b008-a044-cc30-e574-b8832baa7277 (26/25/181)\nok 260 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (25/24/174)\nok 261 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (23/22/160)\nok 262 reboot VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301 (26/25/181)\nok 263 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (25/24/174)\nok 264 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (24/23/167)\nok 265 reboot VM 4842d492-2ae1-c93e-84b5-8244e0830407 (26/25/181)\nok 266 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (25/24/174)\nok 267 reboot VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22 (26/25/181)\nok 268 done restarting\n# delete VMs\nok 269 delete VM ce33b008-a044-cc30-e574-b8832baa7277\nok 270 delete VM 11cd7107-8f57-475d-c523-ffc0fc457ed3\nok 271 delete VM a57cc700-c2c1-6369-8dcb-c144ce67cd8c\nok 272 delete VM 40dcb597-f2d2-e6cf-f72e-cbd854ba6646\nok 273 delete VM 4842d492-2ae1-c93e-84b5-8244e0830407\nok 274 delete VM a80b11f8-7c92-c4ab-ee1b-baad7a0b5301\nok 275 delete VM 50386c4e-e0ac-cbe2-f3c2-c1bb9936302a\nok 276 delete VM 43274d88-6c5a-eeea-e592-b17f1821cce9\nok 277 delete VM 6dbb284d-8c4c-49d4-9644-c8e92e0a5a22\nok 278 delete VM f726ec25-c105-c7cc-aefc-c3aedcca0c4b\nok 279 done deleting\n# stop ZoneeventWatcher\nok 280 stopped watcher\n# check final state\nok 281 events(2400) \u003e HIGH_WATER_MARK(32)\nok 282 2400 \u003e\u003d 2400\nok 283 548084 \u003e\u003d 480000\nok 284 have 100 elements in the ringbuffer\nok 285 ringBuffer entries have event_line\nok 286 ringBuffer entries have event_timestamp\nok 287 ringBuffer[0].event_timestamp(Fri Aug 17 2018 17:41:45 GMT+0000 (UTC)) \u003c ringBuffer[99].event_timestamp(Fri Aug 17 2018 17:42:05 GMT+0000 (UTC))\n\n1..287\n# tests 287\n# pass  287\n\n# ok\n\n#\n# TESTS COMPLETE IN 1287 SECONDS, SUMMARY:\n#\n#   PASS: 605 / 605\n#"},{"timestamp":1535043432,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1\n\n¯\\_(ツ)_/¯"},{"timestamp":1535053076,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1"},{"timestamp":1535120955,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1535120987,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1535121016,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Patch Set 3: Commit message was updated."},{"timestamp":1535121055,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Chris Burroughs"}],"currentPatchSet":{"number":"3","revision":"aec80bb2b327d2149dc402a71b7f12501eb05aea","parents":["e5b3b9156b7e9f4f1d02bc98c116b47d02e4f607"],"ref":"refs/changes/15/4715/3","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1535121016,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534529070,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1535121055,"by":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":".eslintrc","type":"MODIFIED","insertions":38,"deletions":-112},{"file":".gitmodules","type":"MODIFIED","insertions":0,"deletions":-6},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"deps/javascriptlint","type":"DELETED","insertions":0,"deletions":-1},{"file":"deps/jsstyle","type":"DELETED","insertions":0,"deletions":-1},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":14,"deletions":-14},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/watchers/fs-watcher.js","type":"MODIFIED","insertions":9,"deletions":-9},{"file":"lib/watchers/periodic-watcher.js","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"tests/common.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/mocks.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/test.VmAgentMockVmadm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":44,"deletions":-44},{"file":"tests/test.VmapiFields.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/jsl.node.conf","type":"DELETED","insertions":0,"deletions":-139},{"file":"tools/jsl.web.conf","type":"DELETED","insertions":0,"deletions":-137},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":38,"deletions":-10}],"sizeInsertions":209,"sizeDeletions":-528},"patchSets":[{"number":"1","revision":"22dd5e1fdac26cc0d499632e3fcb31c9e2ca2cde","parents":["fae9f462e31c935c973850bae1d38d5fe69a082c"],"ref":"refs/changes/15/4715/1","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1534529047,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534529070,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"MODIFIED","insertions":38,"deletions":-112},{"file":".gitmodules","type":"MODIFIED","insertions":0,"deletions":-6},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"deps/javascriptlint","type":"DELETED","insertions":0,"deletions":-1},{"file":"deps/jsstyle","type":"DELETED","insertions":0,"deletions":-1},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":14,"deletions":-14},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/watchers/fs-watcher.js","type":"MODIFIED","insertions":9,"deletions":-9},{"file":"lib/watchers/periodic-watcher.js","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"tests/common.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/mocks.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/test.VmAgentMockVmadm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":44,"deletions":-44},{"file":"tests/test.VmapiFields.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/jsl.node.conf","type":"DELETED","insertions":0,"deletions":-139},{"file":"tools/jsl.web.conf","type":"DELETED","insertions":0,"deletions":-137},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":38,"deletions":-10}],"sizeInsertions":209,"sizeDeletions":-528},{"number":"2","revision":"4ec123af09254fa281b9666624415b55f06236f5","parents":["e5b3b9156b7e9f4f1d02bc98c116b47d02e4f607"],"ref":"refs/changes/15/4715/2","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1535120955,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534529070,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"MODIFIED","insertions":38,"deletions":-112},{"file":".gitmodules","type":"MODIFIED","insertions":0,"deletions":-6},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"deps/javascriptlint","type":"DELETED","insertions":0,"deletions":-1},{"file":"deps/jsstyle","type":"DELETED","insertions":0,"deletions":-1},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":14,"deletions":-14},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/watchers/fs-watcher.js","type":"MODIFIED","insertions":9,"deletions":-9},{"file":"lib/watchers/periodic-watcher.js","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"tests/common.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/mocks.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/test.VmAgentMockVmadm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":44,"deletions":-44},{"file":"tests/test.VmapiFields.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/jsl.node.conf","type":"DELETED","insertions":0,"deletions":-139},{"file":"tools/jsl.web.conf","type":"DELETED","insertions":0,"deletions":-137},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":38,"deletions":-10}],"sizeInsertions":209,"sizeDeletions":-528},{"number":"3","revision":"aec80bb2b327d2149dc402a71b7f12501eb05aea","parents":["e5b3b9156b7e9f4f1d02bc98c116b47d02e4f607"],"ref":"refs/changes/15/4715/3","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1535121016,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534529070,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535053076,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535043432,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1535121055,"by":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":".eslintrc","type":"MODIFIED","insertions":38,"deletions":-112},{"file":".gitmodules","type":"MODIFIED","insertions":0,"deletions":-6},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"deps/javascriptlint","type":"DELETED","insertions":0,"deletions":-1},{"file":"deps/jsstyle","type":"DELETED","insertions":0,"deletions":-1},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":14,"deletions":-14},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"lib/watchers/fs-watcher.js","type":"MODIFIED","insertions":9,"deletions":-9},{"file":"lib/watchers/periodic-watcher.js","type":"MODIFIED","insertions":7,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":0},{"file":"tests/common.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/mocks.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"tests/test.VmAgentMockVmadm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":44,"deletions":-44},{"file":"tests/test.VmapiFields.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"tests/test.ZoneeventWatcherOverflow.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/jsl.node.conf","type":"DELETED","insertions":0,"deletions":-139},{"file":"tools/jsl.web.conf","type":"DELETED","insertions":0,"deletions":-137},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":38,"deletions":-10}],"sizeInsertions":209,"sizeDeletions":-528}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"}]}