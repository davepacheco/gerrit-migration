{"project":"joyent/sdcadm","branch":"master","id":"I8e04a29a57bcc8d8226bf3b887a06a75021a6bff","number":"3993","subject":"TRITON-325 sdcadm still aggressively gives up after updating non-HA moray Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Approved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/3993","commitMessage":"TRITON-325 sdcadm still aggressively gives up after updating non-HA moray\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nApproved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1527102525,"lastUpdated":1527156996,"open":false,"status":"MERGED","comments":[{"timestamp":1527102525,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1527102530,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit a38f208e92d15f32c3eb9af80f7feac918aa5515\n    \n    TRITON-325 sdcadm still aggressively gives up after updating non-HA moray"},{"timestamp":1527102566,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527102619,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nMarsell: I just wanted to add a test to keep around in the future regarding TRITON-325 and, you know, once I started adding tests I needed to fix something to make the test actually pass :-)"},{"timestamp":1527111904,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1527148359,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1527148365,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 3de62e31a902b0caf3def119977bce07a029dc73\n    \n    TRITON-325 sdcadm still aggressively gives up after updating non-HA moray"},{"timestamp":1527148395,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527148439,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(1 comment)\n\nDone with your suggestion!"},{"timestamp":1527149935,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1527156996,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"2","revision":"8e04a29a57bcc8d8226bf3b887a06a75021a6bff","parents":["b718594e7acfaa9a18c5486bf3306d603fc89585"],"ref":"refs/changes/93/3993/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1527148359,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527148395,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527149935,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527149935,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1527156996,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/procedures/update-moray-v2.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"test/update.test.js","type":"MODIFIED","insertions":28,"deletions":0}],"sizeInsertions":32,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"fa09d2d683079d316286b27452edff2b8fe57fde","parents":["b718594e7acfaa9a18c5486bf3306d603fc89585"],"ref":"refs/changes/93/3993/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1527102525,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527102566,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527111904,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527111904,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"comments":[{"file":"lib/procedures/update-moray-v2.js","line":494,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I think this all boils down to \"(insts.length \u003e tmpInsts.length + 1)\"."},{"file":"lib/procedures/update-moray-v2.js","line":494,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Well, we could also have 2 instances and a temporary instance from a previous failure and that would also be HA ... anyway, that\u0027s quite quite quite strange to happen at all so I\u0027ll go with your suggestion here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/update-moray-v2.js","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"test/update.test.js","type":"MODIFIED","insertions":28,"deletions":0}],"sizeInsertions":32,"sizeDeletions":-3},{"number":"2","revision":"8e04a29a57bcc8d8226bf3b887a06a75021a6bff","parents":["b718594e7acfaa9a18c5486bf3306d603fc89585"],"ref":"refs/changes/93/3993/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1527148359,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527148395,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1527156996,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527149935,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527149935,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/procedures/update-moray-v2.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"test/update.test.js","type":"MODIFIED","insertions":28,"deletions":0}],"sizeInsertions":32,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}