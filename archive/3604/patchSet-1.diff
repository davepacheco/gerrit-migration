From 815314b86046bed5d3443c3af18c16f16401bc60 Mon Sep 17 00:00:00 2001
From: Marsell Kukuljevic <marsell@joyent.com>
Date: Tue, 13 Mar 2018 12:32:23 +1030
Subject: [PATCH] TRITON-196 cloudapi machine objects don't show
 "deletion_protection: false" if it isn't set

---
 lib/machines.js | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

diff --git a/lib/machines.js b/lib/machines.js
index efdc628..85b3c7f 100644
--- a/lib/machines.js
+++ b/lib/machines.js
@@ -140,6 +140,7 @@ function translate(machine, req)  {
         ips: [],
         memory: Number(machine.ram),
         disk: (Number(machine.quota) * 1024) || 0,
+        deletion_protection: !!machine.indestructible_zoneroot,
         metadata: machine.customer_metadata || {},
         tags: machine.tags,
         credentials: credentials,
@@ -164,10 +165,6 @@ function translate(machine, req)  {
         msg.disk = Number(machine.disks[1].size);
     }
 
-    if (machine.indestructible_zoneroot) {
-        msg.deletion_protection = true;
-    }
-
     if (machine.nics && machine.nics.length) {
         machine.nics.forEach(function (nic) {
             msg.ips.push(nic.ip);
-- 
2.21.0

