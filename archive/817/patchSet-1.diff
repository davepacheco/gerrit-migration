From 94c9e5b9fc70f3e30fa04cd6b3d45b892e8d91c4 Mon Sep 17 00:00:00 2001
From: Todd Whiteman <todd.whiteman@joyent.com>
Date: Fri, 28 Oct 2016 19:11:31 -0700
Subject: [PATCH] DOCKER-958 Change 'make test-integration-in-coal' to only run
 against latest docker

---
 test/runtest.common | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/test/runtest.common b/test/runtest.common
index 70aa5bf..cca242e 100644
--- a/test/runtest.common
+++ b/test/runtest.common
@@ -54,9 +54,13 @@ export NAPI_URL="http://$(vmadm lookup -j alias=napi0 | json 0.nics \
 #    run the "test/integration/cli-*.test.js" files. This is overridable, e.g.:
 #       DOCKER_CLI_VERSIONS=1.6.2 .../runtests
 export DOCKER_AVAILABLE_CLI_VERSIONS="1.12.2 1.11.1 1.10.3 1.9.1 1.8.3 1.7.1 1.6.2"
-if [[ -z "$DOCKER_CLI_VERSIONS" ]]; then
+if [[ "$DOCKER_CLI_VERSIONS" == "all" ]]; then
     export DOCKER_CLI_VERSIONS="$DOCKER_AVAILABLE_CLI_VERSIONS"
 fi
+if [[ -z "$DOCKER_CLI_VERSIONS" || "$DOCKER_CLI_VERSIONS" == "latest" ]]; then
+    # Use the first (latest) version, splitting on the space separator.
+    export DOCKER_CLI_VERSIONS="${DOCKER_AVAILABLE_CLI_VERSIONS%% *}"
+fi
 
 # Guard
 guard_file=/lib/sdc/.sdc-test-no-production-data
-- 
2.21.0

