{"project":"joyent/sdc-docker","branch":"master","id":"I0ec27a82892843979ea0bc7ce1f27fe6d79aa906","number":"817","subject":"DOCKER-958 Change \u0027make test-integration-in-coal\u0027 to only run against latest docker Reviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/817","commitMessage":"DOCKER-958 Change \u0027make test-integration-in-coal\u0027 to only run against latest docker\nReviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e\n","createdOn":1477707154,"lastUpdated":1478033560,"open":false,"status":"MERGED","comments":[{"timestamp":1477707154,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1477707190,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477707418,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nAfter this change, we will need to update the Jenkins docker nightly-1 command line to set DOCKER_CLI_VERSIONS\u003dall , and nightly-2 can change to use DOCKER_CLI_VERSIONS\u003dlatest (or just omit it and let it use the default of latest)."},{"timestamp":1478016400,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\nPerhaps add this change to the README.md:\n\n```\ndiff --git a/README.md b/README.md\nindex 40e2e4f..9b46d6f 100644\n--- a/README.md\n+++ b/README.md\n@@ -266,13 +266,16 @@ run from your Mac dev tree, e.g.:\n     ./test/runtest ./test/integration/cli-info.test.js\n \n \n-All \"cli\" integration tests (\"test/integration/cli-\\*.test.js\") are run\n-repeatedly -- onces for each supported Docker CLI version. If you want to\n-run with just a particular version, you can set the `DOCKER_CLI_VERSIONS`\n-(plural) environment variable, e.g:\n-\n+By default all \"cli\" integration tests (\"test/integration/cli-\\*.test.js\") are\n+run against the latest Docker CLI version (see the\n+`DOCKER_AVAILABLE_CLI_VERSIONS` variable in \"test/runtest.common\"). To run\n+against against other versions, or all supported versions, set the\n+`DOCKER_CLI_VERSIONS` (plural) environment variable, e.g.:\n+\n+    make test-integration-in-coal DOCKER_CLI_VERSIONS\u003dall\n+    make test-integration-in-coal DOCKER_CLI_VERSIONS\u003d\"1.11.1 1.10.3\"\n     DOCKER_CLI_VERSIONS\u003d1.11.1 /zones/$(vmadm lookup -1 alias\u003ddocker0)/root/opt/smartdc/docker/test/runtests -f cli-info\n-\n+    DOCKER_CLI_VERSIONS\u003dlatest /zones/$(vmadm lookup -1 alias\u003ddocker0)/root/opt/smartdc/docker/test/runtests -f cli-labels\n \n \n # Testing locally\n```\n\n\nAlso need to rebase."},{"timestamp":1478019524,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1478019556,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1478030405,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1478033560,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"2","revision":"0ec27a82892843979ea0bc7ce1f27fe6d79aa906","parents":["293d3393add7663b6c2f628b8618924c1f14df13"],"ref":"refs/changes/17/817/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1478019524,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1478019556,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1478030405,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1478030405,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1478033560,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"test/runtest.common","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":13,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"94c9e5b9fc70f3e30fa04cd6b3d45b892e8d91c4","parents":["f3cbcf63c876ab9e43353796432d18f5dbd77306"],"ref":"refs/changes/17/817/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1477707154,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477707190,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"test/runtest.common","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":5,"sizeDeletions":-1},{"number":"2","revision":"0ec27a82892843979ea0bc7ce1f27fe6d79aa906","parents":["293d3393add7663b6c2f628b8618924c1f14df13"],"ref":"refs/changes/17/817/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1478019524,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1478019556,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1478030405,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1478030405,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1478033560,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"test/runtest.common","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":13,"sizeDeletions":-5}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}