From 358160b155a82eaf00fa3ba39ea3164f770849a2 Mon Sep 17 00:00:00 2001
From: Patrick Mooney <pmooney@pfmooney.com>
Date: Thu, 13 Jun 2019 16:03:23 +0000
Subject: [PATCH] OS-7838 mapfile name for unix should be less generic

---
 usr/src/uts/i86pc/Makefile.i86pc          |  6 +++---
 usr/src/uts/i86pc/unix/Makefile           |  7 +++----
 usr/src/uts/i86xpv/Makefile.i86xpv        |  9 +++++----
 usr/src/uts/i86xpv/unix/Makefile          |  6 +++---
 usr/src/uts/sun4u/Makefile.sun4u          |  5 +++--
 usr/src/uts/sun4u/opl/unix/Makefile       | 19 ++++++++++---------
 usr/src/uts/sun4u/serengeti/unix/Makefile | 17 +++++++++--------
 usr/src/uts/sun4u/unix/Makefile           | 15 ++++++++-------
 usr/src/uts/sun4v/Makefile.sun4v          | 11 ++++++-----
 usr/src/uts/sun4v/unix/Makefile           | 15 ++++++++-------
 10 files changed, 58 insertions(+), 52 deletions(-)

diff --git a/usr/src/uts/i86pc/Makefile.i86pc b/usr/src/uts/i86pc/Makefile.i86pc
index 228894ec6e..66570f2f41 100644
--- a/usr/src/uts/i86pc/Makefile.i86pc
+++ b/usr/src/uts/i86pc/Makefile.i86pc
@@ -24,7 +24,7 @@
 #
 # Copyright (c) 2005, 2010, Oracle and/or its affiliates. All rights reserved.
 # Copyright (c) 2013 Andrew Stormont.  All rights reserved.
-# Copyright 2017 Joyent, Inc.
+# Copyright 2019 Joyent, Inc.
 # Copyright 2019 OmniOS Community Edition (OmniOSce) Association.
 #
 #
@@ -139,11 +139,11 @@ AS_INC_PATH		+= -I$(DSF_DIR)/$(OBJS_DIR)
 #
 #	The following must be defined for all implementations:
 #
-#	MAPFILE:	ld mapfile for the build of kernel/unix.
+#	UNIX_MAPFILE:	ld mapfile for the build of kernel/unix.
 #	MODSTUBS:	Module stubs source file.
 #	GENASSYM_SRC:	genassym.c
 #
-MAPFILE		 = $(UTSBASE)/$(PLATFORM)/conf/Mapfile
+UNIX_MAPFILE	 = $(UTSBASE)/$(PLATFORM)/conf/Mapfile
 MODSTUBS	 = $(UTSBASE)/intel/ia32/ml/modstubs.s
 GENASSYM_SRC	 = $(UTSBASE)/$(PLATFORM)/ml/genassym.c
 OFFSETS_SRC	 = $(UTSBASE)/$(PLATFORM)/ml/offsets.in
diff --git a/usr/src/uts/i86pc/unix/Makefile b/usr/src/uts/i86pc/unix/Makefile
index 709952df58..715d10bf9c 100644
--- a/usr/src/uts/i86pc/unix/Makefile
+++ b/usr/src/uts/i86pc/unix/Makefile
@@ -20,9 +20,8 @@
 #
 # Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
-# Copyright 2016 Joyent, Inc.
 #
-# Copyright (c) 2018, Joyent, Inc.
+# Copyright 2019 Joyent, Inc.
 # Copyright 2019 OmniOS Community Edition (OmniOSce) Association.
 
 #
@@ -165,8 +164,8 @@ clobber: $(CLOBBER_DEPS)
 
 install: $(INSTALL_DEPS)
 
-MAPFILE_32 = $(MAPFILE)
-MAPFILE_64 = $(MAPFILE).amd64
+MAPFILE_32 = $(UNIX_MAPFILE)
+MAPFILE_64 = $(UNIX_MAPFILE).amd64
 
 MAPFILE_NAME = $(MAPFILE_$(CLASS))
 
diff --git a/usr/src/uts/i86xpv/Makefile.i86xpv b/usr/src/uts/i86xpv/Makefile.i86xpv
index b8450d97ab..cfa20151b8 100644
--- a/usr/src/uts/i86xpv/Makefile.i86xpv
+++ b/usr/src/uts/i86xpv/Makefile.i86xpv
@@ -25,6 +25,7 @@
 # Copyright 2009 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
 # Copyright (c) 2013 Andrew Stormont.  All rights reserved.
+# Copyright 2019 Joyent, Inc.
 #
 
 #
@@ -60,7 +61,7 @@ SYM_MOD		= $(OBJS_DIR)/unix.sym
 
 UNIX_O		 = $(UNIX_DIR)/$(OBJS_DIR)/unix.o
 MODSTUBS_O	 = $(MODSTUBS_DIR)/$(OBJS_DIR)/modstubs.o
-GENLIB	 	 = $(GENLIB_DIR)/$(OBJS_DIR)/libgenunix.so
+GENLIB		 = $(GENLIB_DIR)/$(OBJS_DIR)/libgenunix.so
 LINT_LIB	 = $(LINT_LIB_DIR)/llib-lunix.ln
 DBOOT_LINT_LIB	 = $(LINT_LIB_DIR)/llib-ldboot.ln
 GEN_LINT_LIB	 = $(GEN_LINT_LIB_DIR)/llib-lgenunix.ln
@@ -136,11 +137,11 @@ AS_INC_PATH		+= -I$(DSF_DIR)/$(OBJS_DIR)
 #
 #	The following must be defined for all implementations:
 #
-#	MAPFILE:	ld mapfile for the build of kernel/unix.
+#	UNIX_MAPFILE:	ld mapfile for the build of kernel/unix.
 #	MODSTUBS:	Module stubs source file.
 #	GENASSYM_SRC:	genassym.c
 
-MAPFILE		= $(UTSBASE)/$(PLATFORM)/conf/Mapfile
+UNIX_MAPFILE	= $(UTSBASE)/$(PLATFORM)/conf/Mapfile
 MODSTUBS	= $(UTSBASE)/intel/ia32/ml/modstubs.s
 GENASSYM_SRC	= $(UTSBASE)/i86pc/ml/genassym.c
 OFFSETS_SRC	= $(UTSBASE)/i86pc/ml/offsets.in
@@ -312,7 +313,7 @@ DACF_KMODS	+= consconfig_dacf
 #
 #	'Mach' Modules (/kernel/mach):
 #
-MACH_KMODS     	+= xpv_psm xpv_uppc
+MACH_KMODS	+= xpv_psm xpv_uppc
 
 #
 #	'TOD' modules (/platform/.../kernel/tod):
diff --git a/usr/src/uts/i86xpv/unix/Makefile b/usr/src/uts/i86xpv/unix/Makefile
index 3528ca44f1..bafa0b0417 100644
--- a/usr/src/uts/i86xpv/unix/Makefile
+++ b/usr/src/uts/i86xpv/unix/Makefile
@@ -23,7 +23,7 @@
 # Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
 #
-# Copyright (c) 2018, Joyent, Inc.
+# Copyright 2019 Joyent, Inc.
 #
 #	This makefile drives the production of unix (and unix.o).
 #
@@ -177,8 +177,8 @@ clean.lint: $(CLEAN_LINT_DEPS)
 
 install: $(INSTALL_DEPS)
 
-MAPFILE_32 = $(MAPFILE)
-MAPFILE_64 = $(MAPFILE).amd64
+MAPFILE_32 = $(UNIX_MAPFILE)
+MAPFILE_64 = $(UNIX_MAPFILE).amd64
 
 MAPFILE_NAME = $(MAPFILE_$(CLASS))
 
diff --git a/usr/src/uts/sun4u/Makefile.sun4u b/usr/src/uts/sun4u/Makefile.sun4u
index 98b8ef8832..febac584d2 100644
--- a/usr/src/uts/sun4u/Makefile.sun4u
+++ b/usr/src/uts/sun4u/Makefile.sun4u
@@ -24,6 +24,7 @@
 # Use is subject to license terms.
 # Copyright (c) 2013 Andrew Stormont.  All rights reserved.
 # Copyright 2019 Peter Tribble.
+# Copyright 2019 Joyent, Inc.
 #
 #	This makefile contains the common definitions for the sun4u unix
 #	and all sun4u implementation architecture dependent modules.
@@ -226,14 +227,14 @@ LINT_DEFS = -m64
 #
 #	The following must be defined for all implementations:
 #
-#	MAPFILE:		ld mapfile for the build of kernel/unix.
+#	UNIX_MAPFILE:		ld mapfile for the build of kernel/unix.
 #	MODSTUBS:		Module stubs source file.
 #	GENCONST_SRC:		genconst.c
 #	OFFSETS:		offsets.in
 #	PLATFORM_OFFSETS:	Platform specific mach_offsets.in
 #	FDOFFSETS:		fd_offsets.in
 #
-MAPFILE		 = $(UTSBASE)/sun4/conf/Mapfile
+UNIX_MAPFILE	 = $(UTSBASE)/sun4/conf/Mapfile
 MODSTUBS	 = $(UTSBASE)/sparc/ml/modstubs.s
 GENCONST_SRC	 = $(UTSBASE)/sun4/ml/genconst.c
 OFFSETS		 = $(UTSBASE)/sun4/ml/offsets.in
diff --git a/usr/src/uts/sun4u/opl/unix/Makefile b/usr/src/uts/sun4u/opl/unix/Makefile
index 916c2f8fe5..609ec5ebcc 100644
--- a/usr/src/uts/sun4u/opl/unix/Makefile
+++ b/usr/src/uts/sun4u/opl/unix/Makefile
@@ -21,6 +21,7 @@
 #
 # Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
+# Copyright 2019 Joyent, Inc.
 #
 
 #
@@ -109,7 +110,7 @@ CLOBBERFILES	= $(CLEANFILES) $(UNIX_BIN)
 CLEANLINTFILES	+= $(LINT_LIB)
 
 #
-# lint pass one enforcement 
+# lint pass one enforcement
 # Turn on doubleword alignment for 64 bit counter timer registers
 #
 CFLAGS += $(CCVERBOSE) -dalign
@@ -143,20 +144,20 @@ lint:		$(LINT_DEPS)
 
 clean.lint:	$(CLEAN_LINT_DEPS)
 
-install:  	$(INSTALL_DEPS)
+install:	$(INSTALL_DEPS)
 
 symcheck:       $(SYM_DEPS)
 
-$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(MAPFILE) $(LIBS) \
-		$(DTRACESTUBS) 
-	$(LD) -dy -b -o $@ -e _start -M $(MAPFILE) \
-	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(UNIX_MAPFILE) $(LIBS) \
+		$(DTRACESTUBS)
+	$(LD) -dy -b -o $@ -e _start -M $(UNIX_MAPFILE) \
+	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 	$(CTFMERGE_UNIQUIFY_AGAINST_GENUNIX)
 	$(POST_PROCESS)
 
-symcheck.targ:	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBS) $(DTRACESTUBS) 
-	$(LD) -dy -b -o $(SYM_MOD) -M $(MAPFILE) \
-	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+symcheck.targ:	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBS) $(DTRACESTUBS)
+	$(LD) -dy -b -o $(SYM_MOD) -M $(UNIX_MAPFILE) \
+	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 
 $(UNIX_O):	$(OBJECTS) $(OBJS_DIR)/vers.o
 	$(LD) -r -o $@ $(OBJECTS) $(OBJS_DIR)/vers.o
diff --git a/usr/src/uts/sun4u/serengeti/unix/Makefile b/usr/src/uts/sun4u/serengeti/unix/Makefile
index 7e17ce6332..970cdc845a 100644
--- a/usr/src/uts/sun4u/serengeti/unix/Makefile
+++ b/usr/src/uts/sun4u/serengeti/unix/Makefile
@@ -22,6 +22,7 @@
 #
 # Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
+# Copyright 2019 Joyent, Inc.
 #
 
 #
@@ -108,7 +109,7 @@ CLOBBERFILES	= $(CLEANFILES) $(UNIX_BIN)
 CLEANLINTFILES	+= $(LINT_LIB)
 
 #
-# lint pass one enforcement 
+# lint pass one enforcement
 # Turn on doubleword alignment for 64 bit counter timer registers
 #
 CFLAGS += $(CCVERBOSE) -dalign
@@ -142,20 +143,20 @@ lint:		$(LINT_DEPS)
 
 clean.lint:	$(CLEAN_LINT_DEPS)
 
-install:  	$(INSTALL_DEPS)
+install:	$(INSTALL_DEPS)
 
 symcheck:	$(SYM_DEPS)
 
-$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(MAPFILE) $(LIBS) \
-		$(DTRACESTUBS) 
-	$(LD) -dy -b -o $@ -e _start -M $(MAPFILE) \
-	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(UNIX_MAPFILE) $(LIBS) \
+		$(DTRACESTUBS)
+	$(LD) -dy -b -o $@ -e _start -M $(UNIX_MAPFILE) \
+	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 	$(CTFMERGE_UNIQUIFY_AGAINST_GENUNIX)
 	$(POST_PROCESS)
 
 symcheck.targ:	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBS)
-	$(LD) -dy -b -o $(SYM_MOD) -M $(MAPFILE) \
-	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+	$(LD) -dy -b -o $(SYM_MOD) -M $(UNIX_MAPFILE) \
+	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 
 $(UNIX_O):	$(OBJECTS) $(OBJS_DIR)/vers.o
 	$(LD) -r -o $@ $(OBJECTS) $(OBJS_DIR)/vers.o
diff --git a/usr/src/uts/sun4u/unix/Makefile b/usr/src/uts/sun4u/unix/Makefile
index 8ff31a51ff..8ba80978eb 100644
--- a/usr/src/uts/sun4u/unix/Makefile
+++ b/usr/src/uts/sun4u/unix/Makefile
@@ -22,6 +22,7 @@
 #
 # Copyright 2009 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
+# Copyright 2019 Joyent, Inc.
 #
 
 #
@@ -103,7 +104,7 @@ CLOBBERFILES	= $(CLEANFILES) $(UNIX_BIN)
 CLEANLINTFILES	+= $(LINT_LIB)
 
 #
-# lint pass one enforcement 
+# lint pass one enforcement
 # Turn on doubleword alignment for 64 bit counter timer registers
 #
 CFLAGS += $(CCVERBOSE) -dalign
@@ -149,13 +150,13 @@ lint:		$(LINT_DEPS)
 
 clean.lint:	$(CLEAN_LINT_DEPS)
 
-install:  	$(INSTALL_DEPS)
+install:	$(INSTALL_DEPS)
 
 
-$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(MAPFILE) $(LIBS) \
-		$(DTRACESTUBS) 
-	$(LD) -dy -b -o $@ -e _start -M $(MAPFILE) \
-	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(UNIX_MAPFILE) $(LIBS) \
+		$(DTRACESTUBS)
+	$(LD) -dy -b -o $@ -e _start -M $(UNIX_MAPFILE) \
+	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 	$(CTFMERGE_UNIQUIFY_AGAINST_GENUNIX)
 	$(POST_PROCESS)
 	$(CHK4UBINARY)
@@ -164,7 +165,7 @@ $(UNIX32_LINK):	$(ROOT_PSM_KERN_DIR_32) $(UNIX_BIN)
 	-$(RM) $@; ln -s $(SUBDIR64)/$(UNIX) $@
 
 symcheck:	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBS)
-	$(LD) -dy -b -o $(SYM_MOD) -M $(MAPFILE) \
+	$(LD) -dy -b -o $(SYM_MOD) -M $(UNIX_MAPFILE) \
 	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 
 $(UNIX_O):	$(OBJECTS) $(OBJS_DIR)/vers.o
diff --git a/usr/src/uts/sun4v/Makefile.sun4v b/usr/src/uts/sun4v/Makefile.sun4v
index 3a1b469d21..f1d8cc13d2 100644
--- a/usr/src/uts/sun4v/Makefile.sun4v
+++ b/usr/src/uts/sun4v/Makefile.sun4v
@@ -23,6 +23,7 @@
 # Copyright 2010 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
 # Copyright (c) 2013 Andrew Stormont.  All rights reserved.
+# Copyright 2019 Joyent, Inc.
 #
 #	This makefile contains the common definitions for the sun4v unix
 #	and all sun4v implementation architecture dependent modules.
@@ -114,7 +115,7 @@ DTRACESTUBS	 = $(OBJS_DIR)/libdtracestubs.so
 
 UNIX_O		 = $(UNIX_DIR)/$(OBJS_DIR)/unix.o
 MODSTUBS_O	 = $(MODSTUBS_DIR)/$(OBJS_DIR)/modstubs.o
-GENLIB	 	 = $(GENLIB_DIR)/$(OBJS_DIR)/libgenunix.so
+GENLIB		 = $(GENLIB_DIR)/$(OBJS_DIR)/libgenunix.so
 
 LINT_LIB	 = $(LINT_LIB_DIR)/llib-lunix.ln
 GEN_LINT_LIB	 = $(LINT_LIB_DIR)/llib-lgenunix.ln
@@ -206,19 +207,19 @@ LINT_DEFS	= -m64
 #
 #	The following must be defined for all implementations:
 #
-#	MAPFILE:		ld mapfile for the build of kernel/unix.
+#	UNIX_MAPFILE:		ld mapfile for the build of kernel/unix.
 #	MODSTUBS:		Module stubs source file.
 #	GENCONST_SRC:		genconst.c
 #	OFFSETS:		offsets.in
 #	PLATFORM_OFFSETS:	Platform specific mach_offsets.in
 #	FDOFFSETS:		fd_offsets.in
 #
-MAPFILE		 = $(UTSBASE)/sun4/conf/Mapfile
+UNIX_MAPFILE	 = $(UTSBASE)/sun4/conf/Mapfile
 MODSTUBS	 = $(UTSBASE)/sparc/ml/modstubs.s
 GENCONST_SRC	 = $(UTSBASE)/sun4/ml/genconst.c
 OFFSETS		 = $(UTSBASE)/sun4/ml/offsets.in
 PLATFORM_OFFSETS = $(UTSBASE)/sun4v/ml/mach_offsets.in
-FDOFFSETS 	 = $(UTSBASE)/sun/io/fd_offsets.in
+FDOFFSETS	 = $(UTSBASE)/sun/io/fd_offsets.in
 
 #
 #	Define the actual specific platforms
@@ -266,7 +267,7 @@ IF_TRAPTRACE_OBJ = $(IF_DEBUG_OBJ)
 
 $(IF_TRAPTRACE_OBJ)mach_locore.o	:=	DEBUG_DEFS	+= -DTRAPTRACE
 $(IF_TRAPTRACE_OBJ)mlsetup.o		:=	DEBUG_DEFS	+= -DTRAPTRACE
-$(IF_TRAPTRACE_OBJ)syscall_trap.o 	:=	DEBUG_DEFS	+= -DTRAPTRACE
+$(IF_TRAPTRACE_OBJ)syscall_trap.o	:=	DEBUG_DEFS	+= -DTRAPTRACE
 $(IF_TRAPTRACE_OBJ)startup.o		:=	DEBUG_DEFS	+= -DTRAPTRACE
 $(IF_TRAPTRACE_OBJ)mach_startup.o	:=	DEBUG_DEFS	+= -DTRAPTRACE
 $(IF_TRAPTRACE_OBJ)mp_startup.o		:=	DEBUG_DEFS	+= -DTRAPTRACE
diff --git a/usr/src/uts/sun4v/unix/Makefile b/usr/src/uts/sun4v/unix/Makefile
index 216a236f0f..42ee3a613e 100644
--- a/usr/src/uts/sun4v/unix/Makefile
+++ b/usr/src/uts/sun4v/unix/Makefile
@@ -22,6 +22,7 @@
 #
 # Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
+# Copyright 2019 Joyent, Inc.
 #
 
 #
@@ -102,7 +103,7 @@ CLOBBERFILES	= $(CLEANFILES) $(UNIX_BIN)
 CLEANLINTFILES	+= $(LINT_LIB)
 
 #
-# lint pass one enforcement 
+# lint pass one enforcement
 # Turn on doubleword alignment for 64 bit counter timer registers
 #
 CFLAGS += $(CCVERBOSE) -dalign
@@ -148,13 +149,13 @@ lint:		$(LINT_DEPS)
 
 clean.lint:	$(CLEAN_LINT_DEPS)
 
-install:  	$(INSTALL_DEPS)
+install:	$(INSTALL_DEPS)
 
 
-$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(MAPFILE) $(LIBS) \
-		$(DTRACESTUBS) 
-	$(LD) -dy -b -o $@ -e _start -M $(MAPFILE) \
-	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS) 
+$(UNIX_BIN):	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(UNIX_MAPFILE) $(LIBS) \
+		$(DTRACESTUBS)
+	$(LD) -dy -b -o $@ -e _start -M $(UNIX_MAPFILE) \
+	    $(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 	$(CTFMERGE_UNIQUIFY_AGAINST_GENUNIX)
 	$(POST_PROCESS)
 
@@ -162,7 +163,7 @@ $(UNIX32_LINK):	$(ROOT_PSM_KERN_DIR_32) $(UNIX_BIN)
 	-$(RM) $@; ln -s $(SUBDIR64)/$(UNIX) $@
 
 symcheck:	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBS)
-	$(LD) -dy -b -o $(SYM_MOD) -M $(MAPFILE) \
+	$(LD) -dy -b -o $(SYM_MOD) -M $(UNIX_MAPFILE) \
 	$(UNIX_O) $(KRTLD_O) $(MODSTUBS_O) $(LIBOPTS) $(DTRACESTUBS)
 
 $(UNIX_O):	$(OBJECTS) $(OBJS_DIR)/vers.o
-- 
2.21.0

