commit 9490c7babe3f940333104fef6c0ec2abcbe60608
Author: John Levon <john.levon@joyent.com>
Date:   2019-09-30T13:08:09+00:00 (7 days ago)
    
    OS-7997 update Intel microcode to 20190918

diff --git a/manifest b/manifest
index 0be23336c1..91282b521c 100644
--- a/manifest
+++ b/manifest
@@ -2198,6 +2198,13 @@ f platform/i86pc/ucode/GenuineIntel/000206D7-40 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000206E6-04 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000206F2-01 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000206F2-04 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030678-02 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030678-04 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030678-08 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030679-01 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030679-02 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030679-04 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/00030679-08 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000306A9-02 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000306A9-10 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000306C3-02 0444 root sys
@@ -2239,6 +2246,8 @@ f platform/i86pc/ucode/GenuineIntel/00040661-10 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/00040661-20 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/00040671-02 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/00040671-20 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/000406C3-01 0444 root sys
+f platform/i86pc/ucode/GenuineIntel/000406C4-01 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000406E3-40 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000406E3-80 0444 root sys
 f platform/i86pc/ucode/GenuineIntel/000406F1-01 0444 root sys
@@ -10888,6 +10897,7 @@ f usr/sbin/raidctl 0555 root bin
 f usr/sbin/ramdiskadm 0555 root bin
 f usr/sbin/rcapadm 0555 root bin
 f usr/sbin/rctladm 0555 root bin
+f usr/sbin/rdmsr 0555 root bin
 h usr/sbin/reboot=usr/sbin/halt
 f usr/sbin/rem_drv 0555 root sys
 s usr/sbin/repquota=../lib/fs/ufs/repquota
diff --git a/usr/src/cmd/Makefile b/usr/src/cmd/Makefile
index fdbb25c9a0..88b249abd2 100644
--- a/usr/src/cmd/Makefile
+++ b/usr/src/cmd/Makefile
@@ -490,6 +490,7 @@ i386_SUBDIRS=		\
 	cxgbetool	\
 	diskscan	\
 	nvmeadm		\
+	rdmsr		\
 	rtc		\
 	ucodeadm	\
 	xhci		\
@@ -755,6 +756,7 @@ sparc_MSGSUBDIRS=	\
 	vntsd
 
 i386_MSGSUBDIRS=	\
+	rdmsr		\
 	ucodeadm
 
 #
diff --git a/usr/src/cmd/rdmsr/Makefile b/usr/src/cmd/rdmsr/Makefile
new file mode 100644
index 0000000000..835a1349e4
--- /dev/null
+++ b/usr/src/cmd/rdmsr/Makefile
@@ -0,0 +1,35 @@
+#
+# This file and its contents are supplied under the terms of the
+# Common Development and Distribution License ("CDDL"), version 1.0.
+# You may only use this file in accordance with the terms of version
+# 1.0 of the CDDL.
+#
+# A full copy of the text of the CDDL should have accompanied this
+# source.  A copy of the CDDL is also available via the Internet at
+# http://www.illumos.org/license/CDDL.
+#
+
+#
+# Copyright 2019 Joyent, Inc.
+#
+
+PROG = rdmsr
+
+include ../Makefile.cmd
+include ../Makefile.cmd.64
+
+.KEEP_STATE:
+
+CPPFLAGS += -I../../uts/common
+
+all: $(PROG)
+
+install: all $(ROOTUSRSBINPROG)
+
+check:	$(PROG).c
+	$(CSTYLE) -pP $(PROG).c
+
+clean:
+	$(RM) $(OBJS)
+
+include ../Makefile.targ
diff --git a/usr/src/cmd/rdmsr/rdmsr.c b/usr/src/cmd/rdmsr/rdmsr.c
new file mode 100644
index 0000000000..3d8edf9c30
--- /dev/null
+++ b/usr/src/cmd/rdmsr/rdmsr.c
@@ -0,0 +1,83 @@
+/*
+ * This file and its contents are supplied under the terms of the
+ * Common Development and Distribution License ("CDDL"), version 1.0.
+ * You may only use this file in accordance with the terms of version
+ * 1.0 of the CDDL.
+ *
+ * A full copy of the text of the CDDL should have accompanied this
+ * source.  A copy of the CDDL is also available via the Internet at
+ * http://www.illumos.org/license/CDDL.
+ */
+
+/*
+ * Copyright 2019 Joyent, Inc.
+ */
+
+#include <sys/cpuid_drv.h>
+
+#include <libintl.h>
+#include <string.h>
+#include <locale.h>
+#include <unistd.h>
+#include <stdlib.h>
+#include <fcntl.h>
+#include <stdio.h>
+#include <errno.h>
+
+static const char dev_cpu_self_cpuid[] = "/dev/" CPUID_SELF_NAME;
+
+int
+main(int argc, char *argv[])
+{
+	int errflg = 0;
+	int fd;
+	int c;
+
+	(void) setlocale(LC_ALL, "");
+	(void) textdomain(TEXT_DOMAIN);
+
+	while ((c = getopt(argc, argv, "")) != EOF) {
+		switch (c) {
+		case '?':
+		default:
+			errflg++;
+			break;
+		}
+	}
+
+	if (errflg || optind == argc) {
+		(void) fprintf(stderr,
+		    gettext("usage: rdmsr [0x<msrnr>...]\n"));
+		return (EXIT_FAILURE);
+	}
+
+	if ((fd = open(dev_cpu_self_cpuid, O_RDONLY)) == -1) {
+		perror(dev_cpu_self_cpuid);
+		exit(EXIT_FAILURE);
+	}
+
+	while (optind != argc) {
+		struct cpuid_rdmsr crm;
+		char *p;
+
+		errno = 0;
+		crm.cr_msr_nr = strtoull(argv[optind], &p, 0);
+
+		if (errno != 0 || p == argv[optind] || *p != '\0') {
+			(void) fprintf(stderr, "rdmsr: invalid argument '%s'\n",
+			    argv[optind]);
+			exit(EXIT_FAILURE);
+		}
+
+		if (ioctl(fd, CPUID_RDMSR, &crm) != 0) {
+			fprintf(stderr, "rdmsr(0x%lx) failed: %s\n",
+			    crm.cr_msr_nr, strerror(errno));
+		} else {
+			printf("0x%lx: 0x%lx\n", crm.cr_msr_nr, crm.cr_msr_val);
+		}
+
+		optind++;
+	}
+
+	return (EXIT_SUCCESS);
+}
diff --git a/usr/src/cmd/truss/Makefile.com b/usr/src/cmd/truss/Makefile.com
index 4140101d8d..1d134f6528 100644
--- a/usr/src/cmd/truss/Makefile.com
+++ b/usr/src/cmd/truss/Makefile.com
@@ -23,7 +23,7 @@
 # Copyright (c) 2016 by Delphix. All rights reserved.
 # Copyright 2010 Sun Microsystems, Inc.  All rights reserved.
 # Use is subject to license terms.
-# Copyright (c) 2018, Joyent, Inc.
+# Copyright 2019 Joyent, Inc.
 #
 
 PROG=	truss
@@ -49,6 +49,7 @@ CSTD=	$(CSTD_GNU99)
 LDLIBS	+= -lproc -lrtld_db -lc_db -lnsl -lsocket -ltsol -lnvpair
 CPPFLAGS += -D_REENTRANT -D_LARGEFILE64_SOURCE=1
 CPPFLAGS += -I$(SRC)/uts/common/fs/zfs
+CPPFLAGS += -I$(SRC)/uts/common
 
 LINTFLAGS += -erroff=E_STATIC_UNUSED
 LINTFLAGS += -erroff=E_NAME_USED_NOT_DEF2
@@ -69,7 +70,4 @@ $(PROG): $(OBJS)
 clean:
 	$(RM) $(OBJS)
 
-lint:
-	$(LINT.c) $(SRCS) $(LDLIBS)
-
 include ../../Makefile.targ
diff --git a/usr/src/cmd/truss/codes.c b/usr/src/cmd/truss/codes.c
index 9e7d513178..b169e0567c 100644
--- a/usr/src/cmd/truss/codes.c
+++ b/usr/src/cmd/truss/codes.c
@@ -103,6 +103,7 @@
 #include <sys/usb/clients/hid/hid.h>
 #include <sys/pm.h>
 #include <sys/soundcard.h>
+#include <sys/cpuid_drv.h>
 
 #include "ramdata.h"
 #include "proto.h"
@@ -1670,6 +1671,10 @@ const struct ioc {
 		"pm_searchargs_t" },
 #endif /* _SYSCALL */
 
+	/* cpuid ioctls */
+	{ (uint_t)CPUID_GET_HWCAP,		"CPUID_GET_HWCAP", NULL },
+	{ (uint_t)CPUID_RDMSR,			"CPUID_RDMSR", NULL },
+
 	{ (uint_t)0, NULL, NULL	}
 };
 
diff --git a/usr/src/data/ucode/Makefile b/usr/src/data/ucode/Makefile
index 2fc0ecdc69..db8a624cdf 100644
--- a/usr/src/data/ucode/Makefile
+++ b/usr/src/data/ucode/Makefile
@@ -21,16 +21,18 @@ ROOTINTELDIR = $(ROOTUCODEPATH)/GenuineIntel
 
 AMD_FILES :sh= (cd amd; print *)
 INTEL_FILES :sh= (cd intel; print *)
+include $(SRC)/data/ucode/Makefile.links
 
 ROOTAMDFILES = $(AMD_FILES:%=$(ROOTAMDDIR)/%)
 ROOTINTELFILES = $(INTEL_FILES:%=$(ROOTINTELDIR)/%)
+ROOTINTELLINKS = $(INTEL_LINKS:%=$(ROOTINTELDIR)/%)
 
 $(ROOTAMDFILES) := FILEMODE = 444
 $(ROOTINTELFILES) := FILEMODE = 444
 
 all:
 
-install: $(ROOTAMDFILES) $(ROOTINTELFILES)
+install: $(ROOTAMDFILES) $(ROOTINTELFILES) $(ROOTINTELLINKS)
 
 clean:
 
diff --git a/usr/src/data/ucode/Makefile.links b/usr/src/data/ucode/Makefile.links
new file mode 100644
index 0000000000..df9318921e
--- /dev/null
+++ b/usr/src/data/ucode/Makefile.links
@@ -0,0 +1,383 @@
+INTEL_LINKS = 00000F32-04 00000F32-08 00000F33-04 00000F33-08 00000F34-04 00000F34-08 00000F34-10 00000F41-04 00000F41-08 00000F41-10 00000F41-20 00000F41-80 00000F43-04 00000F43-08 00000F43-10 00000F43-80 00000F44-04 00000F44-08 00000F44-10 00000F44-80 00000F47-04 00000F47-08 00000F47-10 00000F47-80 00000F48-08 00000F48-10 00000F48-40 00000F49-04 00000F49-08 00000F49-10 00000F49-20 00000F49-80 00000F4A-08 00000F4A-10 00000F4A-40 00000F64-10 00000F64-20 00000F68-20 0001067A-10 0001067A-40 0001067A-80 000106A4-02 000106A5-02 000106E5-02 000106E5-10 00020652-10 00020655-10 00020655-80 000206A7-10 000206C2-02 000206D6-04 000206D6-08 000206D6-20 000206D6-40 000206D7-04 000206D7-08 000206D7-20 000206D7-40 000206F2-04 00030678-08 00030679-02 00030679-04 00030679-08 000306A9-10 000306C3-10 000306C3-20 000306D4-80 000306E4-04 000306E4-08 000306E4-20 000306E4-40 000306E4-80 000306E6-04 000306E6-08 000306E6-20 000306E6-40 000306E6-80 000306E7-04 000306E7-08 000306E7-20 000306E7-40 000306E7-80 000306F2-02 000306F2-04 000306F2-08 000306F2-20 000306F2-40 00040651-10 00040651-20 00040651-40 00040661-10 00040661-20 00040671-20 000406E3-80 000406F1-02 000406F1-04 000406F1-08 000406F1-20 000406F1-40 000406F1-80 00050654-02 00050654-04 00050654-10 00050654-20 00050654-80 00050657-02 00050657-04 00050657-08 00050657-10 00050657-20 00050657-80 000506C9-02 000506CA-02 000506E3-04 000506E3-10 000506E3-20 000806E9-80 000806EA-80 000806EB-40 000806EB-80 000806EC-10 000806EC-80 000906E9-08 000906E9-20 000906EA-20 000906EC-20 000906ED-20
+
+$(ROOTINTELDIR)/00000F32-04: $(ROOTINTELDIR)/00000F32-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F32-08: $(ROOTINTELDIR)/00000F32-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F33-04: $(ROOTINTELDIR)/00000F33-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F33-08: $(ROOTINTELDIR)/00000F33-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F34-04: $(ROOTINTELDIR)/00000F34-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F34-08: $(ROOTINTELDIR)/00000F34-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F34-10: $(ROOTINTELDIR)/00000F34-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F41-04: $(ROOTINTELDIR)/00000F41-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F41-08: $(ROOTINTELDIR)/00000F41-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F41-10: $(ROOTINTELDIR)/00000F41-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F41-20: $(ROOTINTELDIR)/00000F41-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F41-80: $(ROOTINTELDIR)/00000F41-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F43-04: $(ROOTINTELDIR)/00000F43-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F43-08: $(ROOTINTELDIR)/00000F43-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F43-10: $(ROOTINTELDIR)/00000F43-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F43-80: $(ROOTINTELDIR)/00000F43-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F44-04: $(ROOTINTELDIR)/00000F44-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F44-08: $(ROOTINTELDIR)/00000F44-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F44-10: $(ROOTINTELDIR)/00000F44-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F44-80: $(ROOTINTELDIR)/00000F44-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F47-04: $(ROOTINTELDIR)/00000F47-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F47-08: $(ROOTINTELDIR)/00000F47-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F47-10: $(ROOTINTELDIR)/00000F47-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F47-80: $(ROOTINTELDIR)/00000F47-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F48-08: $(ROOTINTELDIR)/00000F48-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F48-10: $(ROOTINTELDIR)/00000F48-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F48-40: $(ROOTINTELDIR)/00000F48-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F49-04: $(ROOTINTELDIR)/00000F49-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F49-08: $(ROOTINTELDIR)/00000F49-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F49-10: $(ROOTINTELDIR)/00000F49-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F49-20: $(ROOTINTELDIR)/00000F49-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F49-80: $(ROOTINTELDIR)/00000F49-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F4A-08: $(ROOTINTELDIR)/00000F4A-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F4A-10: $(ROOTINTELDIR)/00000F4A-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F4A-40: $(ROOTINTELDIR)/00000F4A-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F64-10: $(ROOTINTELDIR)/00000F64-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F64-20: $(ROOTINTELDIR)/00000F64-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00000F68-20: $(ROOTINTELDIR)/00000F68-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/0001067A-10: $(ROOTINTELDIR)/0001067A-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/0001067A-40: $(ROOTINTELDIR)/0001067A-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/0001067A-80: $(ROOTINTELDIR)/0001067A-20
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000106A4-02: $(ROOTINTELDIR)/000106A4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000106A5-02: $(ROOTINTELDIR)/000106A5-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000106E5-02: $(ROOTINTELDIR)/000106E5-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000106E5-10: $(ROOTINTELDIR)/000106E5-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00020652-10: $(ROOTINTELDIR)/00020652-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00020655-10: $(ROOTINTELDIR)/00020655-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00020655-80: $(ROOTINTELDIR)/00020655-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206A7-10: $(ROOTINTELDIR)/000206A7-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206C2-02: $(ROOTINTELDIR)/000206C2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D6-04: $(ROOTINTELDIR)/000206D6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D6-08: $(ROOTINTELDIR)/000206D6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D6-20: $(ROOTINTELDIR)/000206D6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D6-40: $(ROOTINTELDIR)/000206D6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D7-04: $(ROOTINTELDIR)/000206D7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D7-08: $(ROOTINTELDIR)/000206D7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D7-20: $(ROOTINTELDIR)/000206D7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206D7-40: $(ROOTINTELDIR)/000206D7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000206F2-04: $(ROOTINTELDIR)/000206F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00030678-08: $(ROOTINTELDIR)/00030678-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00030679-02: $(ROOTINTELDIR)/00030679-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00030679-04: $(ROOTINTELDIR)/00030679-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00030679-08: $(ROOTINTELDIR)/00030679-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306A9-10: $(ROOTINTELDIR)/000306A9-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306C3-10: $(ROOTINTELDIR)/000306C3-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306C3-20: $(ROOTINTELDIR)/000306C3-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306D4-80: $(ROOTINTELDIR)/000306D4-40
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E4-04: $(ROOTINTELDIR)/000306E4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E4-08: $(ROOTINTELDIR)/000306E4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E4-20: $(ROOTINTELDIR)/000306E4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E4-40: $(ROOTINTELDIR)/000306E4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E4-80: $(ROOTINTELDIR)/000306E4-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E6-04: $(ROOTINTELDIR)/000306E6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E6-08: $(ROOTINTELDIR)/000306E6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E6-20: $(ROOTINTELDIR)/000306E6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E6-40: $(ROOTINTELDIR)/000306E6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E6-80: $(ROOTINTELDIR)/000306E6-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E7-04: $(ROOTINTELDIR)/000306E7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E7-08: $(ROOTINTELDIR)/000306E7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E7-20: $(ROOTINTELDIR)/000306E7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E7-40: $(ROOTINTELDIR)/000306E7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306E7-80: $(ROOTINTELDIR)/000306E7-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306F2-02: $(ROOTINTELDIR)/000306F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306F2-04: $(ROOTINTELDIR)/000306F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306F2-08: $(ROOTINTELDIR)/000306F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306F2-20: $(ROOTINTELDIR)/000306F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000306F2-40: $(ROOTINTELDIR)/000306F2-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040651-10: $(ROOTINTELDIR)/00040651-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040651-20: $(ROOTINTELDIR)/00040651-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040651-40: $(ROOTINTELDIR)/00040651-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040661-10: $(ROOTINTELDIR)/00040661-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040661-20: $(ROOTINTELDIR)/00040661-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00040671-20: $(ROOTINTELDIR)/00040671-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406E3-80: $(ROOTINTELDIR)/000406E3-40
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-02: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-04: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-08: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-20: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-40: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000406F1-80: $(ROOTINTELDIR)/000406F1-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050654-02: $(ROOTINTELDIR)/00050654-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050654-04: $(ROOTINTELDIR)/00050654-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050654-10: $(ROOTINTELDIR)/00050654-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050654-20: $(ROOTINTELDIR)/00050654-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050654-80: $(ROOTINTELDIR)/00050654-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-02: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-04: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-08: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-10: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-20: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/00050657-80: $(ROOTINTELDIR)/00050657-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000506C9-02: $(ROOTINTELDIR)/000506C9-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000506CA-02: $(ROOTINTELDIR)/000506CA-01
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000506E3-04: $(ROOTINTELDIR)/000506E3-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000506E3-10: $(ROOTINTELDIR)/000506E3-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000506E3-20: $(ROOTINTELDIR)/000506E3-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806E9-80: $(ROOTINTELDIR)/000806E9-40
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806EA-80: $(ROOTINTELDIR)/000806EA-40
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806EB-40: $(ROOTINTELDIR)/000806EB-10
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806EB-80: $(ROOTINTELDIR)/000806EB-10
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806EC-10: $(ROOTINTELDIR)/000806EC-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000806EC-80: $(ROOTINTELDIR)/000806EC-04
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000906E9-08: $(ROOTINTELDIR)/000906E9-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000906E9-20: $(ROOTINTELDIR)/000906E9-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000906EA-20: $(ROOTINTELDIR)/000906EA-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000906EC-20: $(ROOTINTELDIR)/000906EC-02
+	$(RM) $@; $(LN) $^ $@
+
+$(ROOTINTELDIR)/000906ED-20: $(ROOTINTELDIR)/000906ED-02
+	$(RM) $@; $(LN) $^ $@
+
diff --git a/usr/src/data/ucode/README.ucode b/usr/src/data/ucode/README.ucode
index 24f4d5779c..2968fc5ec5 100644
--- a/usr/src/data/ucode/README.ucode
+++ b/usr/src/data/ucode/README.ucode
@@ -27,7 +27,15 @@ Intead of using this method, we will update the microcode and manage
 them in here as individual files. When updating files, please indicate
 the release that the microcode was obtained from here.
 
+The upstream microcode for Intel can currently be found at:
+
+https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files
+
+The script "update.intel" in this directory can be used to help automate
+the update by providing a tarball of the above microcode, and takes care
+of updating the manifest as necessary. Be careful about new files.
+
 AMD: Updated in March 2012 as part of illumos#2546. Exact revision
 unknown.
 
-Intel: Linux 20190514 release
+Intel: Linux 20190918 release
diff --git a/usr/src/data/ucode/intel/00000F32-04 b/usr/src/data/ucode/intel/00000F32-04
deleted file mode 100644
index 00271ee25e..0000000000
Binary files a/usr/src/data/ucode/intel/00000F32-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F32-08 b/usr/src/data/ucode/intel/00000F32-08
deleted file mode 100644
index 00271ee25e..0000000000
Binary files a/usr/src/data/ucode/intel/00000F32-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F33-04 b/usr/src/data/ucode/intel/00000F33-04
deleted file mode 100644
index 10300a2bb9..0000000000
Binary files a/usr/src/data/ucode/intel/00000F33-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F33-08 b/usr/src/data/ucode/intel/00000F33-08
deleted file mode 100644
index 10300a2bb9..0000000000
Binary files a/usr/src/data/ucode/intel/00000F33-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F34-04 b/usr/src/data/ucode/intel/00000F34-04
deleted file mode 100644
index 27f2b9b27f..0000000000
Binary files a/usr/src/data/ucode/intel/00000F34-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F34-08 b/usr/src/data/ucode/intel/00000F34-08
deleted file mode 100644
index 27f2b9b27f..0000000000
Binary files a/usr/src/data/ucode/intel/00000F34-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F34-10 b/usr/src/data/ucode/intel/00000F34-10
deleted file mode 100644
index 27f2b9b27f..0000000000
Binary files a/usr/src/data/ucode/intel/00000F34-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F41-04 b/usr/src/data/ucode/intel/00000F41-04
deleted file mode 100644
index 2eeb60c67c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F41-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F41-08 b/usr/src/data/ucode/intel/00000F41-08
deleted file mode 100644
index 2eeb60c67c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F41-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F41-10 b/usr/src/data/ucode/intel/00000F41-10
deleted file mode 100644
index 2eeb60c67c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F41-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F41-20 b/usr/src/data/ucode/intel/00000F41-20
deleted file mode 100644
index 2eeb60c67c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F41-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F41-80 b/usr/src/data/ucode/intel/00000F41-80
deleted file mode 100644
index 2eeb60c67c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F41-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F43-04 b/usr/src/data/ucode/intel/00000F43-04
deleted file mode 100644
index 0ed7e18fd7..0000000000
Binary files a/usr/src/data/ucode/intel/00000F43-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F43-08 b/usr/src/data/ucode/intel/00000F43-08
deleted file mode 100644
index 0ed7e18fd7..0000000000
Binary files a/usr/src/data/ucode/intel/00000F43-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F43-10 b/usr/src/data/ucode/intel/00000F43-10
deleted file mode 100644
index 0ed7e18fd7..0000000000
Binary files a/usr/src/data/ucode/intel/00000F43-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F43-80 b/usr/src/data/ucode/intel/00000F43-80
deleted file mode 100644
index 0ed7e18fd7..0000000000
Binary files a/usr/src/data/ucode/intel/00000F43-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F44-04 b/usr/src/data/ucode/intel/00000F44-04
deleted file mode 100644
index 669f65966c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F44-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F44-08 b/usr/src/data/ucode/intel/00000F44-08
deleted file mode 100644
index 669f65966c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F44-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F44-10 b/usr/src/data/ucode/intel/00000F44-10
deleted file mode 100644
index 669f65966c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F44-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F44-80 b/usr/src/data/ucode/intel/00000F44-80
deleted file mode 100644
index 669f65966c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F44-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F47-04 b/usr/src/data/ucode/intel/00000F47-04
deleted file mode 100644
index 0d2190c32c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F47-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F47-08 b/usr/src/data/ucode/intel/00000F47-08
deleted file mode 100644
index 0d2190c32c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F47-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F47-10 b/usr/src/data/ucode/intel/00000F47-10
deleted file mode 100644
index 0d2190c32c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F47-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F47-80 b/usr/src/data/ucode/intel/00000F47-80
deleted file mode 100644
index 0d2190c32c..0000000000
Binary files a/usr/src/data/ucode/intel/00000F47-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F48-08 b/usr/src/data/ucode/intel/00000F48-08
deleted file mode 100644
index 8e0a1fb8f2..0000000000
Binary files a/usr/src/data/ucode/intel/00000F48-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F48-10 b/usr/src/data/ucode/intel/00000F48-10
deleted file mode 100644
index 8e0a1fb8f2..0000000000
Binary files a/usr/src/data/ucode/intel/00000F48-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F48-40 b/usr/src/data/ucode/intel/00000F48-40
deleted file mode 100644
index 8e0a1fb8f2..0000000000
Binary files a/usr/src/data/ucode/intel/00000F48-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F49-04 b/usr/src/data/ucode/intel/00000F49-04
deleted file mode 100644
index 3307178dfb..0000000000
Binary files a/usr/src/data/ucode/intel/00000F49-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F49-08 b/usr/src/data/ucode/intel/00000F49-08
deleted file mode 100644
index 3307178dfb..0000000000
Binary files a/usr/src/data/ucode/intel/00000F49-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F49-10 b/usr/src/data/ucode/intel/00000F49-10
deleted file mode 100644
index 3307178dfb..0000000000
Binary files a/usr/src/data/ucode/intel/00000F49-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F49-20 b/usr/src/data/ucode/intel/00000F49-20
deleted file mode 100644
index 3307178dfb..0000000000
Binary files a/usr/src/data/ucode/intel/00000F49-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F49-80 b/usr/src/data/ucode/intel/00000F49-80
deleted file mode 100644
index 3307178dfb..0000000000
Binary files a/usr/src/data/ucode/intel/00000F49-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F4A-08 b/usr/src/data/ucode/intel/00000F4A-08
deleted file mode 100644
index f788f5e404..0000000000
Binary files a/usr/src/data/ucode/intel/00000F4A-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F4A-10 b/usr/src/data/ucode/intel/00000F4A-10
deleted file mode 100644
index f788f5e404..0000000000
Binary files a/usr/src/data/ucode/intel/00000F4A-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F4A-40 b/usr/src/data/ucode/intel/00000F4A-40
deleted file mode 100644
index f788f5e404..0000000000
Binary files a/usr/src/data/ucode/intel/00000F4A-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F64-10 b/usr/src/data/ucode/intel/00000F64-10
deleted file mode 100644
index 30c70da5ba..0000000000
Binary files a/usr/src/data/ucode/intel/00000F64-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F64-20 b/usr/src/data/ucode/intel/00000F64-20
deleted file mode 100644
index 30c70da5ba..0000000000
Binary files a/usr/src/data/ucode/intel/00000F64-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00000F68-20 b/usr/src/data/ucode/intel/00000F68-20
deleted file mode 100644
index bdc81f4050..0000000000
Binary files a/usr/src/data/ucode/intel/00000F68-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/0001067A-10 b/usr/src/data/ucode/intel/0001067A-10
deleted file mode 100644
index 6341a6125a..0000000000
Binary files a/usr/src/data/ucode/intel/0001067A-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/0001067A-40 b/usr/src/data/ucode/intel/0001067A-40
deleted file mode 100644
index 5a1ae4530e..0000000000
Binary files a/usr/src/data/ucode/intel/0001067A-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/0001067A-80 b/usr/src/data/ucode/intel/0001067A-80
deleted file mode 100644
index aa845f7e7b..0000000000
Binary files a/usr/src/data/ucode/intel/0001067A-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000106A4-02 b/usr/src/data/ucode/intel/000106A4-02
deleted file mode 100644
index 4604f50e05..0000000000
Binary files a/usr/src/data/ucode/intel/000106A4-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000106A5-02 b/usr/src/data/ucode/intel/000106A5-02
deleted file mode 100644
index 154e08c826..0000000000
Binary files a/usr/src/data/ucode/intel/000106A5-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000106E5-02 b/usr/src/data/ucode/intel/000106E5-02
deleted file mode 100644
index b692f51dd2..0000000000
Binary files a/usr/src/data/ucode/intel/000106E5-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000106E5-10 b/usr/src/data/ucode/intel/000106E5-10
deleted file mode 100644
index b692f51dd2..0000000000
Binary files a/usr/src/data/ucode/intel/000106E5-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00020652-10 b/usr/src/data/ucode/intel/00020652-10
deleted file mode 100644
index f63ee5581e..0000000000
Binary files a/usr/src/data/ucode/intel/00020652-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00020655-10 b/usr/src/data/ucode/intel/00020655-10
deleted file mode 100644
index 06bbbc501d..0000000000
Binary files a/usr/src/data/ucode/intel/00020655-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00020655-80 b/usr/src/data/ucode/intel/00020655-80
deleted file mode 100644
index 06bbbc501d..0000000000
Binary files a/usr/src/data/ucode/intel/00020655-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206A7-10 b/usr/src/data/ucode/intel/000206A7-10
deleted file mode 100644
index 844fc1fdb8..0000000000
Binary files a/usr/src/data/ucode/intel/000206A7-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206C2-02 b/usr/src/data/ucode/intel/000206C2-02
deleted file mode 100644
index 2a78b4a4d2..0000000000
Binary files a/usr/src/data/ucode/intel/000206C2-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D6-01 b/usr/src/data/ucode/intel/000206D6-01
index d89a291172..2c9b69c74d 100644
Binary files a/usr/src/data/ucode/intel/000206D6-01 and b/usr/src/data/ucode/intel/000206D6-01 differ
diff --git a/usr/src/data/ucode/intel/000206D6-04 b/usr/src/data/ucode/intel/000206D6-04
deleted file mode 100644
index d89a291172..0000000000
Binary files a/usr/src/data/ucode/intel/000206D6-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D6-08 b/usr/src/data/ucode/intel/000206D6-08
deleted file mode 100644
index d89a291172..0000000000
Binary files a/usr/src/data/ucode/intel/000206D6-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D6-20 b/usr/src/data/ucode/intel/000206D6-20
deleted file mode 100644
index d89a291172..0000000000
Binary files a/usr/src/data/ucode/intel/000206D6-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D6-40 b/usr/src/data/ucode/intel/000206D6-40
deleted file mode 100644
index d89a291172..0000000000
Binary files a/usr/src/data/ucode/intel/000206D6-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D7-01 b/usr/src/data/ucode/intel/000206D7-01
index 0da2b9e3f5..52a3fb66f3 100644
Binary files a/usr/src/data/ucode/intel/000206D7-01 and b/usr/src/data/ucode/intel/000206D7-01 differ
diff --git a/usr/src/data/ucode/intel/000206D7-04 b/usr/src/data/ucode/intel/000206D7-04
deleted file mode 100644
index 0da2b9e3f5..0000000000
Binary files a/usr/src/data/ucode/intel/000206D7-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D7-08 b/usr/src/data/ucode/intel/000206D7-08
deleted file mode 100644
index 0da2b9e3f5..0000000000
Binary files a/usr/src/data/ucode/intel/000206D7-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D7-20 b/usr/src/data/ucode/intel/000206D7-20
deleted file mode 100644
index 0da2b9e3f5..0000000000
Binary files a/usr/src/data/ucode/intel/000206D7-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206D7-40 b/usr/src/data/ucode/intel/000206D7-40
deleted file mode 100644
index 0da2b9e3f5..0000000000
Binary files a/usr/src/data/ucode/intel/000206D7-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000206F2-04 b/usr/src/data/ucode/intel/000206F2-04
deleted file mode 100644
index 8cebe97f86..0000000000
Binary files a/usr/src/data/ucode/intel/000206F2-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00030678-02 b/usr/src/data/ucode/intel/00030678-02
new file mode 100644
index 0000000000..23dedb0086
Binary files /dev/null and b/usr/src/data/ucode/intel/00030678-02 differ
diff --git a/usr/src/data/ucode/intel/00030678-04 b/usr/src/data/ucode/intel/00030678-04
new file mode 100644
index 0000000000..cad81aeeb7
Binary files /dev/null and b/usr/src/data/ucode/intel/00030678-04 differ
diff --git a/usr/src/data/ucode/intel/00030679-01 b/usr/src/data/ucode/intel/00030679-01
new file mode 100644
index 0000000000..410fa71bf9
Binary files /dev/null and b/usr/src/data/ucode/intel/00030679-01 differ
diff --git a/usr/src/data/ucode/intel/000306A9-10 b/usr/src/data/ucode/intel/000306A9-10
deleted file mode 100644
index 896e410ca9..0000000000
Binary files a/usr/src/data/ucode/intel/000306A9-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306C3-10 b/usr/src/data/ucode/intel/000306C3-10
deleted file mode 100644
index a6c51f0c29..0000000000
Binary files a/usr/src/data/ucode/intel/000306C3-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306C3-20 b/usr/src/data/ucode/intel/000306C3-20
deleted file mode 100644
index a6c51f0c29..0000000000
Binary files a/usr/src/data/ucode/intel/000306C3-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306D4-40 b/usr/src/data/ucode/intel/000306D4-40
index 36c954116a..ec79c714d3 100644
Binary files a/usr/src/data/ucode/intel/000306D4-40 and b/usr/src/data/ucode/intel/000306D4-40 differ
diff --git a/usr/src/data/ucode/intel/000306D4-80 b/usr/src/data/ucode/intel/000306D4-80
deleted file mode 100644
index 36c954116a..0000000000
Binary files a/usr/src/data/ucode/intel/000306D4-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E4-04 b/usr/src/data/ucode/intel/000306E4-04
deleted file mode 100644
index b60f219ea3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E4-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E4-08 b/usr/src/data/ucode/intel/000306E4-08
deleted file mode 100644
index b60f219ea3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E4-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E4-20 b/usr/src/data/ucode/intel/000306E4-20
deleted file mode 100644
index b60f219ea3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E4-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E4-40 b/usr/src/data/ucode/intel/000306E4-40
deleted file mode 100644
index b60f219ea3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E4-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E4-80 b/usr/src/data/ucode/intel/000306E4-80
deleted file mode 100644
index b60f219ea3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E4-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E6-04 b/usr/src/data/ucode/intel/000306E6-04
deleted file mode 100644
index 41b2d07cd3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E6-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E6-08 b/usr/src/data/ucode/intel/000306E6-08
deleted file mode 100644
index 41b2d07cd3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E6-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E6-20 b/usr/src/data/ucode/intel/000306E6-20
deleted file mode 100644
index 41b2d07cd3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E6-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E6-40 b/usr/src/data/ucode/intel/000306E6-40
deleted file mode 100644
index 41b2d07cd3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E6-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E6-80 b/usr/src/data/ucode/intel/000306E6-80
deleted file mode 100644
index 41b2d07cd3..0000000000
Binary files a/usr/src/data/ucode/intel/000306E6-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E7-04 b/usr/src/data/ucode/intel/000306E7-04
deleted file mode 100644
index 21a97de3e5..0000000000
Binary files a/usr/src/data/ucode/intel/000306E7-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E7-08 b/usr/src/data/ucode/intel/000306E7-08
deleted file mode 100644
index 21a97de3e5..0000000000
Binary files a/usr/src/data/ucode/intel/000306E7-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E7-20 b/usr/src/data/ucode/intel/000306E7-20
deleted file mode 100644
index 21a97de3e5..0000000000
Binary files a/usr/src/data/ucode/intel/000306E7-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E7-40 b/usr/src/data/ucode/intel/000306E7-40
deleted file mode 100644
index 21a97de3e5..0000000000
Binary files a/usr/src/data/ucode/intel/000306E7-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306E7-80 b/usr/src/data/ucode/intel/000306E7-80
deleted file mode 100644
index 21a97de3e5..0000000000
Binary files a/usr/src/data/ucode/intel/000306E7-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F2-02 b/usr/src/data/ucode/intel/000306F2-02
deleted file mode 100644
index 8445583922..0000000000
Binary files a/usr/src/data/ucode/intel/000306F2-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F2-04 b/usr/src/data/ucode/intel/000306F2-04
deleted file mode 100644
index 8445583922..0000000000
Binary files a/usr/src/data/ucode/intel/000306F2-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F2-08 b/usr/src/data/ucode/intel/000306F2-08
deleted file mode 100644
index 8445583922..0000000000
Binary files a/usr/src/data/ucode/intel/000306F2-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F2-20 b/usr/src/data/ucode/intel/000306F2-20
deleted file mode 100644
index 8445583922..0000000000
Binary files a/usr/src/data/ucode/intel/000306F2-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F2-40 b/usr/src/data/ucode/intel/000306F2-40
deleted file mode 100644
index 8445583922..0000000000
Binary files a/usr/src/data/ucode/intel/000306F2-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000306F4-80 b/usr/src/data/ucode/intel/000306F4-80
index c373a6824d..2cdbb7c270 100644
Binary files a/usr/src/data/ucode/intel/000306F4-80 and b/usr/src/data/ucode/intel/000306F4-80 differ
diff --git a/usr/src/data/ucode/intel/00040651-10 b/usr/src/data/ucode/intel/00040651-10
deleted file mode 100644
index f93f80134b..0000000000
Binary files a/usr/src/data/ucode/intel/00040651-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00040651-20 b/usr/src/data/ucode/intel/00040651-20
deleted file mode 100644
index f93f80134b..0000000000
Binary files a/usr/src/data/ucode/intel/00040651-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00040651-40 b/usr/src/data/ucode/intel/00040651-40
deleted file mode 100644
index f93f80134b..0000000000
Binary files a/usr/src/data/ucode/intel/00040651-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00040661-10 b/usr/src/data/ucode/intel/00040661-10
deleted file mode 100644
index d2d8fb5f8a..0000000000
Binary files a/usr/src/data/ucode/intel/00040661-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00040661-20 b/usr/src/data/ucode/intel/00040661-20
deleted file mode 100644
index d2d8fb5f8a..0000000000
Binary files a/usr/src/data/ucode/intel/00040661-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00040671-02 b/usr/src/data/ucode/intel/00040671-02
index 2d9be24fd1..939c1e93c4 100644
Binary files a/usr/src/data/ucode/intel/00040671-02 and b/usr/src/data/ucode/intel/00040671-02 differ
diff --git a/usr/src/data/ucode/intel/00040671-20 b/usr/src/data/ucode/intel/00040671-20
deleted file mode 100644
index 2d9be24fd1..0000000000
Binary files a/usr/src/data/ucode/intel/00040671-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406C3-01 b/usr/src/data/ucode/intel/000406C3-01
new file mode 100644
index 0000000000..f23284f784
Binary files /dev/null and b/usr/src/data/ucode/intel/000406C3-01 differ
diff --git a/usr/src/data/ucode/intel/000406C4-01 b/usr/src/data/ucode/intel/000406C4-01
new file mode 100644
index 0000000000..b0b003bbdc
Binary files /dev/null and b/usr/src/data/ucode/intel/000406C4-01 differ
diff --git a/usr/src/data/ucode/intel/000406E3-80 b/usr/src/data/ucode/intel/000406E3-80
deleted file mode 100644
index 8f7afa6efd..0000000000
Binary files a/usr/src/data/ucode/intel/000406E3-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-01 b/usr/src/data/ucode/intel/000406F1-01
index c524aec9c8..b38c4a5cc5 100644
Binary files a/usr/src/data/ucode/intel/000406F1-01 and b/usr/src/data/ucode/intel/000406F1-01 differ
diff --git a/usr/src/data/ucode/intel/000406F1-02 b/usr/src/data/ucode/intel/000406F1-02
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-04 b/usr/src/data/ucode/intel/000406F1-04
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-08 b/usr/src/data/ucode/intel/000406F1-08
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-20 b/usr/src/data/ucode/intel/000406F1-20
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-40 b/usr/src/data/ucode/intel/000406F1-40
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000406F1-80 b/usr/src/data/ucode/intel/000406F1-80
deleted file mode 100644
index c524aec9c8..0000000000
Binary files a/usr/src/data/ucode/intel/000406F1-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050653-01 b/usr/src/data/ucode/intel/00050653-01
deleted file mode 100644
index e3a7b02c14..0000000000
Binary files a/usr/src/data/ucode/intel/00050653-01 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050653-02 b/usr/src/data/ucode/intel/00050653-02
deleted file mode 100644
index e3a7b02c14..0000000000
Binary files a/usr/src/data/ucode/intel/00050653-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050653-04 b/usr/src/data/ucode/intel/00050653-04
deleted file mode 100644
index e3a7b02c14..0000000000
Binary files a/usr/src/data/ucode/intel/00050653-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050653-10 b/usr/src/data/ucode/intel/00050653-10
deleted file mode 100644
index e3a7b02c14..0000000000
Binary files a/usr/src/data/ucode/intel/00050653-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050653-80 b/usr/src/data/ucode/intel/00050653-80
deleted file mode 100644
index e3a7b02c14..0000000000
Binary files a/usr/src/data/ucode/intel/00050653-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050654-01 b/usr/src/data/ucode/intel/00050654-01
index c0f3959412..754d08173e 100644
Binary files a/usr/src/data/ucode/intel/00050654-01 and b/usr/src/data/ucode/intel/00050654-01 differ
diff --git a/usr/src/data/ucode/intel/00050654-02 b/usr/src/data/ucode/intel/00050654-02
deleted file mode 100644
index c0f3959412..0000000000
Binary files a/usr/src/data/ucode/intel/00050654-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050654-04 b/usr/src/data/ucode/intel/00050654-04
deleted file mode 100644
index c0f3959412..0000000000
Binary files a/usr/src/data/ucode/intel/00050654-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050654-10 b/usr/src/data/ucode/intel/00050654-10
deleted file mode 100644
index c0f3959412..0000000000
Binary files a/usr/src/data/ucode/intel/00050654-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050654-20 b/usr/src/data/ucode/intel/00050654-20
deleted file mode 100644
index c0f3959412..0000000000
Binary files a/usr/src/data/ucode/intel/00050654-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050654-80 b/usr/src/data/ucode/intel/00050654-80
deleted file mode 100644
index c0f3959412..0000000000
Binary files a/usr/src/data/ucode/intel/00050654-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-01 b/usr/src/data/ucode/intel/00050655-01
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-01 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-02 b/usr/src/data/ucode/intel/00050655-02
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-04 b/usr/src/data/ucode/intel/00050655-04
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-10 b/usr/src/data/ucode/intel/00050655-10
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-20 b/usr/src/data/ucode/intel/00050655-20
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050655-80 b/usr/src/data/ucode/intel/00050655-80
deleted file mode 100644
index 923b87da82..0000000000
Binary files a/usr/src/data/ucode/intel/00050655-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-01 b/usr/src/data/ucode/intel/00050656-01
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-01 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-02 b/usr/src/data/ucode/intel/00050656-02
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-04 b/usr/src/data/ucode/intel/00050656-04
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-08 b/usr/src/data/ucode/intel/00050656-08
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-10 b/usr/src/data/ucode/intel/00050656-10
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-20 b/usr/src/data/ucode/intel/00050656-20
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050656-80 b/usr/src/data/ucode/intel/00050656-80
deleted file mode 100644
index 9aa09ed654..0000000000
Binary files a/usr/src/data/ucode/intel/00050656-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-01 b/usr/src/data/ucode/intel/00050657-01
index 8884c4ec91..b5e3f112a1 100644
Binary files a/usr/src/data/ucode/intel/00050657-01 and b/usr/src/data/ucode/intel/00050657-01 differ
diff --git a/usr/src/data/ucode/intel/00050657-02 b/usr/src/data/ucode/intel/00050657-02
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-04 b/usr/src/data/ucode/intel/00050657-04
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-08 b/usr/src/data/ucode/intel/00050657-08
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-10 b/usr/src/data/ucode/intel/00050657-10
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-20 b/usr/src/data/ucode/intel/00050657-20
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050657-80 b/usr/src/data/ucode/intel/00050657-80
deleted file mode 100644
index 8884c4ec91..0000000000
Binary files a/usr/src/data/ucode/intel/00050657-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/00050662-10 b/usr/src/data/ucode/intel/00050662-10
index 75fc81dbd1..2b4c64d027 100644
Binary files a/usr/src/data/ucode/intel/00050662-10 and b/usr/src/data/ucode/intel/00050662-10 differ
diff --git a/usr/src/data/ucode/intel/00050663-10 b/usr/src/data/ucode/intel/00050663-10
index 387f5a4e19..37f7333bc6 100644
Binary files a/usr/src/data/ucode/intel/00050663-10 and b/usr/src/data/ucode/intel/00050663-10 differ
diff --git a/usr/src/data/ucode/intel/00050664-10 b/usr/src/data/ucode/intel/00050664-10
index 21a6db266d..0e8fc2b5fe 100644
Binary files a/usr/src/data/ucode/intel/00050664-10 and b/usr/src/data/ucode/intel/00050664-10 differ
diff --git a/usr/src/data/ucode/intel/00050665-10 b/usr/src/data/ucode/intel/00050665-10
index 2800d7c687..b2c17aa506 100644
Binary files a/usr/src/data/ucode/intel/00050665-10 and b/usr/src/data/ucode/intel/00050665-10 differ
diff --git a/usr/src/data/ucode/intel/000506C9-02 b/usr/src/data/ucode/intel/000506C9-02
deleted file mode 100644
index b999fdb674..0000000000
Binary files a/usr/src/data/ucode/intel/000506C9-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000506CA-01 b/usr/src/data/ucode/intel/000506CA-01
index 6aaf638f96..51c83447b4 100644
Binary files a/usr/src/data/ucode/intel/000506CA-01 and b/usr/src/data/ucode/intel/000506CA-01 differ
diff --git a/usr/src/data/ucode/intel/000506CA-02 b/usr/src/data/ucode/intel/000506CA-02
deleted file mode 100644
index 6aaf638f96..0000000000
Binary files a/usr/src/data/ucode/intel/000506CA-02 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000506E3-04 b/usr/src/data/ucode/intel/000506E3-04
deleted file mode 100644
index 3dfc610744..0000000000
Binary files a/usr/src/data/ucode/intel/000506E3-04 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000506E3-10 b/usr/src/data/ucode/intel/000506E3-10
deleted file mode 100644
index 3dfc610744..0000000000
Binary files a/usr/src/data/ucode/intel/000506E3-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000506E3-20 b/usr/src/data/ucode/intel/000506E3-20
deleted file mode 100644
index 3dfc610744..0000000000
Binary files a/usr/src/data/ucode/intel/000506E3-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806E9-80 b/usr/src/data/ucode/intel/000806E9-80
deleted file mode 100644
index 49aea22aee..0000000000
Binary files a/usr/src/data/ucode/intel/000806E9-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806EA-80 b/usr/src/data/ucode/intel/000806EA-80
deleted file mode 100644
index 20ff87c8c8..0000000000
Binary files a/usr/src/data/ucode/intel/000806EA-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806EB-40 b/usr/src/data/ucode/intel/000806EB-40
deleted file mode 100644
index 9eae11d13c..0000000000
Binary files a/usr/src/data/ucode/intel/000806EB-40 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806EB-80 b/usr/src/data/ucode/intel/000806EB-80
deleted file mode 100644
index 9eae11d13c..0000000000
Binary files a/usr/src/data/ucode/intel/000806EB-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806EC-10 b/usr/src/data/ucode/intel/000806EC-10
deleted file mode 100644
index b0458f3abc..0000000000
Binary files a/usr/src/data/ucode/intel/000806EC-10 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000806EC-80 b/usr/src/data/ucode/intel/000806EC-80
deleted file mode 100644
index b0458f3abc..0000000000
Binary files a/usr/src/data/ucode/intel/000806EC-80 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000906E9-08 b/usr/src/data/ucode/intel/000906E9-08
deleted file mode 100644
index 51202b3fca..0000000000
Binary files a/usr/src/data/ucode/intel/000906E9-08 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000906E9-20 b/usr/src/data/ucode/intel/000906E9-20
deleted file mode 100644
index 51202b3fca..0000000000
Binary files a/usr/src/data/ucode/intel/000906E9-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000906EA-20 b/usr/src/data/ucode/intel/000906EA-20
deleted file mode 100644
index 68aafca7ed..0000000000
Binary files a/usr/src/data/ucode/intel/000906EA-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000906EC-20 b/usr/src/data/ucode/intel/000906EC-20
deleted file mode 100644
index 5feee15c02..0000000000
Binary files a/usr/src/data/ucode/intel/000906EC-20 and /dev/null differ
diff --git a/usr/src/data/ucode/intel/000906ED-20 b/usr/src/data/ucode/intel/000906ED-20
deleted file mode 100644
index b438fbddcb..0000000000
Binary files a/usr/src/data/ucode/intel/000906ED-20 and /dev/null differ
diff --git a/usr/src/data/ucode/update.intel b/usr/src/data/ucode/update.intel
new file mode 100755
index 0000000000..4444b9ed84
--- /dev/null
+++ b/usr/src/data/ucode/update.intel
@@ -0,0 +1,88 @@
+#!/bin/ksh
+
+# {{{ CDDL HEADER
+#
+# This file and its contents are supplied under the terms of the
+# Common Development and Distribution License ("CDDL"), version 1.0.
+# You may only use this file in accordance with the terms of version
+# 1.0 of the CDDL.
+#
+# A full copy of the text of the CDDL should have accompanied this
+# source. A copy of the CDDL is also available via the Internet at
+# http://www.illumos.org/license/CDDL.
+# }}}
+
+# Copyright 2018 OmniOS Community Edition (OmniOSce) Association.
+
+# A simple update script that extracts an Intel microcode download file
+# into the intel/ directory, and updates the hardlinks in the
+# system/kernel/platform manifest.
+
+[ -z "$1" -o ! -f "$1" ] && echo "Syntax: $0 <path to microcode tar>" && exit 1
+tar="$1"
+
+mf=../../pkg/manifests/system-kernel-platform.mf
+[ ! -f $mf ] && echo "Run from usr/src/data/ucode" && exit 1
+
+fw=platform/i86pc/ucode/GenuineIntel
+
+tmp=`mktemp -d`
+mkdir $tmp/out
+
+gtar -C $tmp -xvf "$1"
+
+find $tmp/Intel-Linux-Processor-Microcode-Data*/intel-ucode*/ -type f \
+    | while read f; do
+	echo "Converting `basename $f`"
+	cp $f $tmp/intel-fw
+	ucodeadm -i -R $tmp/out $tmp/intel-fw
+	rm -f $tmp/intel-fw
+done
+
+pkgfmt -u $mf
+mv $mf $mf.tmp
+egrep -v "(file|hardlink) path=$fw" $mf.tmp > $mf
+rm -f $mf.tmp
+
+rm -f intel/*
+rm -f Makefile.links
+
+typeset -A seen
+typeset -A inodes
+typeset -A links
+
+for f in $tmp/out/*; do
+	bf=`basename $f`
+	[ -n "${seen[$bf]}" ] && continue
+	inode=`stat -c %i $f`
+	if [ -n "${inodes[$inode]}" ]; then
+		links[$bf]=${inodes[$inode]}
+	else
+		inodes[$inode]=$bf
+		seen[$bf]=1
+		cp $f intel/$bf
+	fi
+	seen[$bf]=1
+done
+
+for f in intel/*; do
+	bf=`basename $f`
+	echo "\$(i386_ONLY)file path=$fw/$bf group=sys mode=0444 reboot-needed=true" >> $mf
+done
+
+echo "INTEL_LINKS = ${!links[@]}" > Makefile.links
+echo >> Makefile.links
+
+for i in "${!links[@]}"; do
+	echo "\$(i386_ONLY)hardlink path=$fw/$i target=${links[$i]}" >> $mf
+	cat << EOM >> Makefile.links
+\$(ROOTINTELDIR)/$i: \$(ROOTINTELDIR)/${links[$i]}
+	\$(RM) \$@; \$(LN) \$^ \$@
+
+EOM
+done
+
+pkgfmt $mf
+
+rm -rf $tmp
+
diff --git a/usr/src/pkg/manifests/system-kernel-platform.mf b/usr/src/pkg/manifests/system-kernel-platform.mf
index 23d97f1a3e..816a081667 100644
--- a/usr/src/pkg/manifests/system-kernel-platform.mf
+++ b/usr/src/pkg/manifests/system-kernel-platform.mf
@@ -272,6 +272,8 @@ $(i386_ONLY)dir path=platform/i86pc/kernel/mach/$(ARCH64) group=sys
 $(i386_ONLY)dir path=platform/i86pc/kernel/misc group=sys
 $(i386_ONLY)dir path=platform/i86pc/kernel/misc/$(ARCH64) group=sys
 $(i386_ONLY)dir path=platform/i86pc/ucode group=sys
+$(i386_ONLY)dir path=platform/i86pc/ucode/AuthenticAMD group=sys
+$(i386_ONLY)dir path=platform/i86pc/ucode/GenuineIntel group=sys
 $(i386_ONLY)dir path=platform/i86xpv group=sys
 $(i386_ONLY)dir path=platform/i86xpv/kernel group=sys
 $(i386_ONLY)dir path=platform/i86xpv/kernel/$(ARCH64) group=sys
@@ -751,12 +753,396 @@ $(i386_ONLY)file path=platform/i86pc/kernel/misc/$(ARCH64)/acpidev group=sys \
     mode=0755
 $(i386_ONLY)file path=platform/i86pc/kernel/misc/$(ARCH64)/gfx_private \
     group=sys mode=0755
-$(i386_ONLY)file path=platform/i86pc/ucode/amd-ucode.bin group=sys mode=0444 \
-    original_name=SUNWcakr:platform/i86pc/ucode/amd-ucode.bin preserve=true \
-    reboot-needed=true
-$(i386_ONLY)file path=platform/i86pc/ucode/intel-ucode.txt group=sys mode=0444 \
-    original_name=SUNWcakr:platform/i86pc/ucode/intel-ucode.txt preserve=true \
-    reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1020-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1022-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1041-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1043-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1062-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1080-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/1081-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/10A0-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/3010-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/5010-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/5020-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/6012-00 group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/container group=sys \
+    mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/AuthenticAMD/equivalence-table \
+    group=sys mode=0444 preserve=true reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000650-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000650-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000650-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000651-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000652-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000652-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000652-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000653-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000653-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000653-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000653-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000660-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000665-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066A-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066A-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066A-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066D-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066D-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000066D-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000671-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000672-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000673-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000681-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000681-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000681-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000681-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000681-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000683-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000683-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000686-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000686-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000686-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000686-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000686-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000068A-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000068A-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0000068A-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000695-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000695-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000695-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006A0-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006A1-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006B1-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006B1-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006B4-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006B4-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006D6-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006E8-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006EC-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006EC-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F2-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F6-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F6-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F6-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F7-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006F7-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FA-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FB-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FD-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FD-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000006FD-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F07-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F07-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F0A-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F0A-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F0A-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F12-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F24-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F24-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F24-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F25-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F25-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F25-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F25-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F26-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F27-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F27-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F27-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F29-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F29-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F29-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F32-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F33-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F34-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F41-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F41-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F43-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F44-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F47-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F48-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F48-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F48-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F49-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F4A-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F4A-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F62-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F64-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F64-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F65-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00000F68-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00001632-00 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010661-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010661-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010661-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010676-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010676-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010676-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010676-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010676-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00010677-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0001067A-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0001067A-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/0001067A-20 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106A4-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106A5-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106C2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106C2-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106C2-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106CA-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106CA-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106CA-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106CA-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106D1-08 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000106E5-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00020652-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00020655-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00020661-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00020661-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206A7-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206C2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206D6-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206D7-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206E6-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000206F2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00030678-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00030678-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00030679-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306A9-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306C3-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306D4-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306E4-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306E6-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306E7-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306F2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000306F4-80 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00040651-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00040661-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00040671-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000406C3-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000406C4-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000406E3-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000406F1-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050654-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050657-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050662-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050663-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050664-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/00050665-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000506C2-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000506C9-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000506CA-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000506E3-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000506F1-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000706A1-01 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000806E9-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000806E9-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000806EA-40 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000806EB-10 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000806EC-04 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000906E9-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000906EA-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000906EB-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000906EC-02 group=sys \
+    mode=0444 reboot-needed=true
+$(i386_ONLY)file path=platform/i86pc/ucode/GenuineIntel/000906ED-02 group=sys \
+    mode=0444 reboot-needed=true
 $(i386_ONLY)file path=platform/i86xpv/kernel/$(ARCH64)/unix group=sys \
     mode=0755
 $(i386_ONLY)file path=platform/i86xpv/kernel/cpu/$(ARCH64)/cpu.generic \
@@ -1009,6 +1395,260 @@ $(sparc_ONLY)file path=usr/share/man/man7d/zsh.7d
 $(i386_ONLY)hardlink \
     path=platform/i86pc/kernel/cpu/$(ARCH64)/cpu_ms.GenuineIntel.6.47 \
     target=cpu_ms.GenuineIntel.6.46
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F32-04 \
+    target=00000F32-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F32-08 \
+    target=00000F32-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F33-04 \
+    target=00000F33-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F33-08 \
+    target=00000F33-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F34-04 \
+    target=00000F34-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F34-08 \
+    target=00000F34-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F34-10 \
+    target=00000F34-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F41-04 \
+    target=00000F41-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F41-08 \
+    target=00000F41-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F41-10 \
+    target=00000F41-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F41-20 \
+    target=00000F41-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F41-80 \
+    target=00000F41-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F43-04 \
+    target=00000F43-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F43-08 \
+    target=00000F43-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F43-10 \
+    target=00000F43-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F43-80 \
+    target=00000F43-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F44-04 \
+    target=00000F44-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F44-08 \
+    target=00000F44-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F44-10 \
+    target=00000F44-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F44-80 \
+    target=00000F44-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F47-04 \
+    target=00000F47-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F47-08 \
+    target=00000F47-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F47-10 \
+    target=00000F47-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F47-80 \
+    target=00000F47-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F48-08 \
+    target=00000F48-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F48-10 \
+    target=00000F48-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F48-40 \
+    target=00000F48-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F49-04 \
+    target=00000F49-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F49-08 \
+    target=00000F49-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F49-10 \
+    target=00000F49-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F49-20 \
+    target=00000F49-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F49-80 \
+    target=00000F49-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F4A-08 \
+    target=00000F4A-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F4A-10 \
+    target=00000F4A-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F4A-40 \
+    target=00000F4A-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F64-10 \
+    target=00000F64-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F64-20 \
+    target=00000F64-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00000F68-20 \
+    target=00000F68-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/0001067A-10 \
+    target=0001067A-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/0001067A-40 \
+    target=0001067A-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/0001067A-80 \
+    target=0001067A-20
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000106A4-02 \
+    target=000106A4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000106A5-02 \
+    target=000106A5-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000106E5-02 \
+    target=000106E5-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000106E5-10 \
+    target=000106E5-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00020652-10 \
+    target=00020652-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00020655-10 \
+    target=00020655-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00020655-80 \
+    target=00020655-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206A7-10 \
+    target=000206A7-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206C2-02 \
+    target=000206C2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D6-04 \
+    target=000206D6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D6-08 \
+    target=000206D6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D6-20 \
+    target=000206D6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D6-40 \
+    target=000206D6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D7-04 \
+    target=000206D7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D7-08 \
+    target=000206D7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D7-20 \
+    target=000206D7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206D7-40 \
+    target=000206D7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000206F2-04 \
+    target=000206F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00030678-08 \
+    target=00030678-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00030679-02 \
+    target=00030679-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00030679-04 \
+    target=00030679-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00030679-08 \
+    target=00030679-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306A9-10 \
+    target=000306A9-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306C3-10 \
+    target=000306C3-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306C3-20 \
+    target=000306C3-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306D4-80 \
+    target=000306D4-40
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E4-04 \
+    target=000306E4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E4-08 \
+    target=000306E4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E4-20 \
+    target=000306E4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E4-40 \
+    target=000306E4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E4-80 \
+    target=000306E4-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E6-04 \
+    target=000306E6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E6-08 \
+    target=000306E6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E6-20 \
+    target=000306E6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E6-40 \
+    target=000306E6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E6-80 \
+    target=000306E6-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E7-04 \
+    target=000306E7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E7-08 \
+    target=000306E7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E7-20 \
+    target=000306E7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E7-40 \
+    target=000306E7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306E7-80 \
+    target=000306E7-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306F2-02 \
+    target=000306F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306F2-04 \
+    target=000306F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306F2-08 \
+    target=000306F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306F2-20 \
+    target=000306F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000306F2-40 \
+    target=000306F2-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040651-10 \
+    target=00040651-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040651-20 \
+    target=00040651-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040651-40 \
+    target=00040651-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040661-10 \
+    target=00040661-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040661-20 \
+    target=00040661-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00040671-20 \
+    target=00040671-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406E3-80 \
+    target=000406E3-40
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-02 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-04 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-08 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-20 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-40 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000406F1-80 \
+    target=000406F1-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050654-02 \
+    target=00050654-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050654-04 \
+    target=00050654-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050654-10 \
+    target=00050654-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050654-20 \
+    target=00050654-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050654-80 \
+    target=00050654-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-02 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-04 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-08 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-10 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-20 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/00050657-80 \
+    target=00050657-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000506C9-02 \
+    target=000506C9-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000506CA-02 \
+    target=000506CA-01
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000506E3-04 \
+    target=000506E3-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000506E3-10 \
+    target=000506E3-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000506E3-20 \
+    target=000506E3-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806E9-80 \
+    target=000806E9-40
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806EA-80 \
+    target=000806EA-40
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806EB-40 \
+    target=000806EB-10
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806EB-80 \
+    target=000806EB-10
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806EC-10 \
+    target=000806EC-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000806EC-80 \
+    target=000806EC-04
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000906E9-08 \
+    target=000906E9-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000906E9-20 \
+    target=000906E9-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000906EA-20 \
+    target=000906EA-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000906EC-20 \
+    target=000906EC-02
+$(i386_ONLY)hardlink path=platform/i86pc/ucode/GenuineIntel/000906ED-20 \
+    target=000906ED-02
 $(sparc_ONLY)hardlink path=platform/sun4u/kernel/misc/$(ARCH64)/md5 \
     target=../../../kernel/crypto/$(ARCH64)/md5
 $(sparc_ONLY)hardlink path=platform/sun4u/kernel/misc/$(ARCH64)/sha1 \
diff --git a/usr/src/uts/common/io/cpuid_drv.c b/usr/src/uts/common/io/cpuid_drv.c
index 4f65c5ee09..e47e4a50a4 100644
--- a/usr/src/uts/common/io/cpuid_drv.c
+++ b/usr/src/uts/common/io/cpuid_drv.c
@@ -22,7 +22,7 @@
  * Copyright (c) 2004, 2010, Oracle and/or its affiliates. All rights reserved.
  */
 /*
- * Copyright (c) 2012, Joyent, Inc.  All rights reserved.
+ * Copyright 2019 Joyent, Inc.
  */
 
 
@@ -39,6 +39,7 @@
 #include <sys/modctl.h>
 #include <sys/ddi.h>
 #include <sys/sunddi.h>
+#include <sys/policy.h>
 
 #include <sys/auxv.h>
 #include <sys/cpuid_drv.h>
@@ -183,6 +184,30 @@ cpuid_ioctl(dev_t dev, int cmd, intptr_t arg, int mode, cred_t *cr, int *rval)
 		return (0);
 	}
 
+#ifdef __x86
+	case CPUID_RDMSR: {
+		struct cpuid_rdmsr crm = { 0, };
+		label_t label;
+
+		if (secpolicy_sys_config(cr, B_FALSE) != 0)
+			return (EPERM);
+
+		if (ddi_copyin((void *)arg, &crm, sizeof (crm), mode))
+			return (EFAULT);
+
+		if (on_fault(&label))
+			return (ENOENT);
+
+		crm.cr_msr_val = rdmsr(crm.cr_msr_nr);
+
+		no_fault();
+
+		if (ddi_copyout(&crm, (void *)arg, sizeof (crm), mode))
+			return (EFAULT);
+		return (0);
+	}
+#endif
+
 	default:
 		return (ENOTTY);
 	}
diff --git a/usr/src/uts/common/sys/cpuid_drv.h b/usr/src/uts/common/sys/cpuid_drv.h
index 42cc9a7a32..c26bc7e422 100644
--- a/usr/src/uts/common/sys/cpuid_drv.h
+++ b/usr/src/uts/common/sys/cpuid_drv.h
@@ -24,7 +24,7 @@
  * Use is subject to license terms.
  */
 /*
- * Copyright (c) 2012, Joyent, Inc.  All rights reserved.
+ * Copyright 2019 Joyent, Inc.
  */
 
 #ifndef	_SYS_CPUID_DRV_H
@@ -64,12 +64,18 @@ extern "C" {
 #define	CPUID_IOC		(('c'<<24)|('i'<<16)|('d'<<8))
 
 #define	CPUID_GET_HWCAP		(CPUID_IOC|0)
+#define	CPUID_RDMSR		(CPUID_IOC|1)
 
 struct cpuid_get_hwcap {
 	char *cgh_archname;
 	uint_t cgh_hwcap[2];
 };
 
+struct cpuid_rdmsr {
+	uint64_t cr_msr_nr;
+	uint64_t cr_msr_val;
+};
+
 #if defined(_SYSCALL32_IMPL)
 
 #include <sys/types32.h>
