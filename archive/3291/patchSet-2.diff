From 4f2d13cc9a3933e1ae10e9b3178cbb94453eb1e1 Mon Sep 17 00:00:00 2001
From: Rob Johnston <rob.johnston@joyent.com>
Date: Fri, 2 Feb 2018 03:47:30 +0000
Subject: [PATCH] OS-6129 fmadm reports faults without message summary

---
 usr/src/cmd/fm/modules/common/eversholt/fme.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/usr/src/cmd/fm/modules/common/eversholt/fme.c b/usr/src/cmd/fm/modules/common/eversholt/fme.c
index 096caa73db..553db71b6c 100644
--- a/usr/src/cmd/fm/modules/common/eversholt/fme.c
+++ b/usr/src/cmd/fm/modules/common/eversholt/fme.c
@@ -22,6 +22,7 @@
 /*
  * Copyright (c) 2003, 2010, Oracle and/or its affiliates. All rights reserved.
  * Copyright 2012 Milan Jurik. All rights reserved.
+ * Copyright (c) 2018, Joyent, Inc.
  *
  * fme.c -- fault management exercise module
  *
@@ -350,6 +351,7 @@ newfme(const char *e0class, const struct ipath *e0ipp, fmd_hdl_t *hdl,
 			out(O_ALTFP|O_VERB2, "Unable to map \"%s\" ereport "
 			    "to component path, but silent discard allowed.",
 			    e0class);
+			fmd_case_close(hdl, fmcase);
 		} else {
 			Undiag_reason = UD_VAL_BADEVENTPATH;
 			(void) nvlist_lookup_nvlist(nvl, FM_EREPORT_DETECTOR,
-- 
2.21.0

