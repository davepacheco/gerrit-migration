{"project":"joyent/sdc-docker","branch":"master","id":"I219b6c785284cd0552a043335aedd7ffb0b2f240","number":"1661","subject":"DOCKER-1017 sdc-docker cli-commit.js test failing with \u0027invalid reference format\u0027 Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/1661","commitMessage":"DOCKER-1017 sdc-docker cli-commit.js test failing with \u0027invalid reference format\u0027\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1489511640,"lastUpdated":1489516045,"open":false,"status":"MERGED","comments":[{"timestamp":1489511640,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1489511641,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit aeb8c4fbf72abcb2ea049d553dae7668494f6c8e\n    \n    DOCKER-1017 sdc-docker cli-commit.js test failing with \u0027invalid reference format\u0027"},{"timestamp":1489511671,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489512223,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1\n\n(2 comments)"},{"timestamp":1489512757,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1489512758,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit bc0493e25a62e01c61a99e592ca756e47f809aa7\n    \n    Make separate function for imageName generator."},{"timestamp":1489512793,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489512850,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3."},{"timestamp":1489512851,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 7a5bac46e18aa0b82654ff0cb8360f414d4cee8c\n    \n    update copyright"},{"timestamp":1489512880,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489512943,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1489513090,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1489515984,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1489515996,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5."},{"timestamp":1489516005,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1489516010,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"},{"timestamp":1489516020,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1489516026,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1489516045,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"6","revision":"0f191424c04f9ee02e5176c4b4f902bfefc0e2e8","parents":["26bfc35711730c2ed32526b5a33c52a39869808f"],"ref":"refs/changes/61/1661/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489516005,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512880,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1489516010,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":12,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"3785d0f3f56a86d479f6a8cdad1c16b715fc9723","parents":["4695c42e1f6e4ca55ede54d558f83ebcf0c2288b"],"ref":"refs/changes/61/1661/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489511640,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489511671,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489512223,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489512223,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"test/integration/cli-commit.test.js","line":8,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"2017"},{"file":"test/integration/cli-commit.test.js","line":8,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"test/integration/cli-commit.test.js","line":54,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Would it be better to make a makeImageTagName() function that does this? Or is this the only place we\u0027ll ever need to do this?"},{"file":"test/integration/cli-commit.test.js","line":54,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, I will do that (I think it would be nicer), but the actual problem is the prefix we are passing (which contains the underscore). Fixed by adding a separate IMAGE_PREFIX variable."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":3,"sizeDeletions":-1},{"number":"2","revision":"33caed94a9bf1925ff566ad0bd12fd6276f36524","parents":["4695c42e1f6e4ca55ede54d558f83ebcf0c2288b"],"ref":"refs/changes/61/1661/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489512757,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512793,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":11,"sizeDeletions":-1},{"number":"3","revision":"fc2b536131d4eedf5e2f82b52d9eb71fb284790b","parents":["4695c42e1f6e4ca55ede54d558f83ebcf0c2288b"],"ref":"refs/changes/61/1661/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489512850,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512880,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":12,"sizeDeletions":-2},{"number":"4","revision":"55197c9b6f53865dcff4e52ab9e8974e49177465","parents":["26bfc35711730c2ed32526b5a33c52a39869808f"],"ref":"refs/changes/61/1661/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489515984,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512880,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":12,"sizeDeletions":-2},{"number":"5","revision":"219b6c785284cd0552a043335aedd7ffb0b2f240","parents":["4695c42e1f6e4ca55ede54d558f83ebcf0c2288b"],"ref":"refs/changes/61/1661/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489515996,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512880,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":12,"sizeDeletions":-2},{"number":"6","revision":"0f191424c04f9ee02e5176c4b4f902bfefc0e2e8","parents":["26bfc35711730c2ed32526b5a33c52a39869808f"],"ref":"refs/changes/61/1661/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489516005,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489512880,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1489513090,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1489516010,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"test/integration/cli-commit.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/lib/common.js","type":"MODIFIED","insertions":9,"deletions":0}],"sizeInsertions":12,"sizeDeletions":-2}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}