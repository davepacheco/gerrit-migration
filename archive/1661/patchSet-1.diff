From 3785d0f3f56a86d479f6a8cdad1c16b715fc9723 Mon Sep 17 00:00:00 2001
From: Todd Whiteman <todd.whiteman@joyent.com>
Date: Tue, 14 Mar 2017 10:13:59 -0700
Subject: [PATCH] DOCKER-1017 sdc-docker cli-commit.js test failing with
 'invalid reference format'

---
 test/integration/cli-commit.test.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/test/integration/cli-commit.test.js b/test/integration/cli-commit.test.js
index 4d36b5e..2ebfdc5 100644
--- a/test/integration/cli-commit.test.js
+++ b/test/integration/cli-commit.test.js
@@ -50,7 +50,9 @@ test(TP + 'setup', function (tt) {
 
 test(TP + 'test add file', function (tt) {
 
-    var commitImageTag = common.makeContainerName(CONTAINER_PREFIX);
+    // Note: Image name cannot contain an underscore.
+    var commitImageTag = common.makeContainerName(CONTAINER_PREFIX).
+        replace(/_/g, '-');
     var containerName = common.makeContainerName(CONTAINER_PREFIX);
 
     tt.test('run ' + IMAGE_NAME + ' container', function (t) {
-- 
2.21.0

