{"project":"joyent/sdcadm","branch":"master","id":"Ic906dedd438b26a23c20ba9a0261bc15cdb03884","number":"2909","subject":"TOOLS-1896 sdcadm update sapi could avoid using a temporary instance Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/2909","commitMessage":"TOOLS-1896 sdcadm update sapi could avoid using a temporary instance\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1509778978,"lastUpdated":1530264202,"open":false,"status":"MERGED","comments":[{"timestamp":1509778978,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1509779010,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1510167564,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1510248928,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\n(1 comment)\n\nGood call Julien! Already hit it in the past and modified to the current version which has been working fine since then. Explanation below :-)"},{"timestamp":1511479225,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1512155166,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1512155171,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 5e8d3421ba452a8298c8e868bccb83f4c952cef8\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1512155199,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1512155720,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(2 comments)\n\nNow with 100% less AMQP and more HTTP!"},{"timestamp":1512410027,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nMarsell, adding you as a reviewer at this late stage b/c Julien will be back from vacation when I start mine ... and would like this change integrated before end of year ;-)"},{"timestamp":1513639480,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(7 comments)"},{"timestamp":1513639629,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1513793672,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(8 comments)\n\nI think I\u0027ve replied to all your questions and took all your suggestions now."},{"timestamp":1515685528,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1515685534,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit c7285e32bc76478c375e45967702789513b02895\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1515685561,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515694160,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1515694166,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit b4d89b2ecac6bbbe70c7a5e163eb91e093624a0c\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance\n    \n    commit b4d47fc54edb816288d41af5510d02e34f8d16db\n    \n    TOOLS-1972 \u0027sdcadm avail\u0027 crashes when there are not available updates\n    Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\n    Approved by: Trent Mick \u003ctrentm@gmail.com\u003e"},{"timestamp":1515694194,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515694784,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1515697256,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5: Code-Review-1\n\nWaiting for SAPI-294 to be finished before we go ahead with this one"},{"timestamp":1516115244,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1516115250,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 9ebb23cc45f9ff1441af125904ab0baae14278df\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1516115278,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1516130872,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 7."},{"timestamp":1516130877,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit dc40de82bde751c85281173bed3f3eec53c80a7a\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1516130905,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1516131761,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 8: Patch Set 7 was rebased."},{"timestamp":1516131766,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 88939377b2df8ae37c8f05ede2b070913a4061de\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1516131794,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"},{"timestamp":1516192169,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 9: Patch Set 8 was rebased."},{"timestamp":1516192175,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit 0e70ae4b5c3bd15d938641cf3a19839b4399de6b\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1516192203,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9:\n\n\"make check\" passed ok"},{"timestamp":1516816356,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 10: Patch Set 9 was rebased."},{"timestamp":1516816362,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit cba00cc9878e31eea67de8eb76554a7bb9230f70\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1516816389,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10:\n\n\"make check\" passed ok"},{"timestamp":1517412456,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 11."},{"timestamp":1517412462,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit d06d656686372e3883a958a7757e2e8048a74ca1\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance\n    \n    commit fb4cadc9cb9813a986650a758657034a10fc4cc1\n    \n    TOOLS-1725 sdcadm up should not bypass Triton stack\n    Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n    Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e"},{"timestamp":1517412490,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528478960,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 12."},{"timestamp":1528478965,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit cf9c6beb67a3976b5b04d987aeecca0e803db1ef\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528481748,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 13: Patch Set 12 was rebased."},{"timestamp":1528481752,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit 0beeaee613b8c45387c80e2edbf59c4a088b0a43\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528482032,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528490559,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 14: Patch Set 13 was rebased."},{"timestamp":1528490564,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 14:\n\nNew commits:\n    \n    commit 5c8b79ad3f207860235f01775ada98da4c2ad963\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528490592,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14:\n\n\"make check\" passed ok"},{"timestamp":1528792128,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 15: Patch Set 14 was rebased."},{"timestamp":1528792133,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 15:\n\nNew commits:\n    \n    commit d4ad5f06e58c0796671794d2d8e58accc987dafb\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528792164,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15:\n\n\"make check\" passed ok"},{"timestamp":1528878852,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 16: Patch Set 15 was rebased."},{"timestamp":1528878857,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 16:\n\nNew commits:\n    \n    commit c3445ad1893b5a5dc6cb33b6782f6c73964d7efe\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528878889,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 16:\n\n\"make check\" passed ok"},{"timestamp":1528901497,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 17."},{"timestamp":1528901503,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 17:\n\nNew commits:\n    \n    commit 8457f8f5cc95633c3446c954416559007f14aa81\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528901513,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 17: -Code-Review"},{"timestamp":1528901534,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 17: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528901578,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 17:\n\nNo stoppers for this issue anymore other than having SAPI-294 CR approved and merged into master so we can set the definitive SAPI version from when we can start updating it w/o going through temporary instance"},{"timestamp":1528913702,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 18."},{"timestamp":1528913707,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 18:\n\nNew commits:\n    \n    commit 05d440180adf6075ca995c0749d66bc3933141c3\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1528913737,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 18: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529683398,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 19."},{"timestamp":1529683403,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 19:\n\nNew commits:\n    \n    commit 6b5aa059f42b52194bb3c44e73f44daf774b31e7\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1529683433,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 19: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529684744,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 20: Patch Set 19 was rebased."},{"timestamp":1529684749,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 20:\n\nNew commits:\n    \n    commit b86a8ac612e1c20c8f3376b2a4bf1c2397dff304\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1529684781,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 20:\n\n\"make check\" passed ok"},{"timestamp":1530143942,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 20:\n\n(3 comments)\n\nJust the one Q. I haven\u0027t tested this yet."},{"timestamp":1530181705,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 21."},{"timestamp":1530181710,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 21:\n\nNew commits:\n    \n    commit d92a286c2b50501091657ab527ed36ff750b958d\n    \n    TOOLS-1896 sdcadm update sapi could avoid using a temporary instance"},{"timestamp":1530181739,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 21:\n\n(2 comments)\n\nThanks for the CR Trent! Done with the suggested changes included"},{"timestamp":1530181741,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 21: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530213971,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 21: Code-Review+1 Integration-Approval+1\n\nI tested a few scenarios in coal and it seems to be working well for me."},{"timestamp":1530264116,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 22: Commit message was updated."},{"timestamp":1530264202,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"22","revision":"c906dedd438b26a23c20ba9a0261bc15cdb03884","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/09/2909/22","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530264116,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530181741,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1530264202,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":68,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":201,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":361,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"3a3284c91c3d5753b382f35694ac88a09d7a0dd7","parents":["1a713cce5c39c82fc1ae2e4e9f9e4c6b35e9bc43"],"ref":"refs/changes/09/2909/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1509778978,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509779010,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/procedures/index.js","line":434,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Does splitting on hyphens work if the branch name that is part of the version string has an hyphen? If not, maybe using a regular expression would be more robust?"},{"file":"lib/procedures/index.js","line":434,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"If you look at line 436, I\u0027m looking at the final part of the version string, which is always the same, despite of whatever we set for branch name. So, yeah, it works this way, but b/c we\u0027re interested into the final parts"},{"file":"lib/procedures/index.js","line":434,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Sounds good!"},{"file":"lib/procedures/shared.js","line":1888,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Should we use a cn-agent task for this instead of ur (re: https://jira.joyent.us/browse/HEAD-2256)?"},{"file":"lib/procedures/shared.js","line":1888,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"It took me some CNAPI digging but I\u0027ve got it! Josh would be proud of me ;-)"},{"file":"lib/procedures/shared.js","line":1905,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is the event listener for the \u0027error\u0027 event missing?"},{"file":"lib/procedures/shared.js","line":1905,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"No longer relevant"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":60,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":210,"deletions":0}],"sizeInsertions":342,"sizeDeletions":-6},{"number":"2","revision":"abfdf4ee42252d53fd33741ab63b412383ae8616","parents":["c3b20dc42de36fc7b5b1a3a572e76b034d4d2932"],"ref":"refs/changes/09/2909/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1512155166,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512155199,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/procedures/index.js","line":50,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Will this need to be updated to the timestamp of the corresponding image once it\u0027s published to the dev channel?"},{"file":"lib/procedures/index.js","line":50,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Yessir"},{"file":"lib/procedures/index.js","line":528,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: typo \"carying\" -\u003e \"caring\"."},{"file":"lib/procedures/index.js","line":528,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/index.js","line":542,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is testing \"svcInsts.length\" useful here? Wouldn\u0027t\n\nif (svcInsts.length \u003e 1) {\n}\n\nbe sufficient? Or even better:\n\nassert.arrayOfObject(svcsInsts, \u0027svcsInsts\u0027);\nif (svcInsts.length \u003e 1) {\n}\n\n?\n\nAlso, it seems we handle the case where svcsInsts has a length of 1 and a length of 0 with the same code. However, it seems that finding 0 instance (svcsInsts of length 0) would be invalid (svcInsts[0] would throw). Should we assert that svcInsts has a .length \u003e 0?"},{"file":"lib/procedures/index.js","line":542,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"You\u0027re right about do not use svcInsts[0] when we have no first instance. Avoiding that. Modified."},{"file":"lib/procedures/update-sapi-v2.js","line":28,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name this callback (e.g \"summarizeChange\")."},{"file":"lib/procedures/update-sapi-v2.js","line":28,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-sapi-v2.js","line":72,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: alphabetize variable declarations."},{"file":"lib/procedures/update-sapi-v2.js","line":72,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-sapi-v2.js","line":123,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"nit: name forEach callback."},{"file":"lib/procedures/update-sapi-v2.js","line":123,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-sapi-v2.js","line":181,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is this also because we want to work around SAPI-199 and TOOLS-638?"},{"file":"lib/procedures/update-sapi-v2.js","line":181,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Specially TOOLS-638, yeah"},{"file":"lib/procedures/update-sapi-v2.js","line":188,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"maybe create a variable (or rather, a constant) named SAPI_URL so that it can be reused both at line 143 and here, such that if it changes at some point we don\u0027t forget to update it at both places?"},{"file":"lib/procedures/update-sapi-v2.js","line":188,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":60,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":211,"deletions":0}],"sizeInsertions":343,"sizeDeletions":-6},{"number":"3","revision":"155a601e1ff33d8e5378e5f13ed8438164a197f2","parents":["47704904431d8fb7d1316cffdc6280a082de7893"],"ref":"refs/changes/09/2909/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1515685528,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515685561,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":62,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":347,"sizeDeletions":-6},{"number":"4","revision":"1f6feb3e92dc1afdbc4a3484e561a34f48eb9dd5","parents":["8a083b5b363fb2479d9217dcdb0b0594a390e853"],"ref":"refs/changes/09/2909/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1515694160,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515694194,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_avail.js","type":"MODIFIED","insertions":12,"deletions":-14},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":62,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":359,"sizeDeletions":-20},{"number":"5","revision":"8ec76e250c409071ef92cf998b469021299fbf90","parents":["b4d47fc54edb816288d41af5510d02e34f8d16db"],"ref":"refs/changes/09/2909/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1515694784,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515694194,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":62,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":347,"sizeDeletions":-6},{"number":"6","revision":"4a99d26873bb3903fa8008575832b4bc61162b57","parents":["04678262480337462b21f3a48949f4ddd906968d"],"ref":"refs/changes/09/2909/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516115244,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515694194,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":62,"deletions":-5},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":347,"sizeDeletions":-6},{"number":"7","revision":"7831f3d9bb70db04cd5ccd198d009ec3c21dece0","parents":["0c37c409d75476e7a91aad3978d9404bd3629308"],"ref":"refs/changes/09/2909/7","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516130872,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516130905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":346,"sizeDeletions":-5},{"number":"8","revision":"81b2c069420af4609823193d9ad60680ec200395","parents":["e89033fae0546c36010046c5e27d6a7371638308"],"ref":"refs/changes/09/2909/8","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516131761,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516130905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":346,"sizeDeletions":-5},{"number":"9","revision":"720f549f25fdb498402b7179d7f8ea1048cb95f6","parents":["bbde4fd33163212e524744b66f8831670198c947"],"ref":"refs/changes/09/2909/9","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516192169,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516130905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":346,"sizeDeletions":-5},{"number":"10","revision":"e95e1d70334511178712905f39c972ff28e6e1be","parents":["9be5e6870224b7e3214716e51381568ed5eecda8"],"ref":"refs/changes/09/2909/10","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516816356,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1516130905,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":346,"sizeDeletions":-5},{"number":"11","revision":"81e02b6c05c5e2115c398969b3047996d67f0c6a","parents":["d89e5064e40b94e2041233bb3de9a15ef90d008e"],"ref":"refs/changes/09/2909/11","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1517412456,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1517412490,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":61,"deletions":-4},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":78,"deletions":-2},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":352,"sizeDeletions":-6},{"number":"12","revision":"fe33c04a22d207dcd9d0e0d6e695463590b81a76","parents":["ee4bfb9c3acb3dfd730549dfff71fff8d1ab3452"],"ref":"refs/changes/09/2909/12","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528478960,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"13","revision":"14714aa0c65a1843020d82d27ea906f0fcf9818a","parents":["3fbc528636315ec02d63231b4e0f683c5fd37b15"],"ref":"refs/changes/09/2909/13","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528481748,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528482032,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"14","revision":"2de21a4c6473cf8a3fe97e81a307891b36f7d683","parents":["af67a0208c78bf5cda3d81ddf067135b8277eaf7"],"ref":"refs/changes/09/2909/14","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528490559,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528482032,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"15","revision":"2f4668ffc08738810e0327e50f94309cf8c286c0","parents":["9e72efaa9aa51aaadf4162b68d5c119ac2acbc95"],"ref":"refs/changes/09/2909/15","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528792128,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528482032,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"16","revision":"b0b2968e61c1dfcaab77de434a7fe7c53a1aff2b","parents":["09a6a8757e372323de717dd63d13e12049950839"],"ref":"refs/changes/09/2909/16","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528878852,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528482032,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1515697256,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"17","revision":"7b504ddbd2128f1352a24ddb87a75d6bbf04bfe5","parents":["09a6a8757e372323de717dd63d13e12049950839"],"ref":"refs/changes/09/2909/17","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528901497,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528901534,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"18","revision":"ad5be440053a009a362bb9d3d89b286febf0b4e8","parents":["09a6a8757e372323de717dd63d13e12049950839"],"ref":"refs/changes/09/2909/18","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528913702,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528913737,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0}],"sizeInsertions":344,"sizeDeletions":-1},{"number":"19","revision":"11eeb01002015e6e17fb951d0b5c35d26d3a0e21","parents":["09a6a8757e372323de717dd63d13e12049950839"],"ref":"refs/changes/09/2909/19","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1529683398,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529683433,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":68,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":373,"sizeDeletions":-2},{"number":"20","revision":"5a228b4d822e3e4856fda4bd49a4c53d19042ed4","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/09/2909/20","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1529684744,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529683433,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/procedures/update-sapi-v2.js","line":116,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"At some point, I think this \"SAPI must be in full mode\" could be a check done for any \u0027sdcadm up\u0027 command. But it is fine here."},{"file":"lib/procedures/update-sapi-v2.js","line":116,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Let\u0027s make it happen now, instead of \"at some point\": https://jira.joyent.us/browse/TRITON-558"},{"file":"lib/procedures/update-sapi-v2.js","line":149,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"When we have serviceconfig stuff, or when we think all TritonDCs have done this service update, then we could drop this.\n\n\n*Then*, I think we could just have this SAPI upgrade procedure be the same as update-stateless-services-v1.js.\n\nAnyway, that\u0027s for the future."},{"file":"lib/procedures/update-sapi-v2.js","line":193,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Why this? I don\u0027t think it should be necessary. If sapiN boot required \"mdata-get sapi-url\" at all, then the reprovision step above would have failed."},{"file":"lib/procedures/update-sapi-v2.js","line":193,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Possibly due to previous implementations, which were sightly different (one of the many different things we tried for SAPI-294 I mean). I just went through the usual tests w/o this step and every sapi instance is happily pointing to its own IP as the URL of choice."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":68,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":213,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":373,"sizeDeletions":-2},{"number":"21","revision":"6259dff481a2a2b1fc928673a57dc0fa5f095733","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/09/2909/21","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530181705,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530181741,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":68,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":201,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":361,"sizeDeletions":-2},{"number":"22","revision":"c906dedd438b26a23c20ba9a0261bc15cdb03884","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/09/2909/22","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530264116,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530181741,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530213971,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1530264202,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"lib/procedures/index.js","type":"MODIFIED","insertions":68,"deletions":0},{"file":"lib/procedures/shared.js","type":"MODIFIED","insertions":72,"deletions":-1},{"file":"lib/procedures/update-sapi-v2.js","type":"ADDED","insertions":201,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":361,"sizeDeletions":-2}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}