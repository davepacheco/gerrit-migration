From 21d2652441bf399b81fe7117a0099552d507515a Mon Sep 17 00:00:00 2001
From: Nick Zivkovic <nick.zivkovic@joyent.com>
Date: Tue, 3 Apr 2018 21:38:15 +0000
Subject: [PATCH] TRITON-261 "triton image get" should show requirements.brand

---
 docs/index.md   | 11 +++++++++++
 lib/datasets.js |  3 +++
 package.json    |  2 +-
 3 files changed, 15 insertions(+), 1 deletion(-)

diff --git a/docs/index.md b/docs/index.md
index fa465fc..c198c46 100644
--- a/docs/index.md
+++ b/docs/index.md
@@ -908,6 +908,11 @@ The set of supported *API versions* is given in the ping endpoint:
 
 The section describes API changes in CloudAPI versions.
 
+## 8.10.0
+
+- GetImage now includes information about the brand requirements in the
+  `requirements.brand` member of the returned JSON.
+
 ## 8.9.0
 
 - The plugin interface has changed. preProvision/postProvision hooks have been
@@ -3252,6 +3257,9 @@ os           | String   | The underlying operating system for this image
 version      | String   | The version for this image
 type         | String   | What kind of image this is. The values differ after v8.0.0+
 requirements | Object   | Contains a grouping of various minimum requirements for provisioning an instance with this image. For example 'password' indicates that a password must be provided
+requirements.max_ram | String | Indicates the maximum RAM requirement that must be provided in the VM manifest to provision a VM based on this image.
+requirements.min_ram | String | Indicates the minimum RAM requirement that must be provided in the VM manifest to provision a VM based on this image.
+requirements.brand | String | Indicates which brand has to be used in the VM manifest to provision a VM with based on this image.
 homepage     | String   | The URL for a web page with more detailed information for this image
 files        | Array    | An array of image files that make up each image. Currently only a single file per image is supported
 files[0].compression | String | The type of file compression used for the image file. One of 'bzip2', 'gzip', 'none'
@@ -3359,6 +3367,9 @@ os           | String   | The underlying operating system for this image
 version      | String   | The version for this image
 type         | String   | What kind of image this is. The values differ after v8.0.0+
 requirements | Object   | Contains a grouping of various minimum requirements for provisioning an instance with this image. For example 'password' indicates that a password must be provided
+requirements.max_ram | String | Indicates the maximum RAM requirement that must be provided in the VM manifest to provision a VM based on this image.
+requirements.min_ram | String | Indicates the minimum RAM requirement that must be provided in the VM manifest to provision a VM based on this image.
+requirements.brand | String | Indicates which brand has to be used in the VM manifest to provision a VM with based on this image.
 homepage     | String   | The URL for a web page with more detailed information for this image
 files        | Array    | An array of image files that make up each image. Currently only a single file per image is supported
 files[0].compression | String | The type of file compression used for the image file. One of 'bzip2', 'gzip', 'none'
diff --git a/lib/datasets.js b/lib/datasets.js
index 1a0520c..8723ac1 100644
--- a/lib/datasets.js
+++ b/lib/datasets.js
@@ -149,6 +149,9 @@ function translate(req, dataset) {
             obj.requirements.min_memory = dataset.requirements.min_ram;
             obj.requirements.min_ram = dataset.requirements.min_ram;
         }
+        if (dataset.requirements.brand) {
+            obj.requirements.brand = dataset.requirements.brand;
+        }
     }
 
     var fields = {
diff --git a/package.json b/package.json
index bdeaf88..dd20a5a 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
     "name": "cloudapi",
     "description": "SmartDataCenter CloudAPI",
-    "version": "8.9.0",
+    "version": "8.10.0",
     "author": "Joyent (joyent.com)",
     "private": true,
     "engines": {
-- 
2.21.0

