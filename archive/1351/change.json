{"project":"joyent/manta-marlin","branch":"master","id":"I4f0f23f2970b58fa22323a0d00485bc24ebb9522","number":"1351","subject":"MANTA-3126 update marlin to Moray v3 Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e","owner":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"url":"https://cr.joyent.us/1351","commitMessage":"MANTA-3126 update marlin to Moray v3\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e\n","createdOn":1485475867,"lastUpdated":1486079889,"open":false,"status":"MERGED","comments":[{"timestamp":1485475867,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 1."},{"timestamp":1485475918,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485476067,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 2."},{"timestamp":1485476108,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485562118,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1485816074,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1485882326,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1\n\n(2 comments)"},{"timestamp":1485893682,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1486079707,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1486079889,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by David Pacheco"}],"currentPatchSet":{"number":"3","revision":"4f0f23f2970b58fa22323a0d00485bc24ebb9522","parents":["216ac69660ca5a1c9168ce986e69aad2c243781b"],"ref":"refs/changes/51/1351/3","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1486079707,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485476108,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1485882326,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1485893682,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"SUBM","value":"1","grantedOn":1486079889,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"agent/lib/agent/agent.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"common/lib/bus.js","type":"MODIFIED","insertions":12,"deletions":-42},{"file":"common/lib/marlin.js","type":"MODIFIED","insertions":35,"deletions":-9},{"file":"dev/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"jobsupervisor/etc/config.coal.json","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"jobsupervisor/lib/worker/locator.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"jobsupervisor/lib/worker/schema.js","type":"MODIFIED","insertions":3,"deletions":-26},{"file":"jobsupervisor/lib/worker/worker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"jobsupervisor/sapi_manifests/marlin/template","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":105,"sizeDeletions":-105},"patchSets":[{"number":"1","revision":"2bb3cc8f0901060e65ee9c5e0bb583ba892ac69d","parents":["216ac69660ca5a1c9168ce986e69aad2c243781b"],"ref":"refs/changes/51/1351/1","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1485475867,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485475918,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"agent/lib/agent/agent.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"common/lib/bus.js","type":"MODIFIED","insertions":12,"deletions":-42},{"file":"common/lib/marlin.js","type":"MODIFIED","insertions":35,"deletions":-9},{"file":"dev/package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"jobsupervisor/etc/config.coal.json","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"jobsupervisor/lib/worker/locator.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"jobsupervisor/lib/worker/schema.js","type":"MODIFIED","insertions":3,"deletions":-26},{"file":"jobsupervisor/lib/worker/worker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"jobsupervisor/sapi_manifests/marlin/template","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":106,"sizeDeletions":-106},{"number":"2","revision":"96018254d5d8eef8feef54d0872e0df79a81a215","parents":["216ac69660ca5a1c9168ce986e69aad2c243781b"],"ref":"refs/changes/51/1351/2","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1485476067,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1485882326,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485476108,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1485893682,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"comments":[{"file":"dev/package.json","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think this has my same question about the proper use of ^ and what\u0027s the right thing."},{"file":"dev/package.json","line":36,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"See my note on change https://cr.joyent.us/#/c/1350/.  I went back to an exact version on this repo to match what it seemed like we were doing for most of the other dependencies (though it\u0027s a little less consistent here).  I\u0027m happy to change it either way, to be honest."},{"file":"dev/package.json","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"jobsupervisor/etc/config.coal.json","line":14,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Most other coal configurations use coal.joyent.us. Do you know why this uses sf.joyent.us? I know this is just keeping the same hosts as previously, so it may not be worth making them the same or changing things."},{"file":"jobsupervisor/etc/config.coal.json","line":14,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I don\u0027t recall the history of this one to know why.\n\nLong-term, I\u0027d prefer to eliminate these sample config files.  There are many problems with them: it\u0027s usually not documented which parts have to be modified for different deployments, and it\u0027s very easy for them to get out of sync with the configuration template, so we\u0027re not testing what we ship.  I think the better option would be to have a tool that uses config-agent to translate the SAPI manifest into a real configuration file based on the SAPI metadata for some other instance.\n\nThat\u0027s obviously beyond the scope of this work.  In the meantime, I\u0027ve just been trying to keep the sample config files in sync with the templates."},{"file":"jobsupervisor/etc/config.coal.json","line":14,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, that makes sense, thanks for the explanation."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"agent/lib/agent/agent.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"common/lib/bus.js","type":"MODIFIED","insertions":12,"deletions":-42},{"file":"common/lib/marlin.js","type":"MODIFIED","insertions":35,"deletions":-9},{"file":"dev/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"jobsupervisor/etc/config.coal.json","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"jobsupervisor/lib/worker/locator.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"jobsupervisor/lib/worker/schema.js","type":"MODIFIED","insertions":3,"deletions":-26},{"file":"jobsupervisor/lib/worker/worker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"jobsupervisor/sapi_manifests/marlin/template","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":105,"sizeDeletions":-105},{"number":"3","revision":"4f0f23f2970b58fa22323a0d00485bc24ebb9522","parents":["216ac69660ca5a1c9168ce986e69aad2c243781b"],"ref":"refs/changes/51/1351/3","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1486079707,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1486079889,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1485882326,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485476108,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1485893682,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"agent/lib/agent/agent.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"common/lib/bus.js","type":"MODIFIED","insertions":12,"deletions":-42},{"file":"common/lib/marlin.js","type":"MODIFIED","insertions":35,"deletions":-9},{"file":"dev/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"jobsupervisor/etc/config.coal.json","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"jobsupervisor/lib/worker/locator.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"jobsupervisor/lib/worker/schema.js","type":"MODIFIED","insertions":3,"deletions":-26},{"file":"jobsupervisor/lib/worker/worker.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"jobsupervisor/sapi_manifests/marlin/template","type":"MODIFIED","insertions":10,"deletions":-9},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":105,"sizeDeletions":-105}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}]}