{"project":"joyent/node-libmanta","branch":"master","id":"I12fbd0f5bde9a76deb0e61bfdfce0040383076ef","number":"6016","subject":"MANTA-4195 Update node-libmanta nodeunit dependency","owner":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"url":"https://cr.joyent.us/6016","commitMessage":"MANTA-4195 Update node-libmanta nodeunit dependency\n","createdOn":1553600507,"lastUpdated":1553878399,"open":false,"status":"MERGED","comments":[{"timestamp":1553600507,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Uploaded patch set 1."},{"timestamp":1553600513,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 9c08cd08837b5184eed1c5f9e0be652ae97f06c1\n    \n    MANTA-4195 Update nodeunit dependency\n    make prepush passes with this change"},{"timestamp":1553600533,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1553803550,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\nHow did you get these to run out of curiosity?  When I tried I got this:\n\n```\n[root@31c0b1ad-8265-6fe1-a388-ea134af436b6 ~/node-libmanta]# make test\nfatal: ref HEAD is not a symbolic ref\n./node_modules/.bin/nodeunit test/*.test.js\n\njobs.test.js\n✔ transform job\n\nmahi.test.js\n✖ load user by login\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ load user not found\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ load user by uuid\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ load user by uuid not found\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ toString\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ set members\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ empty set or set not found\n\nError: MAHI_HOST not set in environment\n    at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n\nmoray-ro.test.js\n✖ negative test: putMetadata on read-only client\n\nError: ELECTRIC_MORAY must be specified\n    at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ negative test: putFinalizingMetadata on read-only client\n\nError: ELECTRIC_MORAY must be specified\n    at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ getMetadata: read-only client\n\nError: ELECTRIC_MORAY must be specified\n    at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n\nmoray.test.js\n✖ putMetadata (object) not root\n\nError: ELECTRIC_MORAY must be specified\n    at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ putMetadata (object) root\n\nError: ELECTRIC_MORAY must be specified\n    at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ putMetadata (link) not root\n\nError: ELECTRIC_MORAY must be specified\n    at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ putMetadata (directory) root\n\nError: ELECTRIC_MORAY must be specified\n    at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n✖ getMetadata (directory) root\n\nError: ELECTRIC_MORAY must be specified\n    at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n    at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n    at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n    at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n    at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n    at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n    at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n    at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n    at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n\n\nqueue.test.js\n✔ run queue\n\nFAILURES: 15/20 assertions failed (517ms)\nMakefile:63: recipe for target \u0027test\u0027 failed\nmake: *** [test] Error 1\n```"},{"timestamp":1553847677,"reviewer":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"message":"Patch Set 1:\n\n\u003e How did you get these to run out of curiosity?  When I tried I got\n \u003e this:\n \u003e \n \u003e ```\n \u003e [root@31c0b1ad-8265-6fe1-a388-ea134af436b6 ~/node-libmanta]# make\n \u003e test\n \u003e fatal: ref HEAD is not a symbolic ref\n \u003e ./node_modules/.bin/nodeunit test/*.test.js\n \u003e \n \u003e jobs.test.js\n \u003e ✔ transform job\n \u003e \n \u003e mahi.test.js\n \u003e ✖ load user by login\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ load user not found\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ load user by uuid\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ load user by uuid not found\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ toString\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ set members\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ empty set or set not found\n \u003e \n \u003e Error: MAHI_HOST not set in environment\n \u003e at Object.self (/root/node-libmanta/test/mahi.test.js:35:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e \n \u003e moray-ro.test.js\n \u003e ✖ negative test: putMetadata on read-only client\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ negative test: putFinalizingMetadata on read-only client\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ getMetadata: read-only client\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.opts.md.uploadId (/root/node-libmanta/test/moray-ro.test.js:36:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e \n \u003e moray.test.js\n \u003e ✖ putMetadata (object) not root\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ putMetadata (object) root\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ putMetadata (link) not root\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ putMetadata (directory) root\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e ✖ getMetadata (directory) root\n \u003e \n \u003e Error: ELECTRIC_MORAY must be specified\n \u003e at Object.makeOpts.path (/root/node-libmanta/test/moray.test.js:37:12)\n \u003e at Object._setup (/root/node-libmanta/test/helper.js:91:23)\n \u003e at /root/node-libmanta/node_modules/nodeunit/lib/core.js:260:35\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:458:21\n \u003e at /root/node-libmanta/node_modules/nodeunit/deps/async.js:163:13\n \u003e at iterate (/root/node-libmanta/node_modules/nodeunit/deps/async.js:123:13)\n \u003e at async.forEachSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:139:9)\n \u003e at _asyncMap (/root/node-libmanta/node_modules/nodeunit/deps/async.js:162:9)\n \u003e at Object.mapSeries (/root/node-libmanta/node_modules/nodeunit/deps/async.js:152:23)\n \u003e at Object.async.series (/root/node-libmanta/node_modules/nodeunit/deps/async.js:456:19)\n \u003e \n \u003e \n \u003e queue.test.js\n \u003e ✔ run queue\n \u003e \n \u003e FAILURES: 15/20 assertions failed (517ms)\n \u003e Makefile:63: recipe for target \u0027test\u0027 failed\n \u003e make: *** [test] Error 1\n \u003e ```\n\nI set MAHI_HOST and ELECTRIC_MORAY in my env with\n\n$ export ELECTRIC_MORAY\u003delectric-moray.garage.local\n$ export MAHI_HOST\u003dauthcache.garage.local\n\nYou\u0027ll need a set up CoaL/Lab manta deployment for the tests as they\u0027re integration tests."},{"timestamp":1553875994,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1\n\nOk, got them running and verified this resolves the issue. Looks good!"},{"timestamp":1553878399,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Russell Brown"}],"currentPatchSet":{"number":"1","revision":"12fbd0f5bde9a76deb0e61bfdfce0040383076ef","parents":["d63e380ddcebec3a93579392962a82944aa30962"],"ref":"refs/changes/16/6016/1","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1553600507,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553600533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553875994,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553875994,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1553878399,"by":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"12fbd0f5bde9a76deb0e61bfdfce0040383076ef","parents":["d63e380ddcebec3a93579392962a82944aa30962"],"ref":"refs/changes/16/6016/1","uploader":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"createdOn":1553600507,"author":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553600533,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553875994,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553875994,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1553878399,"by":{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},{"name":"Russell Brown","email":"russell.brown@joyent.com","username":"russelldb"}]}