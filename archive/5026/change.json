{"project":"joyent/node-manta","branch":"master","id":"Ie54810720958e817107928df5f949d2b6cf4d77a","number":"5026","subject":"mchmod issues with parseCmdOptions","owner":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"url":"https://cr.joyent.us/5026","commitMessage":"mchmod issues with parseCmdOptions\n","createdOn":1541445430,"lastUpdated":1542214478,"open":true,"status":"NEW","comments":[{"timestamp":1541445430,"reviewer":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"message":"Uploaded patch set 1."},{"timestamp":1541445456,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1541445760,"reviewer":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"message":"Uploaded patch set 2."},{"timestamp":1541445785,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1542051595,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1542214478,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2:\n\n\u003e (1 comment)\n\nHere\u0027s a gist of the changes I made: https://gist.github.com/kellymclaughlin/84107991f2b9cd08f96947dd30ee9ab9. I ran the full test suite with these changes and everything passes, but adding some tests to exercise `mchmod` as part of this change set would be good too. I\u0027ll try to work on that over the next few days."}],"currentPatchSet":{"number":"2","revision":"e54810720958e817107928df5f949d2b6cf4d77a","parents":["da7a8ea23d03ebe20da239bcef15d26950739e4e"],"ref":"refs/changes/26/5026/2","uploader":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"createdOn":1541445760,"author":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1541445785,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/options.js","line":92,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"This would fix the problem with mchmod, but it would also undo some previous fixes (see https://github.com/joyent/node-manta/issues/346) for other commands. We just have some inconsistency in behavior across some of the tools unfortunately. \n\nI think the solution here is to do a fold (a.k.a reduce) over `opts._args` to find the valid paths in the provided arguments, assert that there is at least one provided path,  and then proceed to call `parseCmdOptions`. That ought to work for all of the commands."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/options.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":3,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"911ae54186a356b2e814bab18b9e5d91d696175a","parents":["da7a8ea23d03ebe20da239bcef15d26950739e4e"],"ref":"refs/changes/26/5026/1","uploader":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"createdOn":1541445430,"author":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1541445456,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/options.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-1},{"number":"2","revision":"e54810720958e817107928df5f949d2b6cf4d77a","parents":["da7a8ea23d03ebe20da239bcef15d26950739e4e"],"ref":"refs/changes/26/5026/2","uploader":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"createdOn":1541445760,"author":{"name":"Jeff Emershaw","email":"me@jeffemershaw.com","username":"jemershaw"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1541445785,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/options.js","line":92,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"This would fix the problem with mchmod, but it would also undo some previous fixes (see https://github.com/joyent/node-manta/issues/346) for other commands. We just have some inconsistency in behavior across some of the tools unfortunately. \n\nI think the solution here is to do a fold (a.k.a reduce) over `opts._args` to find the valid paths in the provided arguments, assert that there is at least one provided path,  and then proceed to call `parseCmdOptions`. That ought to work for all of the commands."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/options.js","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":3,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}]}