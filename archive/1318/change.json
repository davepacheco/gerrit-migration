{"project":"joyent/node-manta","branch":"master","topic":"MANTA-2169","id":"I8e34251dcf29bb7b573da8f8923e73958ec1c602","number":"1318","subject":"MANTA-2169 Support multipart upload of a single file to Manta Reviewed by: David Pacheco \u003cdap@joyent.com\u003e Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Reviewed by: Angela Fong \u003cangela.fong@joyent.com\u003e Reviewed by: Wyatt Preul \u003cwpreul@gmail.com\u003e Approved by:","owner":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"url":"https://cr.joyent.us/1318","commitMessage":"MANTA-2169 Support multipart upload of a single file to Manta\nReviewed by: David Pacheco \u003cdap@joyent.com\u003e\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nReviewed by: Angela Fong \u003cangela.fong@joyent.com\u003e\nReviewed by: Wyatt Preul \u003cwpreul@gmail.com\u003e\nApproved by: David Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1485198643,"lastUpdated":1490657200,"open":false,"status":"MERGED","comments":[{"timestamp":1485198643,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 1."},{"timestamp":1485198673,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485198676,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Topic set to MANTA-2169"},{"timestamp":1485201979,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 2."},{"timestamp":1485202010,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485281864,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 3."},{"timestamp":1485281899,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485371003,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 4."},{"timestamp":1485371044,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485371559,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 5."},{"timestamp":1485371594,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485371617,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 6."},{"timestamp":1485371653,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1485371711,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 6:\n\nNotes for reviewers: There are a few TODOs throughout here that I don\u0027t consider critical having completed before the deadline for Samsung. Please do let me know if you have suggestions or disagree with any of these.\n\nI also would definitely appreciate suggestions related to usability. Thanks!"},{"timestamp":1485374869,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6:\n\n(26 comments)\n\nOverall this looks great.  I have a bunch of smalls suggestions and nits."},{"timestamp":1485394753,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 6:\n\n(23 comments)\n\nI look forward to playing with this tomorrow. Here are some comments from just reading the code."},{"timestamp":1485397341,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6:\n\n(2 comments)"},{"timestamp":1485535326,"reviewer":{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"},"message":"Patch Set 6:\n\n(3 comments)"},{"timestamp":1486144710,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 7."},{"timestamp":1486144740,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486419770,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 8."},{"timestamp":1486419805,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486503275,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 8:\n\nOne other thing I found while using this: it would be useful to have a \"-v\" option analogous to the other tools to enable verbose logging.  (Setting LOG_LEVEL is a fine workaround.)"},{"timestamp":1490030249,"reviewer":{"name":"Wyatt Preul","email":"wpreul@gmail.com","username":"geek"},"message":"Patch Set 8:\n\n(2 comments)"},{"timestamp":1490389628,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 9."},{"timestamp":1490389654,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1490389825,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 9:\n\n(52 comments)\n\nThanks for your reviews. I think I addressed everyone\u0027s feedback, but please let me know if I\u0027ve missed something!\n\nAs for testing, I added tests for bin/mmpu that exercise the subcommands and their flags. I also added a few client tests to exercise the new client API.\n\nI will add a manual page and docs in a separate ticket/commit, as this one is already very large, and it will require another solid chunk of work from me."},{"timestamp":1490640226,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 9: Code-Review+1\n\n(6 comments)"},{"timestamp":1490654333,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 10."},{"timestamp":1490654364,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1490654647,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 10:\n\n(5 comments)\n\nThis changeset addresses Dave\u0027s feedback, and fixes my previous use of Verror (I was using the wrong error as input to the constructor in a few places).\n\nI have re-run the node-manta test suite and manually verified that error paths that hit the fixed Verrors are correct."},{"timestamp":1490654988,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 11."},{"timestamp":1490655013,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1490655458,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 11: Code-Review+1"},{"timestamp":1490656091,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 11: Integration-Approval+1"},{"timestamp":1490657167,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 12: Commit message was updated."},{"timestamp":1490657200,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jordan Hendricks"}],"currentPatchSet":{"number":"12","revision":"8e34251dcf29bb7b573da8f8923e73958ec1c602","parents":["9f19ca771b8a7f6741e45e841cde0302ecefe57c"],"ref":"refs/changes/18/1318/12","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1490657167,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1490655013,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1490655458,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1490656091,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1490657200,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":649,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":512,"deletions":-127},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/client.test.js","type":"MODIFIED","insertions":123,"deletions":0},{"file":"test/mmpu.test.js","type":"ADDED","insertions":604,"deletions":0}],"sizeInsertions":1889,"sizeDeletions":-127},"patchSets":[{"number":"1","revision":"43726fff1b1a41705c1765121da0cfd105aadbdf","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/1","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485198643,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485198673,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":485,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":333,"deletions":-2}],"sizeInsertions":818,"sizeDeletions":-2},{"number":"2","revision":"a649b33d06c66bbcf2b2672e6ab346bf379655d1","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/2","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485201979,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485202010,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":485,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":332,"deletions":-2}],"sizeInsertions":817,"sizeDeletions":-2},{"number":"3","revision":"1ce2611f5f759299e5d61f4883d531f7a739896d","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/3","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485281864,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485281899,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":493,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":332,"deletions":-2}],"sizeInsertions":825,"sizeDeletions":-2},{"number":"4","revision":"bbf79e82dbf6d5703f9ee109228842d6c0ed5ea1","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/4","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485371003,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485371044,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":564,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":369,"deletions":-4}],"sizeInsertions":933,"sizeDeletions":-4},{"number":"5","revision":"d6e3a32d12ac7a875e6cb06500034ab975be2efb","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/5","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485371559,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485371594,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":562,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":366,"deletions":-4}],"sizeInsertions":928,"sizeDeletions":-4},{"number":"6","revision":"2fc383fc054506b675640b6d58dd594d5bf07b49","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/6","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1485371617,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1485371653,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/mmpu","line":0,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Thoughts on adding a manual page and test cases?\n\nIf we decide to punt on the manual page (or don\u0027t want to because we don\u0027t want to commit to this interface), could we get a block comment at the top of this file explaining what the command is for?"},{"file":"bin/mmpu","line":0,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I will add a manual page in a separate commit."},{"file":"bin/mmpu","line":39,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"We probably ought to replace process.nextTick() with setImmediate() in new code."},{"file":"bin/mmpu","line":39,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":39,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"That doesn\u0027t seem to have been changed here?"},{"file":"bin/mmpu","line":39,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Shoot, you\u0027re right. Fixed again."},{"file":"bin/mmpu","line":77,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This option isn\u0027t currently handled. I can help with that if you like. There should be some code to copy in \u0027mjob\u0027.\n\nActually, you should just be able to copy MJob.prototype.init to properly handle \u0027--help\u0027, \u0027--version\u0027, and \u0027--completion\u0027."},{"file":"bin/mmpu","line":77,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Thanks for catching that.\n\nI copied the code over from mjob and tested that a top-level completion worked (`mmpu he` suggested `mmpu help`). Let me know if I\u0027m missing anything else here."},{"file":"bin/mmpu","line":94,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Check if args.length \u003e 1 too?"},{"file":"bin/mmpu","line":94,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done. Added this for the other subcommands as well."},{"file":"bin/mmpu","line":99,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Please do the assertOpts block *before* other \u0027args\u0027 checking. `assertOpts` is currently where handling of \u0027--help\u0027 is done. E.g. So that \u0027mmpu create --help\u0027 works."},{"file":"bin/mmpu","line":99,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":102,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is it intentional (or important) that we re-use \"opts\" for both the command-line options and the options for createUpload?"},{"file":"bin/mmpu","line":102,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Likewise, I\u0027d be inclined to have a separate \u0027createOpts\u0027 or whatever var name, and be explicit about which params are passed on. It could be confusing in `client.createUpload` that the opts given to it have unrelated `url`, `keyId`, etc. fields."},{"file":"bin/mmpu","line":108,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think you want `strsplit(h, \u0027:\u0027, 2)` here in case the header\u0027s value has colons in it."},{"file":"bin/mmpu","line":108,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":156,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could this help explain how that md5 is used? Does the server check that on commit?\n\nAlso, is this a base64 digest? Or a hex digest?"},{"file":"bin/mmpu","line":156,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Expanded the explanation a bit. Let me know what you think."},{"file":"bin/mmpu","line":164,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I don\u0027t think we want to ignore the jsstyle checks here.  The help output should still be 80 columns, and you\u0027d still be able to use 73 without breaking jsstyle."},{"file":"bin/mmpu","line":164,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"FWIW, if the 80-cols in the source file get in the way of\nusing 80-cols for the *help output* when that is nicer for presentation, then I use the BEGIN/END JSSTYLED around CLI .help"},{"file":"bin/mmpu","line":164,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"The help output in this example is not 80 columns either.  Personally, I\u0027d rather limit to 73 columns of usable output and have both help output and source output checked, but that could be a style choice.  (Option options: put these into separate data files or to use a rewrap function for each paragraph.)"},{"file":"bin/mmpu","line":164,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":164,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I\u0027ve added the style checks back in for help messages."},{"file":"bin/mmpu","line":168,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think there\u0027s a missing comma in the text at the end of this line."},{"file":"bin/mmpu","line":168,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":170,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"This seems slightly different than \"mput\u0027s\" --md5 option.  Is that intentional?"},{"file":"bin/mmpu","line":170,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Yes. Since the md5 is specified on creating the upload to the API, there isn\u0027t really a way to support the type of option `mpu5` provides here. We could add a new tool that creates, uploads a file, and has a similar option to mput if that would be useful. I\u0027m also opening to suggestions for renaming this option if that would be helpful to usability."},{"file":"bin/mmpu","line":178,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"should have blank line before {{options}}"},{"file":"bin/mmpu","line":178,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":227,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"indentation here"},{"file":"bin/mmpu","line":227,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":239,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is there anything else to do?  Can we just invoke the callback with an error here?"},{"file":"bin/mmpu","line":239,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Calling the callback with an error would allow MMpu.main() handling to emit error details, and things like errHelp."},{"file":"bin/mmpu","line":239,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Changed this to close the client, then call the callback with an appropriate error (and not use process.exit)."},{"file":"bin/mmpu","line":271,"reviewer":{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"},"message":"missing part number here, should be `mmpu upload [OPTIONS] UPLOAD-ID PART-NUMBER`?"},{"file":"bin/mmpu","line":271,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Yes. Fixed."},{"file":"bin/mmpu","line":272,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"That second synopsis shold be `mmpu upload [OPTIONS] UploadId -f FILE`, right? I.e. if using `-f`, the `FILE` must also be supplied.\n\nAlso wonder if we want consistent ALL-CAPS for values to provide, e.g. `mmpu upload [OPTIONS] UPLOAD-ID -f FILE` ... tho that is hard because I don\u0027t think the `m*` tools are typically consistent here."},{"file":"bin/mmpu","line":272,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Fixed the first thing.\n\nI do prefer to have all-caps for values to provide, but some m* tools (such as mjob, which I modeled most of mmpu from) don\u0027t. I will change it for mmpu, and perhaps we can move other m* tools in that direction. It looks like at least mlogin and msign use underscores to delineate words for all-caps values, so I will use that format."},{"file":"bin/mmpu","line":295,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"We don\u0027t `client.close()` in the error case here. Depending on the tool\u0027s exit handling, that could result in a keep-alive hang of the process.  You probably won\u0027t see that now because node-manta tools *currently* tend to use `process.exit` directly to exit.\n\nDitto for other subcommands."},{"file":"bin/mmpu","line":295,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Okay, thanks. I think I caught all the cases where I wasn\u0027t doing this in the latest patchset, but of course let mek now if you notice one I missed."},{"file":"bin/mmpu","line":327,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I\u0027d strike the comment altogether."},{"file":"bin/mmpu","line":327,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"This was meant more as a note to reviewers, though I realize now that may not have been clear. Given that no one has expressed issues with the format of the command, I will delete the comment and leave this as is."},{"file":"bin/mmpu","line":365,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"\"[OPTIONS]\"?"},{"file":"bin/mmpu","line":365,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Dave,\n\nAre you asking if there *are* any options specific to \u0027mmpu commit\u0027?"},{"file":"bin/mmpu","line":365,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think I misread this as a synopsis and thought it was misformatted.  I see now it\u0027s a header, so ignore that.  Sorry."},{"file":"bin/mmpu","line":365,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":365,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":365,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":375,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Can the .help explain what the etag arguments are for? I\u0027m not read up on MPU and I don\u0027t know what they do."},{"file":"bin/mmpu","line":375,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Sure. I added a few examples explaining how to use it. Let me know if you think I should add anything else!"},{"file":"bin/mmpu","line":422,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This should be \u0027get\u0027?"},{"file":"bin/mmpu","line":422,"reviewer":{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"},"message":"I think this is meant to be \u0027state\u0027, matching with the endpoint URI. I do see that it can be too restrictive as it returns more than just the state information. To be consistent with `mjob`, \u0027get\u0027 will be better."},{"file":"bin/mmpu","line":422,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"The name of the subcommand is `get`, so this message is wrong. I have fixed it in this patchset."},{"file":"bin/mmpu","line":422,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":431,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Yeah, we should probably commonize that."},{"file":"bin/mmpu","line":431,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I ended up removing this because it was mostly unneeded."},{"file":"bin/mmpu","line":439,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Why\u0027s this needed?"},{"file":"bin/mmpu","line":439,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":482,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Have you found this one useful?  I\u0027d be tempted to remove it in favor of the \"parts\" subcommand."},{"file":"bin/mmpu","line":482,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I\u0027ve actually used `list` a lot more than I\u0027ve used parts. List shows all uploads (and optionally parts). I think they both are useful, but I\u0027ve probably used this API differently than most."},{"file":"bin/mmpu","line":501,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is that right?  (Also seems reasonable to drop these headers.)"},{"file":"bin/mmpu","line":501,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"No, it\u0027s not. The RFD calls this \"list-parts\"."},{"file":"bin/mmpu","line":516,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I\u0027d be inclined to explicitly list the options to pass in, rather than just whatever happens to be on the CLI `opts` (which might include other fields irrelevant to `printEntry`).\n\nDitto for the `opts` passed to createClient. Ignore me if that seems to already be a pattern in this repo."},{"file":"bin/mmpu","line":516,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"This is a pattern in the repo, though I will admit I\u0027m not a huge fan of it either, at least in the case of passing options to methods on the manta client. For the options passed to createClient, I don\u0027t think it\u0027s quite as bad, as createBinClient seems to expect a lot of options already passed to the do_* commands.\n\nI\u0027ve explicitly defined options passed to manta client methods now, which I think is an improvement."},{"file":"bin/mmpu","line":538,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Drop this \u0027group\u0027 if there aren\u0027t any options specific to \u0027mmpu parts\u0027. Else you get a hanging thing in the help output:\n\n```\n...\n    -u URL, --url\u003dURL              Manta URL. Environment: MANTA_URL\u003dURL\n\n  mmpu parts options:\n```"},{"file":"bin/mmpu","line":538,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done. I also removed the group for get, abort, and commit, as they don\u0027t have any specific options at this time."},{"file":"lib/client.js","line":51,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"UPLOAD_OPS for a constant?"},{"file":"lib/client.js","line":51,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Sure."},{"file":"lib/client.js","line":52,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"indentation"},{"file":"lib/client.js","line":52,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"The indentation of all of the code I added in this file is off compared to most of this file. I realized this is because of this line that was added when the medusaAttach code was added:\n\n\"/* vim: set ts\u003d8 sts\u003d8 sw\u003d8 expandtab: */\"\n\nI\u0027m using vim, so my tabs were converted to 8-columns. I\u0027m going to remove that line and fix the rest of indentation in this file."},{"file":"lib/client.js","line":494,"reviewer":{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"},"message":"small typo here with \"simultaneously\""},{"file":"lib/client.js","line":494,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":503,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I\u0027d reword this to say something like: \"We can implement this mechanism in the future, but for now we just hardcode the prefix.\""},{"file":"lib/client.js","line":503,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":508,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I\u0027m not sure if we\u0027re very consistent in this file either way, but we often prefer named arguments in an \"args\" object when there\u0027s more than 1 or 2 arguments."},{"file":"lib/client.js","line":508,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Even for helper functions like this?"},{"file":"lib/client.js","line":509,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"indentation"},{"file":"lib/client.js","line":509,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":519,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is an upload id not always a uuid? If so, perhaps:\n\n    assert.uuid(id, \u0027id\u0027);"},{"file":"lib/client.js","line":519,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Yeah, it is. I didn\u0027t know about that assert function, so I\u0027ll use that."},{"file":"lib/client.js","line":2496,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is this change in whitespace intentional?  It looks wrong in Gerrit, but that might be a rendering issue."},{"file":"lib/client.js","line":2496,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"No, that must\u0027ve been accidentally introduced. Removed."},{"file":"lib/client.js","line":3310,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I\u0027d suggest a jsprim.deepCopy() so that we don\u0027t modify the caller\u0027s argument."},{"file":"lib/client.js","line":3310,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3312,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think we should document and assert that opts.copies is a number and make sure parseInt() did not return NaN."},{"file":"lib/client.js","line":3312,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I\u0027ve decided it makes more sense for these options to already be numbers in the client, so I have added type checking asserts to the beginning of the method and moved the string parsing into bin/mmpu."},{"file":"lib/client.js","line":3312,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"That sounds good."},{"file":"lib/client.js","line":3316,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"This should use opts.size.  Also, this should check the type too."},{"file":"lib/client.js","line":3316,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3320,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Ditto.  This should use opts.md5."},{"file":"lib/client.js","line":3320,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3322,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Doesn\u0027t createOptions handle \u0027content-length\u0027 and \u0027content-md5\u0027 headers from opts.contentLength and opts.contentMD5 already? I.e. instead of handling opts.md5 and opts.size here?\n\nSeparate question: Does \u0027content-length\u0027 and \u0027content-md5\u0027 here play loose with the HTTP spec, where the values here don\u0027t apply to *this* request?"},{"file":"lib/client.js","line":3322,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"These represent headers stored on the object once it is committed, not headers on the request. They are passed in as JSON to the create request, and the muskie commit path saves them properly in moray for the object. I\u0027m not sure if that completely answers your question, so let me know if I missed something."},{"file":"lib/client.js","line":3336,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think a nicer pattern here is:\n\n    err \u003d new VError(err, \u0027signing request\u0027)\n    log.debug(err)\n\nThat way, you have the \"signing request\" context both in the log and in the error message."},{"file":"lib/client.js","line":3336,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3347,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Recommend verror here, same as above, and in similar places in the other new functions."},{"file":"lib/client.js","line":3347,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3402,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"The indenting looks off here.  Same in the other functions."},{"file":"lib/client.js","line":3402,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3412,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is there any reason this is a separate closure here?  Same in the other functions."},{"file":"lib/client.js","line":3412,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"In an earlier implementation, the separate closure made some things easier, but the upload() function is now superfluous. I removed it."},{"file":"lib/client.js","line":3445,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"abortUpload doesn\u0027t take those opts does it?"},{"file":"lib/client.js","line":3445,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"No. Fixed."},{"file":"lib/client.js","line":3498,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"These don\u0027t apply here, right?"},{"file":"lib/client.js","line":3498,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3548,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"These don\u0027t apply here, right?"},{"file":"lib/client.js","line":3548,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":562,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":365,"deletions":-4}],"sizeInsertions":927,"sizeDeletions":-4},{"number":"7","revision":"cefdd4d6eb82fcec8a1a3bcd267ccb7b918eb0b0","parents":["5725b4b411340548e5340be020f28b7532900438"],"ref":"refs/changes/18/1318/7","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1486144710,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486144740,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":557,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":365,"deletions":-4}],"sizeInsertions":922,"sizeDeletions":-4},{"number":"8","revision":"3be02e83d6375790f9c1e7f86d3302345d38be07","parents":["9827908c3bb1f3e8fb3c9fd7ab74679966821fc6"],"ref":"refs/changes/18/1318/8","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1486419770,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486419805,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/client.js","line":3316,"reviewer":{"name":"Wyatt Preul","email":"wpreul@gmail.com","username":"geek"},"message":"should this be `opts.size`"},{"file":"lib/client.js","line":3316,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/client.js","line":3320,"reviewer":{"name":"Wyatt Preul","email":"wpreul@gmail.com","username":"geek"},"message":"should be `headers[\u0027content-md5\u0027] \u003d opts.md5;`"},{"file":"lib/client.js","line":3320,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":557,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":366,"deletions":-4}],"sizeInsertions":923,"sizeDeletions":-4},{"number":"9","revision":"174b05132d661762e34bfb72af8e2434f26900e5","parents":["9f19ca771b8a7f6741e45e841cde0302ecefe57c"],"ref":"refs/changes/18/1318/9","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1490389628,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1490640226,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1490389654,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/mmpu","line":98,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"It would be good to commonize this code, since it\u0027s non-trivial, depends on Node internals, and now appears in a bunch of places."},{"file":"bin/mmpu","line":98,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"This code is already commonized, and mjob (and now mmpu) are the only commands that don\u0027t use it (see: create_client.js#completionCheckPrintAndExit).\n\nI talked to Trent about this, as the commonized code was added when he added bash completion (https://github.com/joyent/node-manta/issues/214), and it turns out that this code isn\u0027t completely correct anyway (see https://github.com/joyent/node-exeunt#readme). Trent said he will be moving this repo and others to one of the \"solutions\" in that repo. With this in mind, I think it\u0027s better to punt on commonizing this until we improve exit handling for all of these tools.\n\n(It\u0027s also worth noting I can\u0027t use the completionCheckPrintAndExit function directly, as mjob and mmpu use cmdln, while that function is tailored toward those using dashdash.)"},{"file":"bin/mmpu","line":145,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Aren\u0027t these already integers because of cmdln\u0027s validation?"},{"file":"bin/mmpu","line":145,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"bin/mmpu","line":196,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Why did this type change from positiveInteger?  Was that to allow for 0-sized objects?  Should this at least be \"integer\"?"},{"file":"bin/mmpu","line":196,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I changed it because I thought maybe it would be useful to specify a size of zero. I changed it back. If a user needs to specify a size of zero, they can use the -H option."},{"file":"lib/index.js","line":51,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is this exported from this module, or just internally?  Does it need to be exported publicly?  It looks undocumented and kind of complicated."},{"file":"lib/index.js","line":51,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I originally exported it for use by the muskie test suite, but I just rewrote the code that uses it and it seems to work fine without, so I will change this back."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":659,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":512,"deletions":-127},{"file":"lib/index.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/client.test.js","type":"MODIFIED","insertions":123,"deletions":0},{"file":"test/mmpu.test.js","type":"ADDED","insertions":604,"deletions":0}],"sizeInsertions":1900,"sizeDeletions":-127},{"number":"10","revision":"eb49533328a452adf0eec55839b4ca3a2f1731a5","parents":["9f19ca771b8a7f6741e45e841cde0302ecefe57c"],"ref":"refs/changes/18/1318/10","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1490654333,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1490654364,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":649,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":512,"deletions":-127},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/client.test.js","type":"MODIFIED","insertions":123,"deletions":0},{"file":"test/mmpu.test.js","type":"ADDED","insertions":604,"deletions":0}],"sizeInsertions":1889,"sizeDeletions":-127},{"number":"11","revision":"83748840afc51a6b8fbd83f1be614459a1c8bf2a","parents":["9f19ca771b8a7f6741e45e841cde0302ecefe57c"],"ref":"refs/changes/18/1318/11","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1490654988,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1490655458,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1490656091,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1490655013,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":649,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":512,"deletions":-127},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/client.test.js","type":"MODIFIED","insertions":123,"deletions":0},{"file":"test/mmpu.test.js","type":"ADDED","insertions":604,"deletions":0}],"sizeInsertions":1889,"sizeDeletions":-127},{"number":"12","revision":"8e34251dcf29bb7b573da8f8923e73958ec1c602","parents":["9f19ca771b8a7f6741e45e841cde0302ecefe57c"],"ref":"refs/changes/18/1318/12","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1490657167,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1490655458,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1490656091,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1490655013,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1490657200,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"bin/mmpu","type":"ADDED","insertions":649,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":512,"deletions":-127},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/client.test.js","type":"MODIFIED","insertions":123,"deletions":0},{"file":"test/mmpu.test.js","type":"ADDED","insertions":604,"deletions":0}],"sizeInsertions":1889,"sizeDeletions":-127}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Angela Fong","email":"angela.fong@joyent.com","username":"askfongjojo"},{"name":"Wyatt Preul","email":"wpreul@gmail.com","username":"geek"}]}