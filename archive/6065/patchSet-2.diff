From 9a4d8b321efce3e79cf5fe068af80784b972c42f Mon Sep 17 00:00:00 2001
From: Robert Mustacchi <rm@joyent.com>
Date: Mon, 8 Apr 2019 18:17:15 +0000
Subject: [PATCH] OS-7711 AVX-512 dis tests fail with 'Error: zeroing-masking
 only allowed with write mask'

---
 .../util-tests/tests/dis/i386/32.avx512.out   | 100 ++++++++---------
 .../util-tests/tests/dis/i386/32.avx512.s     | 102 +++++++++---------
 .../util-tests/tests/dis/i386/64.avx512.out   | 100 ++++++++---------
 .../util-tests/tests/dis/i386/64.avx512.s     | 102 +++++++++---------
 4 files changed, 202 insertions(+), 202 deletions(-)

diff --git a/usr/src/test/util-tests/tests/dis/i386/32.avx512.out b/usr/src/test/util-tests/tests/dis/i386/32.avx512.out
index b49b738c14..90dff7c443 100644
--- a/usr/src/test/util-tests/tests/dis/i386/32.avx512.out
+++ b/usr/src/test/util-tests/tests/dis/i386/32.avx512.out
@@ -17,7 +17,7 @@
                        24 08 00 00 00 
     libdis_test+0x50:  62 f1 7c c9 28 f9  vmovaps %zmm1,%zmm7{%k1}{z}
     libdis_test+0x56:  62 f1 7c 4f 28 e6  vmovaps %zmm6,%zmm4{%k7}
-    libdis_test+0x5c:  62 f1 7c c8 28 da  vmovaps %zmm2,%zmm3{z}
+    libdis_test+0x5c:  62 f1 7c 48 28 da  vmovaps %zmm2,%zmm3
     libdis_test+0x62:  62 f1 7c 8b 28 d7  vmovaps %xmm7,%xmm2{%k3}{z}
     libdis_test+0x68:  62 f1 7c 2d 28 d9  vmovaps %ymm1,%ymm3{%k5}
     libdis_test+0x6e:  62 f1 fd 48 28 fa  vmovapd %zmm2,%zmm7
@@ -25,7 +25,7 @@
                        20 00 00 00 
     libdis_test+0x7e:  62 f1 7c 48 10 bc  vmovups 0x8(%esp),%zmm7
                        24 08 00 00 00 
-    libdis_test+0x89:  62 f1 7c c8 10 18  vmovups (%eax),%zmm3{z}
+    libdis_test+0x89:  62 f1 7c 48 10 18  vmovups (%eax),%zmm3
     libdis_test+0x8f:  62 f1 fd 4a 10 0c  vmovupd (%esp),%zmm1{%k2}
                        24 
     libdis_test+0x96:  62 f1 fd 48 11 34  vmovupd %zmm6,(%esp)
@@ -95,49 +95,49 @@
                        24 
     libdis_test+0x1ab: 62 f1 fe 48 6f 04  vmovdqu64 (%esp),%zmm0
                        24 
-    libdis_test+0x1b2: 62 f1 f5 88 55 d0  vandnpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x1b8: 62 f1 e5 88 55 20  vandnpd (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x1be: 62 f1 d5 88 55 b1  vandnpd 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x1b2: 62 f1 f5 89 55 d0  vandnpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x1b8: 62 f1 e5 89 55 20  vandnpd (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x1be: 62 f1 d5 89 55 b1  vandnpd 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x1c8: 62 f1 f5 a8 55 d0  vandnpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x1ce: 62 f1 e5 a8 55 23  vandnpd (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x1d4: 62 f1 d5 a8 55 b2  vandnpd 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x1c8: 62 f1 f5 29 55 d0  vandnpd %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x1ce: 62 f1 e5 29 55 23  vandnpd (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x1d4: 62 f1 d5 29 55 b2  vandnpd 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x1de: 62 f1 f5 48 55 d0  vandnpd %zmm0,%zmm1,%zmm2
     libdis_test+0x1e4: 62 f1 e5 48 55 23  vandnpd (%ebx),%zmm3,%zmm4
     libdis_test+0x1ea: 62 f1 d5 48 55 b2  vandnpd 0x42(%edx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x1f4: 62 f1 74 88 55 d0  vandnps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x1fa: 62 f1 64 88 55 20  vandnps (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x200: 62 f1 54 88 55 b1  vandnps 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x1f4: 62 f1 74 89 55 d0  vandnps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x1fa: 62 f1 64 89 55 20  vandnps (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x200: 62 f1 54 89 55 b1  vandnps 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x20a: 62 f1 74 a8 55 d0  vandnps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x210: 62 f1 64 a8 55 23  vandnps (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x216: 62 f1 54 a8 55 b2  vandnps 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x20a: 62 f1 74 29 55 d0  vandnps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x210: 62 f1 64 29 55 23  vandnps (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x216: 62 f1 54 29 55 b2  vandnps 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x220: 62 f1 74 48 55 d0  vandnps %zmm0,%zmm1,%zmm2
     libdis_test+0x226: 62 f1 64 48 55 23  vandnps (%ebx),%zmm3,%zmm4
     libdis_test+0x22c: 62 f1 54 48 55 b2  vandnps 0x42(%edx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x236: 62 f1 f5 88 54 d0  vandpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x23c: 62 f1 e5 88 54 20  vandpd (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x242: 62 f1 d5 88 54 b1  vandpd 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x236: 62 f1 f5 89 54 d0  vandpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x23c: 62 f1 e5 89 54 20  vandpd (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x242: 62 f1 d5 89 54 b1  vandpd 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x24c: 62 f1 f5 a8 54 d0  vandpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x252: 62 f1 e5 a8 54 23  vandpd (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x258: 62 f1 d5 a8 54 b2  vandpd 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x24c: 62 f1 f5 29 54 d0  vandpd %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x252: 62 f1 e5 29 54 23  vandpd (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x258: 62 f1 d5 29 54 b2  vandpd 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x262: 62 f1 f5 48 54 d0  vandpd %zmm0,%zmm1,%zmm2
     libdis_test+0x268: 62 f1 e5 48 54 23  vandpd (%ebx),%zmm3,%zmm4
     libdis_test+0x26e: 62 f1 d5 48 54 b2  vandpd 0x42(%edx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x278: 62 f1 74 88 54 d0  vandps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x27e: 62 f1 64 88 54 20  vandps (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x284: 62 f1 54 88 54 b1  vandps 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x278: 62 f1 74 89 54 d0  vandps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x27e: 62 f1 64 89 54 20  vandps (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x284: 62 f1 54 89 54 b1  vandps 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x28e: 62 f1 74 a8 54 d0  vandps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x294: 62 f1 64 a8 54 23  vandps (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x29a: 62 f1 54 a8 54 b2  vandps 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x28e: 62 f1 74 29 54 d0  vandps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x294: 62 f1 64 29 54 23  vandps (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x29a: 62 f1 54 29 54 b2  vandps 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x2a4: 62 f1 74 48 54 d0  vandps %zmm0,%zmm1,%zmm2
     libdis_test+0x2aa: 62 f1 64 48 54 23  vandps (%ebx),%zmm3,%zmm4
@@ -191,25 +191,25 @@
     libdis_test+0x3b2: 62 f1 e5 48 df 23  vpandnq (%ebx),%zmm3,%zmm4
     libdis_test+0x3b8: 62 f1 d5 48 df b2  vpandnq 0x42(%edx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x3c2: 62 f1 f5 88 56 d0  vorpd  %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x3c8: 62 f1 e5 88 56 20  vorpd  (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x3ce: 62 f1 d5 88 56 b1  vorpd  0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x3c2: 62 f1 f5 89 56 d0  vorpd  %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x3c8: 62 f1 e5 89 56 20  vorpd  (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x3ce: 62 f1 d5 89 56 b1  vorpd  0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x3d8: 62 f1 f5 a8 56 d0  vorpd  %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x3de: 62 f1 e5 a8 56 23  vorpd  (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x3e4: 62 f1 d5 a8 56 b2  vorpd  0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x3d8: 62 f1 f5 29 56 d0  vorpd  %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x3de: 62 f1 e5 29 56 23  vorpd  (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x3e4: 62 f1 d5 29 56 b2  vorpd  0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x3ee: 62 f1 f5 48 56 d0  vorpd  %zmm0,%zmm1,%zmm2
     libdis_test+0x3f4: 62 f1 e5 48 56 20  vorpd  (%eax),%zmm3,%zmm4
     libdis_test+0x3fa: 62 f1 d5 48 56 b1  vorpd  0x42(%ecx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x404: 62 f1 74 88 56 d0  vorps  %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x40a: 62 f1 64 88 56 20  vorps  (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x410: 62 f1 54 88 56 b1  vorps  0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x404: 62 f1 74 89 56 d0  vorps  %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x40a: 62 f1 64 89 56 20  vorps  (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x410: 62 f1 54 89 56 b1  vorps  0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x41a: 62 f1 74 a8 56 d0  vorps  %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x420: 62 f1 64 a8 56 23  vorps  (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x426: 62 f1 54 a8 56 b2  vorps  0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x41a: 62 f1 74 29 56 d0  vorps  %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x420: 62 f1 64 29 56 23  vorps  (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x426: 62 f1 54 29 56 b2  vorps  0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x430: 62 f1 74 48 56 d0  vorps  %zmm0,%zmm1,%zmm2
     libdis_test+0x436: 62 f1 64 48 56 20  vorps  (%eax),%zmm3,%zmm4
@@ -263,25 +263,25 @@
     libdis_test+0x53e: 62 f1 e5 48 ef 20  vpxorq (%eax),%zmm3,%zmm4
     libdis_test+0x544: 62 f1 d5 48 ef b1  vpxorq 0x42(%ecx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x54e: 62 f1 f5 88 57 d0  vxorpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x554: 62 f1 e5 88 57 20  vxorpd (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x55a: 62 f1 d5 88 57 b1  vxorpd 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x54e: 62 f1 f5 89 57 d0  vxorpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x554: 62 f1 e5 89 57 20  vxorpd (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x55a: 62 f1 d5 89 57 b1  vxorpd 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x564: 62 f1 f5 a8 57 d0  vxorpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x56a: 62 f1 e5 a8 57 23  vxorpd (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x570: 62 f1 d5 a8 57 b2  vxorpd 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x564: 62 f1 f5 29 57 d0  vxorpd %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x56a: 62 f1 e5 29 57 23  vxorpd (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x570: 62 f1 d5 29 57 b2  vxorpd 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x57a: 62 f1 f5 48 57 d0  vxorpd %zmm0,%zmm1,%zmm2
     libdis_test+0x580: 62 f1 e5 48 57 23  vxorpd (%ebx),%zmm3,%zmm4
     libdis_test+0x586: 62 f1 d5 48 57 b2  vxorpd 0x42(%edx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x590: 62 f1 74 88 57 d0  vxorps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x596: 62 f1 64 88 57 20  vxorps (%eax),%xmm3,%xmm4{z}
-    libdis_test+0x59c: 62 f1 54 88 57 b1  vxorps 0x42(%ecx),%xmm5,%xmm6{z}
+    libdis_test+0x590: 62 f1 74 89 57 d0  vxorps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x596: 62 f1 64 89 57 20  vxorps (%eax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x59c: 62 f1 54 89 57 b1  vxorps 0x42(%ecx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x5a6: 62 f1 74 a8 57 d0  vxorps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x5ac: 62 f1 64 a8 57 23  vxorps (%ebx),%ymm3,%ymm4{z}
-    libdis_test+0x5b2: 62 f1 54 a8 57 b2  vxorps 0x42(%edx),%ymm5,%ymm6{z}
+    libdis_test+0x5a6: 62 f1 74 29 57 d0  vxorps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x5ac: 62 f1 64 29 57 23  vxorps (%ebx),%ymm3,%ymm4{%k1}
+    libdis_test+0x5b2: 62 f1 54 29 57 b2  vxorps 0x42(%edx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x5bc: 62 f1 74 48 57 d0  vxorps %zmm0,%zmm1,%zmm2
     libdis_test+0x5c2: 62 f1 64 48 57 23  vxorps (%ebx),%zmm3,%zmm4
diff --git a/usr/src/test/util-tests/tests/dis/i386/32.avx512.s b/usr/src/test/util-tests/tests/dis/i386/32.avx512.s
index 3107788a99..bc37c07bc4 100755
--- a/usr/src/test/util-tests/tests/dis/i386/32.avx512.s
+++ b/usr/src/test/util-tests/tests/dis/i386/32.avx512.s
@@ -10,7 +10,7 @@
  */
 
 /*
- * Copyright 2017 Joyent, Inc.
+ * Copyright 2019 Joyent, Inc.
  */
 
 /*
@@ -44,7 +44,7 @@ libdis_test:
 	vmovaps		0x8(%esp), %zmm3
 	vmovaps		%zmm1, %zmm7{%k1}{z}
 	vmovaps		%zmm6, %zmm4{%k7}
-	vmovaps		%zmm2, %zmm3{z}
+	vmovaps		%zmm2, %zmm3
 
 	vmovaps		%xmm7, %xmm2{%k3}{z}
 	vmovaps		%ymm1, %ymm3{%k5}
@@ -53,7 +53,7 @@ libdis_test:
 
 	vmovups		%zmm7, 0x20(%ebp)
 	vmovups		0x8(%esp), %zmm7
-	vmovups		(%eax), %zmm3{z}
+	vmovups		(%eax), %zmm3
 
 	vmovupd		(%esp), %zmm1{%k2}
 	vmovupd		%zmm6, (%esp)
@@ -98,42 +98,42 @@ libdis_test:
 	vmovdqu32	(%esp), %zmm0
 	vmovdqu64	(%esp), %zmm0
 
-	vandnpd	%xmm0, %xmm1, %xmm2{z}
-	vandnpd	(%eax), %xmm3, %xmm4{z}
-	vandnpd	0x42(%ecx), %xmm5, %xmm6{z}
-	vandnpd	%ymm0, %ymm1, %ymm2{z}
-	vandnpd	(%ebx), %ymm3, %ymm4{z}
-	vandnpd	0x42(%edx), %ymm5, %ymm6{z}
+	vandnpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandnpd	(%eax), %xmm3, %xmm4{%k1}{z}
+	vandnpd	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vandnpd	%ymm0, %ymm1, %ymm2{%k1}
+	vandnpd	(%ebx), %ymm3, %ymm4{%k1}
+	vandnpd	0x42(%edx), %ymm5, %ymm6{%k1}
 	vandnpd	%zmm0, %zmm1, %zmm2
 	vandnpd	(%ebx), %zmm3, %zmm4
 	vandnpd	0x42(%edx), %zmm5, %zmm6
 
-	vandnps	%xmm0, %xmm1, %xmm2{z}
-	vandnps	(%eax), %xmm3, %xmm4{z}
-	vandnps	0x42(%ecx), %xmm5, %xmm6{z}
-	vandnps	%ymm0, %ymm1, %ymm2{z}
-	vandnps	(%ebx), %ymm3, %ymm4{z}
-	vandnps	0x42(%edx), %ymm5, %ymm6{z}
+	vandnps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandnps	(%eax), %xmm3, %xmm4{%k1}{z}
+	vandnps	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vandnps	%ymm0, %ymm1, %ymm2{%k1}
+	vandnps	(%ebx), %ymm3, %ymm4{%k1}
+	vandnps	0x42(%edx), %ymm5, %ymm6{%k1}
 	vandnps	%zmm0, %zmm1, %zmm2
 	vandnps	(%ebx), %zmm3, %zmm4
 	vandnps	0x42(%edx), %zmm5, %zmm6
 
-	vandpd	%xmm0, %xmm1, %xmm2{z}
-	vandpd	(%eax), %xmm3, %xmm4{z}
-	vandpd	0x42(%ecx), %xmm5, %xmm6{z}
-	vandpd	%ymm0, %ymm1, %ymm2{z}
-	vandpd	(%ebx), %ymm3, %ymm4{z}
-	vandpd	0x42(%edx), %ymm5, %ymm6{z}
+	vandpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandpd	(%eax), %xmm3, %xmm4{%k1}{z}
+	vandpd	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vandpd	%ymm0, %ymm1, %ymm2{%k1}
+	vandpd	(%ebx), %ymm3, %ymm4{%k1}
+	vandpd	0x42(%edx), %ymm5, %ymm6{%k1}
 	vandpd	%zmm0, %zmm1, %zmm2
 	vandpd	(%ebx), %zmm3, %zmm4
 	vandpd	0x42(%edx), %zmm5, %zmm6
 
-	vandps	%xmm0, %xmm1, %xmm2{z}
-	vandps	(%eax), %xmm3, %xmm4{z}
-	vandps	0x42(%ecx), %xmm5, %xmm6{z}
-	vandps	%ymm0, %ymm1, %ymm2{z}
-	vandps	(%ebx), %ymm3, %ymm4{z}
-	vandps	0x42(%edx), %ymm5, %ymm6{z}
+	vandps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandps	(%eax), %xmm3, %xmm4{%k1}{z}
+	vandps	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vandps	%ymm0, %ymm1, %ymm2{%k1}
+	vandps	(%ebx), %ymm3, %ymm4{%k1}
+	vandps	0x42(%edx), %ymm5, %ymm6{%k1}
 	vandps	%zmm0, %zmm1, %zmm2
 	vandps	(%ebx), %zmm3, %zmm4
 	vandps	0x42(%edx), %zmm5, %zmm6
@@ -178,22 +178,22 @@ libdis_test:
 	vpandnq	(%ebx), %zmm3, %zmm4
 	vpandnq	0x42(%edx), %zmm5, %zmm6
 
-	vorpd	%xmm0, %xmm1, %xmm2{z}
-	vorpd	(%eax), %xmm3, %xmm4{z}
-	vorpd	0x42(%ecx), %xmm5, %xmm6{z}
-	vorpd	%ymm0, %ymm1, %ymm2{z}
-	vorpd	(%ebx), %ymm3, %ymm4{z}
-	vorpd	0x42(%edx), %ymm5, %ymm6{z}
+	vorpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vorpd	(%eax), %xmm3, %xmm4{%k1}{z}
+	vorpd	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vorpd	%ymm0, %ymm1, %ymm2{%k1}
+	vorpd	(%ebx), %ymm3, %ymm4{%k1}
+	vorpd	0x42(%edx), %ymm5, %ymm6{%k1}
 	vorpd	%zmm0, %zmm1, %zmm2
 	vorpd	(%eax), %zmm3, %zmm4
 	vorpd	0x42(%ecx), %zmm5, %zmm6
 
-	vorps	%xmm0, %xmm1, %xmm2{z}
-	vorps	(%eax), %xmm3, %xmm4{z}
-	vorps	0x42(%ecx), %xmm5, %xmm6{z}
-	vorps	%ymm0, %ymm1, %ymm2{z}
-	vorps	(%ebx), %ymm3, %ymm4{z}
-	vorps	0x42(%edx), %ymm5, %ymm6{z}
+	vorps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vorps	(%eax), %xmm3, %xmm4{%k1}{z}
+	vorps	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vorps	%ymm0, %ymm1, %ymm2{%k1}
+	vorps	(%ebx), %ymm3, %ymm4{%k1}
+	vorps	0x42(%edx), %ymm5, %ymm6{%k1}
 	vorps	%zmm0, %zmm1, %zmm2
 	vorps	(%eax), %zmm3, %zmm4
 	vorps	0x42(%ecx), %zmm5, %zmm6
@@ -238,22 +238,22 @@ libdis_test:
 	vpxorq	(%eax), %zmm3, %zmm4
 	vpxorq	0x42(%ecx), %zmm5, %zmm6
 
-	vxorpd	%xmm0, %xmm1, %xmm2{z}
-	vxorpd	(%eax), %xmm3, %xmm4{z}
-	vxorpd	0x42(%ecx), %xmm5, %xmm6{z}
-	vxorpd	%ymm0, %ymm1, %ymm2{z}
-	vxorpd	(%ebx), %ymm3, %ymm4{z}
-	vxorpd	0x42(%edx), %ymm5, %ymm6{z}
+	vxorpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vxorpd	(%eax), %xmm3, %xmm4{%k1}{z}
+	vxorpd	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vxorpd	%ymm0, %ymm1, %ymm2{%k1}
+	vxorpd	(%ebx), %ymm3, %ymm4{%k1}
+	vxorpd	0x42(%edx), %ymm5, %ymm6{%k1}
 	vxorpd	%zmm0, %zmm1, %zmm2
 	vxorpd	(%ebx), %zmm3, %zmm4
 	vxorpd	0x42(%edx), %zmm5, %zmm6
 
-	vxorps	%xmm0, %xmm1, %xmm2{z}
-	vxorps	(%eax), %xmm3, %xmm4{z}
-	vxorps	0x42(%ecx), %xmm5, %xmm6{z}
-	vxorps	%ymm0, %ymm1, %ymm2{z}
-	vxorps	(%ebx), %ymm3, %ymm4{z}
-	vxorps	0x42(%edx), %ymm5, %ymm6{z}
+	vxorps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vxorps	(%eax), %xmm3, %xmm4{%k1}{z}
+	vxorps	0x42(%ecx), %xmm5, %xmm6{%k1}{z}
+	vxorps	%ymm0, %ymm1, %ymm2{%k1}
+	vxorps	(%ebx), %ymm3, %ymm4{%k1}
+	vxorps	0x42(%edx), %ymm5, %ymm6{%k1}
 	vxorps	%zmm0, %zmm1, %zmm2
 	vxorps	(%ebx), %zmm3, %zmm4
 	vxorps	0x42(%edx), %zmm5, %zmm6
diff --git a/usr/src/test/util-tests/tests/dis/i386/64.avx512.out b/usr/src/test/util-tests/tests/dis/i386/64.avx512.out
index e8293406e6..cdaa5bb5a4 100644
--- a/usr/src/test/util-tests/tests/dis/i386/64.avx512.out
+++ b/usr/src/test/util-tests/tests/dis/i386/64.avx512.out
@@ -52,7 +52,7 @@
                        24 08 00 00 00 
     libdis_test+0x11e: 62 c1 7c c9 28 cd  vmovaps %zmm13,%zmm17{%k1}{z}
     libdis_test+0x124: 62 21 7c 4f 28 c0  vmovaps %zmm16,%zmm24{%k7}
-    libdis_test+0x12a: 62 01 7c c8 28 ec  vmovaps %zmm28,%zmm29{z}
+    libdis_test+0x12a: 62 01 7c 48 28 ec  vmovaps %zmm28,%zmm29
     libdis_test+0x130: 62 21 7c 08 28 c8  vmovaps %xmm16,%xmm25
     libdis_test+0x136: 62 e1 7c 8b 28 e7  vmovaps %xmm7,%xmm20{%k3}{z}
     libdis_test+0x13c: 62 e1 7c 28 28 c1  vmovaps %ymm1,%ymm16
@@ -64,7 +64,7 @@
                        20 00 00 00 
     libdis_test+0x164: 62 e1 7c 48 10 8c  vmovups 0x8(%rsp),%zmm17
                        24 08 00 00 00 
-    libdis_test+0x16f: 62 e1 7c c8 10 38  vmovups (%rax),%zmm23{z}
+    libdis_test+0x16f: 62 e1 7c 48 10 38  vmovups (%rax),%zmm23
     libdis_test+0x175: 62 21 7c 08 10 c8  vmovups %xmm16,%xmm25
     libdis_test+0x17b: 62 21 7c 28 10 e8  vmovups %ymm16,%ymm29
     libdis_test+0x181: 62 41 fd 4a 10 3a  vmovupd (%r10),%zmm31{%k2}
@@ -160,49 +160,49 @@
                        24 
     libdis_test+0x313: 62 e1 fe 48 6f 24  vmovdqu64 (%rsp),%zmm20
                        24 
-    libdis_test+0x31a: 62 f1 f5 88 55 d0  vandnpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x320: 62 f1 e5 88 55 20  vandnpd (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x326: 62 f1 d5 88 55 b1  vandnpd 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x31a: 62 f1 f5 89 55 d0  vandnpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x320: 62 f1 e5 89 55 20  vandnpd (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x326: 62 f1 d5 89 55 b1  vandnpd 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x330: 62 f1 f5 a8 55 d0  vandnpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x336: 62 f1 e5 a8 55 23  vandnpd (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x33c: 62 f1 d5 a8 55 b2  vandnpd 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x330: 62 f1 f5 a9 55 d0  vandnpd %ymm0,%ymm1,%ymm2{%k1}{z}
+    libdis_test+0x336: 62 f1 e5 a9 55 23  vandnpd (%rbx),%ymm3,%ymm4{%k1}{z}
+    libdis_test+0x33c: 62 f1 d5 a9 55 b2  vandnpd 0x42(%rdx),%ymm5,%ymm6{%k1}{z}
                        42 00 00 00 
     libdis_test+0x346: 62 f1 f5 48 55 d0  vandnpd %zmm0,%zmm1,%zmm2
     libdis_test+0x34c: 62 f1 e5 48 55 23  vandnpd (%rbx),%zmm3,%zmm4
     libdis_test+0x352: 62 f1 d5 48 55 b2  vandnpd 0x42(%rdx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x35c: 62 f1 74 88 55 d0  vandnps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x362: 62 f1 64 88 55 20  vandnps (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x368: 62 f1 54 88 55 b1  vandnps 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x35c: 62 f1 74 89 55 d0  vandnps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x362: 62 f1 64 89 55 20  vandnps (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x368: 62 f1 54 89 55 b1  vandnps 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x372: 62 f1 74 a8 55 d0  vandnps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x378: 62 f1 64 a8 55 23  vandnps (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x37e: 62 f1 54 a8 55 b2  vandnps 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x372: 62 f1 74 29 55 d0  vandnps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x378: 62 f1 64 29 55 23  vandnps (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x37e: 62 f1 54 29 55 b2  vandnps 0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x388: 62 f1 74 48 55 d0  vandnps %zmm0,%zmm1,%zmm2
     libdis_test+0x38e: 62 f1 64 48 55 23  vandnps (%rbx),%zmm3,%zmm4
     libdis_test+0x394: 62 f1 54 48 55 b2  vandnps 0x42(%rdx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x39e: 62 f1 f5 88 54 d0  vandpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x3a4: 62 f1 e5 88 54 20  vandpd (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x3aa: 62 f1 d5 88 54 b1  vandpd 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x39e: 62 f1 f5 89 54 d0  vandpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x3a4: 62 f1 e5 89 54 20  vandpd (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x3aa: 62 f1 d5 89 54 b1  vandpd 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x3b4: 62 f1 f5 a8 54 d0  vandpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x3ba: 62 f1 e5 a8 54 23  vandpd (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x3c0: 62 f1 d5 a8 54 b2  vandpd 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x3b4: 62 f1 f5 29 54 d0  vandpd %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x3ba: 62 f1 e5 29 54 23  vandpd (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x3c0: 62 f1 d5 29 54 b2  vandpd 0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x3ca: 62 f1 f5 48 54 d0  vandpd %zmm0,%zmm1,%zmm2
     libdis_test+0x3d0: 62 f1 e5 48 54 23  vandpd (%rbx),%zmm3,%zmm4
     libdis_test+0x3d6: 62 f1 d5 48 54 b2  vandpd 0x42(%rdx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x3e0: 62 f1 74 88 54 d0  vandps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x3e6: 62 f1 64 88 54 20  vandps (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x3ec: 62 f1 54 88 54 b1  vandps 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x3e0: 62 f1 74 89 54 d0  vandps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x3e6: 62 f1 64 89 54 20  vandps (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x3ec: 62 f1 54 89 54 b1  vandps 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x3f6: 62 f1 74 a8 54 d0  vandps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x3fc: 62 f1 64 a8 54 23  vandps (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x402: 62 f1 54 a8 54 b2  vandps 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x3f6: 62 f1 74 29 54 d0  vandps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x3fc: 62 f1 64 29 54 23  vandps (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x402: 62 f1 54 29 54 b2  vandps 0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x40c: 62 f1 74 48 54 d0  vandps %zmm0,%zmm1,%zmm2
     libdis_test+0x412: 62 f1 64 48 54 23  vandps (%rbx),%zmm3,%zmm4
@@ -256,25 +256,25 @@
     libdis_test+0x51a: 62 f1 e5 48 df 23  vpandnq (%rbx),%zmm3,%zmm4
     libdis_test+0x520: 62 f1 d5 48 df b2  vpandnq 0x42(%rdx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x52a: 62 f1 f5 88 56 d0  vorpd  %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x530: 62 f1 e5 88 56 20  vorpd  (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x536: 62 f1 d5 88 56 b1  vorpd  0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x52a: 62 f1 f5 89 56 d0  vorpd  %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x530: 62 f1 e5 89 56 20  vorpd  (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x536: 62 f1 d5 89 56 b1  vorpd  0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x540: 62 f1 f5 a8 56 d0  vorpd  %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x546: 62 f1 e5 a8 56 23  vorpd  (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x54c: 62 f1 d5 a8 56 b2  vorpd  0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x540: 62 f1 f5 29 56 d0  vorpd  %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x546: 62 f1 e5 29 56 23  vorpd  (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x54c: 62 f1 d5 29 56 b2  vorpd  0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x556: 62 f1 f5 48 56 d0  vorpd  %zmm0,%zmm1,%zmm2
     libdis_test+0x55c: 62 f1 e5 48 56 20  vorpd  (%rax),%zmm3,%zmm4
     libdis_test+0x562: 62 f1 d5 48 56 b1  vorpd  0x42(%rcx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x56c: 62 f1 74 88 56 d0  vorps  %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x572: 62 f1 64 88 56 20  vorps  (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x578: 62 f1 54 88 56 b1  vorps  0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x56c: 62 f1 74 89 56 d0  vorps  %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x572: 62 f1 64 89 56 20  vorps  (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x578: 62 f1 54 89 56 b1  vorps  0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x582: 62 f1 74 a8 56 d0  vorps  %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x588: 62 f1 64 a8 56 23  vorps  (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x58e: 62 f1 54 a8 56 b2  vorps  0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x582: 62 f1 74 29 56 d0  vorps  %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x588: 62 f1 64 29 56 23  vorps  (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x58e: 62 f1 54 29 56 b2  vorps  0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x598: 62 f1 74 48 56 d0  vorps  %zmm0,%zmm1,%zmm2
     libdis_test+0x59e: 62 f1 64 48 56 20  vorps  (%rax),%zmm3,%zmm4
@@ -328,25 +328,25 @@
     libdis_test+0x6a6: 62 f1 e5 48 ef 20  vpxorq (%rax),%zmm3,%zmm4
     libdis_test+0x6ac: 62 f1 d5 48 ef b1  vpxorq 0x42(%rcx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x6b6: 62 f1 f5 88 57 d0  vxorpd %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x6bc: 62 f1 e5 88 57 20  vxorpd (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x6c2: 62 f1 d5 88 57 b1  vxorpd 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x6b6: 62 f1 f5 89 57 d0  vxorpd %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x6bc: 62 f1 e5 89 57 20  vxorpd (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x6c2: 62 f1 d5 89 57 b1  vxorpd 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x6cc: 62 f1 f5 a8 57 d0  vxorpd %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x6d2: 62 f1 e5 a8 57 23  vxorpd (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x6d8: 62 f1 d5 a8 57 b2  vxorpd 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x6cc: 62 f1 f5 29 57 d0  vxorpd %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x6d2: 62 f1 e5 29 57 23  vxorpd (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x6d8: 62 f1 d5 29 57 b2  vxorpd 0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x6e2: 62 f1 f5 48 57 d0  vxorpd %zmm0,%zmm1,%zmm2
     libdis_test+0x6e8: 62 f1 e5 48 57 23  vxorpd (%rbx),%zmm3,%zmm4
     libdis_test+0x6ee: 62 f1 d5 48 57 b2  vxorpd 0x42(%rdx),%zmm5,%zmm6
                        42 00 00 00 
-    libdis_test+0x6f8: 62 f1 74 88 57 d0  vxorps %xmm0,%xmm1,%xmm2{z}
-    libdis_test+0x6fe: 62 f1 64 88 57 20  vxorps (%rax),%xmm3,%xmm4{z}
-    libdis_test+0x704: 62 f1 54 88 57 b1  vxorps 0x42(%rcx),%xmm5,%xmm6{z}
+    libdis_test+0x6f8: 62 f1 74 89 57 d0  vxorps %xmm0,%xmm1,%xmm2{%k1}{z}
+    libdis_test+0x6fe: 62 f1 64 89 57 20  vxorps (%rax),%xmm3,%xmm4{%k1}{z}
+    libdis_test+0x704: 62 f1 54 89 57 b1  vxorps 0x42(%rcx),%xmm5,%xmm6{%k1}{z}
                        42 00 00 00 
-    libdis_test+0x70e: 62 f1 74 a8 57 d0  vxorps %ymm0,%ymm1,%ymm2{z}
-    libdis_test+0x714: 62 f1 64 a8 57 23  vxorps (%rbx),%ymm3,%ymm4{z}
-    libdis_test+0x71a: 62 f1 54 a8 57 b2  vxorps 0x42(%rdx),%ymm5,%ymm6{z}
+    libdis_test+0x70e: 62 f1 74 29 57 d0  vxorps %ymm0,%ymm1,%ymm2{%k1}
+    libdis_test+0x714: 62 f1 64 29 57 23  vxorps (%rbx),%ymm3,%ymm4{%k1}
+    libdis_test+0x71a: 62 f1 54 29 57 b2  vxorps 0x42(%rdx),%ymm5,%ymm6{%k1}
                        42 00 00 00 
     libdis_test+0x724: 62 f1 74 48 57 d0  vxorps %zmm0,%zmm1,%zmm2
     libdis_test+0x72a: 62 f1 64 48 57 23  vxorps (%rbx),%zmm3,%zmm4
diff --git a/usr/src/test/util-tests/tests/dis/i386/64.avx512.s b/usr/src/test/util-tests/tests/dis/i386/64.avx512.s
index c7e25b7328..71dec9007f 100755
--- a/usr/src/test/util-tests/tests/dis/i386/64.avx512.s
+++ b/usr/src/test/util-tests/tests/dis/i386/64.avx512.s
@@ -10,7 +10,7 @@
  */
 
 /*
- * Copyright 2017 Joyent, Inc.
+ * Copyright 2019 Joyent, Inc.
  */
 
 /*
@@ -77,7 +77,7 @@ libdis_test:
 	vmovaps		0x8(%rsp), %zmm31
 	vmovaps		%zmm13, %zmm17{%k1}{z}
 	vmovaps		%zmm16, %zmm24{%k7}
-	vmovaps		%zmm28, %zmm29{z}
+	vmovaps		%zmm28, %zmm29
 
 	vmovaps		%xmm16, %xmm25
 	vmovaps		%xmm7, %xmm20{%k3}{z}
@@ -90,7 +90,7 @@ libdis_test:
 
 	vmovups		%zmm7, 0x20(%rbp)
 	vmovups		0x8(%rsp), %zmm17
-	vmovups		(%rax), %zmm23{z}
+	vmovups		(%rax), %zmm23
 	vmovups		%xmm16, %xmm25
 	vmovups		%ymm16, %ymm29
 
@@ -155,42 +155,42 @@ libdis_test:
 	vmovdqu32	(%rsp), %zmm20
 	vmovdqu64	(%rsp), %zmm20
 
-	vandnpd	%xmm0, %xmm1, %xmm2{z}
-	vandnpd	(%rax), %xmm3, %xmm4{z}
-	vandnpd	0x42(%rcx), %xmm5, %xmm6{z}
-	vandnpd	%ymm0, %ymm1, %ymm2{z}
-	vandnpd	(%rbx), %ymm3, %ymm4{z}
-	vandnpd	0x42(%rdx), %ymm5, %ymm6{z}
+	vandnpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandnpd	(%rax), %xmm3, %xmm4{%k1}{z}
+	vandnpd	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vandnpd	%ymm0, %ymm1, %ymm2{%k1}{z}
+	vandnpd	(%rbx), %ymm3, %ymm4{%k1}{z}
+	vandnpd	0x42(%rdx), %ymm5, %ymm6{%k1}{z}
 	vandnpd	%zmm0, %zmm1, %zmm2
 	vandnpd	(%rbx), %zmm3, %zmm4
 	vandnpd	0x42(%rdx), %zmm5, %zmm6
 
-	vandnps	%xmm0, %xmm1, %xmm2{z}
-	vandnps	(%rax), %xmm3, %xmm4{z}
-	vandnps	0x42(%rcx), %xmm5, %xmm6{z}
-	vandnps	%ymm0, %ymm1, %ymm2{z}
-	vandnps	(%rbx), %ymm3, %ymm4{z}
-	vandnps	0x42(%rdx), %ymm5, %ymm6{z}
+	vandnps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandnps	(%rax), %xmm3, %xmm4{%k1}{z}
+	vandnps	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vandnps	%ymm0, %ymm1, %ymm2{%k1}
+	vandnps	(%rbx), %ymm3, %ymm4{%k1}
+	vandnps	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vandnps	%zmm0, %zmm1, %zmm2
 	vandnps	(%rbx), %zmm3, %zmm4
 	vandnps	0x42(%rdx), %zmm5, %zmm6
 
-	vandpd	%xmm0, %xmm1, %xmm2{z}
-	vandpd	(%rax), %xmm3, %xmm4{z}
-	vandpd	0x42(%rcx), %xmm5, %xmm6{z}
-	vandpd	%ymm0, %ymm1, %ymm2{z}
-	vandpd	(%rbx), %ymm3, %ymm4{z}
-	vandpd	0x42(%rdx), %ymm5, %ymm6{z}
+	vandpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandpd	(%rax), %xmm3, %xmm4{%k1}{z}
+	vandpd	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vandpd	%ymm0, %ymm1, %ymm2{%k1}
+	vandpd	(%rbx), %ymm3, %ymm4{%k1}
+	vandpd	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vandpd	%zmm0, %zmm1, %zmm2
 	vandpd	(%rbx), %zmm3, %zmm4
 	vandpd	0x42(%rdx), %zmm5, %zmm6
 
-	vandps	%xmm0, %xmm1, %xmm2{z}
-	vandps	(%rax), %xmm3, %xmm4{z}
-	vandps	0x42(%rcx), %xmm5, %xmm6{z}
-	vandps	%ymm0, %ymm1, %ymm2{z}
-	vandps	(%rbx), %ymm3, %ymm4{z}
-	vandps	0x42(%rdx), %ymm5, %ymm6{z}
+	vandps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vandps	(%rax), %xmm3, %xmm4{%k1}{z}
+	vandps	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vandps	%ymm0, %ymm1, %ymm2{%k1}
+	vandps	(%rbx), %ymm3, %ymm4{%k1}
+	vandps	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vandps	%zmm0, %zmm1, %zmm2
 	vandps	(%rbx), %zmm3, %zmm4
 	vandps	0x42(%rdx), %zmm5, %zmm6
@@ -235,22 +235,22 @@ libdis_test:
 	vpandnq	(%rbx), %zmm3, %zmm4
 	vpandnq	0x42(%rdx), %zmm5, %zmm6
 
-	vorpd	%xmm0, %xmm1, %xmm2{z}
-	vorpd	(%rax), %xmm3, %xmm4{z}
-	vorpd	0x42(%rcx), %xmm5, %xmm6{z}
-	vorpd	%ymm0, %ymm1, %ymm2{z}
-	vorpd	(%rbx), %ymm3, %ymm4{z}
-	vorpd	0x42(%rdx), %ymm5, %ymm6{z}
+	vorpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vorpd	(%rax), %xmm3, %xmm4{%k1}{z}
+	vorpd	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vorpd	%ymm0, %ymm1, %ymm2{%k1}
+	vorpd	(%rbx), %ymm3, %ymm4{%k1}
+	vorpd	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vorpd	%zmm0, %zmm1, %zmm2
 	vorpd	(%rax), %zmm3, %zmm4
 	vorpd	0x42(%rcx), %zmm5, %zmm6
 
-	vorps	%xmm0, %xmm1, %xmm2{z}
-	vorps	(%rax), %xmm3, %xmm4{z}
-	vorps	0x42(%rcx), %xmm5, %xmm6{z}
-	vorps	%ymm0, %ymm1, %ymm2{z}
-	vorps	(%rbx), %ymm3, %ymm4{z}
-	vorps	0x42(%rdx), %ymm5, %ymm6{z}
+	vorps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vorps	(%rax), %xmm3, %xmm4{%k1}{z}
+	vorps	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vorps	%ymm0, %ymm1, %ymm2{%k1}
+	vorps	(%rbx), %ymm3, %ymm4{%k1}
+	vorps	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vorps	%zmm0, %zmm1, %zmm2
 	vorps	(%rax), %zmm3, %zmm4
 	vorps	0x42(%rcx), %zmm5, %zmm6
@@ -295,22 +295,22 @@ libdis_test:
 	vpxorq	(%rax), %zmm3, %zmm4
 	vpxorq	0x42(%rcx), %zmm5, %zmm6
 
-	vxorpd	%xmm0, %xmm1, %xmm2{z}
-	vxorpd	(%rax), %xmm3, %xmm4{z}
-	vxorpd	0x42(%rcx), %xmm5, %xmm6{z}
-	vxorpd	%ymm0, %ymm1, %ymm2{z}
-	vxorpd	(%rbx), %ymm3, %ymm4{z}
-	vxorpd	0x42(%rdx), %ymm5, %ymm6{z}
+	vxorpd	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vxorpd	(%rax), %xmm3, %xmm4{%k1}{z}
+	vxorpd	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vxorpd	%ymm0, %ymm1, %ymm2{%k1}
+	vxorpd	(%rbx), %ymm3, %ymm4{%k1}
+	vxorpd	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vxorpd	%zmm0, %zmm1, %zmm2
 	vxorpd	(%rbx), %zmm3, %zmm4
 	vxorpd	0x42(%rdx), %zmm5, %zmm6
 
-	vxorps	%xmm0, %xmm1, %xmm2{z}
-	vxorps	(%rax), %xmm3, %xmm4{z}
-	vxorps	0x42(%rcx), %xmm5, %xmm6{z}
-	vxorps	%ymm0, %ymm1, %ymm2{z}
-	vxorps	(%rbx), %ymm3, %ymm4{z}
-	vxorps	0x42(%rdx), %ymm5, %ymm6{z}
+	vxorps	%xmm0, %xmm1, %xmm2{%k1}{z}
+	vxorps	(%rax), %xmm3, %xmm4{%k1}{z}
+	vxorps	0x42(%rcx), %xmm5, %xmm6{%k1}{z}
+	vxorps	%ymm0, %ymm1, %ymm2{%k1}
+	vxorps	(%rbx), %ymm3, %ymm4{%k1}
+	vxorps	0x42(%rdx), %ymm5, %ymm6{%k1}
 	vxorps	%zmm0, %zmm1, %zmm2
 	vxorps	(%rbx), %zmm3, %zmm4
 	vxorps	0x42(%rdx), %zmm5, %zmm6
-- 
2.21.0

