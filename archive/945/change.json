{"project":"joyent/sdc-cnapi","branch":"master","id":"I148a959729c250a2a0c2a0da06423a7e1702becd","number":"945","subject":"CNAPI-679 CNAPI should use node v4.x Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"url":"https://cr.joyent.us/945","commitMessage":"CNAPI-679 CNAPI should use node v4.x\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1479950161,"lastUpdated":1480540737,"open":false,"status":"MERGED","comments":[{"timestamp":1479950161,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 1."},{"timestamp":1479950162,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 764cbd6331bd8d3ee06918d2a45d77edf1885e5a\n    \n    Fix errors, zfsTask missing req_id, moray opts\n    \n    commit 0c70dc54c9129a52931b8d76eec003649d283729\n    \n    uuid changes\n    \n    commit 287613d3cc40d5b0a09a63919eedff183dd7f3a0\n    \n    package.json\n    \n    commit d7f6e2998000e674a15ca07afcfde6448caf4849\n    \n    Update Makefile and package.json"},{"timestamp":1479950209,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480016537,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 2."},{"timestamp":1480016539,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit bf4f42e916999f6e3e8f23aee6edadbbe1621fd3\n    \n    add to bucket reset script more buckets to be reset\n    \n    commit 64868cf6be3e783ad193eae17fd60e434e48e9e5\n    \n    remove zfs test from Makefile"},{"timestamp":1480016575,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480016663,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 3."},{"timestamp":1480016664,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit b422f5d59ee58d3d2d70af4064f6179c9fad6838\n    \n    update copyright year"},{"timestamp":1480016701,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480105571,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\n(9 comments)\n\nlib/server.js\u0027s usage of queryParser should be updated per bullet \"3.\" of https://github.com/joyent/rfd/tree/master/rfd/0059#restify"},{"timestamp":1480324492,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 4."},{"timestamp":1480358166,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480375092,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(5 comments)"},{"timestamp":1480416343,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4:\n\n(9 comments)"},{"timestamp":1480416447,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 5."},{"timestamp":1480416448,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit a6e7539e34c37c790e7f6d4f003ed78185dd38bf\n    \n    mapParams, amqp explicit version, libuuid changes"},{"timestamp":1480416490,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480473509,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\n(3 comments)"},{"timestamp":1480497569,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 6."},{"timestamp":1480497570,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 3efb602d42ca0cb4890861e4592fd427e5283c44\n    \n    update dapi\n    \n    commit f1e94b0ca7d6832ad5f5350bb4b8d50426ab71d5\n    \n    fix mapParams\n    \n    commit e6fcb6e78b8da20b5711ddf1b4c413ab265fcd2c\n    \n    bump version"},{"timestamp":1480497614,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480531513,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1480536734,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 7."},{"timestamp":1480536735,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 6caafa37ccf24ad8ae015e645a1e8857694dd28c\n    \n    fix ur endpoint validation"},{"timestamp":1480536777,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1480540448,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1480540737,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Orlando Vazquez"}],"currentPatchSet":{"number":"7","revision":"148a959729c250a2a0c2a0da06423a7e1702becd","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/7","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480536734,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480536777,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1480540448,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1480540448,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1480540737,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/app.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/ur.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-28},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":38,"deletions":-38},{"file":"lib/server.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"lib/validation/endpoints.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":19,"deletions":-22},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/api/test-tasks.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/test-zfs.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/waitlist/test-waitlist-continuous.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-expiry.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"test/waitlist/test-waitlist-repeatedly.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-wait.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":206,"sizeDeletions":-161},"patchSets":[{"number":"1","revision":"be5eaf325691fbda91d96a52a2e949524b7e37f8","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/1","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1479950161,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1479950209,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":13,"deletions":-12},{"file":"lib/common.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-5},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":20,"deletions":-17},{"file":"package.json","type":"MODIFIED","insertions":10,"deletions":-13}],"sizeInsertions":150,"sizeDeletions":-74},{"number":"2","revision":"0725df6c0d6d9d2c3e3806b03f7d214f71581169","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/2","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480016537,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480016575,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":13,"deletions":-12},{"file":"lib/common.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":7,"deletions":-2},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-5},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":20,"deletions":-17},{"file":"package.json","type":"MODIFIED","insertions":10,"deletions":-13},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":2,"deletions":0}],"sizeInsertions":148,"sizeDeletions":-74},{"number":"3","revision":"db978497a76af4ec5a3ca343f0c67beb4c6e2c78","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480016663,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480016701,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/apis/moray.js","line":164,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Isn\u0027t \u0027hasCauseWithName\u0027 in the \u0027VError\u0027 *class* instead of the module?\n\nAh, I see. \u0027verror\u0027 sets \u0027VError\u0027 as its export for. Can I make a suggestion that you change cnapi code to do the following?\n\n1. call the import \"VError\" the class, instead of \"verror\" the module:\n\n    var VError \u003d require(\u0027verror\u0027);\n\n2. s/verror/VError/ in files that have that import.\n\n3. And then you can shorten \u0027verror.VError\u0027 usages to just \u0027VError\u0027.\n\nIt should make a few lines a little shorter, and the style will better match verror\u0027s docs, e.g. https://github.com/joyent/node-verror#verrorhascausewithnameerr-name"},{"file":"lib/apis/moray.js","line":164,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"lib/models/server.js","line":2386,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Cruft method now?"},{"file":"package.json","line":7,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"some minor bump that could be considered:\n\n    file                 0.2.1   0.2.1   0.2.2  file\n    jsprim               1.3.0   1.3.0   1.3.1  jsprim\n    moray                2.0.0   2.0.0   2.0.1  moray\n    nodeunit             0.9.1   0.9.1  0.10.2  nodeunit\n    once                 1.3.0   1.3.0   1.4.0  once\n    restify-validator    0.3.0   0.3.0   0.3.1  restify-validator\n    vasync               1.6.3   1.6.3   1.6.4  vasync"},{"file":"package.json","line":7,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"package.json","line":8,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is this warning of concern?\n    \n    npm WARN engine amqp@0.2.4: wanted: {\"node\":\"0.4 || 0.6 || 0.8 || 0.9 || 0.10 || 0.11 || 0.12\"} (current: {\"node\":\"4.6.1\",\"npm\":\"2.15.9\"})\n\nConsider updating to the latest amqp. The package.json in #master doesn\u0027t\nhave this \u0027engines\u0027 field anymore, FWIW.\n\nChanges from current sdc-cnapi to latest amqp are:\nhttps://github.com/postwait/node-amqp/compare/7a421793796bf66f5741282624c3db3ae266b3b5...master"},{"file":"package.json","line":8,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"package.json","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"dapi dep needs some node v4\u0027ing\n\n\u003e dtrace-provider@0.4.0 install /Users/trentm/joy/sdc-cnapi/node_modules/dapi/node_modules/bunyan/node_modules/dtrace-provider\n\u003e node scripts/install.js\n\n---------------\nBuilding dtrace-provider failed with exit code 1 and signal 0\nre-run install with environment variable V set to see the build output\n---------------"},{"file":"package.json","line":13,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Consider update of this from 0.0.0 to the current latest 1.0.1.\nThe latest actually tests with 0.12 at least. :)\n    https://github.com/substack/node-deep-equal/commit/5055802274a85a3e1493fa1b7378499554c6a4dc"},{"file":"package.json","line":13,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"package.json","line":14,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"consider updating dox\n\n    npm WARN deprecated github-flavored-markdown@1.0.1: This project is long out of date. Use \u0027marked\u0027 instead.\n\nand then validating the CNAPI docs build"},{"file":"package.json","line":14,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I\u0027ll leave this for a subsequent change"},{"file":"package.json","line":21,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps go to 4.3.0 now then we can discuss turning off the uncaughtException handler."},{"file":"package.json","line":21,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"},{"file":"package.json","line":23,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Should go to 10.0.3 for imgapi fixes (there *are* refs to imgapi in CNAPI, but I think they might be cruft now: the imgapiPeers stuff)."},{"file":"package.json","line":23,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-5},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":20,"deletions":-17},{"file":"package.json","type":"MODIFIED","insertions":10,"deletions":-13},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":154,"sizeDeletions":-80},{"number":"4","revision":"c4e93823dd61bfacd55ad494c62ccd4a285646a9","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/4","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480324492,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480358166,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/server.js","line":26,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"why adding formatters?"},{"file":"lib/server.js","line":26,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Re: queryParser/formatters change, I went to the RFD link, noticed and remembered the formatters (bullet point 1) change for the recent sdc-docker node v4 change, thought it might be prudent to make that change here too, then forgot about the queryParser change. I\u0027ll update that."},{"file":"lib/server.js","line":61,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"still not updated"},{"file":"package.json","line":8,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Use a published npm ver."},{"file":"package.json","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"still Q about sdc-designation update with node v4 support"},{"file":"package.json","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"So this\u0027ll wait for a the dapi commit, yah? After that, +1 from me. For bonus points: make a simple CHANGES.md for sdc-designation.git, make a \u0027v7.1.0\u0027 tag on that repo (perhaps doc\u0027ing in the README.md that a tag should be created for a release), then use a tag here in this package.json."},{"file":"package.json","line":14,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"still Q about dox update"},{"file":"package.json","line":14,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I\u0027d prefer to defer this for now, the documentation file (index.md) appears to have been modified manually and committed (despite the warning at the top), rather than being generated from the source files, so I would like to address that in a separate ticket before I start messing with the package. `dox` does continue to work with node v4.6.1."},{"file":"package.json","line":14,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"wfm"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/app.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-27},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":38,"deletions":-38},{"file":"lib/server.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/validation/endpoints.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":17,"deletions":-20},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-146},{"number":"5","revision":"6dc4aeab1b7da53213c246c7905e57e538b3e432","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/5","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480416447,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480416490,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/server.js","line":55,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Surely that\u0027ll break test-servers.js:\n\nfunction testListServersWithVms(t) {\n    client.get(\u0027/servers?extras\u003dvms\u0027, function (err, req, res, body) {\n\nat least. mapParams:false is not the default. By doing that you are making it so query params are *not* added to \u0027req.params\u0027, but only to \u0027req.query\u0027. lib/endpoints/servers.js#Server.list is using req.params."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/app.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-28},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":38,"deletions":-38},{"file":"lib/server.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"lib/validation/endpoints.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":17,"deletions":-20},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/api/test-tasks.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/test-zfs.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/waitlist/test-waitlist-continuous.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-expiry.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"test/waitlist/test-waitlist-repeatedly.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-wait.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":203,"sizeDeletions":-158},{"number":"6","revision":"3b94f1cf8842b0f16e6050683d9c9ceb6352e024","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/6","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480497569,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480497614,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1480531513,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1480531513,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/app.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-28},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":38,"deletions":-38},{"file":"lib/server.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"lib/validation/endpoints.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":19,"deletions":-22},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/api/test-tasks.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/test-zfs.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/waitlist/test-waitlist-continuous.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-expiry.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"test/waitlist/test-waitlist-repeatedly.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-wait.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":205,"sizeDeletions":-160},{"number":"7","revision":"148a959729c250a2a0c2a0da06423a7e1702becd","parents":["ba575c6136179f74ca16f086d1d71b9032e44e8d"],"ref":"refs/changes/45/945/7","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1480536734,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1480536777,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1480540448,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1480540448,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1480540737,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/apis/moray.js","type":"MODIFIED","insertions":14,"deletions":-13},{"file":"lib/app.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/tasks.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"lib/endpoints/ur.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/zfs.js","type":"MODIFIED","insertions":64,"deletions":-18},{"file":"lib/models/image.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/server.js","type":"MODIFIED","insertions":27,"deletions":-28},{"file":"lib/models/vm.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/models/waitlist.js","type":"MODIFIED","insertions":38,"deletions":-38},{"file":"lib/server.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"lib/validation/endpoints.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":19,"deletions":-22},{"file":"scripts/cnapi-delete-all-servers.sh","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/api/test-tasks.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/test-zfs.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/waitlist/test-waitlist-continuous.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-expiry.js","type":"MODIFIED","insertions":1,"deletions":-4},{"file":"test/waitlist/test-waitlist-repeatedly.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist-wait.js","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"test/waitlist/test-waitlist.js","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":206,"sizeDeletions":-161}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}