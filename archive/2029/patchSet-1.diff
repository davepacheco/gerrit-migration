commit 51b70ee7caee30ab8d970e78a83bfb761dee3c41 (refs/changes/29/2029/1)
Author: David Pacheco <dap@joyent.com>
Date:   2017-06-01T17:57:57-07:00 (2 years, 4 months ago)
    
    MANTA-3293 "manta-adm alarm config verify --unconfigure" crash

diff --git a/lib/alarms/update.js b/lib/alarms/update.js
index 7f383b6..529aa94 100644
--- a/lib/alarms/update.js
+++ b/lib/alarms/update.js
@@ -844,16 +844,15 @@ function amonUpdatePlanSummarize(args)
 		ntotagents = 0;
 		ntotprobes = 0;
 		plan.mup_groups_remove.forEach(function (pg) {
-			assertplus.ok(plan.mup_nremove_bygroup.hasOwnProperty(
-			    pg.pg_uuid));
 			assertplus.ok(!plan.mup_nadd_bygroup.hasOwnProperty(
 			    pg.pg_uuid));
-			nprobes = plan.mup_nremove_bygroup[pg.pg_uuid];
+			nprobes = plan.mup_nremove_bygroup.hasOwnProperty(
+			    pg.pg_uuid) ?
+			    plan.mup_nremove_bygroup[pg.pg_uuid] : 0;
 
-			assertplus.ok(plan.mup_agents_bygroup.hasOwnProperty(
-			    pg.pg_uuid));
-			nagents = Object.keys(plan.mup_agents_bygroup[
-			    pg.pg_uuid]).length;
+			nagents = plan.mup_agents_bygroup.hasOwnProperty(
+			    pg.pg_uuid) ? Object.keys(
+			    plan.mup_agents_bygroup[pg.pg_uuid]).length : 0;
 
 			fprintf(out, '%7d %7d %s\n',
 			    nprobes, nagents, pg.pg_name);
