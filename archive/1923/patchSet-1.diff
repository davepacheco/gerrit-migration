From 15d3076ffaaa936060f4ec0b17f6415d3e41652a Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Tue, 9 May 2017 13:17:26 -0700
Subject: [PATCH] TOOLS-1752 Create tool for creating Triton origin images (cr
 comments)

---
 README.md            | 3 ++-
 tools/build-image.sh | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/README.md b/README.md
index dbcdd56..7564eac 100644
--- a/README.md
+++ b/README.md
@@ -140,7 +140,8 @@ for details.
 The triton-origin images to be built are defined in
 [images.json](./images.json). This set should remain small to avoid having a
 large number of origin images in play that can increase the size of the Triton
-headnode build on the USB key; and to avoid testing/maintenance surface area.
+headnode build on the USB key; and to avoid a large testing/maintenance surface
+area.
 
 The active set of triton-origin images is defined by the Triton/Manta
 components' `image_uuid` UUID value in [MG's
diff --git a/tools/build-image.sh b/tools/build-image.sh
index eac75dc..6643a48 100755
--- a/tools/build-image.sh
+++ b/tools/build-image.sh
@@ -213,7 +213,7 @@ mput -f $buildinfoFile -H 'content-type: application/json' \
 #   proto instance was deployed.
 # - Set owner to the "not set" UUID (see IMGAPI-408), as is done by
 #   updates.joyent.com itself on import.
-imgmanifestName=$(mls $mantaUploadDir | grep '\.imgmanifest')
+imgmanifestName=$(mls $mantaUploadDir | grep '\.imgmanifest$')
 mget -o build/$imgmanifestName $mantaUploadDir/$imgmanifestName
 json -f build/$imgmanifestName -I \
     -e "this.requirements.min_platform['7.0'] = '$originMinPlatform'" \
-- 
2.21.0

