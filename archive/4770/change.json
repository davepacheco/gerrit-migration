{"project":"joyent/illumos-joyent","branch":"master","id":"I192e1e6405f98e4b0a12f9488793c5dd000f3f7e","number":"4770","subject":"OS-7175 BLOCKIF_IOV_MAX inadequate for Win2016 on bhyve Reviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Jason King \u003cjbk@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/4770","commitMessage":"OS-7175 BLOCKIF_IOV_MAX inadequate for Win2016 on bhyve\nReviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Jason King \u003cjbk@joyent.com\u003e\n","createdOn":1535657773,"lastUpdated":1536363417,"open":false,"status":"MERGED","comments":[{"timestamp":1535657773,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1535659786,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1535663004,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1535697034,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1535733170,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1535917776,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1535996831,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 2: Code-Review+1\n\nTested FreeBSD, OmniOSce and Windows 10 with this."},{"timestamp":1536076385,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1536355796,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\ntest notes added to ticket."},{"timestamp":1536358063,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1536359160,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1536359874,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1536363417,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"4","revision":"192e1e6405f98e4b0a12f9488793c5dd000f3f7e","parents":["78b5ec13e46ab3b58f3ef9d6501c98dc7e278d69"],"ref":"refs/changes/70/4770/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1536359874,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535996831,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536076385,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536358063,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"SUBM","value":"1","grantedOn":1536363417,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/bhyve/pci_virtio_block.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":27,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"f53a8cb0445ceb4f7720edb3332e7ec1af9f175b","parents":["6e567b7bf9c30262784d63ef8e2ad150be55b6c1"],"ref":"refs/changes/70/4770/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1535657773,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535697034,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/cmd/bhyve/block_if.h","line":52,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"QEMU\u0027s IOV_MAX is 1024. I\u0027d recommend using this value instead. This is what we do in HMV-846 with QEMU."},{"file":"usr/src/cmd/bhyve/block_if.h","line":52,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This is clamped by seg_max in virtio-block anyways, so pushing it to IOV_MAX doesn\u0027t buy us much today."},{"file":"usr/src/cmd/bhyve/block_if.h","line":52,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"I think there might be more info from upstream in this one too https://reviews.freebsd.org/D10581 it looks like they that broke other things?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/bhyve/pci_virtio_block.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":22,"sizeDeletions":-1},{"number":"2","revision":"662b486a906d68203d14802343fb762d8e631204","parents":["6e567b7bf9c30262784d63ef8e2ad150be55b6c1"],"ref":"refs/changes/70/4770/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1535917776,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536076385,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536358063,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535996831,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/bhyve/pci_virtio_block.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":27,"sizeDeletions":-1},{"number":"3","revision":"dad52d5ef64c6d8dc61c4756b60076fe96b2c037","parents":["78b5ec13e46ab3b58f3ef9d6501c98dc7e278d69"],"ref":"refs/changes/70/4770/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1536359160,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536076385,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536358063,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535996831,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/bhyve/pci_virtio_block.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":27,"sizeDeletions":-1},{"number":"4","revision":"192e1e6405f98e4b0a12f9488793c5dd000f3f7e","parents":["78b5ec13e46ab3b58f3ef9d6501c98dc7e278d69"],"ref":"refs/changes/70/4770/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1536359874,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536076385,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1536363417,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536358063,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1535996831,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.c","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/block_if.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/cmd/bhyve/pci_virtio_block.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":27,"sizeDeletions":-1}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}