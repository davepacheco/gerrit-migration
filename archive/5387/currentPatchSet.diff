From c9422bbeaa6b10c8d0b398f4678ccdc8877757ab Mon Sep 17 00:00:00 2001
From: Rob Johnston <rob.johnston@joyent.com>
Date: Fri, 18 Jan 2019 21:39:37 +0000
Subject: [PATCH] OS-7521 disk enumerator should make protocol/label prop
 mutable

---
 usr/src/lib/fm/topo/modules/common/disk/disk_common.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/usr/src/lib/fm/topo/modules/common/disk/disk_common.c b/usr/src/lib/fm/topo/modules/common/disk/disk_common.c
index b1ddbd06e9..8088e79f02 100644
--- a/usr/src/lib/fm/topo/modules/common/disk/disk_common.c
+++ b/usr/src/lib/fm/topo/modules/common/disk/disk_common.c
@@ -21,7 +21,7 @@
 
 /*
  * Copyright (c) 2008, 2010, Oracle and/or its affiliates. All rights reserved.
- * Copyright (c) 2018, Joyent, Inc.
+ * Copyright (c) 2019, Joyent, Inc.
  */
 
 /*
@@ -154,7 +154,8 @@ disk_set_props(topo_mod_t *mod, tnode_t *parent,
 			    "label error %s\n", topo_strerror(err));
 			goto error;
 		}
-	} else if (topo_node_label_set(dtn, label, &err) != 0) {
+	} else if (topo_prop_set_string(dtn, TOPO_PGROUP_PROTOCOL,
+	    TOPO_PROP_LABEL, TOPO_PROP_MUTABLE, label, &err) != 0) {
 		topo_mod_dprintf(mod, "disk_set_props: "
 		    "label_set error %s\n", topo_strerror(err));
 		goto error;
-- 
2.21.0

