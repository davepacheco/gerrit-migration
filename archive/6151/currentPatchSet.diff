From f9ab35ddb9cb6b17572ff5b91ac4b1108f135803 Mon Sep 17 00:00:00 2001
From: Todd Whiteman <todd.whiteman@joyent.com>
Date: Tue, 23 Apr 2019 15:18:05 -0700
Subject: [PATCH] TRITON-1628 migration provision test failing with "invalid
 networks" when no fabrics available

---
 test/vms.migrate.test.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/test/vms.migrate.test.js b/test/vms.migrate.test.js
index 75f8813..e71d383 100644
--- a/test/vms.migrate.test.js
+++ b/test/vms.migrate.test.js
@@ -167,7 +167,7 @@ exports.get_admin_fabric_network = function (t) {
 
             t.ok(networks[0], 'Admin fabric network should be found');
             if (Array.isArray(networks) && networks.length >= 1) {
-                PROVISION_NETWORKS = {uuid: networks[0].uuid};
+                PROVISION_NETWORKS = [ {uuid: networks[0].uuid} ];
             }
 
             t.done();
@@ -188,7 +188,7 @@ exports.config_setup = function configSetup(t) {
             assert.string(cfg.packageName, 'cfg.packageName');
             assert.object(cfg.vm, 'cfg.vm');
 
-            cfg.vm.networks = [PROVISION_NETWORKS];
+            cfg.vm.networks = PROVISION_NETWORKS;
 
             vasync.pipeline({funcs: [
                 function loadPackages(_, next) {
-- 
2.21.0

