{"project":"joyent/illumos-joyent","branch":"master","id":"I920ae1400e6245bf6c0ed9d43da5b20b80cbc8a3","number":"1812","subject":"OS-6044 add support for cpumap in lx_sysfs Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"url":"https://cr.joyent.us/1812","commitMessage":"OS-6044 add support for cpumap in lx_sysfs\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1492641686,"lastUpdated":1493060662,"open":false,"status":"MERGED","comments":[{"timestamp":1492641686,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 1."},{"timestamp":1492715815,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1: Code-Review+1\n\n(2 comments)\n\nJust a couple style choices."},{"timestamp":1492781053,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1492781064,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 2."},{"timestamp":1492814405,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\nI\u0027m going to upload a new patch which is merged with the changes from OS-6069."},{"timestamp":1492814455,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1492814520,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1492814947,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1492814958,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 3."},{"timestamp":1492815675,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 4."},{"timestamp":1492816998,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 5."},{"timestamp":1493054976,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1493057750,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1493060596,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1493060651,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 7: Commit message was updated."},{"timestamp":1493060662,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jerry Jelinek"}],"currentPatchSet":{"number":"7","revision":"920ae1400e6245bf6c0ed9d43da5b20b80cbc8a3","parents":["73aad7bcbbe52de3391e9d36717401faa3fbed13"],"ref":"refs/changes/12/1812/7","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493060651,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493054976,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493057750,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1493060662,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":60,"deletions":-6}],"sizeInsertions":60,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"3f2df82a471445f1ec38aa85ca25b4f8916ee5a1","parents":["ce33465b99b9a4811a15724b9822c0531560d2b5"],"ref":"refs/changes/12/1812/1","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1492641686,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492715815,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"comments":[{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1147,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This logic will get a little wonky if NCPU is not evenly divisible by 4. (Possible via mdb -kw)  Maybe just VERIFY() that for paranoia?"},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1147,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"done"},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1162,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Because we\u0027re doing this all outside of a lock, we could choose to just lxsys_uiobuf_printf directly."},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1162,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I decided to just leave this as is."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":59,"deletions":-5}],"sizeInsertions":59,"sizeDeletions":-5},{"number":"2","revision":"91509e78c8548b3f62176181820eaf66a79de2fd","parents":["ce33465b99b9a4811a15724b9822c0531560d2b5"],"ref":"refs/changes/12/1812/2","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1492781064,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492814455,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"comments":[{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1138,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Shouldn\u0027t this use NCPU?"},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","line":1138,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"That is a constant, so it couldn\u0027t be patched as per your previous comment."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":63,"deletions":-5}],"sizeInsertions":63,"sizeDeletions":-5},{"number":"3","revision":"8ab784ab43444db6a368f3e5ede7ec277101421f","parents":["6f1d54d1657b9c469ae08d5ee733e114fe36c690"],"ref":"refs/changes/12/1812/3","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1492814958,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":63,"deletions":-6}],"sizeInsertions":63,"sizeDeletions":-6},{"number":"4","revision":"32fd602d632c39032d612c73d423c6c5a0855c7d","parents":["6f1d54d1657b9c469ae08d5ee733e114fe36c690"],"ref":"refs/changes/12/1812/4","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1492815675,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":62,"deletions":-6}],"sizeInsertions":62,"sizeDeletions":-6},{"number":"5","revision":"ca9661807c5774babb35e7062afe8b9c7a611cb9","parents":["6f1d54d1657b9c469ae08d5ee733e114fe36c690"],"ref":"refs/changes/12/1812/5","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1492816998,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493054976,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493057750,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":60,"deletions":-6}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"6","revision":"a1bc8200900027e1334c194c30720ceb4af1498a","parents":["73aad7bcbbe52de3391e9d36717401faa3fbed13"],"ref":"refs/changes/12/1812/6","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493060596,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493054976,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493057750,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":60,"deletions":-6}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"7","revision":"920ae1400e6245bf6c0ed9d43da5b20b80cbc8a3","parents":["73aad7bcbbe52de3391e9d36717401faa3fbed13"],"ref":"refs/changes/12/1812/7","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1493060651,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1493060662,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1493054976,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1493057750,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/brand/lx/sysfs/lx_sysvnops.c","type":"MODIFIED","insertions":60,"deletions":-6}],"sizeInsertions":60,"sizeDeletions":-6}],"allReviewers":[{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}]}