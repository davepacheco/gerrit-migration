{"project":"joyent/illumos-joyent","branch":"master","id":"I1cb3ba547f23532c62f715007a21832205f7fdf7","number":"872","subject":"OS-1151 need support for USB v3.0 OS-5778 want usb_pipe_xopen(9F) OS-5776 usbai burst macros for endpoint descriptor are wrong OS-5367 usba_hcdi_register() should fail if driver is using private data OS-5368 failing to load the usba root hub module destro","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/872","commitMessage":"OS-1151 need support for USB v3.0\nOS-5778 want usb_pipe_xopen(9F)\nOS-5776 usbai burst macros for endpoint descriptor are wrong\nOS-5367 usba_hcdi_register() should fail if driver is using private data\nOS-5368 failing to load the usba root hub module destroys driver parent private data\nOS-5775 want ::hubd walker\nOS-5774 ::prtusb should include version\nOS-5777 usb_*_request(9S) manual pages should match structure names\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nReviewed by: Bryan Cantrill \u003cbryan@joyent.com\u003e\nApproved by: Dave Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1478798372,"lastUpdated":1481242860,"open":false,"status":"MERGED","comments":[{"timestamp":1478798372,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1478798428,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\nNotes for reviewers:\n\nFirst, thank you for reviewing this. There\u0027s a lot here. If you\u0027re\nreviewing this, I\u0027d strongly suggest you start with the file\nuts/common/io/usb/hcd/xhci/xhci.c. This contains a big theory statement\nwhich importantly has an introduction to USB from the kernel developer\u0027s\nperspective. It also has an overview to the design of the xHCI hardware.\n\nNext, there\u0027s an RFD that discusses changes to the public DDI for USBA\nthat are used for client drivers. It\u0027s worth reading this and\nunderstanding it. Also, if you spot typos on the document please update\nit! You can find it at:\n\nhttps://github.com/joyent/rfd/tree/master/rfd/0066\n\nIn addition, I started writing, but did not finish a set of manual pages\nfor the host controller driver interface (hcdi) that xhci implements.\nYou can find those manual pages here:\n\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/Intro.9e.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_alloc_hcdi_ops.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_cb.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_device_init.9e.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_dup_intr_req.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_dup_isoc_req.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_get_device_private.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hcdi_register.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hubdi_bind_root_hub.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hubdi_busops.9o.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hubdi_cb_ops.9f.html\nhttp://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/newman/usba_hubdi_dev_ops.9f.html\n\nRendered versions of all the manual pages here are available at:\nhttps://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/index.html\n\nIn terms of how to review, I\u0027d suggest starting with the xhci driver\nwhich is found in uts/common/io/usb/hcd/xhci/*, along with its primary\nheader in usr/src/uts/common/sys/usb/hcd/xhci/xhci.h.\n\nNext, I would make sure to review the rfd and the manual page changes,\nand then venture out into the core usba changes in\nusr/src/uts/common/io/usb/usba/. Once that\u0027s done, looking at the\nremaining client driver changes and the userland components probably\nmake the most sense.\n\n\nIn terms of testing, we\u0027ve done the following:\n\n - Tested all of the xhci-reroute options\n - Various USB keyboards (typed, LEDs, etc.)\n    o USB 1.1 (Dell, Daskeyboard)\n    o USB 2.0 (Sun keyboard + Integrated hub)\n - USB mouse (Just checked for device nodes)\n - USB NICs (usbgem) (Plumbed up, sent traffic, etc.)\n - Various USB Keys (vfat, ZFS, diskinfo, format, etc.)\n    o Tested at USB 2.0, 2.1, 3.0.\n - Serial (usbsprl)\n - Audio playback and recording (smoother than ehci)\n - Full, Low, High, Super speed devices tested\n - Various devices plugged into hubs\n - USB 2, 2.1, 3 HUBs, nested with Full, low, high, and super devices\n   plugged in.\n - Tested following xHCI controllers:\n     o VMware Fusion controller\n     o Fresco Logic FL1100EX\n     o Tested with Intel 8 Series/C220 series chipset\n     o Both Intel 8 / Fresco in the same machine\n     o Sunrise Point-H USB 3.0 xHCI Controller\n - Extensive use of dmod (mostly mdb, but some kmdb)\n - Pulling out a hub with many nested hubs and devices and plugging it\n   back in. Performing I/Os to devices and findleaks.\n - Verified some of the broken hcdi drivers no longer cause OS-5368 and\n   OS-5367"},{"timestamp":1478799193,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\nAlso, links to specifications:\n\nxhci - http://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/specs/xhci.pdf\nUSB 3.1 - http://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/specs/USB_3_1_r1.0.pdf\nehci - http://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/specs/ehci.pdf\nUSB 2.0 - http://us-east.manta.joyent.com/rmustacc/public/webrevs/xhci/specs/usb_20.pdf"},{"timestamp":1478813220,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(12 comments)\n\nFirst set of copy-edits to the BTS."},{"timestamp":1479248018,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(28 comments)"},{"timestamp":1479424001,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(24 comments)"},{"timestamp":1479483405,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(15 comments)\n\nnext set of comments"},{"timestamp":1479504132,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1: Code-Review-1\n\n(2 comments)"},{"timestamp":1479505061,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(3 comments)\n\nThis is an impressive piece of work, nice job! I have completed my initial round of review. The majority of my input can be considered nits."},{"timestamp":1479763291,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(35 comments)"},{"timestamp":1479777820,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(12 comments)"},{"timestamp":1479880714,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2."},{"timestamp":1479880999,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2: -Code-Review\n\n(131 comments)"},{"timestamp":1479919121,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(32 comments)"},{"timestamp":1479929365,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3."},{"timestamp":1479929432,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(31 comments)"},{"timestamp":1479943703,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 3: Code-Review+1\n\nIt looks like all of my comments have been addressed. Again, nice job on such a huge project!"},{"timestamp":1479950359,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\n(7 comments)"},{"timestamp":1480031708,"reviewer":{"name":"Toomas Soome","email":"tsoome@me.com","username":"tsoome"},"message":"Patch Set 3:\n\n(1 comment)\n\nYou also may want to check:\nhttp://src.illumos.org/source/xref/illumos-gate/usr/src/uts/i86pc/io/immu.c#259 http://src.illumos.org/source/xref/illumos-gate/usr/src/uts/i86pc/io/consplat.c#122"},{"timestamp":1480370403,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 3:\n\n(19 comments)\n\nIn general, I think this looks great -- terrific work!  I did manage to find one actual bug (in xhci_usba.c) but my other comments are total nits; feel free to disregard as you see fit.  Great work on this, and looking forward to seeing it integrated!"},{"timestamp":1480714710,"reviewer":{"name":"Piotr Jasiukajtis","email":"estibi@me.com","username":"estibi"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1480718533,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 4."},{"timestamp":1480718573,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4:\n\n(29 comments)"},{"timestamp":1480718682,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4:\n\nThis most recent change covers a large number of fixes and issues that we\u0027ve encountered in the field. Particularly some deadlocks from the quiesce path (not properly signaling), not properly handling some of the BIOS clearing, redoing how we handle the port status change notifications which eliminates a class of ports that don\u0027t immediately function, and more."},{"timestamp":1480880595,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 5."},{"timestamp":1480961367,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 5: Code-Review+1\n\nLooks great!"},{"timestamp":1480966452,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1480966560,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(4 comments)"},{"timestamp":1481154577,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 6."},{"timestamp":1481154589,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(4 comments)"},{"timestamp":1481156929,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1481159833,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6: Code-Review+1\n\nNice job, Robert."},{"timestamp":1481233979,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6:\n\nSome updated testing notes:\n\n - Tested all of the xhci-reroute options\n - Manually tested operating with INTx and MSI interrupts (all the rest\n   of the testing was done with MSI-X)\n - Various USB keyboards (typed, LEDs, etc.)\n    o USB 1.1 (Dell, Daskeyboard)\n    o USB 2.0 (Sun keyboard + Integrated hub)\n - USB mouse (Just checked for device nodes)\n - USB NICs (usbgem) (Plumbed up, sent traffic, etc.)\n - Various USB Keys (vfat, ZFS, diskinfo, format, etc.)\n    o Tested at USB 2.0, 2.1, 3.0.\n - Serial (usbsprl)\n - Audio playback and recording (smoother than ehci)\n - Full, Low, High, Super speed devices tested\n - Various devices plugged into hubs\n - USB 2, 2.1, 3 HUBs, nested with Full, low, high, and super devices\n   plugged in.\n - Tested following xHCI controllers:\n     o VMware Fusion controller\n     o Fresco Logic FL1100EX\n     o Tested with Intel 8 Series/C220 series chipset\n     o Both Intel 8 / Fresco in the same machine\n     o Sunrise Point-H USB 3.0 xHCI Controller\n     o Intel Celeron N2000 Series USB xHCI (Toomas)\n     o xHCI 0.96 support - NEC Corporation uPD720200 USB 3.0 Host Controller \n     o Renesas Technology Corp. uPD720202 USB 3.0 Host Controller \n     o xhci on prototype chipsets\n - Extensive use of dmod (mostly mdb, but some kmdb)\n - Pulling out a hub with many nested hubs and devices and plugging it\n   back in. Performing I/Os to devices and findleaks.\n - Pulling devices after starting zpool creates on them, to simulate \n   drive failure and recovery\n - Verified some of the broken hcdi drivers no longer cause OS-5368 and\n   OS-5367"},{"timestamp":1481238662,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1481241911,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1481242614,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1481242727,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1481242860,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"8","revision":"1cb3ba547f23532c62f715007a21832205f7fdf7","parents":["83390469eaf76687ae434504ed3e41fdbe4ae3b6"],"ref":"refs/changes/72/872/8","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1481242727,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481156929,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481159833,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481238662,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481241911,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"SUBM","value":"1","grantedOn":1481242860,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":18,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1963,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14321,"sizeDeletions":-1082},"patchSets":[{"number":"1","revision":"d0be42c9828e0390ab02eceb4be12dfad3bbb1b1","parents":["9a6eb06b470e9c1d8649210d4e7e79c603bf4cf0"],"ref":"refs/changes/72/872/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1478798372,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1479504132,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":621,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"missing space after \"the\""},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":621,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":677,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"should this check be moved up to before line 671 and then the check at 671 be modified so it doesn\u0027t re-check !slot_set?"},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":677,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, it turns out that I think we can just delete the check at 671 with this."},{"file":"usr/src/pkg/manifests/driver-usb.mf","line":60,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Note to self: This is missing the fixes from Dan and Toomas to make sure we have the right group."},{"file":"usr/src/pkg/manifests/driver-usb.mf","line":60,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":56,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"s/where as/whereas/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":56,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":366,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Made up of what?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":366,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":371,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Should there be a sentence about the second part?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":371,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":380,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"tense error"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":380,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":395,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This is a little awkward and could stand to be rewritten."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":395,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":481,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This seems a little repeated?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":481,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":503,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":503,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Add comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":503,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":503,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":504,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/until we need to, to/until they are needed, to/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":504,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":507,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/set up/setup/?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":507,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":520,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/int/in/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":520,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":639,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"s/or/for/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":639,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":657,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/either/other/?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":657,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":661,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"May wish to upgrade to the stronger \u0027never\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":661,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":758,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/ors/ORs/ perhaps"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":758,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1068,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Worth going to \u0027unsigned int\u0027 to avoid overflow issues?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1068,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Really should probably just VERIFY that tries \u003e\u003d 0 with an int, but I\u0027ve changed this to a uint_t."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1097,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/regsister/register/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1097,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1115,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"extra space"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1115,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1203,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Is this the right format (with a 0.NN)? The comment  above makes it sound like the version we don\u0027t support is 1.0 or 1.1."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1203,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This is a note to myself, that the format there is correct; however, it should be a %x value. The comment does need to be clarified, as we actually don\u0027t support *old* versions of the spec."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1203,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1203,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1355,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"A comment describing this function would be nice."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1355,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve put something together to try and cover this. Let me know if that\u0027s sufficient."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1413,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why not initialize in the definition?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1413,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1495,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Am I misunderstanding this, or are we waiting for the BIOS_OWNED bit to reappear in the register?  That seems odd."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1495,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Good catch, thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1558,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Out of convention or specification?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1558,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s specification plus some more. I added a comment describing it."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1696,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Are there plans to implement actual runtime reset logic here?  It would be nice to have short explanation of why the panic()."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1696,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1696,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"There are, I\u0027ve added a comment to make that more explicit."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1696,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1725,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"following up on Patrick\u0027s comment, we\u0027re going to panic under this condition?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1725,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, that\u0027s correct based on what exists right now."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":2000,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Consistency between \u0027\u003d\u003d B_FALSE\u0027 and \u0027!\u003d B_TRUE\u0027 would be nice here."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":2000,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":2003,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Are the stop/reset/configure actions the convention for controller initialization?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":2003,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Well, yes and no. They aren\u0027t explicit things that are here. However, it matches what we\u0027d do. And importantly in the land where we don\u0027t properly panic under resets, we\u0027d then do a controller reset and a controller configure again. Basically controller_configure() is supposed to do everything that\u0027s required after the controller has been reset and we need to deal with the rest of the initialization."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","line":28,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"use 0 instead of false"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","line":28,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":28,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I would nix \u0027However,\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":28,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":32,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"comma after \u0027CV\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":32,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think it reads fine without."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":56,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This diagram is lovely."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":56,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I agree with Patrick about the diagram, but it seems at odds with the comment above for ABORT_DONE, which states that you transition back to running. The diagram shows us going back to idle. I am not sure if the comment should just be modified slightly? Do we only leave idle when a command is enqueued?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":56,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":56,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The image is right, but the comment is wrong. I\u0027ve fixed the comment."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":101,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nix \u0027basically\u0027?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":101,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":111,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"\"for calls to the command routines to be made while\" perhaps"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":111,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":122,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Worth a \u0027_us\u0027 suffix?  I\u0027m not sure what the overall convention is for such a thing."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":122,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Not sure it really is."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":128,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Any reason to for these to be signed types?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":128,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve changed it to match the requirement for drv_usectohz which is a clock_t. It looks like the clock_t is still signed though; however, at least we get out of any type coercion."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":207,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If this race is odd enough for the given comment, is it worth tracking in a private little counter?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":207,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t know, I\u0027ve mostly done this for defensive reasons. I\u0027ve eliminated the comment for now."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":281,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Make this unsigned?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":281,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Changed to clock_t to match drv_usectohz."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":319,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This sentence could use some rework (double \u0027indicates, missing comma)"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":319,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":337,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nix \u0027So\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":337,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":430,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nix \u0027due\u0027 probably?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":430,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":431,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/tat/that/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":431,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":488,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Even though it will evaluate the same, I think it might make sense to OR in XHCI_TRB_SET_SLOT(0).  Up to you."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":488,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":488,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":488,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"That macro doesn\u0027t make sense here. That\u0027s trying to set a slot ID as opposed to the type. The SET_SLOT macro modifies bits that are reserved to zero. However, I\u0027ve gone ahead and added a macro to cover this case."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","line":32,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: newline between variable declarations and logic?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","line":32,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","line":93,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"if you fail to allocate memory partway through this loop, won\u0027t the _fini code attempt to free all of the pages? What happens when it gets to the point where you didn\u0027t allocate?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","line":93,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, in this case, the contents of xsp_scractch_dma are all initialized to zero. The xhci_dma_free function is designed to handle a partially constructed or properly initialized (aka zeroed) structure. So what\u0027ll end up happening here is that we\u0027ll end up calling into xhci_dma_free() with everything initialized to zero for those additional pages.\n\nBecause this may be a bit confusing, I\u0027ll leave a comment explaining why this is safe."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":92,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"two maximums"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":92,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":144,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"attributes"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":144,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":239,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Shouldn\u0027t this be using memcb like above?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":239,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, it should."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":438,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"incomplete sentence"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","line":438,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":41,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nix \u0027However\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":41,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":49,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Related to the comment in xhci.h, perhaps make this uint_t?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":49,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":92,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Make this a uint_t?  Some of the later manipulations might get it up closer to overflow."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":92,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":402,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"a little *more* fluid?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":402,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":403,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"minimum"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":403,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":596,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Isn\u0027t an xhci_ring_free needed here?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":596,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, it is."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":650,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"s/do/due/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":650,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":982,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"message"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":982,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1016,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Dangerously shares name with the xhci_transfer_t in the parent scope.  uint_t would be more consistent with the values it\u0027s accessing"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1016,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1175,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"mean"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1175,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1378,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps move this assignment into the preceding \u0027if\u0027 conditional evaluation."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1378,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1403,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Drop the \u0027however\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1403,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1464,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"so if you get to this point, you don\u0027t call mutex_exit on xhci_lock. It looks like that is what the following comment means, but I am confused about this behavior. What does it mean to \"call back into USBA\" and where is the mutex exited?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1464,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"In this case all of the *_callback functions end up dropping the lock. So I\u0027ll go through and clarify this comment so that it makes more sense."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":90,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"is it ok to return here and at line 107 doing any cleanup on the alloc from line 85?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":90,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, we need to do the clean up functions in both cases. Thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":196,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/restting/resetting/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":196,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":27,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"s/where as/whereas/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":27,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":28,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"*as a"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":28,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":29,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"insert comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":29,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":163,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"remore we"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":163,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":726,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"\u0027momemnt\u0027, and phasing is awkward.  perhaps \"For the moment, we mimic ehci\u0027s behavior and generate an event.\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":726,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":787,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Shouldn\u0027t this be \u0027|\u003d\u0027 ?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":787,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","line":185,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"The block comment notes that the INTR_PENDING bit is not automatically cleared for fixed interrupts.  In that case, is it necessary to clear it from the field before writing back out to the register?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","line":185,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, because this is a write one to clear register."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","line":45,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"query_quirks or populate_quirks might be a little more descriptive for this function"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","line":45,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":55,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I think this could be clarified a bit, particularly given the usage of \u0027we\u0027 and \u0027us\u0027.  Explicit description of when the cycle bits are examined/toggled and by who (the controller, the kernel, both?) would help, I think."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":55,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve rewritten a large chunk of this section. I hope it makes more sense."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":102,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"The \u0027graph started referencing the transfer ring.  Is it really the event ring which requires the tail update?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":102,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah. The earlier references to transfer ring in this paragraph were incorrect."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":225,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Use \u0027uint_t\u0027 for consistency."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":225,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":254,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":254,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":256,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":256,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":283,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t, probably?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":283,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":288,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":288,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":298,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why is this a for-loop rather than a comparison and some assignments?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":298,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I just found this simpler to reason about."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":327,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":327,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":329,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":329,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":431,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"uint_t"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":431,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":45,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"In theory what?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":45,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":114,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":114,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":125,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"don\u0027t you need to fee the pipe here?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":125,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":131,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"don\u0027t you have to free the pipe here?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":131,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":140,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":140,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":141,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"This comment is kind of hard to understand."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":141,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":320,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"You\u0027re returning with the mutex still held"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":320,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Good catch."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":997,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"drivers or \"a driver that does\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":997,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1093,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"is it ok to return in this path without calling mutex_exit? Other error returns have already released the mutex."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1093,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah it was. The function was designed such that it should actually be returning with a lock held.\n\nHowever, I found this to be too confusing. So I rearranged things in a few places to make the lock ordering more explicit. Therefore this function now acquires and releases the lock on its own."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1259,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"you return here without exiting the mutex"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1259,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Good catch, thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1356,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"whereas"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1356,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1361,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"device"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1361,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/basically//"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1361,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1361,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1591,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"context"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1591,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1717,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"should"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1717,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1719,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/its/it/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1719,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1923,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"do you need to deallocate ops here?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1923,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, we do."},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":2220,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"do you have to exit the mutex here?"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":2220,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, I don\u0027t think so. If you look at the start of this function, we come in and assert that we have the mutex held. Therefore the invariant is that this function needs to return with the mutex held. If you look down below, we do the same thing when we return through the normal path."},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":3368,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Merge the trailing sentence fragment and s/Where as/whereas/"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":3368,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4774,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"this comment isn\u0027t clear"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4774,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Agreed, it could use some re-work."},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4774,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4774,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":5500,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Needs a colon (or at least a comma)"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":5500,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/usba.c","line":683,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"awkward phrasing (kind of begs the question \"no longer what?\")"},{"file":"usr/src/uts/common/io/usb/usba/usba.c","line":683,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/usba.c","line":2277,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Probably doesn\u0027t need to be cargo-copied."},{"file":"usr/src/uts/common/io/usb/usba/usba.c","line":2277,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","line":832,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Probably nix this (despite how agitating things might be)"},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","line":832,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":51,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps a little too conversational for a header comment."},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":51,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":52,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Needs a comma somewhere"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":52,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":54,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/trd/TRD/ for consistent caps"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":58,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Commas are a mess here."},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":58,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":112,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"lots of repetition here"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":112,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":129,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":129,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":131,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":131,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":156,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"not based?"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":156,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":164,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Not a fan of apostrophe-s for type multiples.  Something like \"xhch_transfer_t instances\" is a little cleaner, IMO."},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":164,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":242,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":242,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":438,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":438,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":493,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Make these \u0027uint_t\u0027?"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":493,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","line":281,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It might be nice to include MASK in the name given its interaction with the reserved bits which is slightly misleading at first glance."},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","line":281,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","line":139,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Sentence fragment"},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","line":139,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","line":425,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Append a comma, at least.  The sentence as a whole is a little awkward."},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","line":425,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve tried to make this a bit clearer. Let me know if that\u0027s better or not."},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","line":90,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Capitalize?"},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","line":90,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I capitalized the first character, though I wasn\u0027t sure if you wanted the rest. Most of the rest of this seems to be lower case unfortunately."},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","line":90,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yep, that\u0027s adequate."},{"file":"usr/src/uts/common/sys/usb/usbai.h","line":1077,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I think it would be clearer to change this to say usb_pipe_open, since both endpoints look like they are discussed in this comment"},{"file":"usr/src/uts/common/sys/usb/usbai.h","line":1077,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":898,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":35,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2200,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":847,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":243,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":538,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1490,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":223,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":876,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":438,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1934,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":536,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":24,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":94,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":794,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":519,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":105,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14192,"sizeDeletions":-1079},{"number":"2","revision":"e5f6ccf43bf68119186566ff65c2257c9f1745c4","parents":["0e094404f4a199a440ac665b3442f89891352798"],"ref":"refs/changes/72/872/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1479880714,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":506,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"*minimizes"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":506,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1200,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"plural mess, probably switch to something like \"versions which precede it\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1200,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1357,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"quote \u0027init\u0027, perhaps tweak to something like \"The \u0027init\u0027 parameter\" so the sentence can be capitalized"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1357,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"quote \u0027id\u0027?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1357,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1357,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1704,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1704,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1705,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"delete"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1705,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1707,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"we don\u0027t \"end up\" panicking, we panic."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1707,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":318,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":318,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1406,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1406,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I instead removed the so, which I think made you want the comma."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1470,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/end up dropping/drop/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":1470,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":29,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/One gotcha is/It is critical/"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":29,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":29,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"*case"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":29,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":29,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":29,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":30,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nix \u0027however\u0027, turn it into a full stop.  \"...the producer.  For the event ring...\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":30,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":54,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This either needs a preceding comma, or should be moved up to \u0027This can potentially be\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":54,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"segment"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":54,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":72,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"*except"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":72,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":102,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nix \u0027Now\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":102,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":107,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nix Now"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":107,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":108,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"maybe prepend \u0027of\u0027"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","line":108,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1731,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":1731,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":3367,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":3367,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4771,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"hcd is capitalized elsewhere"},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","line":4771,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":51,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":51,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":62,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"proven? proved?"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":62,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":62,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":62,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":63,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"omit \u0027class\u0027?"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":63,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I was referring explicitly to the set of USB class drivers, but I\u0027ll remove it."},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":111,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":111,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":111,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":111,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":156,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"omit \u0027really\u0027"},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","line":156,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","line":427,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Still pretty awkward.  Consider: \"USB 3.x devices have the notion of a \u0027route\u0027 which describes the series of hubs which must be passed through to reach a given device.  This route string has support...\""},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","line":427,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2213,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":226,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":880,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1953,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":94,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":794,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":521,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14275,"sizeDeletions":-1079},{"number":"3","revision":"7d0da8056402108bd3ef895e4af63288fedbe28f","parents":["0e094404f4a199a440ac665b3442f89891352798"],"ref":"refs/changes/72/872/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1479929365,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1479943703,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"comments":[{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":452,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Worth a macro to perform this shift?"},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":452,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I added one."},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":621,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"\"intput\""},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","line":621,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man7d/hubd.7d","line":308,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"cascaded"},{"file":"usr/src/man/man7d/hubd.7d","line":308,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man7d/hubd.7d","line":312,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Definite article required here? It reads easier for me as \"USB 3.0 has...\" instead of \"The USB 3.0 has...\""},{"file":"usr/src/man/man7d/hubd.7d","line":312,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, it shouldn\u0027t be there. Probably a remnant of a past revision."},{"file":"usr/src/man/man7d/usba.7d","line":103,"reviewer":{"name":"Piotr Jasiukajtis","email":"estibi@me.com","username":"estibi"},"message":"why it\u0027s removed?"},{"file":"usr/src/man/man7d/usba.7d","line":103,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"As was previously discussed in #illumos, this was removed because it didn\u0027t actually provide any value to folks who use illumos. Almost all systems we support are PCI based these days, even if they support older systems."},{"file":"usr/src/man/man7d/usba.7d","line":116,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Universal"},{"file":"usr/src/man/man7d/usba.7d","line":116,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","line":63,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","line":63,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","line":65,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Is this the desired phrasing?"},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","line":65,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","line":84,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/Sample/Example/ if you want to avoid the sample-\u003eaudio pun"},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","line":84,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This is from usb_pipe_open(9F). Everything here uses Sample to describe this, so I\u0027m going to leave it."},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","line":71,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/So a/A/"},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","line":71,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","line":72,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"that"},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","line":72,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":139,"reviewer":{"name":"Piotr Jasiukajtis","email":"estibi@me.com","username":"estibi"},"message":"typo?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":139,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve removed the second then which I think makes that sentence flow better."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":311,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Hyper-nit: \"which\" should be \"that\" in this context -- it\u0027s a subordinate clause."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":311,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":380,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Subject/verb agreement: singular driver or \"open and close\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":380,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1361,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Should this be returning a boolean_t?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1361,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, it should. This was missed when I refactored. Thanks."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1496,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Should be \"de facto\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1496,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1599,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Worth making a global variable to allow this to be tunable?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","line":1599,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Sure, might as well."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":349,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Does the invariant need to be asserted here given that the lock is being dropped -- or do know that the xcr_state can\u0027t change while the lock is dropped?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":349,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Because of the way this is built, it shouldn\u0027t be possible that we can violate it. At least, in theory. If we\u0027re timing it out, then there shouldn\u0027t be a way that we can get to a point where we\u0027re now going to abort something."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":457,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Should be \"USB_SUCCESS\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","line":457,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":42,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Space between \"ep\" and 1?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":42,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":103,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"\"necessarily\""},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":103,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":548,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Capital \"I\" on \"initialize\"?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":548,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":985,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"\"trbs\" -\u003e \"TRBs\"?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","line":985,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":64,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"This is a stylistic issue, but for routines that return a boolean_t, I generally use the language to check for true or false -- i.e., using \"!xhci_dma_alloc()\" instead of \"xhci_dma_alloc() \u003d\u003d B_FALSE\".  I\u0027m especially likely to use this when it will reduce the number of lines in the expression. ;)"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","line":64,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":348,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"This doesn\u0027t quite parse -- what does \"write one to clear\" mean?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":348,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":82,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"This is a spurious drop of xhci_lock -- we already dropped it on L70."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":82,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":497,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Presuming it\u0027s safe to hold xd_imtx across this untimeout(), probably worth mentioning that in the comment at L493..."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":497,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It is, I updated the general big theory statement as well."},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","line":832,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"\"conses\"? Dunno."},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","line":832,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I rephrased this a bit to try and make it a bit clearer and have less uncertain language."},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","line":92,"reviewer":{"name":"Toomas Soome","email":"tsoome@me.com","username":"tsoome"},"message":"Perhaps it would be better:\nBoth the basic and the extended endpoint are kept around..."},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","line":92,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2212,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":226,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":880,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1953,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":94,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":794,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":521,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14274,"sizeDeletions":-1079},{"number":"4","revision":"153fb90c24c09c4027592a4ee7fb195d8175e3d0","parents":["47ab409f7a3750d5ecf595f817d5356ed89f5e43"],"ref":"refs/changes/72/872/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1480718533,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":607,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"should this be capitalized?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","line":607,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":358,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Is there a pressing reason to do the cv_broadcast after having dropped xhci_lock?  Is there any possibility that the endpoint may be destroyed before the cv_broadcast?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":358,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"In general there shouldn\u0027t be many threads that are waiting on this, so we shouldn\u0027t have a thundering herd. In general I try to do the broadcast outside of the lock to make sure that we don\u0027t just have a herd of threads woken up to just be blocked in the lock.\n\nRegarding the endpoint being destroyed. Given where we are, I don\u0027t believe so. However, it is fair that this isn\u0027t the best trodden ground in the code and we don\u0027t have a great way of guaranteeing it.\n\nSo, in that case, I\u0027ll move the different cases of this back inside."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":379,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Same concern as above regarding the endpoint lifetime."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":379,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"See above."},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":602,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"The double-broadcast seems rather strage.  Care to add more detail about it?"},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","line":602,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s an error. That one shouldn\u0027t be there."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1967,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14325,"sizeDeletions":-1082},{"number":"5","revision":"424567cbc970e57cf3b34f3c89e4b88282ff5127","parents":["47ab409f7a3750d5ecf595f817d5356ed89f5e43"],"ref":"refs/changes/72/872/5","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1480880595,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1480961367,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1480966452,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1967,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14325,"sizeDeletions":-1082},{"number":"6","revision":"d54c0eda2e0facc68d30f83dcf655895713ec97d","parents":["c180fecb1d3e6f21a8453964dd4f3b5e4acce56c"],"ref":"refs/changes/72/872/6","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1481154577,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481238662,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481241911,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481156929,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481159833,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1963,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14321,"sizeDeletions":-1082},{"number":"7","revision":"4917e78148fb510cf4810b459aab8a47cc494d6a","parents":["83390469eaf76687ae434504ed3e41fdbe4ae3b6"],"ref":"refs/changes/72/872/7","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1481242614,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481238662,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481241911,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481156929,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481159833,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":14,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1963,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14321,"sizeDeletions":-1082},{"number":"8","revision":"1cb3ba547f23532c62f715007a21832205f7fdf7","parents":["83390469eaf76687ae434504ed3e41fdbe4ae3b6"],"ref":"refs/changes/72/872/8","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1481242727,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1481238662,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1481242860,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481241911,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481156929,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1481159833,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":18,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/Makefile.common","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/kmdb/mapfile_skel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/conf/mapfile-extern","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/usba/prtusb.c","type":"MODIFIED","insertions":33,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/usba/usb.c","type":"MODIFIED","insertions":77,"deletions":-6},{"file":"usr/src/cmd/mdb/common/modules/xhci/xhci.c","type":"ADDED","insertions":893,"deletions":0},{"file":"usr/src/cmd/mdb/intel/amd64/xhci/Makefile","type":"ADDED","insertions":27,"deletions":0},{"file":"usr/src/cmd/mdb/intel/ia32/xhci/Makefile","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/cmd/xhci/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/cmd/xhci/xhci_portsc.c","type":"ADDED","insertions":373,"deletions":0},{"file":"usr/src/common/pci/pci_strings.c","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/man/man1m/cfgadm_usb.1m","type":"MODIFIED","insertions":6,"deletions":-11},{"file":"usr/src/man/man7d/hubd.7d","type":"MODIFIED","insertions":18,"deletions":-9},{"file":"usr/src/man/man7d/ugen.7d","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/man/man7d/usba.7d","type":"MODIFIED","insertions":166,"deletions":-173},{"file":"usr/src/man/man9f/Makefile","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/man/man9f/usb_client_attach.9f","type":"MODIFIED","insertions":2,"deletions":-12},{"file":"usr/src/man/man9f/usb_ep_xdescr_fill.9f","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/man/man9f/usb_get_addr.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_cfg.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_get_dev_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_lookup_ep_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_parse_data.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_bulk_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_close.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_ctrl_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_get_state.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_intr_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_isoc_xfer.9f","type":"MODIFIED","insertions":2,"deletions":-13},{"file":"usr/src/man/man9f/usb_pipe_open.9f","type":"DELETED","insertions":0,"deletions":-373},{"file":"usr/src/man/man9f/usb_pipe_reset.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_set_private.9f","type":"MODIFIED","insertions":2,"deletions":-10},{"file":"usr/src/man/man9f/usb_pipe_xopen.9f","type":"ADDED","insertions":299,"deletions":0},{"file":"usr/src/man/man9f/usb_reset_device.9f","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/man/man9s/Makefile","type":"MODIFIED","insertions":38,"deletions":-9},{"file":"usr/src/man/man9s/usb_bulk_req.9s","fileOld":"usr/src/man/man9s/usb_bulk_request.9s","type":"RENAMED","insertions":2,"deletions":-6},{"file":"usr/src/man/man9s/usb_client_dev_data.9s","type":"MODIFIED","insertions":3,"deletions":-9},{"file":"usr/src/man/man9s/usb_ctrl_req.9s","fileOld":"usr/src/man/man9s/usb_ctrl_request.9s","type":"RENAMED","insertions":1,"deletions":-6},{"file":"usr/src/man/man9s/usb_ep_ss_comp_descr.9s","type":"ADDED","insertions":122,"deletions":0},{"file":"usr/src/man/man9s/usb_ep_xdescr.9s","type":"ADDED","insertions":117,"deletions":0},{"file":"usr/src/man/man9s/usb_intr_req.9s","fileOld":"usr/src/man/man9s/usb_intr_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/man/man9s/usb_isoc_req.9s","fileOld":"usr/src/man/man9s/usb_isoc_request.9s","type":"RENAMED","insertions":1,"deletions":-1},{"file":"usr/src/pkg/manifests/driver-usb.mf","type":"MODIFIED","insertions":37,"deletions":-5},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/Makefile.rules","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/consconfig_dacf.c","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/io/usb/clients/hid/hid.c","type":"MODIFIED","insertions":16,"deletions":-17},{"file":"usr/src/uts/common/io/usb/hcd/ehci/ehci_hub.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.c","type":"ADDED","insertions":2235,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci.conf","type":"ADDED","insertions":31,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_command.c","type":"ADDED","insertions":848,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_context.c","type":"ADDED","insertions":251,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_dma.c","type":"ADDED","insertions":535,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_endpoint.c","type":"ADDED","insertions":1495,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_event.c","type":"ADDED","insertions":224,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_hub.c","type":"ADDED","insertions":881,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_intr.c","type":"ADDED","insertions":193,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_quirks.c","type":"ADDED","insertions":78,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_ring.c","type":"ADDED","insertions":444,"deletions":0},{"file":"usr/src/uts/common/io/usb/hcd/xhci/xhci_usba.c","type":"ADDED","insertions":1963,"deletions":0},{"file":"usr/src/uts/common/io/usb/scsa2usb/scsa2usb.c","type":"MODIFIED","insertions":33,"deletions":-10},{"file":"usr/src/uts/common/io/usb/usba/hcdi.c","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/hubdi.c","type":"MODIFIED","insertions":535,"deletions":-212},{"file":"usr/src/uts/common/io/usb/usba/usba.c","type":"MODIFIED","insertions":23,"deletions":-3},{"file":"usr/src/uts/common/io/usb/usba/usba_ugen.c","type":"MODIFIED","insertions":21,"deletions":-5},{"file":"usr/src/uts/common/io/usb/usba/usbai_pipe_mgmt.c","type":"MODIFIED","insertions":93,"deletions":-8},{"file":"usr/src/uts/common/io/usb/usba/usbai_register.c","type":"MODIFIED","insertions":97,"deletions":-1},{"file":"usr/src/uts/common/os/policy.c","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/common/os/printf.c","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/sys/cmn_err.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/common/sys/pci.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/policy.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/clients/hid/hidvar.h","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE","type":"ADDED","insertions":24,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/THIRDPARTYLICENSE.descrip","type":"ADDED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci.h","type":"ADDED","insertions":799,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhci_ioctl.h","type":"ADDED","insertions":56,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hcd/xhci/xhcireg.h","type":"ADDED","insertions":523,"deletions":0},{"file":"usr/src/uts/common/sys/usb/hubd/hub.h","type":"MODIFIED","insertions":106,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/hubd/hubdvar.h","type":"MODIFIED","insertions":21,"deletions":-3},{"file":"usr/src/uts/common/sys/usb/scsa2usb/scsa2usb.h","type":"MODIFIED","insertions":14,"deletions":-6},{"file":"usr/src/uts/common/sys/usb/usba/hcdi.h","type":"MODIFIED","insertions":37,"deletions":-4},{"file":"usr/src/uts/common/sys/usb/usba/hubdi.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usba/usba_types.h","type":"MODIFIED","insertions":30,"deletions":-1},{"file":"usr/src/uts/common/sys/usb/usba/usba_ugend.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/sys/usb/usbai.h","type":"MODIFIED","insertions":111,"deletions":-13},{"file":"usr/src/uts/i86pc/io/consplat.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/uts/i86pc/io/immu.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/intel/xhci/Makefile","type":"ADDED","insertions":50,"deletions":0}],"sizeInsertions":14321,"sizeDeletions":-1082}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Toomas Soome","email":"tsoome@me.com","username":"tsoome"},{"name":"Piotr Jasiukajtis","email":"estibi@me.com","username":"estibi"}]}