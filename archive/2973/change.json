{"project":"joyent/sdcadm","branch":"master","id":"I6d6d21107a07f3b5e4f0bf6b4ce756a68ad23c9a","number":"2973","subject":"VOLAPI-92 nightly2-020-test-system failing in node-sdc-clients volapi tests Reviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e Approved by: Trent Mick \u003ctrent","owner":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"url":"https://cr.joyent.us/2973","commitMessage":"VOLAPI-92 nightly2-020-test-system failing in node-sdc-clients volapi tests\nReviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1511219166,"lastUpdated":1511464854,"open":false,"status":"MERGED","comments":[{"timestamp":1511219166,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 1."},{"timestamp":1511219199,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511220420,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 2."},{"timestamp":1511220453,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511346189,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2: Code-Review+1\n\n(2 comments)\n\nOther than my preference for usage of either SdcAdmError or verror.WError instances, looks good to me"},{"timestamp":1511392239,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1511433905,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2: Integration-Approval+1\n\n(1 comment)\n\nJulien, that\u0027s just a personal preference. Feel free to merge it using default Error class!"},{"timestamp":1511433912,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1511433948,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1511460822,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\n(3 comments)"},{"timestamp":1511463810,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 4."},{"timestamp":1511463819,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1511463843,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511463956,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1511464203,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Uploaded patch set 5."},{"timestamp":1511464221,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1511464235,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1511464423,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1511464768,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1511464830,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 6:\n\nAdded Pedro as reviewer + approver for integration since he did that recently, and subsequent patch sets did not change this CR significantly. My apologies if that\u0027s not the right thing to do, I wanted to give credits to Pedro for his help reviewing and approving this."},{"timestamp":1511464849,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1511464854,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Julien Gilli"}],"currentPatchSet":{"number":"7","revision":"e98262be5b0cbdf0f16e521cab08427068e1b281","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/7","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511464849,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511464235,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1511464854,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":13,"deletions":0}],"sizeInsertions":35,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"ee21eff1d226df4463bb3117f25c9125549e89d6","parents":["1ff0c70ac430f6f408fe710941470503e0146e50"],"ref":"refs/changes/73/2973/1","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511219166,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511219199,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":24,"deletions":0}],"sizeInsertions":24,"sizeDeletions":0},{"number":"2","revision":"c11f43cc5c8ac418dfe859de4a09e7008c94befe","parents":["1ff0c70ac430f6f408fe710941470503e0146e50"],"ref":"refs/changes/73/2973/2","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511220420,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511220453,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511346189,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511433905,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"comments":[{"file":"lib/cli/do_nfs_volumes.js","line":317,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Not a big deal, but shouldn\u0027t this one be an instance of SdcAdmError or any of its subclasses?"},{"file":"lib/cli/do_nfs_volumes.js","line":317,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"It seems we don\u0027t create instances of the SdcAdmError \"class\" in sdcadm, so I guess that \"SdcAdmError\" is meant to be used as an \"abstract class\" or as an \"interface\".\n\nThe other error \"classes\" that already exist in sdcadm don\u0027t seem to be representing this specific error case well, so we\u0027d need to create a new error class. What would be that error class?\n\nI still think that using the standard Error class is fine, but I\u0027d be happy to be convinced otherwise."},{"file":"lib/cli/do_nfs_volumes.js","line":317,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I\u0027d just go for \"UsageError\" here but that\u0027s a personal preference. I already +1\u0027ed it b/c of that :-)"},{"file":"lib/post-setup/volapi.js","line":179,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto, shouldn\u0027t we go for SdcAdmError, subclasses or, at least, and instance of verror.WError?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":24,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":15,"deletions":0}],"sizeInsertions":39,"sizeDeletions":0},{"number":"3","revision":"8703233086202256ca3b0676d43faa549c726540","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1511433912,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511220453,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511460822,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511460822,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511346189,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511433905,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"comments":[{"file":"lib/cli/do_nfs_volumes.js","line":314,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"same messaging comments as from volapi.js"},{"file":"lib/cli/do_nfs_volumes.js","line":314,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/post-setup/volapi.js","line":176,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"My pref would be to drop this. I.e. it is more silent when things are fine..."},{"file":"lib/post-setup/volapi.js","line":176,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"},{"file":"lib/post-setup/volapi.js","line":180,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"... and then updating this error message to give some context. E.g. something like:\n\n    cannot setup volapi: this DC is not setup for fabric networks"},{"file":"lib/post-setup/volapi.js","line":180,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":24,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":15,"deletions":0}],"sizeInsertions":39,"sizeDeletions":0},{"number":"4","revision":"3dcc0aec0167c4afc9b1168b89e1ce1534b5c5ff","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/4","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511463810,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511463843,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/cli/do_nfs_volumes.js","line":315,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"In this case this is about enabling nfs-volumes feature right?"},{"file":"lib/cli/do_nfs_volumes.js","line":315,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":13,"deletions":0}],"sizeInsertions":35,"sizeDeletions":0},{"number":"5","revision":"6d6d21107a07f3b5e4f0bf6b4ce756a68ad23c9a","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/5","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511464203,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511464235,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":13,"deletions":0}],"sizeInsertions":35,"sizeDeletions":0},{"number":"6","revision":"738b3ca3a2afc6b0123ccc5a7a3dab1b9ad054b7","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/6","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511464768,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511464235,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":13,"deletions":0}],"sizeInsertions":35,"sizeDeletions":0},{"number":"7","revision":"e98262be5b0cbdf0f16e521cab08427068e1b281","parents":["fd6fc5c711c6a22ef6795baed99712eb1b110831"],"ref":"refs/changes/73/2973/7","uploader":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"createdOn":1511464849,"author":{"name":"Julien Gilli","email":"julien.gilli@joyent.com","username":""},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1511464235,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1511464423,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1511464854,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"lib/cli/do_nfs_volumes.js","type":"MODIFIED","insertions":22,"deletions":0},{"file":"lib/post-setup/volapi.js","type":"MODIFIED","insertions":13,"deletions":0}],"sizeInsertions":35,"sizeDeletions":0}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}]}