{"project":"joyent/manta","branch":"master","id":"Ia81b52e273d442ffde0dfd1535b09c8bdaa522cb","number":"3151","subject":"MANTA-3053 manta operator guide should document multi-DC SAPI config MANTA-3054 manta operator guide should document \"manta-adm genconfig --from-file\" MANTA-3105 need docs for multi-DC deployment MANTA-3535 operator guide edits Reviewed by: Richard Bradle","owner":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"url":"https://cr.joyent.us/3151","commitMessage":"MANTA-3053 manta operator guide should document multi-DC SAPI config\nMANTA-3054 manta operator guide should document \"manta-adm genconfig --from-file\"\nMANTA-3105 need docs for multi-DC deployment\nMANTA-3535 operator guide edits\nReviewed by: Richard Bradley \u003crichard.bradley@joyent.com\u003e\nReviewed by: Jan Wyszynski \u003cjan.wyszynski@joyent.com\u003e\nApproved by: Richard Bradley \u003crichard.bradley@joyent.com\u003e\n","createdOn":1514993723,"lastUpdated":1515436711,"open":false,"status":"MERGED","comments":[{"timestamp":1514993723,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 1."},{"timestamp":1514993725,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515026660,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 2."},{"timestamp":1515026662,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515026821,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\nTesting notes are in MANTA-3535."},{"timestamp":1515059869,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Patch Set 2:\n\n(4 comments)\n\nThe manta-oneach examples look much cleaner!"},{"timestamp":1515088800,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 3."},{"timestamp":1515088802,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515089312,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(4 comments)\n\nThanks for taking a look!"},{"timestamp":1515104641,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1515153134,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Patch Set 3: Code-Review+1\n\n(2 comments)\n\nLooks good to me. It looks like Jan has some feedback here too, but once changes settle and you\u0027re happy that the latest patch set renders OK then I\u0027m happy to IA+1, too."},{"timestamp":1515199633,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 4."},{"timestamp":1515199635,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515199662,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1515199699,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1515199701,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1515407885,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1515436659,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1515436674,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1515436711,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by David Pacheco"}],"currentPatchSet":{"number":"6","revision":"a81b52e273d442ffde0dfd1535b09c8bdaa522cb","parents":["4cb5b90d0784f0f28d3c5356e0ba9cbf19210bd2"],"ref":"refs/changes/51/3151/6","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515436674,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515199635,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515436659,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}},{"type":"SUBM","value":"1","grantedOn":1515436711,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":148,"deletions":-136}],"sizeInsertions":148,"sizeDeletions":-136},"patchSets":[{"number":"1","revision":"a41666a4bf7fde2058169450605a33ffb5008f30","parents":["4cb5b90d0784f0f28d3c5356e0ba9cbf19210bd2"],"ref":"refs/changes/51/3151/1","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1514993723,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1514993725,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":140,"deletions":-135}],"sizeInsertions":140,"sizeDeletions":-135},{"number":"2","revision":"038bab3b4b3b8f68fc4ea260bab7fcde32751060","parents":["4f79fbf73c88a5c7a9e4f28ae507559bf00eb553"],"ref":"refs/changes/51/3151/2","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515026660,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515026662,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/operator-guide.md","line":617,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Would a reference to joyent/manta-genazconfig be appropriate here, too? If not immediately useful to other people (i.e. non-device 42 users) then it could at least be used as an area for users to request or work on changes to the tool."},{"file":"docs/operator-guide.md","line":617,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Done"},{"file":"docs/operator-guide.md","line":844,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"nit: we use a hash here (and below), but a dollar in the above code examples."},{"file":"docs/operator-guide.md","line":844,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Done (and slightly reformatted)."},{"file":"docs/operator-guide.md","line":1301,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"nit: Could we word this to refer to an example? As it is it makes it sound like we\u0027re writing the guide for someone who is operating us-east. How about:\n\n\u003e For example, in a production deployment named \"us-east\", the following would be appropriate:\n\nHaving said that, our initial documented call to this command doesn\u0027t specify the values or examples. Maybe this shouldn\u0027t either?"},{"file":"docs/operator-guide.md","line":1301,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Honestly, this was originally here because it _was_ intended for someone who is operating us-east.  I don\u0027t think there\u0027s another place to put that information, so I kind of want to keep it there for now.\n\nI think the right solution here is to avoid having `manta-init` require this option after the first time you run it (or avoid needing to run `manta-init` more than once altogether)."},{"file":"docs/operator-guide.md","line":1301,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Yep, understood. No big deal on this one."},{"file":"docs/operator-guide.md","line":1324,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"What issue is this trying to prevent? As far as I\u0027m aware, we only want to serialise storage zone creation across datacenters/AZs. Erring on the side of caution isn\u0027t a bad thing, though."},{"file":"docs/operator-guide.md","line":1324,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"MANTA-2185 (storage zones), MANTA-2868 (loadbalancers).  In the past, we\u0027ve also had MANTA-2789 (compute ids).  There\u0027s also MANTA-3439, which doesn\u0027t affect `manta-adm update` per se, but reflects that the deployment tooling really isn\u0027t built for concurrent use.\n\nI suspect it would also not work to deploy nameservice zones concurrently, since that needs to update SAPI metadata."},{"file":"docs/operator-guide.md","line":1324,"reviewer":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},"message":"Thanks! No problem leaving this as is."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":141,"deletions":-136}],"sizeInsertions":141,"sizeDeletions":-136},{"number":"3","revision":"1738ae3b309d8cae0d3062d1b5644ba7f2d64631","parents":["4f79fbf73c88a5c7a9e4f28ae507559bf00eb553"],"ref":"refs/changes/51/3151/3","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515088800,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515088802,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515153134,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}}],"comments":[{"file":"docs/operator-guide.md","line":754,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"We could fix this typo."},{"file":"docs/operator-guide.md","line":754,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":148,"deletions":-136}],"sizeInsertions":148,"sizeDeletions":-136},{"number":"4","revision":"30b600b9c5b5dbd5b59c7bd860a2687e1e1c07f3","parents":["4f79fbf73c88a5c7a9e4f28ae507559bf00eb553"],"ref":"refs/changes/51/3151/4","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515199633,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515199635,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":148,"deletions":-136}],"sizeInsertions":148,"sizeDeletions":-136},{"number":"5","revision":"b78b2a203e8ef05782cc9e3f932fbc6371d4b75d","parents":["4cb5b90d0784f0f28d3c5356e0ba9cbf19210bd2"],"ref":"refs/changes/51/3151/5","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515199699,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515199635,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515436659,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":148,"deletions":-136}],"sizeInsertions":148,"sizeDeletions":-136},{"number":"6","revision":"a81b52e273d442ffde0dfd1535b09c8bdaa522cb","parents":["4cb5b90d0784f0f28d3c5356e0ba9cbf19210bd2"],"ref":"refs/changes/51/3151/6","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1515436674,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1515436711,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515199635,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515407885,"by":{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515436659,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"docs/operator-guide.md","type":"MODIFIED","insertions":148,"deletions":-136}],"sizeInsertions":148,"sizeDeletions":-136}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Richard Bradley","email":"richard.bradley@joyent.com","username":"chudley"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}]}