From 3b2745aa9f67924606bb2e4f51110f8f663179be Mon Sep 17 00:00:00 2001
From: Orlando Vazquez <ovazquez@gmail.com>
Date: Wed, 3 Jul 2019 00:33:00 -0700
Subject: [PATCH] TRITON-1213 VM resize fails when tmpfs is 0 and no tmpfs set
 in package

---
 src/vm/node_modules/vmload/vmload-datasets.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/vm/node_modules/vmload/vmload-datasets.js b/src/vm/node_modules/vmload/vmload-datasets.js
index 05505eeb..cfe6b320 100644
--- a/src/vm/node_modules/vmload/vmload-datasets.js
+++ b/src/vm/node_modules/vmload/vmload-datasets.js
@@ -298,13 +298,14 @@ function getDatasets(obj, options, callback)
     if (obj.zonepath) {
         assert.strictEqual(obj.zonepath[0], '/');
         parents.push(obj.zonepath.slice(1));
-
+        _options.depth = 1;
     } else {
         /*
          * If we don't have one we're listing all VMs and need to fetch
          * everything anyway.
          */
         listEverything = true;
+        _options.depth = 2;
     }
 
     if (obj.datasets) {
-- 
2.21.0

