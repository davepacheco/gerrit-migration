commit 3b2745aa9f67924606bb2e4f51110f8f663179be
Author: Orlando Vazquez <ovazquez@gmail.com>
Date:   2019-07-03T00:33:00-07:00 (3 months ago)
    
    TRITON-1213 VM resize fails when tmpfs is 0 and no tmpfs set in package

diff --git a/src/vm/node_modules/vmload/vmload-datasets.js b/src/vm/node_modules/vmload/vmload-datasets.js
index 05505eeb..cfe6b320 100644
--- a/src/vm/node_modules/vmload/vmload-datasets.js
+++ b/src/vm/node_modules/vmload/vmload-datasets.js
@@ -298,13 +298,14 @@ function getDatasets(obj, options, callback)
     if (obj.zonepath) {
         assert.strictEqual(obj.zonepath[0], '/');
         parents.push(obj.zonepath.slice(1));
-
+        _options.depth = 1;
     } else {
         /*
          * If we don't have one we're listing all VMs and need to fetch
          * everything anyway.
          */
         listEverything = true;
+        _options.depth = 2;
     }
 
     if (obj.datasets) {
