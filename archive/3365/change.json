{"project":"joyent/illumos-joyent","branch":"master","id":"I0d2eb7a53abcabd58cac94fda80cb021bae84390","number":"3365","subject":"OS-6607 Expose drive speed and temperature on disk topo node Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Dan McDonald \u003cdanmcd@joyent.com\u003e","owner":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"url":"https://cr.joyent.us/3365","commitMessage":"OS-6607 Expose drive speed and temperature on disk topo node\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Dan McDonald \u003cdanmcd@joyent.com\u003e\n","createdOn":1518637585,"lastUpdated":1522434549,"open":false,"status":"MERGED","comments":[{"timestamp":1518637585,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 1."},{"timestamp":1519152026,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1519153352,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)\n\nWhat happens when we run this on a system with nvme devices? It appears that nvme does not implement the DKIOCGTEMPERATURE ioctl. We should probably have it support that a few other DKIOC bits as well.\n\nOtherwise, this seems good in general."},{"timestamp":1519155351,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 3."},{"timestamp":1519155595,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 3:\n\n(1 comment)\n\nFixed the weird line break.\n\nWRT nvme devices, the temp sensor facility node would still get created, but attempts to get the value of the facility/reading prop would fail.\n\nI filed the following ticket:\nOS-6650 Add support for subset of DKIO ioctls on nvme devices"},{"timestamp":1520576029,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1522336568,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1522431463,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1522433756,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1522434408,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1522434549,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Rob Johnston"}],"currentPatchSet":{"number":"6","revision":"0d2eb7a53abcabd58cac94fda80cb021bae84390","parents":["b409c9a314a881a4aa643e85cd5494af77fa4488"],"ref":"refs/changes/65/3365/6","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1522434408,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522336568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522433756,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"SUBM","value":"1","grantedOn":1522434549,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":173,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":189,"sizeDeletions":-29},"patchSets":[{"number":"1","revision":"44005de31965a1d96ec5105fcc8b61de1a200cce","parents":["b765746f152284954a1f5d8b38a5db126d45645a"],"ref":"refs/changes/65/3365/1","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1518637585,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":174,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-29},{"number":"2","revision":"9904f292d598e47f074f07d0de27dd663296c0f7","parents":["57e71e6ae577b3a62adc80688f00a5963bf97264"],"ref":"refs/changes/65/3365/2","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1519152026,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","comments":[{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","line":389,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This looks like odd line breaking."},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","line":389,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Fixed."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":174,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":190,"sizeDeletions":-29},{"number":"3","revision":"9ddd16dc4738abe9feb44388fbc50d857d0ecd30","parents":["57e71e6ae577b3a62adc80688f00a5963bf97264"],"ref":"refs/changes/65/3365/3","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1519155351,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":173,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":189,"sizeDeletions":-29},{"number":"4","revision":"b99606f5a01b853288680325548e3c963a2fe360","parents":["d38f0be9359bf06ba03adf1de3d2656ff80b77e7"],"ref":"refs/changes/65/3365/4","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1520576029,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522336568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":173,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":189,"sizeDeletions":-29},{"number":"5","revision":"49daf4e8d5f231f8a2c2b7a3097c7c4e603c16dd","parents":["b409c9a314a881a4aa643e85cd5494af77fa4488"],"ref":"refs/changes/65/3365/5","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1522431463,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522336568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522433756,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":173,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":189,"sizeDeletions":-29},{"number":"6","revision":"0d2eb7a53abcabd58cac94fda80cb021bae84390","parents":["b409c9a314a881a4aa643e85cd5494af77fa4488"],"ref":"refs/changes/65/3365/6","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1522434408,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1522336568,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1522433756,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"SUBM","value":"1","grantedOn":1522434549,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/disk/Makefile","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/disk/disk_common.c","type":"MODIFIED","insertions":173,"deletions":-21},{"file":"usr/src/lib/fm/topo/modules/common/ses/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses.c","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/common/ses/ses_facility.c","type":"MODIFIED","insertions":5,"deletions":-1}],"sizeInsertions":189,"sizeDeletions":-29}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}]}