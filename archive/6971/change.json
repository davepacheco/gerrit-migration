{"project":"joyent/smartos-live","branch":"master","id":"I7bd8c2c5e2b5758f2f073ca726f2fdcaa52c50ff","number":"6971","subject":"OS-7909 sysinfo(1M) doesn\u0027t report an \"Admin IP\" when the CN has booted via DHCP","owner":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"url":"https://cr.joyent.us/6971","commitMessage":"OS-7909 sysinfo(1M) doesn\u0027t report an \"Admin IP\" when the CN has booted via DHCP\n","createdOn":1571083750,"lastUpdated":1571093920,"open":true,"status":"NEW","comments":[{"timestamp":1571083750,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 1."},{"timestamp":1571087952,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1571092861,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1571093920,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(1 comment)"}],"currentPatchSet":{"number":"1","revision":"7bd8c2c5e2b5758f2f073ca726f2fdcaa52c50ff","parents":["9a2273a76f29d56264620263f2adce74c71807cf"],"ref":"refs/changes/71/6971/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1571083750,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","comments":[{"file":"src/sysinfo","line":327,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"this comment needs updating/removing\n\nI\u0027m wondering why it was like this before, though? Is there some situation the grep would meaningfully return \u003e 1 result?"},{"file":"src/sysinfo","line":327,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"The reason I made changes here was to make the code match the comment.  I couldn\u0027t see a reason that it would make sense to return only a single result if `net-boot-config --enabled` returns 0 but return multiple results in other cases.\n\nI was looking at this because at first I thought this may be a reasonable place to insert the ifconfig parsing."},{"file":"src/sysinfo","line":327,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"So the comment is saying that if net-boot-config --enabled, \nthen we *only* return any matches there, and don\u0027t check anything else. And by implication, if *not*, then we check more than one source.\n\nBut now, you always only ever report one thing - they\u0027re all exclusive - so the comment doesn\u0027t quite make sense."},{"file":"src/sysinfo","line":573,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"can we move get_nic_tags() up so that we can use NicTagLinks etc. and not have to repeat the parsing?"},{"file":"src/sysinfo","line":573,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Oops, didn\u0027t see that. There\u0027s no need to move it around to use it.  Will fix."},{"file":"src/sysinfo","line":600,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"sources\" ?"},{"file":"src/sysinfo","line":600,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"yeah"},{"file":"src/sysinfo","line":602,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: why isn\u0027t this net_conf_grep part of get_tag_ip() function itself?"},{"file":"src/sysinfo","line":602,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Yeah, could be done that way too.  Will probably change as you suggest."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/sysinfo","type":"MODIFIED","insertions":43,"deletions":-5}],"sizeInsertions":43,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"7bd8c2c5e2b5758f2f073ca726f2fdcaa52c50ff","parents":["9a2273a76f29d56264620263f2adce74c71807cf"],"ref":"refs/changes/71/6971/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1571083750,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","comments":[{"file":"src/sysinfo","line":327,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"this comment needs updating/removing\n\nI\u0027m wondering why it was like this before, though? Is there some situation the grep would meaningfully return \u003e 1 result?"},{"file":"src/sysinfo","line":327,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"The reason I made changes here was to make the code match the comment.  I couldn\u0027t see a reason that it would make sense to return only a single result if `net-boot-config --enabled` returns 0 but return multiple results in other cases.\n\nI was looking at this because at first I thought this may be a reasonable place to insert the ifconfig parsing."},{"file":"src/sysinfo","line":327,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"So the comment is saying that if net-boot-config --enabled, \nthen we *only* return any matches there, and don\u0027t check anything else. And by implication, if *not*, then we check more than one source.\n\nBut now, you always only ever report one thing - they\u0027re all exclusive - so the comment doesn\u0027t quite make sense."},{"file":"src/sysinfo","line":573,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"can we move get_nic_tags() up so that we can use NicTagLinks etc. and not have to repeat the parsing?"},{"file":"src/sysinfo","line":573,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Oops, didn\u0027t see that. There\u0027s no need to move it around to use it.  Will fix."},{"file":"src/sysinfo","line":600,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"sources\" ?"},{"file":"src/sysinfo","line":600,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"yeah"},{"file":"src/sysinfo","line":602,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: why isn\u0027t this net_conf_grep part of get_tag_ip() function itself?"},{"file":"src/sysinfo","line":602,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Yeah, could be done that way too.  Will probably change as you suggest."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/sysinfo","type":"MODIFIED","insertions":43,"deletions":-5}],"sizeInsertions":43,"sizeDeletions":-5}],"allReviewers":[{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}]}