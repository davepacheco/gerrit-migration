{"project":"joyent/illumos-joyent","branch":"vpc","id":"I979a82910dbbebfd01856074c59877626c2df983","number":"3653","subject":"9166 zfs storage pool checkpoint Reviewed by: Matthew Ahrens \u003cmahrens@delphix.com\u003e Reviewed by: John Kennedy \u003cjohn.kennedy@delphix.com\u003e Reviewed by: Dan Kimmel \u003cdan.kimmel@delphix.com\u003e Approved by: Richard Lowe \u003crichlowe@richlowe.net\u003e","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/3653","commitMessage":"9166 zfs storage pool checkpoint\nReviewed by: Matthew Ahrens \u003cmahrens@delphix.com\u003e\nReviewed by: John Kennedy \u003cjohn.kennedy@delphix.com\u003e\nReviewed by: Dan Kimmel \u003cdan.kimmel@delphix.com\u003e\nApproved by: Richard Lowe \u003crichlowe@richlowe.net\u003e\n","createdOn":1521219626,"lastUpdated":1521219893,"open":false,"status":"ABANDONED","comments":[{"timestamp":1521219626,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1521219893,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Abandoned"}],"currentPatchSet":{"number":"1","revision":"979a82910dbbebfd01856074c59877626c2df983","parents":["4d530805ff2854b4f48bff1bfecbca195722a981"],"ref":"refs/changes/53/3653/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1521219626,"author":{"name":"Serapheim Dimitropoulos","email":"serapheim.dimitro@delphix.com","username":""},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/zfs/zfs.c","type":"MODIFIED","insertions":38,"deletions":-29},{"file":"usr/src/cmd/truss/codes.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/zdb/zdb.c","type":"MODIFIED","insertions":727,"deletions":-120},{"file":"usr/src/cmd/zdb/zdb_il.c","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"usr/src/cmd/zpool/zpool_main.c","type":"MODIFIED","insertions":208,"deletions":-7},{"file":"usr/src/cmd/ztest/ztest.c","type":"MODIFIED","insertions":109,"deletions":-11},{"file":"usr/src/common/zfs/zfeature_common.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/common/zfs/zfeature_common.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/common/zfs/zpool_prop.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libzfs/common/libzfs.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/libzfs/common/libzfs_pool.c","type":"MODIFIED","insertions":43,"deletions":0},{"file":"usr/src/lib/libzfs/common/libzfs_util.c","type":"MODIFIED","insertions":27,"deletions":-2},{"file":"usr/src/lib/libzfs/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/libzfs_core.c","type":"MODIFIED","insertions":68,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/libzfs_core.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/mapfile-vers","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/man/man1m/zdb.1m","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/man/man1m/zpool.1m","type":"MODIFIED","insertions":93,"deletions":0},{"file":"usr/src/man/man5/zpool-features.5","type":"MODIFIED","insertions":19,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-zfstest.mf","type":"MODIFIED","insertions":52,"deletions":0},{"file":"usr/src/test/zfs-tests/cmd/randwritecomp/Makefile","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/test/zfs-tests/cmd/randwritecomp/randwritecomp.c","type":"ADDED","insertions":192,"deletions":0},{"file":"usr/src/test/zfs-tests/include/commands.cfg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/test/zfs-tests/include/libtest.shlib","type":"MODIFIED","insertions":19,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/delphix.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/longevity.run","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/test/zfs-tests/runfiles/omnios.run","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/openindiana.run","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/test/zfs-tests/tests/functional/cli_root/zdb/zdb_001_neg.ksh","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/zfs-tests/tests/functional/cli_root/zpool_import/import_rewind_config_changed.ksh","type":"MODIFIED","insertions":29,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/Makefile","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_after_rewind.ksh","type":"ADDED","insertions":55,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_big_rewind.ksh","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_capacity.ksh","type":"ADDED","insertions":90,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_conf_change.ksh","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard.ksh","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard_busy.ksh","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard_many.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_indirect.ksh","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_invalid.ksh","type":"ADDED","insertions":80,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_lun_expsz.ksh","type":"ADDED","insertions":61,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_open.ksh","type":"ADDED","insertions":48,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_removal.ksh","type":"ADDED","insertions":72,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_rewind.ksh","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_ro_rewind.ksh","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_sm_scale.ksh","type":"ADDED","insertions":74,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_twice.ksh","type":"ADDED","insertions":40,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_vdev_add.ksh","type":"ADDED","insertions":63,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_zdb.ksh","type":"ADDED","insertions":80,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_zhack_feat.ksh","type":"ADDED","insertions":66,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/cleanup.ksh","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/pool_checkpoint.kshlib","type":"ADDED","insertions":392,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/setup.ksh","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal.kshlib","type":"MODIFIED","insertions":52,"deletions":-56},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_remap_deadlists.ksh","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_reservation.ksh","type":"MODIFIED","insertions":2,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_add.ksh","type":"MODIFIED","insertions":5,"deletions":-9},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_create_fs.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_export.ksh","type":"MODIFIED","insertions":12,"deletions":-15},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_remap.ksh","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_remove.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_scrub.ksh","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_send.ksh","type":"MODIFIED","insertions":4,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_send_recv.ksh","type":"MODIFIED","insertions":5,"deletions":-8},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_snapshot.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_zdb.ksh","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/test/zfs-tests/tests/longevity/Makefile","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/longevity/slop_space_test.ksh","type":"ADDED","insertions":255,"deletions":0},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/dmu_traverse.c","type":"MODIFIED","insertions":6,"deletions":-8},{"file":"usr/src/uts/common/fs/zfs/dnode.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/dnode_sync.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/dsl_dataset.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/fs/zfs/dsl_destroy.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/dsl_dir.c","type":"MODIFIED","insertions":24,"deletions":-13},{"file":"usr/src/uts/common/fs/zfs/dsl_pool.c","type":"MODIFIED","insertions":98,"deletions":-12},{"file":"usr/src/uts/common/fs/zfs/dsl_scan.c","type":"MODIFIED","insertions":87,"deletions":-58},{"file":"usr/src/uts/common/fs/zfs/dsl_synctask.c","type":"MODIFIED","insertions":88,"deletions":-36},{"file":"usr/src/uts/common/fs/zfs/dsl_userhold.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/metaslab.c","type":"MODIFIED","insertions":285,"deletions":-156},{"file":"usr/src/uts/common/fs/zfs/range_tree.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/spa.c","type":"MODIFIED","insertions":411,"deletions":-40},{"file":"usr/src/uts/common/fs/zfs/spa_checkpoint.c","type":"ADDED","insertions":623,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/spa_misc.c","type":"MODIFIED","insertions":72,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/space_map.c","type":"MODIFIED","insertions":140,"deletions":-9},{"file":"usr/src/uts/common/fs/zfs/sys/dmu.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_dir.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_pool.h","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_synctask.h","type":"MODIFIED","insertions":36,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/sys/metaslab.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/fs/zfs/sys/metaslab_impl.h","type":"MODIFIED","insertions":28,"deletions":-25},{"file":"usr/src/uts/common/fs/zfs/sys/range_tree.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/spa.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/spa_checkpoint.h","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/spa_impl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/space_map.h","type":"MODIFIED","insertions":7,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/sys/uberblock_impl.h","type":"MODIFIED","insertions":23,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/vdev.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/sys/vdev_impl.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/vdev_removal.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/sys/zio.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/zthr.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/uberblock.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/vdev.c","type":"MODIFIED","insertions":164,"deletions":-17},{"file":"usr/src/uts/common/fs/zfs/vdev_indirect.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/fs/zfs/vdev_label.c","type":"MODIFIED","insertions":57,"deletions":-22},{"file":"usr/src/uts/common/fs/zfs/vdev_removal.c","type":"MODIFIED","insertions":57,"deletions":-21},{"file":"usr/src/uts/common/fs/zfs/zcp.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/zcp_synctask.c","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/zfs_ioctl.c","type":"MODIFIED","insertions":32,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/zil.c","type":"MODIFIED","insertions":96,"deletions":-13},{"file":"usr/src/uts/common/fs/zfs/zio.c","type":"MODIFIED","insertions":3,"deletions":-14},{"file":"usr/src/uts/common/fs/zfs/zthr.c","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/sys/fs/zfs.h","type":"MODIFIED","insertions":36,"deletions":0}],"sizeInsertions":6297,"sizeDeletions":-848},"patchSets":[{"number":"1","revision":"979a82910dbbebfd01856074c59877626c2df983","parents":["4d530805ff2854b4f48bff1bfecbca195722a981"],"ref":"refs/changes/53/3653/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1521219626,"author":{"name":"Serapheim Dimitropoulos","email":"serapheim.dimitro@delphix.com","username":""},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/cmd/mdb/common/modules/zfs/zfs.c","type":"MODIFIED","insertions":38,"deletions":-29},{"file":"usr/src/cmd/truss/codes.c","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"usr/src/cmd/zdb/zdb.c","type":"MODIFIED","insertions":727,"deletions":-120},{"file":"usr/src/cmd/zdb/zdb_il.c","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"usr/src/cmd/zpool/zpool_main.c","type":"MODIFIED","insertions":208,"deletions":-7},{"file":"usr/src/cmd/ztest/ztest.c","type":"MODIFIED","insertions":109,"deletions":-11},{"file":"usr/src/common/zfs/zfeature_common.c","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/common/zfs/zfeature_common.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/common/zfs/zpool_prop.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/lib/libzfs/common/libzfs.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/libzfs/common/libzfs_pool.c","type":"MODIFIED","insertions":43,"deletions":0},{"file":"usr/src/lib/libzfs/common/libzfs_util.c","type":"MODIFIED","insertions":27,"deletions":-2},{"file":"usr/src/lib/libzfs/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/libzfs_core.c","type":"MODIFIED","insertions":68,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/libzfs_core.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/lib/libzfs_core/common/mapfile-vers","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/man/man1m/zdb.1m","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/man/man1m/zpool.1m","type":"MODIFIED","insertions":93,"deletions":0},{"file":"usr/src/man/man5/zpool-features.5","type":"MODIFIED","insertions":19,"deletions":-1},{"file":"usr/src/pkg/manifests/system-test-zfstest.mf","type":"MODIFIED","insertions":52,"deletions":0},{"file":"usr/src/test/zfs-tests/cmd/randwritecomp/Makefile","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/test/zfs-tests/cmd/randwritecomp/randwritecomp.c","type":"ADDED","insertions":192,"deletions":0},{"file":"usr/src/test/zfs-tests/include/commands.cfg","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/test/zfs-tests/include/libtest.shlib","type":"MODIFIED","insertions":19,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/delphix.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/longevity.run","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/test/zfs-tests/runfiles/omnios.run","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/test/zfs-tests/runfiles/openindiana.run","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/test/zfs-tests/tests/functional/cli_root/zdb/zdb_001_neg.ksh","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/test/zfs-tests/tests/functional/cli_root/zpool_import/import_rewind_config_changed.ksh","type":"MODIFIED","insertions":29,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/Makefile","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_after_rewind.ksh","type":"ADDED","insertions":55,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_big_rewind.ksh","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_capacity.ksh","type":"ADDED","insertions":90,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_conf_change.ksh","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard.ksh","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard_busy.ksh","type":"ADDED","insertions":106,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_discard_many.ksh","type":"ADDED","insertions":52,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_indirect.ksh","type":"ADDED","insertions":59,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_invalid.ksh","type":"ADDED","insertions":80,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_lun_expsz.ksh","type":"ADDED","insertions":61,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_open.ksh","type":"ADDED","insertions":48,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_removal.ksh","type":"ADDED","insertions":72,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_rewind.ksh","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_ro_rewind.ksh","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_sm_scale.ksh","type":"ADDED","insertions":74,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_twice.ksh","type":"ADDED","insertions":40,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_vdev_add.ksh","type":"ADDED","insertions":63,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_zdb.ksh","type":"ADDED","insertions":80,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/checkpoint_zhack_feat.ksh","type":"ADDED","insertions":66,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/cleanup.ksh","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/pool_checkpoint.kshlib","type":"ADDED","insertions":392,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/pool_checkpoint/setup.ksh","type":"ADDED","insertions":25,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal.kshlib","type":"MODIFIED","insertions":52,"deletions":-56},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_remap_deadlists.ksh","type":"MODIFIED","insertions":2,"deletions":-3},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_reservation.ksh","type":"MODIFIED","insertions":2,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_add.ksh","type":"MODIFIED","insertions":5,"deletions":-9},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_create_fs.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_export.ksh","type":"MODIFIED","insertions":12,"deletions":-15},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_remap.ksh","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_remove.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_scrub.ksh","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_send.ksh","type":"MODIFIED","insertions":4,"deletions":-7},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_send_recv.ksh","type":"MODIFIED","insertions":5,"deletions":-8},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_snapshot.ksh","type":"MODIFIED","insertions":3,"deletions":-6},{"file":"usr/src/test/zfs-tests/tests/functional/removal/removal_with_zdb.ksh","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/test/zfs-tests/tests/longevity/Makefile","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/zfs-tests/tests/longevity/slop_space_test.ksh","type":"ADDED","insertions":255,"deletions":0},{"file":"usr/src/uts/common/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/dmu_traverse.c","type":"MODIFIED","insertions":6,"deletions":-8},{"file":"usr/src/uts/common/fs/zfs/dnode.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/dnode_sync.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/dsl_dataset.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/common/fs/zfs/dsl_destroy.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/dsl_dir.c","type":"MODIFIED","insertions":24,"deletions":-13},{"file":"usr/src/uts/common/fs/zfs/dsl_pool.c","type":"MODIFIED","insertions":98,"deletions":-12},{"file":"usr/src/uts/common/fs/zfs/dsl_scan.c","type":"MODIFIED","insertions":87,"deletions":-58},{"file":"usr/src/uts/common/fs/zfs/dsl_synctask.c","type":"MODIFIED","insertions":88,"deletions":-36},{"file":"usr/src/uts/common/fs/zfs/dsl_userhold.c","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/metaslab.c","type":"MODIFIED","insertions":285,"deletions":-156},{"file":"usr/src/uts/common/fs/zfs/range_tree.c","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/spa.c","type":"MODIFIED","insertions":411,"deletions":-40},{"file":"usr/src/uts/common/fs/zfs/spa_checkpoint.c","type":"ADDED","insertions":623,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/spa_misc.c","type":"MODIFIED","insertions":72,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/space_map.c","type":"MODIFIED","insertions":140,"deletions":-9},{"file":"usr/src/uts/common/fs/zfs/sys/dmu.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_dir.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_pool.h","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/dsl_synctask.h","type":"MODIFIED","insertions":36,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/sys/metaslab.h","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/fs/zfs/sys/metaslab_impl.h","type":"MODIFIED","insertions":28,"deletions":-25},{"file":"usr/src/uts/common/fs/zfs/sys/range_tree.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/spa.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/spa_checkpoint.h","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/spa_impl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/sys/space_map.h","type":"MODIFIED","insertions":7,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/sys/uberblock_impl.h","type":"MODIFIED","insertions":23,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/vdev.h","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/sys/vdev_impl.h","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/vdev_removal.h","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/fs/zfs/sys/zio.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/sys/zthr.h","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/uberblock.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/vdev.c","type":"MODIFIED","insertions":164,"deletions":-17},{"file":"usr/src/uts/common/fs/zfs/vdev_indirect.c","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"usr/src/uts/common/fs/zfs/vdev_label.c","type":"MODIFIED","insertions":57,"deletions":-22},{"file":"usr/src/uts/common/fs/zfs/vdev_removal.c","type":"MODIFIED","insertions":57,"deletions":-21},{"file":"usr/src/uts/common/fs/zfs/zcp.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/fs/zfs/zcp_synctask.c","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"usr/src/uts/common/fs/zfs/zfs_ioctl.c","type":"MODIFIED","insertions":32,"deletions":0},{"file":"usr/src/uts/common/fs/zfs/zil.c","type":"MODIFIED","insertions":96,"deletions":-13},{"file":"usr/src/uts/common/fs/zfs/zio.c","type":"MODIFIED","insertions":3,"deletions":-14},{"file":"usr/src/uts/common/fs/zfs/zthr.c","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/sys/fs/zfs.h","type":"MODIFIED","insertions":36,"deletions":0}],"sizeInsertions":6297,"sizeDeletions":-848}]}