{"project":"joyent/illumos-joyent","branch":"master","id":"I5a02003f48844ffada03336634b28edaff8574ec","number":"6833","subject":"OS-7938 add DDI UFM support to the nvme driver Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Reviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e Approved by: Joshua M. Clulow \u003cjosh@sysmgr.org\u003e","owner":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"url":"https://cr.joyent.us/6833","commitMessage":"OS-7938 add DDI UFM support to the nvme driver\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nReviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjosh@sysmgr.org\u003e\n","createdOn":1566509816,"lastUpdated":1567639069,"open":false,"status":"MERGED","comments":[{"timestamp":1566509816,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 1."},{"timestamp":1566515768,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1566558051,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 2."},{"timestamp":1566558073,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1566558474,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 3."},{"timestamp":1566558509,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 3:\n\nFixed missing kmem_free in error path"},{"timestamp":1566583331,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1566925861,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 4."},{"timestamp":1566926075,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1566926739,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1566927607,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 5."},{"timestamp":1566927741,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 6."},{"timestamp":1566927786,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1566931481,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1566932412,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 7."},{"timestamp":1566935610,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 7:\n\n(1 comment)"},{"timestamp":1567123856,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1567180592,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 7:\n\n(3 comments)"},{"timestamp":1567183280,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 8."},{"timestamp":1567183445,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 8:\n\n(3 comments)\n\nThe diff in this latest patch set looks large because I resync\u0027d my repo w\\master and pulled in the nvme hotplug changes."},{"timestamp":1567198891,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 8: Code-Review+1\n\n(2 comments)\n\na couple small nits but otherwise LGTM!"},{"timestamp":1567199531,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 9."},{"timestamp":1567199578,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 8:\n\n(2 comments)"},{"timestamp":1567206243,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 9: Code-Review+1"},{"timestamp":1567632765,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 9: Code-Review+1"},{"timestamp":1567633450,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 9: Integration-Approval+1\n\nThank you for the testing notes.  I approve!"},{"timestamp":1567634079,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 10: Patch Set 9 was rebased."},{"timestamp":1567634245,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 11: Commit message was updated."},{"timestamp":1567636265,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Uploaded patch set 12."},{"timestamp":1567636349,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 12:\n\ngit pbchk caught the cstyle warning below which I fixed - can you guys +1 it again?\n\n\u003d\u003d\u003d\u003d cstyle/hdrchk errors \u003d\u003d\u003d\u003d\n\nThe following command caused the error:\ndmake: Warning: Command failed for target `nvme.check\u0027\ndmake: Warning: Command failed for target `uts\u0027\ndmake: Warning: Target `check\u0027 not remade because of errors\nnvme.h: 449: continuation line not indented by 4 spaces"},{"timestamp":1567636708,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 12: Code-Review+1"},{"timestamp":1567636859,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 12: Integration-Approval+1"},{"timestamp":1567639069,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Rob Johnston"}],"currentPatchSet":{"number":"12","revision":"5a02003f48844ffada03336634b28edaff8574ec","parents":["245c8cb8fe488fd25dea7e61885def4612759829"],"ref":"refs/changes/33/6833/12","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567636265,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567636708,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1567636859,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1567639069,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":152,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":176,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"0aebb8dd65c8fd433c404a5b849a4020c62a37ec","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/1","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566509816,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we check that this value isn\u0027t zero before we call this? Will the system handle it being set to zero OK? I know the spec guarantees it\u0027s non-zero, so maybe it\u0027s OK?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"There\u0027s an ASSERT in ufm_cache_fill() that checks that it\u0027s non-zero, so we\u0027ll panic on debug bits.  On non-debug it looks like umem_cache_fill() will confusingly fail with ENOMEM after we attempt a zero-byte allocation."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can we please fix up the ufm_cache_fill() to not do the zero byte allocation and take another action then?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"I went ahead and changed the ASSERT to a VERIFY.  I think that\u0027s reasonable here as I would imagine that the most likely reason this assert would fail is because of a coding error in a driver that\u0027s consuming the framework - in which case a panic seems reasonable."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027m not sure that I agree this is reasonable. Right now we\u0027re passing a value from hardware directly to this. We can\u0027t have the kernel say it\u0027s a programmer error, but then not require us to actually check what we\u0027re getting from hardware. I think it\u0027s a mistake to panic in this case."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4639,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"I see your point.  Ok, I\u0027ve changed ufm_cache_fill() to simply return an error here."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4662,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think it\u0027ll be much clearer here and at the strcpy if we use a macro that explains how this is based on the hardware size."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4662,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Done"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4675,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Don\u0027t we need to check that bufsize makes sense and is valid before we start dereferencing data in case hardware gave us something questionable?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4675,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Probably a good idea - done."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4692,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Don\u0027t we need to check if the slot is readable and writable and update the attributes here? Importantly the first slot may be read-only per the firmware information in the controller spec. Otherwise I think every other slot is writable at this time."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4692,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Yep, I totally spaced on that.  Fixed."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":133,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":140,"sizeDeletions":0},{"number":"2","revision":"a5eba09dd9ea3fa0a6e3071a8f53bfd6e4cb5aa3","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/2","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566558051,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":142,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":152,"sizeDeletions":-1},{"number":"3","revision":"4a49e5bc3c7716e96ff22159567caaff0de01e50","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/3","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566558474,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4444,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Sorry I didn\u0027t think about this the first time. But I\u0027m wondering if we should consolidate the invalidation logic here and in the firmware commit ioctl. Probably doesn\u0027t matter in this case."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4444,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"No problem - I\u0027ve factored this code out into a separate function."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":144,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":154,"sizeDeletions":-1},{"number":"4","revision":"e71282103969c00e8f6edc4b8bccad3853529bea","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/4","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566925861,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":144,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":155,"sizeDeletions":-2},{"number":"5","revision":"3f113afb2745681fd1067153e53b72cc6e178c9b","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/5","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566927607,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":144,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":156,"sizeDeletions":-2},{"number":"6","revision":"71c05cd6ab686c5aea29793ead8d2b7bb120e085","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/6","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566927741,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/os/ddi_ufm.c","line":188,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think this will return without having an actual error set. ret will still be set based on the return of ufm_op_fill_image."},{"file":"usr/src/uts/common/os/ddi_ufm.c","line":188,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"DOH!  Fixed - sorry, I think I\u0027m a bit distracted by everything today.\n\nI went with EIO for this case, as we have the following text in the ufm(7d) manpage for EIO:\n\n\"A failure occurred while executing a DDI UFM entry  point.\""}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":144,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":156,"sizeDeletions":-2},{"number":"7","revision":"9042ac1fc1cd655e219ab3acc964e1f5cc50e1ac","parents":["79a83c9704a9cf92db1f36550cc849fecedc5c7a"],"ref":"refs/changes/33/6833/7","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1566932412,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567123856,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/uts/common/io/nvme/nvme.c","line":20,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Could we add something about UFM support to this comment?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":20,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Yes, done."},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4635,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Sorry if this is an ignorant question. what is the reason for failing here? Is it because there is only 1 image?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":4635,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Yes, exactly."},{"file":"usr/src/uts/common/sys/nvme.h","line":447,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"should this value be pulled into a more descriptive constant as well?"},{"file":"usr/src/uts/common/sys/nvme.h","line":447,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Sounds reasonable - done."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":144,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":3,"deletions":-1}],"sizeInsertions":158,"sizeDeletions":-2},{"number":"8","revision":"f75e3cf5045c26acfa354f588edbbc48f5624298","parents":["40781992661b2626691b6b26740cf8f1605855e8"],"ref":"refs/changes/33/6833/8","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567183280,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567198891,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"comments":[{"file":"usr/src/uts/common/io/nvme/nvme.c","line":219,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"nit: looks like other sections are separated with 2 blank lines surrounding them (same for below here, too)"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":219,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Done"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":225,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"9E\"?"},{"file":"usr/src/uts/common/io/nvme/nvme.c","line":225,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":150,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":174,"sizeDeletions":-4},{"number":"9","revision":"bdf15e82e286ce5cb4f6ddd84459c9e5a34d1bcc","parents":["40781992661b2626691b6b26740cf8f1605855e8"],"ref":"refs/changes/33/6833/9","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567199531,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567632765,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1567633450,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567206243,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":152,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":176,"sizeDeletions":-4},{"number":"10","revision":"52b62ac58801cbcdb94e9215fd3477ba88abd3c8","parents":["245c8cb8fe488fd25dea7e61885def4612759829"],"ref":"refs/changes/33/6833/10","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567634079,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567632765,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1567633450,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567206243,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":152,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":176,"sizeDeletions":-4},{"number":"11","revision":"ef191895655e12abb7b7d11c328793732e440b28","parents":["245c8cb8fe488fd25dea7e61885def4612759829"],"ref":"refs/changes/33/6833/11","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567634245,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567632765,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1567633450,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567206243,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":152,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":176,"sizeDeletions":-4},{"number":"12","revision":"5a02003f48844ffada03336634b28edaff8574ec","parents":["245c8cb8fe488fd25dea7e61885def4612759829"],"ref":"refs/changes/33/6833/12","uploader":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"createdOn":1567636265,"author":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567636708,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1567636859,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1567639069,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme.c","type":"MODIFIED","insertions":152,"deletions":0},{"file":"usr/src/uts/common/io/nvme/nvme_var.h","type":"MODIFIED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/os/ddi_ufm.c","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/common/sys/nvme.h","type":"MODIFIED","insertions":12,"deletions":-3}],"sizeInsertions":176,"sizeDeletions":-4}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}]}