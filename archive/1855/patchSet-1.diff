From 81e2e57f35313f71b09f580e208e5ee83872ee28 Mon Sep 17 00:00:00 2001
From: Patrick Mooney <pmooney@pfmooney.com>
Date: Wed, 26 Apr 2017 22:56:40 +0000
Subject: [PATCH] OS-6081 lxbrand xattr panics on userspace access

---
 usr/src/uts/common/brand/lx/syscall/lx_xattr.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/usr/src/uts/common/brand/lx/syscall/lx_xattr.c b/usr/src/uts/common/brand/lx/syscall/lx_xattr.c
index dc6139008f..19bf9a4ebb 100644
--- a/usr/src/uts/common/brand/lx/syscall/lx_xattr.c
+++ b/usr/src/uts/common/brand/lx/syscall/lx_xattr.c
@@ -132,9 +132,9 @@ lx_setxattr_common(vnode_t *vp, char *name, void *value, size_t sz, int flags)
 		break;
 	case LX_XATTR_NS_SYSTEM:
 		if (strcmp(key, LX_XATTR_POSIX_ACL_ACCESS) == 0) {
-			error = lx_acl_setxattr(vp, LX_ACL_ACCESS, value, sz);
+			error = lx_acl_setxattr(vp, LX_ACL_ACCESS, buf, sz);
 		} else if (strcmp(key, LX_XATTR_POSIX_ACL_DEFAULT) == 0) {
-			error = lx_acl_setxattr(vp, LX_ACL_DEFAULT, value, sz);
+			error = lx_acl_setxattr(vp, LX_ACL_DEFAULT, buf, sz);
 		}
 	default:
 		break;
-- 
2.21.0

