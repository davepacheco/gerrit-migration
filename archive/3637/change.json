{"project":"joyent/sdc-docker","branch":"master","id":"Ia72bda54b11bfebbe576ca3ec8521b2a5f5bacc1","number":"3637","subject":"PUBAPI-1476 Create a compatibility layer so that all cloudapi plugins can be used in sdc-docker, and vice versa DOCKER-1054 Provide provisioning limits plugin for sdc-docker similar to cloudapi functionality","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/3637","commitMessage":"PUBAPI-1476 Create a compatibility layer so that all cloudapi plugins can be used in sdc-docker, and vice versa\nDOCKER-1054 Provide provisioning limits plugin for sdc-docker similar to cloudapi functionality\n","createdOn":1521075492,"lastUpdated":1521079876,"open":false,"status":"ABANDONED","comments":[{"timestamp":1521075492,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1521075529,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521076589,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\nThis copies the free_tier and machine_email plugins over, and allows the use of absolute paths in plugin names."},{"timestamp":1521077438,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1521077733,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1521078797,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1521078832,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521079683,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nRegarding adding stock plugins to sdc-docker: Why would we add functionality that isn\u0027t wanted? The tickets don\u0027t ask for this. At best they should only be added if asked for in a separate ticket."},{"timestamp":1521079876,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Abandoned\n\nDecided this is unneeded."}],"currentPatchSet":{"number":"2","revision":"a72bda54b11bfebbe576ca3ec8521b2a5f5bacc1","parents":["b13a5ce5cd475a459b89b9e1c997bcac6d21e82e"],"ref":"refs/changes/37/3637/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1521078797,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521078832,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"plugins/free_tier.js","type":"ADDED","insertions":125,"deletions":0},{"file":"plugins/machine_email.js","type":"ADDED","insertions":143,"deletions":0}],"sizeInsertions":268,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"05dbcea086ff61a10594ee51f49aeb5ed2ef34f8","parents":["b13a5ce5cd475a459b89b9e1c997bcac6d21e82e"],"ref":"refs/changes/37/3637/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1521075492,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521075529,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/plugin-manager.js","line":165,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"path.resolve copes with a component being an absolute path:\n\n```\n\u003e __dirname \u003d \u0027/opt/smartdc/cloudapi/lib\u0027\n\u0027/opt/smartdc/cloudapi/lib\u0027\n\u003e path.resolve(__dirname, \u0027../plugins\u0027, \"foo\");\n\u0027/opt/smartdc/cloudapi/plugins/foo\u0027\n\u003e path.resolve(__dirname, \u0027../plugins\u0027, \"/data/plugins/foo\");\n\u0027/data/plugins/foo\u0027\n```\n\nSo I don\u0027t think this code is necessary. Or am I missing something?"},{"file":"lib/plugin-manager.js","line":165,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Oh dear. I tested with a file path that didn\u0027t exist before making this change. I\u0027ll remove it."},{"file":"plugins/free_tier.js","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Was there a need to add stock plugins to sdc-docker?"},{"file":"plugins/machine_email.js","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Was there a need to add stock plugins to sdc-docker? This one won\u0027t work in sdc-docker anyway because it doesn\u0027t include the \u0027nodemailer\u0027 module.\n\nAFAIK the only requirement was to support plugins so custom ones could be added. I don\u0027t think we need to *add* stock plugins."},{"file":"plugins/machine_email.js","line":12,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Previous commit to sdc-docker included nodemailer 0.7.1.\n\nThe reason to copy them here is simply that all configs that ops come up with will work between both sdc-docker and cloudapi."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/plugin-manager.js","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"plugins/free_tier.js","type":"ADDED","insertions":125,"deletions":0},{"file":"plugins/machine_email.js","type":"ADDED","insertions":143,"deletions":0}],"sizeInsertions":282,"sizeDeletions":-1},{"number":"2","revision":"a72bda54b11bfebbe576ca3ec8521b2a5f5bacc1","parents":["b13a5ce5cd475a459b89b9e1c997bcac6d21e82e"],"ref":"refs/changes/37/3637/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1521078797,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521078832,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"plugins/free_tier.js","type":"ADDED","insertions":125,"deletions":0},{"file":"plugins/machine_email.js","type":"ADDED","insertions":143,"deletions":0}],"sizeInsertions":268,"sizeDeletions":0}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Pedro Palaz√≥n Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}