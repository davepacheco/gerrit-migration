From 592f31503c6e5f4182c661869840e1ecdd739d86 Mon Sep 17 00:00:00 2001
From: Jerry Jelinek <jerry.jelinek@joyent.com>
Date: Tue, 19 Jun 2018 21:18:15 +0000
Subject: [PATCH] MANATEE-401 postgresql should not reuse old WAL files

---
 deps/postgresql96                        | 2 +-
 etc/9.6/postgresql.manta.coal.conf       | 1 +
 etc/9.6/postgresql.manta.lab.conf        | 1 +
 etc/9.6/postgresql.manta.production.conf | 1 +
 4 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/deps/postgresql96 b/deps/postgresql96
index 563881d..5a4b526 160000
--- a/deps/postgresql96
+++ b/deps/postgresql96
@@ -1 +1 @@
-Subproject commit 563881d704954a95174be84330af3e218e30143b
+Subproject commit 5a4b5261882b456bb71183969b0ad55d2c88d6b3
diff --git a/etc/9.6/postgresql.manta.coal.conf b/etc/9.6/postgresql.manta.coal.conf
index dc6a3da..8fd2fc8 100644
--- a/etc/9.6/postgresql.manta.coal.conf
+++ b/etc/9.6/postgresql.manta.coal.conf
@@ -652,3 +652,4 @@ default_text_search_config = 'pg_catalog.english'
 #------------------------------------------------------------------------------
 
 # Add settings for extensions here
+wal_recycle = off
diff --git a/etc/9.6/postgresql.manta.lab.conf b/etc/9.6/postgresql.manta.lab.conf
index d745fe8..af89a11 100644
--- a/etc/9.6/postgresql.manta.lab.conf
+++ b/etc/9.6/postgresql.manta.lab.conf
@@ -652,3 +652,4 @@ default_text_search_config = 'pg_catalog.english'
 #------------------------------------------------------------------------------
 
 # Add settings for extensions here
+wal_recycle = off
diff --git a/etc/9.6/postgresql.manta.production.conf b/etc/9.6/postgresql.manta.production.conf
index 72f5d84..fac0e2e 100644
--- a/etc/9.6/postgresql.manta.production.conf
+++ b/etc/9.6/postgresql.manta.production.conf
@@ -653,3 +653,4 @@ default_text_search_config = 'pg_catalog.english'
 #------------------------------------------------------------------------------
 
 # Add settings for extensions here
+wal_recycle = off
-- 
2.21.0

