{"project":"joyent/sdc-vm-agent","branch":"master","id":"Iae8b119e380cba77e8da3862e6eb5d99a95830fc","number":"2730","subject":"AGENT-979 vm-agent needs vminfod watcher Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e","owner":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"url":"https://cr.joyent.us/2730","commitMessage":"AGENT-979 vm-agent needs vminfod watcher\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1507223782,"lastUpdated":1509387870,"open":false,"status":"MERGED","comments":[{"timestamp":1507223782,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 1."},{"timestamp":1507223785,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit fc4b37b5b20eb5b48f4fb6d91b1807c7df86ef73\n    \n    copyright\n    \n    commit 02a439541038840cadf84930049189ae58bd0a17\n    \n    properly handle undefined\n    \n    commit b11567466bd5dc3ed4d40237d0b53dd0a8ea20cd\n    \n    AGENT-979 vm-agent needs vminfod watcher"},{"timestamp":1507223824,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n \n /tmp/repo/lib/vm-watcher.js\n   121:29  error  Unexpected use of undefined  no-undefined\n \n ✖ 1 problem (1 error, 0 warnings)\n \n Makefile:152: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1507223907,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 2."},{"timestamp":1507223910,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 608fbe5fddbd6214b4b29eed16b2657ffbe43aaf\n    \n    fix make check with use of undefined"},{"timestamp":1507223970,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507656742,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2: Code-Review+1\n\n(1 comment)\n\nlgtm, I assume all the tests have been run through a few times and everything looks good there?"},{"timestamp":1508354313,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 3."},{"timestamp":1508354316,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit a63a213d568b6f41cc2713f197bd26b747d56548\n    \n    use `vmadm events`"},{"timestamp":1508354372,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508354399,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3: Code-Review-1\n\nThis patchset will not work as-is because it relies on https://cr.joyent.us/#/c/2798/ existing."},{"timestamp":1508433198,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 4."},{"timestamp":1508433201,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 8ee2f3256d73d68a9ce49f0ac39ce4daf95038f7\n    \n    noop vmadm events .start()"},{"timestamp":1508433233,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n \n /tmp/repo/lib/watchers/vmadm-events-watcher.js\n   32:5  error  Assignment to function parameter \u0027cb\u0027  no-param-reassign\n \n ✖ 1 problem (1 error, 0 warnings)\n \n Makefile:152: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1508433243,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 5."},{"timestamp":1508433247,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 2e62cc4278d95dca47e132fd6bf1ba0a4c4ce08f\n    \n    make check pass"},{"timestamp":1508433291,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508820792,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 5:\n\n(3 comments)\n\nOverall I think this looks ok so far, I think it would be nice to have a test.VmadmWatcher.js or test.VmadmEventsWatcher.js though... To test that that backend works as expected."},{"timestamp":1508873461,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1508953973,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 6."},{"timestamp":1508953976,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 3ea0bf48ce22948e0aedaf7db6d22cf9a5bb6564\n    \n    joshw based review"},{"timestamp":1508954051,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508962839,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 6: Code-Review+1\n\n(2 comments)\n\nChanges look good, thanks for adding the test! I assume everything runs through successfully and reports that vmadm events was used?"},{"timestamp":1509037255,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: -Code-Review\n\n(2 comments)\n\nNew patchset coming today with `waitEvent` logic abstracted, and a bumped version of `node-vmadm` in the package.json.  Yes, everything in this CR is currently in use on the vminfod test machine and the tests pass.  (they failed last night but that\u0027s for a different reason from something unrelated I was manually testing - they\u0027ll be back to passing today)."},{"timestamp":1509052469,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 7."},{"timestamp":1509052472,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit e5c9891dc30a01d3cc64ca81af6ef67304bca977\n    \n    extract waitEvent to test/common.js\n    \n    commit b6b22d072f4e973120ecf8393fc0f72b1f59fb48\n    \n    bump vmadm dep"},{"timestamp":1509052527,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1509052701,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 7:\n\nPatchset 7 is in a fully working state and is in a state where it is ready for integration to the best of my knowledge."},{"timestamp":1509385974,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1\n\nlgtm, thanks!"},{"timestamp":1509387463,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1509387870,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dave Eddy"}],"currentPatchSet":{"number":"8","revision":"ae8b119e380cba77e8da3862e6eb5d99a95830fc","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/8","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1509387463,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509052527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1509387870,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/event-source.js","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":53,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":92,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/common.js","type":"MODIFIED","insertions":36,"deletions":-2},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.FsWatcher.js","type":"MODIFIED","insertions":3,"deletions":-32},{"file":"tests/test.PeriodicWatcher.js","type":"MODIFIED","insertions":16,"deletions":-49},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":126,"deletions":-111},{"file":"tests/test.VmWatcher.js","type":"MODIFIED","insertions":38,"deletions":-44},{"file":"tests/test.VmadmEventsWatcher.js","type":"ADDED","insertions":174,"deletions":0},{"file":"tests/test.ZoneeventWatcher.js","type":"MODIFIED","insertions":2,"deletions":-31}],"sizeInsertions":673,"sizeDeletions":-336},"patchSets":[{"number":"1","revision":"194be0004791d710eaf67d1ce37baaffee03f99f","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/1","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1507223782,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1507223824,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":57,"deletions":-27},{"file":"lib/watchers/vminfod-vm-watcher.js","type":"ADDED","insertions":82,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":97,"deletions":-106}],"sizeInsertions":251,"sizeDeletions":-143},{"number":"2","revision":"f482b19254e8419d5f91a687164cc5e9cfe5a0b9","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/2","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1507223907,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507223970,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507656742,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"lib/vm-agent.js","line":674,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"good idea."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":57,"deletions":-27},{"file":"lib/watchers/vminfod-vm-watcher.js","type":"ADDED","insertions":82,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":6,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":97,"deletions":-106}],"sizeInsertions":251,"sizeDeletions":-143},{"number":"3","revision":"e177a5d9062f655aed8e4e0aa689db424401819b","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1508354313,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508354372,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1508354399,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":70,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":75,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":97,"deletions":-106}],"sizeInsertions":323,"sizeDeletions":-172},{"number":"4","revision":"bec2b0658984aecc8c4c8fef7a566666d37f08a9","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/4","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1508433198,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1508433233,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1508354399,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":70,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":79,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":97,"deletions":-106}],"sizeInsertions":327,"sizeDeletions":-172},{"number":"5","revision":"652f35554d6f97fdd50f50300671c5a9066d200f","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/5","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1508433243,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508433291,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1508354399,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"lib/vm-agent.js","line":601,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Maybe make it clearer that we don\u0027t care about events, because this is only here to determine if vmadm events are supported?"},{"file":"lib/vm-agent.js","line":601,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Done"},{"file":"tests/test.VmAgentRealVmadm.js","line":1014,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Is there a reason we needed to make this parallel here? If so, maybe we should document here?"},{"file":"tests/test.VmAgentRealVmadm.js","line":1014,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"There is, but I modified it a long time ago so 1. i\u0027ll have to remind myself what it is (i *wish* i had documented it then) and 2. it may not be strictly necessary anymore, but I think it had to do with the callback passed to `vmAgent.start()` now."},{"file":"tests/test.VmAgentRealVmadm.js","line":1014,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Figuring that out for this case and below and documenting sounds good. :)"},{"file":"tests/test.VmAgentRealVmadm.js","line":1014,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"This has been documented in patchset 6"},{"file":"tests/test.VmAgentRealVmadm.js","line":1055,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"same question as above Re: parallel."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":70,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":78,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":97,"deletions":-106}],"sizeInsertions":326,"sizeDeletions":-172},{"number":"6","revision":"1f33187eacf3ac09b2ab4c3eefce0e2007fe55c2","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/6","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1508953973,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508954051,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1508962839,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"tests/test.VmadmEventsWatcher.js","line":39,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"This doesn\u0027t just check for create, right?"},{"file":"tests/test.VmadmEventsWatcher.js","line":39,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Ah, i lifted this logic from `test.FsWatcher` and it has the same comment (which is *also* incorrect for that test as well).\n\nThis `waitEvent` logic is duplicated in 4 tests (5 now with test.VmadmEventsWatcher.js).  I\u0027ll extract it out into `test/common.js` and rework all the tests to use that instead."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/event-source.js","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":53,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":92,"deletions":0},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":126,"deletions":-111},{"file":"tests/test.VmWatcher.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"tests/test.VmadmEventsWatcher.js","type":"ADDED","insertions":201,"deletions":0}],"sizeInsertions":626,"sizeDeletions":-178},{"number":"7","revision":"bc410252a07ffe1de3ca4434056c66520d90d70a","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/7","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1509052469,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509052527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/event-source.js","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":53,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":92,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/common.js","type":"MODIFIED","insertions":36,"deletions":-2},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.FsWatcher.js","type":"MODIFIED","insertions":3,"deletions":-32},{"file":"tests/test.PeriodicWatcher.js","type":"MODIFIED","insertions":16,"deletions":-49},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":126,"deletions":-111},{"file":"tests/test.VmWatcher.js","type":"MODIFIED","insertions":38,"deletions":-44},{"file":"tests/test.VmadmEventsWatcher.js","type":"ADDED","insertions":174,"deletions":0},{"file":"tests/test.ZoneeventWatcher.js","type":"MODIFIED","insertions":2,"deletions":-31}],"sizeInsertions":673,"sizeDeletions":-336},{"number":"8","revision":"ae8b119e380cba77e8da3862e6eb5d99a95830fc","parents":["79791d5e4fccecb6f9b32a71b05999c4fd9b0667"],"ref":"refs/changes/30/2730/8","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1509387463,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509052527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509385974,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1509387870,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/event-source.js","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/vm-agent.js","type":"MODIFIED","insertions":53,"deletions":-33},{"file":"lib/vm-watcher.js","type":"MODIFIED","insertions":71,"deletions":-31},{"file":"lib/watchers/vmadm-events-watcher.js","type":"ADDED","insertions":92,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tests/common.js","type":"MODIFIED","insertions":36,"deletions":-2},{"file":"tests/mocks.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"tests/test.FsWatcher.js","type":"MODIFIED","insertions":3,"deletions":-32},{"file":"tests/test.PeriodicWatcher.js","type":"MODIFIED","insertions":16,"deletions":-49},{"file":"tests/test.VmAgentRealVmadm.js","type":"MODIFIED","insertions":126,"deletions":-111},{"file":"tests/test.VmWatcher.js","type":"MODIFIED","insertions":38,"deletions":-44},{"file":"tests/test.VmadmEventsWatcher.js","type":"ADDED","insertions":174,"deletions":0},{"file":"tests/test.ZoneeventWatcher.js","type":"MODIFIED","insertions":2,"deletions":-31}],"sizeInsertions":673,"sizeDeletions":-336}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}