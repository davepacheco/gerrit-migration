From 9df90cd5da71cbaa18761d12b3c90b65c2906016 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Fri, 20 Apr 2018 13:44:32 -0700
Subject: [PATCH] joyent/node-smartdc-auth#16 KeyPair isKey assertion should be
 min-versioned

---
 lib/keypair.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/lib/keypair.js b/lib/keypair.js
index bf644ed..4ff597e 100644
--- a/lib/keypair.js
+++ b/lib/keypair.js
@@ -47,7 +47,11 @@ function SDCKeyPair(kr, opts) {
 	this.comment = '';
 
 	if (opts.public !== undefined) {
-		mod_assert.ok(mod_sshpk.Key.isKey(opts.public),
+		/*
+		 * We need a Key of v1,3 or later for defaultHashAlgorithm and
+		 * the Signature hashAlgorithm support.
+		 */
+		mod_assert.ok(mod_sshpk.Key.isKey(opts.public, [1, 3]),
 		    'options.public must be a sshpk.Key instance');
 		this.comment = opts.public.comment;
 	}
-- 
2.21.0

