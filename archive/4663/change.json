{"project":"joyent/illumos-joyent","branch":"master","id":"I02a64cfbb85e422730e9e7e182c468da625d2c6e","number":"4663","subject":"OS-7119 adjust pci slots to support windows Reviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"url":"https://cr.joyent.us/4663","commitMessage":"OS-7119 adjust pci slots to support windows\nReviewed by: Jorge Schrauwen \u003cjorge@blackdot.be\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1533935681,"lastUpdated":1535582450,"open":false,"status":"MERGED","comments":[{"timestamp":1533935681,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 1."},{"timestamp":1533936905,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1533938267,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1533938602,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1534365813,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 2."},{"timestamp":1534448549,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1534452876,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1535581287,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\nFinished testing; notes in ticket."},{"timestamp":1535582034,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1535582409,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3: Commit message was updated."},{"timestamp":1535582417,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1535582450,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Mike Gerdts"}],"currentPatchSet":{"number":"4","revision":"6ee3a34140b2fc1881eeccb9a5037957b69e14c0","parents":["8e7167ad0ea919e3af46eebdd1ccdaba3dd93acc"],"ref":"refs/changes/63/4663/4","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1535582417,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534448549,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534452876,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535582034,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1535582450,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":2,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"14d8c81464e738963d217a4f143f9d3e4bb2bf54","parents":["185a422e63f55e51465370d497ca1c1a13366df4"],"ref":"refs/changes/63/4663/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1533935681,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":45,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"What\u0027s the argument to preserve this ID?"},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":45,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Fear of the unknown.  I worried that moving disks to a different pci id may cause them to be enumerated differently such that /dev/vda points to a missing disk and the root disk is now at /dev/vdb or /dev/vdc.  If the instance is not mounting by uuid, this could cause boot failures.\n\nIf you don\u0027t think this should be a problem, I\u0027m happy to whack it."},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","line":45,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"On further consideration... we may need to move these to support Windows if we want to allow ahci.  https://wiki.freebsd.org/bhyve/Windows"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":2,"sizeDeletions":-2},{"number":"2","revision":"02a64cfbb85e422730e9e7e182c468da625d2c6e","parents":["a67cdbf32a87562bb8953403839403aee9287f2e"],"ref":"refs/changes/63/4663/2","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1534365813,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534448549,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535582034,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534452876,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":2,"sizeDeletions":-2},{"number":"3","revision":"a7093baa088c28402e7ca8dd7aa2b533562eef0e","parents":["a67cdbf32a87562bb8953403839403aee9287f2e"],"ref":"refs/changes/63/4663/3","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1535582409,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534448549,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535582034,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534452876,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":2,"sizeDeletions":-2},{"number":"4","revision":"6ee3a34140b2fc1881eeccb9a5037957b69e14c0","parents":["8e7167ad0ea919e3af46eebdd1ccdaba3dd93acc"],"ref":"refs/changes/63/4663/4","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1535582417,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534448549,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1535582034,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534452876,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}},{"type":"SUBM","value":"1","grantedOn":1535582450,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"MODIFIED","insertions":2,"deletions":-2}],"sizeInsertions":2,"sizeDeletions":-2}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}]}