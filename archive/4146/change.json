{"project":"joyent/node-vmadm","branch":"master","id":"I72c8516d7c0667d4806cc8e4d9f06863c0a7a66d","number":"4146","subject":"TRITON-467 as a library node-vmadm should not use node_prebuilt Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"url":"https://cr.joyent.us/4146","commitMessage":"TRITON-467 as a library node-vmadm should not use node_prebuilt\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1528232454,"lastUpdated":1528309181,"open":false,"status":"MERGED","comments":[{"timestamp":1528232454,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Uploaded patch set 1."},{"timestamp":1528232458,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528237936,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Code-Review+1\n\n(3 comments)"},{"timestamp":1528297542,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Uploaded patch set 2."},{"timestamp":1528297545,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528297787,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1528305021,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1528309173,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Patch Set 3: Commit message was updated."},{"timestamp":1528309181,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Chris Burroughs"}],"currentPatchSet":{"number":"3","revision":"e76e1e0c919ae566abf2f14c548fb62090426b25","parents":["bfe4d6913785cfaa0abe7e008634794942553b29"],"ref":"refs/changes/46/4146/3","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1528309173,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528297545,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1528309181,"by":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-23},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-110},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-159},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29}],"sizeInsertions":3,"sizeDeletions":-445},"patchSets":[{"number":"1","revision":"34d2bd3163a843d3c00cd537dbbc726b48460422","parents":["bfe4d6913785cfaa0abe7e008634794942553b29"],"ref":"refs/changes/46/4146/1","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1528232454,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528232458,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528237936,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"Makefile","line":33,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Drop \"REPO_DEPS\". eng.git makefiles don\u0027t define that."},{"file":"Makefile","line":33,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Done"},{"file":"Makefile","line":34,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I believe we prefer \u0027npm install\u0027. There was a time years ago when \u0027npm rebuild\u0027 was used but I never learned the reasoning. We are still pretty conflicted:\n\n```\n[15:31:49 trentm@bluesteel:~/all]\n$ rg \u0027\\$\\(NPM\\) install\u0027 */Makefile | wc -l\n     178\n[15:31:52 trentm@bluesteel:~/all]\n$ rg \u0027\\$\\(NPM\\) rebuild\u0027 */Makefile | wc -l\n      24\n```"},{"file":"Makefile","line":34,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could simplify even more and drop \"NPM\" and \"NPM_EXEC\" and just call `npm` directly here."},{"file":"Makefile","line":34,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"https://docs.npmjs.com/cli/rebuild\n\n\"This command runs the npm build command on the matched folders. \" ¯\\_(ツ)_/¯\n\nSince that is a meaningful change to what the target does (not just variable cleanup) I\u0027d prefer to do that in a separate change, and fix it everywhere."},{"file":"Makefile","line":34,"reviewer":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-21},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-110},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-159},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29}],"sizeInsertions":3,"sizeDeletions":-443},{"number":"2","revision":"72c8516d7c0667d4806cc8e4d9f06863c0a7a66d","parents":["bfe4d6913785cfaa0abe7e008634794942553b29"],"ref":"refs/changes/46/4146/2","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1528297542,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528297545,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-23},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-110},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-159},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29}],"sizeInsertions":3,"sizeDeletions":-445},{"number":"3","revision":"e76e1e0c919ae566abf2f14c548fb62090426b25","parents":["bfe4d6913785cfaa0abe7e008634794942553b29"],"ref":"refs/changes/46/4146/3","uploader":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"createdOn":1528309173,"author":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528297545,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528305021,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1528309181,"by":{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-23},{"file":"tools/mk/Makefile.node.defs","type":"DELETED","insertions":0,"deletions":-110},{"file":"tools/mk/Makefile.node.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"DELETED","insertions":0,"deletions":-159},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"DELETED","insertions":0,"deletions":-42},{"file":"tools/mk/Makefile.smf.defs","type":"DELETED","insertions":0,"deletions":-40},{"file":"tools/mk/Makefile.smf.targ","type":"DELETED","insertions":0,"deletions":-29}],"sizeInsertions":3,"sizeDeletions":-445}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Chris Burroughs","email":"chris.burroughs@joyent.com","username":"cburroughs"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}