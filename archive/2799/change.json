{"project":"joyent/sdc-imgapi","branch":"master","id":"I6b889aaa32e1e6d44a16a3067f3273e56316b441","number":"2799","subject":"DOCKER-1118 docker build should not set image min_platform","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/2799","commitMessage":"DOCKER-1118 docker build should not set image min_platform\n","createdOn":1508271708,"lastUpdated":1508434260,"open":false,"status":"ABANDONED","comments":[{"timestamp":1508271708,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1508271709,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 7739699ada530291274d28f903b44581f0233c36\n    \n    DOCKER-1118 docker build should not set image min_platform"},{"timestamp":1508271736,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508276769,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(2 comments)\n\nThere is some imgadm code that should be updated for this change as well: https://github.com/joyent/smartos-live/blob/master/src/img/lib/imgadm.js#L3464-L3478\n\nWe should discuss in chat."},{"timestamp":1508434260,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Abandoned\n\nClosing this, will resubmit as IMGAPI-651."}],"currentPatchSet":{"number":"1","revision":"6b889aaa32e1e6d44a16a3067f3273e56316b441","parents":["ba1d634230e16c007a14a1991fcdf5e58f2e1b01"],"ref":"refs/changes/99/2799/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1508271708,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508271736,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/images.js","line":1887,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I wonder if we can drop this handling along with dropping IMGAPI-251 workarounds.\n\nYes, OS-2651 when in 2013-12-03, which is before our current min supported platform. That means we can clear out all the special min_platform handling here and just add handling for avoiding having req.min_platform for non-smartos images."},{"file":"lib/images.js","line":1893,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027smartos\u0027 isn\u0027t the brand value I don\u0027t think. I think they are \u0027joyent\u0027 or \u0027joyent-minimal\u0027.  I don\u0027t recall the full set though.\n\nFrom `man vmadm`, the set of brands is: joyent, joyent-minimal, lx and kvm.\n\nWe should first decide if we\u0027d want a newly added brand (e.g. say \"bhyve\") to fallback to getting a requirements.min_paltform or not... and then write this code appropriately."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1,"deletions":-44},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":6,"sizeDeletions":-45},"patchSets":[{"number":"1","revision":"6b889aaa32e1e6d44a16a3067f3273e56316b441","parents":["ba1d634230e16c007a14a1991fcdf5e58f2e1b01"],"ref":"refs/changes/99/2799/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1508271708,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508271736,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/images.js","line":1887,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I wonder if we can drop this handling along with dropping IMGAPI-251 workarounds.\n\nYes, OS-2651 when in 2013-12-03, which is before our current min supported platform. That means we can clear out all the special min_platform handling here and just add handling for avoiding having req.min_platform for non-smartos images."},{"file":"lib/images.js","line":1893,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027smartos\u0027 isn\u0027t the brand value I don\u0027t think. I think they are \u0027joyent\u0027 or \u0027joyent-minimal\u0027.  I don\u0027t recall the full set though.\n\nFrom `man vmadm`, the set of brands is: joyent, joyent-minimal, lx and kvm.\n\nWe should first decide if we\u0027d want a newly added brand (e.g. say \"bhyve\") to fallback to getting a requirements.min_paltform or not... and then write this code appropriately."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/images.js","type":"MODIFIED","insertions":1,"deletions":-44},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":6,"sizeDeletions":-45}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}