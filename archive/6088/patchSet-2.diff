From 0abbda9445a4c6d0459457390caa5ab75eb9f292 Mon Sep 17 00:00:00 2001
From: David Pacheco <dap@joyent.com>
Date: Wed, 10 Apr 2019 17:28:58 -0700
Subject: [PATCH] MANTA-4213 debugging guide could use more information about
 some errors

---
 0001-incident-response.adoc   |  12 +-
 0002-investigation-tasks.adoc | 165 ++++++++++--
 0003-quick-reference.adoc     |   4 +-
 docs/index.html               | 462 ++++++++++++++++++++++++----------
 4 files changed, 483 insertions(+), 160 deletions(-)

diff --git a/0001-incident-response.adoc b/0001-incident-response.adoc
index 368b7ba..4f562fa 100644
--- a/0001-incident-response.adoc
+++ b/0001-incident-response.adoc
@@ -257,7 +257,6 @@ There are a couple of major kinds of error.
 
 See <<_not_enough_free_space_for_mb>>.
 
-// TODO cover 504?
 
 ==== Response code 503
 
@@ -343,15 +342,18 @@ processed by Muskie.
   This appears to be a client issue.
 
 
+==== Response code 413
+
+See <<_request_has_exceeded_bytes>>.
+
 ==== Other 400-level response codes
 
 These are usually client issues, though it's always possible there are
-server-side bugs that cause erroneous 400-level responses.  The only way to be
-sure is to examine the request and response to see if the response appears
+server-side bugs that cause erroneous 400-level responses.  (For an obscure
+example, see https://smartos.org/bugview/MANTA-2319[MANTA-2319].)  The only way
+to be sure is to examine the request and response to see if the response appears
 correct.
 
-// TODO find bug where too many ssh keys resulted in 401/403?
-
 
 === Investigating a specific request that has failed
 
diff --git a/0002-investigation-tasks.adoc b/0002-investigation-tasks.adoc
index 3374b8b..fce0d82 100644
--- a/0002-investigation-tasks.adoc
+++ b/0002-investigation-tasks.adoc
@@ -804,15 +804,53 @@ client, and we also know which Muskie zone it was.
 
 === Details about specific error messages
 
-==== `No storage nodes available for this request`
+==== "Request has exceeded ... bytes"
 
-==== `Not enough free space for ... MB`
+You may observe any of the following symptoms:
 
-This code (associated with 507 errors) indicates that Manta does not have enough
-space available on any storage nodes for the write _that was requested_.  This
-would be surprising in production environments, although it's easy to induce
-even in production by requesting an absurd size.  For example, you'll see this
-if you attempt to upload an enormous object:
+- a 413 ("Request Entity Too Large") response code
+- an error with name `MaxContentLengthExceededError`
+- an error with a message like `request has exceeded 11 bytes` (the actual
+  number of bytes varies)
+- a Muskie log entry showing `MaxSizeExceededError`
+
+All of these indicate that the client attempted a streaming upload but attempted
+to upload more bytes than Manta expected.  If the `max-content-length` header
+was provided, its value was too small for the content that was uploaded.  If the
+header was not provided, then the default value picked for the maximum streaming
+upload size was not sufficient.  In both cases, the issue can be resolved by
+having the client provide a `max-content-length` that's at least as large as the
+object that it's attempting to upload.
+
+Here's an example that demonstrates the case:
+
+[source,text]
+----
+$ echo 1234567890 | mput -q -H 'max-content-length: 7' /dap/public/foo
+mput: MaxContentLengthExceededError: request has exceeded 11 bytes
+$
+----
+
+See the section on <<_not_enough_free_space_for_mb>> for more details on
+streaming uploads and the `max-content-length` header.  **Note that the error
+message incorrectly implies that 11 bytes was the limit.**  This is a
+http://smartos.org/bugview/MANTA-4214[bug].  The actual limit was whatever was
+specified by the `max-content-length` header or else a default value described
+in that linked section.
+
+Note that for non-streaming uploads, the failure mode for attempting to upload
+too many bytes is less well-defined, as this is likely to break the framing of
+HTTP requests on the TCP connection.
+
+==== "No storage nodes available for this request"
+
+==== "Not enough free space for ... MB"
+
+This message (associated with 507 errors) indicates that Manta does not have
+enough space available on enough storage nodes _for the write that was
+requested_.  This would be surprising in production environments, although it's
+easy to induce even in production by requesting an absurd size.  For example,
+you'll see this if you attempt to upload an enormous object:
 
 [source,text]
 ----
@@ -820,18 +858,111 @@ $ mput -H 'max-content-length: 1125899906842624' /dap/stor/waytoobig
 mput: NotEnoughSpaceError: not enough free space for 1073741824 MB
 ----
 
-https://apidocs.joyent.com/manta/api.html#PutObject[Recall that Manta supports
-two kinds of uploads]: streaming and fixed-length.
+Manta determines a maximum object size for each upload request and validates
+that enough storage is available to satisfy the request.  When there aren't
+enough storage nodes that have the required amount of space, the request fails
+with this message.  (A request will also fail if the client attempts to upload
+more than the maximum expected size, but that produces
+<<_request_has_exceeded_bytes,a different error>>.)
+
+In determining the maximum object size for an upload request,
+https://apidocs.joyent.com/manta/api.html#PutObject[Manta supports two kinds of
+uploads]: fixed-size and streaming.  A **fixed-size** upload is one that
+specifies the size of the object using the `content-length` request header.
+Manta uses this value directly as the maximum object size.  A **streaming**
+upload is specified using the `transfer-encoding: chunked` header.  In this
+case, the space that Manta allocates up front (and validates) is given by the
+`max-content-length` header, if provided, or else a server-side, configurable
+default value.  The `storage.defaultMaxStreamingSizeMB` property in Muskie's
+configuration file determines this value.  This is typically populated from the
+`MUSKIE_DEFAULT_MAX_STREAMING_SIZE_MB` SAPI property.  The typical value is 5120
+MB.  **This is documented in the Manta API, so changing it may break working
+clients.**  Note that this default is sometimes too large in some development
+environments, which can cause streaming uploads to fail with this message.  An
+object PUT must specify either `transfer-encoding: chunked` or `content-length`.
+
+To understand a specific instance of this error, ask:
+
+* **Does the size in the error message match what you (and the end user)
+  expected would be required for this request?** The process by which Manta
+  determines this size is described above.  If this does not match what you
+  and the end user expect, that may reflect a bug.  (More commonly, end users
+  may not understand the semantics of `content-length` and `max-content-length`
+  or operators don't understand the `defaultMaxStreamingSizeMB` default value.
+  Again, see above and the linked API documentation for an explanation of
+  those.)
+* If the value matches what you expect, **does Manta actually have that much
+  space?**  This question is more complex than it sounds.  Keep in mind that:
+** Manta will only consider storage zones currently using less than a
+   configurable maximum amount of space.  This is determined by the
+   `storage.maxUtilizationPct` property of Muskie configuration files, which
+   comes from the `MUSKIE_MAX_UTILIZATION_PCT` SAPI property.  For requests from
+   operator accounts, the `storage.maxOperatorUtilizationPct` property is used
+   instead, which comes from the `MUSKIE_MAX_OPERATOR_UTILIZATION_PCT` SAPI
+   property.
+** Multiple copies are written for each new object.  The number of copies is
+   determined by the `durability-level` header that is specified by the client.
+   All copies of the object must be assigned to separate storage zones.  The
+   requested amount of space must be present on as many storage zones are there
+   are supposed to be copies created.
+** If this is a multi-datacenter deployment (i.e., if the `storage.multiDC`
+   Muskie configuration property (which comes from the `MUSKIE_MULTI_DC` SAPI
+   property) is set to a true value), then copies must be spread across
+   datacenters as well.  If the number of copies is less than the number of
+   datacenters (e.g., 2 copies in a 3-datacenter deployment), then all copies
+   must be placed into separate datacenters (so there must be a storage zone in
+   each datacenter with enough capacity).  If the number of copies is at least
+   the number of datacenters, at least one copy must be placed in each
+   datacenter.
+
+Example: in the common case of `durability-level: 2` (the default) in a multi-DC
+deployment with `content-length` of 10 GB, there must be 10 GB of space
+available on at least one storage zone _in each of two datacenters_.  The
+request could fail with this error even if there are two storage zones with
+enough space if those storage zones are all in the same datacenter.
+
+The `mpicker` tool can be used to determine how much space is available on each
+storage zone.  The `mpicker poll` command summarizes available space on each
+storage zone that's under the configured utilization percentage.  For example:
+
+[source,text]
+----
+[root@380920d9 (webapi) ~]$ /opt/smartdc/muskie/bin/mpicker poll
+polling options:
+ max percentage utilization: 92
+
+DATACENTER MANTA_STORAGE_ID          %USED         AVAIL_MB      TIMESTAMP
+staging-3  3.stor.staging.joyent.us  91            197218        2019-04-10T21:15:35.726Z
+staging-2  2.stor.staging.joyent.us  87            306039        2019-04-10T21:15:35.221Z
+staging-1  1.stor.staging.joyent.us  81            456521        2019-04-10T21:15:37.506Z
+[root@380920d9 (webapi) ~]$
+----
+
+The `mpicker choose` command can be used to simulate Manta's storage allocation
+behavior for a request of a given size.  Here's an example request for a size
+that would fail, given the above output:
+
+[source,text]
+----
+[root@380920d9 (webapi) ~]$ /opt/smartdc/muskie/bin/mpicker poll -j | /opt/smartdc/muskie/bin/mpicker choose -s 310000
+replicas requested: 2
+size requested: 310000 MB
+storage server count by datacenter:
+        staging-3: 1 (0 available)
+        staging-2: 1 (0 available)
+        staging-1: 1 (1 available)
+total storage server count: 3 (1 available)
+
+could not choose storage node set: 2 copies requested, but only 1 DC(s) have sufficient space
+----
+
+If you run `mpicker choose` in this way using the same size as you see in the
+"No space available for ... " message, you'd typically expected to see the same
+error.
 
-Streaming uploads are specified using the `transfer-encoding: chunked` header.
-In this case, the space allocated up front (and validated) is specified by the
-`max-content-length` header.  If that header is missing, a default value is used
-_that is sometimes too large in some development environments_, which can cause
-streaming uploads to fail in development environments.
+The `mpicker` command has a number of options to control the output and simulate
+different conditions.  See the help output for details.
 
-If an object PUT does not specify `transfer-encoding: chunked`, then it must
-specify `content-length`, in which case that value is used for allocation (and
-validation).
 
 === Locating metadata for an object
 
diff --git a/0003-quick-reference.adoc b/0003-quick-reference.adoc
index 308dbb4..9ae3386 100644
--- a/0003-quick-reference.adoc
+++ b/0003-quick-reference.adoc
@@ -26,13 +26,13 @@ Here we cover only status codes with particular meanings within Manta or that ar
 | 408          | `Request Timeout` | The server did not receive a complete request from the client within a reasonable timeout.
 | 409          | `Conflict`        | The client sent an invalid combination of parameters for an API request.
 | 412          | `Precondition Failed` | The client issued a conditional request and the conditions were not true.  (For example, this could have been a PUT-if-the-object-does-not-already-exist, and the object already existed.)
+| 413          | `Request Entity Too Large` | The client attempted a streaming upload and sent more bytes than were allowed based on the `max-content-length` header.  See <<_request_has_exceeded_bytes>> for details.
 | 429          | `Too Many Requests`     | The client is being rate-limited by the server because it issued too many requests in too short a period.
 | 499          | (not in HTTP)   | The 499 status is used to indicate that the client appeared to abandon the request.  (In this case, it's not possible to send a response.  The 499 code is used for internal logging and statistics.)  This was originally used in nginx.
 | 500          | `Internal Server Error` | Catch-all code for a failure to process this request.
 | 502          | `Bad Gateway`           | Historically, this code was emitted by Manta when requests took more than two minutes to complete.  This was an artifact of the load balancer.  Modern versions of Manta report this as a 503.
 | 503          | `Service Unavailable`   | This code generally indicates that the system is overloaded and cannot process more work.  In practice, this currently means that a particular metadata shard's queue is full, that Muskie took too long to respond to the request, or that there aren't enough working storage nodes with enough disk space to satisfy this upload.
-| 504          | `Gateway Timeout`       | Similar to 502.
-| 507          | `Not Enough Space`      | The Manta deployment is out of physical disk space for new objects.
+| 507          | `Not Enough Space`      | The Manta deployment is out of physical disk space for new objects.  See <<_not_enough_free_space_for_mb>> for details.
 |================================================
 
 Generally:
diff --git a/docs/index.html b/docs/index.html
index 0706d15..fe394a5 100644
--- a/docs/index.html
+++ b/docs/index.html
@@ -4,17 +4,16 @@
 <meta charset="UTF-8">
 <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
-<meta name="generator" content="Asciidoctor 1.5.5">
+<meta name="generator" content="Asciidoctor 1.5.7.1">
 <title>Manta Debugging Guide</title>
 <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
 <style>
 /* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
-/* Remove comment around @import statement below when using as a custom stylesheet */
+/* Uncomment @import statement below to use as custom stylesheet */
 /*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
 article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
 audio,canvas,video{display:inline-block}
 audio:not([controls]){display:none;height:0}
-[hidden],template{display:none}
 script{display:none!important}
 html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
 a{background:transparent}
@@ -44,12 +43,10 @@ button,select{text-transform:none}
 button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
 button[disabled],html input[disabled]{cursor:default}
 input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
-input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
-input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
 button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
 textarea{overflow:auto;vertical-align:top}
 table{border-collapse:collapse;border-spacing:0}
-*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
+*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
 html,body{font-size:100%}
 body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
 a:hover{cursor:pointer}
@@ -67,8 +64,7 @@ img,object,svg{display:inline-block;vertical-align:middle}
 textarea{height:auto;min-height:50px}
 select{width:100%}
 .center{margin-left:auto;margin-right:auto}
-.spread{width:100%}
-p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
+.stretch{width:100%}
 .subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
 div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
 a{color:#2156a5;text-decoration:underline;line-height:inherit}
@@ -89,13 +85,12 @@ strong,b{font-weight:bold;line-height:inherit}
 small{font-size:60%;line-height:inherit}
 code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
 ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
-ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
+ul,ol{margin-left:1.5em}
 ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
 ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
 ul.square{list-style-type:square}
 ul.circle{list-style-type:circle}
 ul.disc{list-style-type:disc}
-ul.no-bullet{list-style:none}
 ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
 dl dt{margin-bottom:.3125em;font-weight:bold}
 dl dd{margin-bottom:1.25em}
@@ -103,24 +98,24 @@ abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-
 abbr{text-transform:none}
 blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
 blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
-blockquote cite:before{content:"\2014 \0020"}
+blockquote cite::before{content:"\2014 \0020"}
 blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
 blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
-@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
+@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
 h1{font-size:2.75em}
 h2{font-size:2.3125em}
 h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
 h4{font-size:1.4375em}}
 table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
-table thead,table tfoot{background:#f7f8f7;font-weight:bold}
+table thead,table tfoot{background:#f7f8f7}
 table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
 table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
 table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
 table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
 h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
 h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
-.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
-.clearfix:after,.float-group:after{clear:both}
+.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
+.clearfix::after,.float-group::after{clear:both}
 *:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
 *:not(pre)>code.nobreak{word-wrap:normal}
 *:not(pre)>code.nowrap{white-space:nowrap}
@@ -131,16 +126,20 @@ strong strong{font-weight:400}
 kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
 .keyseq kbd:first-child{margin-left:0}
 .keyseq kbd:last-child{margin-right:0}
-.menuseq,.menu{color:rgba(0,0,0,.8)}
-b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
-b.button:before{content:"[";padding:0 3px 0 2px}
-b.button:after{content:"]";padding:0 2px 0 3px}
+.menuseq,.menuref{color:#000}
+.menuseq b:not(.caret),.menuref{font-weight:inherit}
+.menuseq{word-spacing:-.02em}
+.menuseq b.caret{font-size:1.25em;line-height:.8}
+.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
+b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
+b.button::before{content:"[";padding:0 3px 0 2px}
+b.button::after{content:"]";padding:0 2px 0 3px}
 p a>code:hover{color:rgba(0,0,0,.9)}
 #header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
-#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
-#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
+#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
+#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
 #content{margin-top:1.25em}
-#content:before{content:none}
+#content::before{content:none}
 #header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
 #header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
 #header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
@@ -148,11 +147,11 @@ p a>code:hover{color:rgba(0,0,0,.9)}
 #header .details span:first-child{margin-left:-.125em}
 #header .details span.email a{color:rgba(0,0,0,.85)}
 #header .details br{display:none}
-#header .details br+span:before{content:"\00a0\2013\00a0"}
-#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
-#header .details br+span#revremark:before{content:"\00a0|\00a0"}
+#header .details br+span::before{content:"\00a0\2013\00a0"}
+#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
+#header .details br+span#revremark::before{content:"\00a0|\00a0"}
 #header #revnumber{text-transform:capitalize}
-#header #revnumber:after{content:"\00a0"}
+#header #revnumber::after{content:"\00a0"}
 #content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
 #toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
 #toc>ul{margin-left:.125em}
@@ -163,7 +162,7 @@ p a>code:hover{color:rgba(0,0,0,.9)}
 #toc a{text-decoration:none}
 #toc a:active{text-decoration:underline}
 #toctitle{color:#7a2518;font-size:1.2em}
-@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
+@media screen and (min-width:768px){#toctitle{font-size:1.375em}
 body.toc2{padding-left:15em;padding-right:0}
 #toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
 #toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
@@ -172,7 +171,7 @@ body.toc2{padding-left:15em;padding-right:0}
 #toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
 body.toc2.toc-right{padding-left:0;padding-right:15em}
 body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
-@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
+@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
 #toc.toc2{width:20em}
 #toc.toc2 #toctitle{font-size:1.375em}
 #toc.toc2>ul{font-size:.95em}
@@ -183,19 +182,22 @@ body.toc2.toc-right{padding-left:0;padding-right:20em}}
 #content #toc>:last-child{margin-bottom:0}
 #footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
 #footer-text{color:rgba(255,255,255,.8);line-height:1.44}
+#content{margin-bottom:.625em}
 .sect1{padding-bottom:.625em}
-@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
+@media screen and (min-width:768px){#content{margin-bottom:1.25em}
+.sect1{padding-bottom:1.25em}}
+.sect1:last-child{padding-bottom:0}
 .sect1+.sect1{border-top:1px solid #efefed}
 #content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
-#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
+#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
 #content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
 #content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
 #content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
 .audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
 .admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
-table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
-.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
-table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
+table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
+.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
+table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
 .admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
 .admonitionblock>table td.icon{text-align:center;width:80px}
 .admonitionblock>table td.icon img{max-width:none}
@@ -214,17 +216,17 @@ table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inh
 .sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
 .literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
 .literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
-@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
-@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
+@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
+@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
 .literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
 .listingblock pre.highlightjs{padding:0}
 .listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
 .listingblock pre.prettyprint{border-width:0}
 .listingblock>.content{position:relative}
-.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
-.listingblock:hover code[data-lang]:before{display:block}
-.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
-.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
+.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
+.listingblock:hover code[data-lang]::before{display:block}
+.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
+.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
 table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
 table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
 table.pyhltable td.code{padding-left:.75em;padding-right:0}
@@ -235,35 +237,39 @@ table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
 .quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
 .quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
 .quoteblock blockquote{margin:0;padding:0;border:0}
-.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
+.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
 .quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
 .quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
 .quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
 .quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
-.quoteblock .quoteblock blockquote:before{display:none}
-.verseblock{margin:0 1em 1.25em 1em}
+.quoteblock .quoteblock blockquote::before{display:none}
+.verseblock{margin:0 1em 1.25em}
 .verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
 .verseblock pre strong{font-weight:400}
 .verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
 .quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
 .quoteblock .attribution br,.verseblock .attribution br{display:none}
 .quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
-.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
-.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
-.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
+.quoteblock.abstract{margin:0 1em 1.25em;display:block}
+.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
+.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
+.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
 table.tableblock{max-width:100%;border-collapse:separate}
-table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
+p.tableblock:last-child{margin-bottom:0}
+td.tableblock>.content{margin-bottom:-1.25em}
 table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
-table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
-table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
-table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
-table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
-table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
-table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
-table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
+table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
+table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
+table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
+table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
+table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
+table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
+table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
 table.frame-all{border-width:1px}
 table.frame-sides{border-width:0 1px}
-table.frame-topbot{border-width:1px 0}
+table.frame-topbot,table.frame-ends{border-width:1px 0}
+table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
+table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
 th.halign-left,td.halign-left{text-align:left}
 th.halign-right,td.halign-right{text-align:right}
 th.halign-center,td.halign-center{text-align:center}
@@ -281,13 +287,14 @@ ul li ol{margin-left:1.5em}
 dl dd{margin-left:1.125em}
 dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
 ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
-ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
-ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
-ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
-ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
-ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
-ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
-ul.inline>li>*{display:block}
+ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
+ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
+ul.unstyled,ol.unstyled{margin-left:0}
+ul.checklist{margin-left:.625em}
+ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
+ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
+ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
+ul.inline>li{margin-left:1.25em}
 .unstyled dl dt{font-weight:400;font-style:normal}
 ol.arabic{list-style-type:decimal}
 ol.decimal{list-style-type:decimal-leading-zero}
@@ -301,8 +308,9 @@ ol.lowergreek{list-style-type:lower-greek}
 td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
 td.hdlist1{font-weight:bold;padding-bottom:1.25em}
 .literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
-.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
-.colist>table tr>td:last-of-type{padding:.25em 0}
+.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
+.colist td:not([class]):first-child img{max-width:none}
+.colist td:not([class]):last-child{padding:.25em 0}
 .thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
 .imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
 .imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
@@ -318,9 +326,9 @@ sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:sup
 sup.footnote a,sup.footnoteref a{text-decoration:none}
 sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
 #footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
-#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
-#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
-#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
+#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
+#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
+#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
 #footnotes .footnote:last-of-type{margin-bottom:0}
 #content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
 .gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
@@ -364,16 +372,17 @@ div.unbreakable{page-break-inside:avoid}
 .yellow{color:#bfbf00}
 .yellow-background{background-color:#fafa00}
 span.icon>.fa{cursor:default}
+a span.icon>.fa{cursor:inherit}
 .admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
-.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
-.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
-.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
-.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
-.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
+.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
+.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
+.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
+.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
+.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
 .conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
 .conum[data-value] *{color:#fff!important}
 .conum[data-value]+b{display:none}
-.conum[data-value]:after{content:attr(data-value)}
+.conum[data-value]::after{content:attr(data-value)}
 pre .conum[data-value]{position:relative;top:-.125em}
 b.conum *{color:inherit!important}
 .conum:not([data-value]):empty{display:none}
@@ -385,12 +394,13 @@ p{margin-bottom:1.25rem}
 .sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
 .exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
 .print-only{display:none!important}
-@media print{@page{margin:1.25cm .75cm}
-*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
+@page{margin:1.25cm .75cm}
+@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
+html{font-size:80%}
 a{color:inherit!important;text-decoration:underline!important}
 a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
-a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
-abbr[title]:after{content:" (" attr(title) ")"}
+a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
+abbr[title]::after{content:" (" attr(title) ")"}
 pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
 thead{display:table-header-group}
 svg{max-width:100%}
@@ -398,24 +408,26 @@ p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
 h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
 #toc,.sidebarblock,.exampleblock>.content{background:none!important}
 #toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
-.sect1{padding-bottom:0!important}
-.sect1+.sect1{border:0!important}
-#header>h1:first-child{margin-top:1.25rem}
 body.book #header{text-align:center}
-body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
+body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
 body.book #header .details{border:0!important;display:block;padding:0!important}
 body.book #header .details span:first-child{margin-left:0!important}
 body.book #header .details br{display:block}
-body.book #header .details br+span:before{content:none!important}
+body.book #header .details br+span::before{content:none!important}
 body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
 body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
-.listingblock code[data-lang]:before{display:block}
-#footer{background:none!important;padding:0 .9375em}
-#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
+.listingblock code[data-lang]::before{display:block}
+#footer{padding:0 .9375em}
 .hide-on-print{display:none!important}
 .print-only{display:block!important}
 .hide-for-print{display:none!important}
 .show-for-print{display:inherit!important}}
+@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
+.sect1{padding:0!important}
+.sect1+.sect1{border:0}
+#footer{background:none}
+#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
+@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
 </style>
 </head>
 <body class="book toc2 toc-left">
@@ -435,14 +447,15 @@ body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-b
 <li><a href="#_response_code_502">Response code 502</a></li>
 <li><a href="#_response_code_500">Response code 500</a></li>
 <li><a href="#_response_code_499">Response code 499</a></li>
+<li><a href="#_response_code_413">Response code 413</a></li>
 <li><a href="#_other_400_level_response_codes">Other 400-level response codes</a></li>
 </ul>
 </li>
 <li><a href="#_investigating_a_specific_request_that_has_failed">Investigating a specific request that has failed</a>
 <ul class="sectlevel3">
-<li><a href="#_if_you_have_the_code_x_request_id_code_and_code_x_server_name_code_headers">If you have the <code>x-request-id</code> and <code>x-server-name</code> headers</a></li>
-<li><a href="#_if_you_have_the_code_x_request_id_code_but_no_code_x_server_name_code">If you have the <code>x-request-id</code>, but no <code>x-server-name</code></a></li>
-<li><a href="#_if_you_don_t_have_the_code_x_request_id_code">If you don&#8217;t have the <code>x-request-id</code></a></li>
+<li><a href="#_if_you_have_the_x_request_id_and_x_server_name_headers">If you have the <code>x-request-id</code> and <code>x-server-name</code> headers</a></li>
+<li><a href="#_if_you_have_the_x_request_id_but_no_x_server_name">If you have the <code>x-request-id</code>, but no <code>x-server-name</code></a></li>
+<li><a href="#_if_you_dont_have_the_x_request_id">If you don&#8217;t have the <code>x-request-id</code></a></li>
 <li><a href="#_if_there_is_no_muskie_log_entry">If there is no Muskie log entry</a></li>
 </ul>
 </li>
@@ -475,8 +488,9 @@ body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-b
 <li><a href="#_build_a_request_timeline">Build a request timeline</a></li>
 <li><a href="#_details_about_specific_error_messages">Details about specific error messages</a>
 <ul class="sectlevel3">
-<li><a href="#__code_no_storage_nodes_available_for_this_request_code"><code>No storage nodes available for this request</code></a></li>
-<li><a href="#__code_not_enough_free_space_for_mb_code"><code>Not enough free space for ... MB</code></a></li>
+<li><a href="#_request_has_exceeded_bytes">"Request has exceeded &#8230;&#8203; bytes"</a></li>
+<li><a href="#_no_storage_nodes_available_for_this_request">"No storage nodes available for this request"</a></li>
+<li><a href="#_not_enough_free_space_for_mb">"Not enough free space for &#8230;&#8203; MB"</a></li>
 </ul>
 </li>
 <li><a href="#_locating_metadata_for_an_object">Locating metadata for an object</a></li>
@@ -510,7 +524,7 @@ body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-b
 <ul class="sectlevel3">
 <li><a href="#_general_muskie_provided_properties">General Muskie-provided properties</a></li>
 <li><a href="#_muskie_provided_properties_for_debugging_only">Muskie-provided properties for debugging only</a></li>
-<li><a href="#__a_href_https_github_com_trentm_node_bunyan_core_fields_bunyan_a_provided_properties"><a href="https://github.com/trentm/node-bunyan#core-fields">Bunyan</a>-provided properties</a></li>
+<li><a href="#_bunyan_provided_properties">Bunyan-provided properties</a></li>
 </ul>
 </li>
 <li><a href="#_debugging_tools_quick_reference">Debugging tools quick reference</a></li>
@@ -962,7 +976,7 @@ connection, both sides will generally report an explicit socket error.</p>
 <div class="sect3">
 <h4 id="_response_code_507">Response code 507</h4>
 <div class="paragraph">
-<p>See <a href="#_not_enough_free_space_for_mb">[_not_enough_free_space_for_mb]</a>.</p>
+<p>See <a href="#_not_enough_free_space_for_mb">"Not enough free space for &#8230;&#8203; MB"</a>.</p>
 </div>
 </div>
 <div class="sect3">
@@ -1107,11 +1121,18 @@ This appears to be a client issue.</p>
 </div>
 </div>
 <div class="sect3">
+<h4 id="_response_code_413">Response code 413</h4>
+<div class="paragraph">
+<p>See <a href="#_request_has_exceeded_bytes">"Request has exceeded &#8230;&#8203; bytes"</a>.</p>
+</div>
+</div>
+<div class="sect3">
 <h4 id="_other_400_level_response_codes">Other 400-level response codes</h4>
 <div class="paragraph">
 <p>These are usually client issues, though it&#8217;s always possible there are
-server-side bugs that cause erroneous 400-level responses.  The only way to be
-sure is to examine the request and response to see if the response appears
+server-side bugs that cause erroneous 400-level responses.  (For an obscure
+example, see <a href="https://smartos.org/bugview/MANTA-2319">MANTA-2319</a>.)  The only way
+to be sure is to examine the request and response to see if the response appears
 correct.</p>
 </div>
 </div>
@@ -1155,7 +1176,7 @@ own request</a> to investigate.</p>
 details.  If you find none, see <a href="#_if_there_is_no_muskie_log_entry">If there is no Muskie log entry</a>.</p>
 </div>
 <div class="sect3">
-<h4 id="_if_you_have_the_code_x_request_id_code_and_code_x_server_name_code_headers">If you have the <code>x-request-id</code> and <code>x-server-name</code> headers</h4>
+<h4 id="_if_you_have_the_x_request_id_and_x_server_name_headers">If you have the <code>x-request-id</code> and <code>x-server-name</code> headers</h4>
 <div class="paragraph">
 <p>The <code>x-server-name</code> header gives you the uuid for the "webapi" zone that
 processed this request.</p>
@@ -1226,7 +1247,7 @@ details.  If you find none, see <a href="#_if_there_is_no_muskie_log_entry">If t
 </div>
 </div>
 <div class="sect3">
-<h4 id="_if_you_have_the_code_x_request_id_code_but_no_code_x_server_name_code">If you have the <code>x-request-id</code>, but no <code>x-server-name</code></h4>
+<h4 id="_if_you_have_the_x_request_id_but_no_x_server_name">If you have the <code>x-request-id</code>, but no <code>x-server-name</code></h4>
 <div class="paragraph">
 <p>In this case, you have to check the log files for all "webapi" zones to find the
 log entry.</p>
@@ -1284,7 +1305,7 @@ details.  If you find none, see <a href="#_if_there_is_no_muskie_log_entry">If t
 </div>
 </div>
 <div class="sect3">
-<h4 id="_if_you_don_t_have_the_code_x_request_id_code">If you don&#8217;t have the <code>x-request-id</code></h4>
+<h4 id="_if_you_dont_have_the_x_request_id">If you don&#8217;t have the <code>x-request-id</code></h4>
 <div class="paragraph">
 <p>If you don&#8217;t have the request id, then you&#8217;ll need some other information about
 the request that you can use to filter it.  Examples include:</p>
@@ -1502,7 +1523,7 @@ typically has multiple processes deployed in each zone, which means the
 saturation point (80-85% per process) is different for each type of zone:</p>
 <div class="openblock">
 <div class="content">
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 25%;">
 <col style="width: 25%;">
@@ -2367,7 +2388,7 @@ can use it like this:</p>
 <div class="paragraph">
 <p>There&#8217;s quite a lot of information here!  Among the most relevant bits:</p>
 </div>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 33.3333%;">
 <col style="width: 33.3333%;">
@@ -2470,17 +2491,72 @@ client, and we also know which Muskie zone it was.</p>
 <div class="sect2">
 <h3 id="_details_about_specific_error_messages">Details about specific error messages</h3>
 <div class="sect3">
-<h4 id="__code_no_storage_nodes_available_for_this_request_code"><code>No storage nodes available for this request</code></h4>
+<h4 id="_request_has_exceeded_bytes">"Request has exceeded &#8230;&#8203; bytes"</h4>
+<div class="paragraph">
+<p>You may observe any of the following symptoms:</p>
+</div>
+<div class="ulist">
+<ul>
+<li>
+<p>a 413 ("Request Entity Too Large") response code</p>
+</li>
+<li>
+<p>an error with name <code>MaxContentLengthExceededError</code></p>
+</li>
+<li>
+<p>an error with a message like <code>request has exceeded 11 bytes</code> (the actual
+number of bytes varies)</p>
+</li>
+<li>
+<p>a Muskie log entry showing <code>MaxSizeExceededError</code></p>
+</li>
+</ul>
+</div>
+<div class="paragraph">
+<p>All of these indicate that the client attempted a streaming upload but attempted
+to upload more bytes than Manta expected.  If the <code>max-content-length</code> header
+was provided, its value was too small for the content that was uploaded.  If the
+header was not provided, then the default value picked for the maximum streaming
+upload size was not sufficient.  In both cases, the issue can be resolved by
+having the client provide a <code>max-content-length</code> that&#8217;s at least as large as the
+object that it&#8217;s attempting to upload.</p>
+</div>
+<div class="paragraph">
+<p>Here&#8217;s an example that demonstrates the case:</p>
+</div>
+<div class="listingblock">
+<div class="content">
+<pre class="highlight"><code class="language-text" data-lang="text">$ echo 1234567890 | mput -q -H 'max-content-length: 7' /dap/public/foo
+mput: MaxContentLengthExceededError: request has exceeded 11 bytes
+$</code></pre>
+</div>
+</div>
+<div class="paragraph">
+<p>See the section on <a href="#_not_enough_free_space_for_mb">"Not enough free space for &#8230;&#8203; MB"</a> for more details on
+streaming uploads and the <code>max-content-length</code> header.  <strong>Note that the error
+message incorrectly implies that 11 bytes was the limit.</strong>  This is a
+<a href="http://smartos.org/bugview/MANTA-4214">bug</a>.  The actual limit was whatever was
+specified by the <code>max-content-length</code> header or else a default value described
+in that linked section.</p>
+</div>
+<div class="paragraph">
+<p>Note that for non-streaming uploads, the failure mode for attempting to upload
+too many bytes is less well-defined, as this is likely to break the framing of
+HTTP requests on the TCP connection.</p>
+</div>
+</div>
+<div class="sect3">
+<h4 id="_no_storage_nodes_available_for_this_request">"No storage nodes available for this request"</h4>
 
 </div>
 <div class="sect3">
-<h4 id="__code_not_enough_free_space_for_mb_code"><code>Not enough free space for ... MB</code></h4>
+<h4 id="_not_enough_free_space_for_mb">"Not enough free space for &#8230;&#8203; MB"</h4>
 <div class="paragraph">
-<p>This code (associated with 507 errors) indicates that Manta does not have enough
-space available on any storage nodes for the write <em>that was requested</em>.  This
-would be surprising in production environments, although it&#8217;s easy to induce
-even in production by requesting an absurd size.  For example, you&#8217;ll see this
-if you attempt to upload an enormous object:</p>
+<p>This message (associated with 507 errors) indicates that Manta does not have
+enough space available on enough storage nodes <em>for the write that was
+requested</em>.  This would be surprising in production environments, although it&#8217;s
+easy to induce even in production by requesting an absurd size.  For example,
+you&#8217;ll see this if you attempt to upload an enormous object:</p>
 </div>
 <div class="listingblock">
 <div class="content">
@@ -2489,20 +2565,134 @@ mput: NotEnoughSpaceError: not enough free space for 1073741824 MB</code></pre>
 </div>
 </div>
 <div class="paragraph">
-<p><a href="https://apidocs.joyent.com/manta/api.html#PutObject">Recall that Manta supports
-two kinds of uploads</a>: streaming and fixed-length.</p>
+<p>Manta determines a maximum object size for each upload request and validates
+that enough storage is available to satisfy the request.  When there aren&#8217;t
+enough storage nodes that have the required amount of space, the request fails
+with this message.  (A request will also fail if the client attempts to upload
+more than the maximum expected size, but that produces
+<a href="#_request_has_exceeded_bytes">a different error</a>.)</p>
+</div>
+<div class="paragraph">
+<p>In determining the maximum object size for an upload request,
+<a href="https://apidocs.joyent.com/manta/api.html#PutObject">Manta supports two kinds of
+uploads</a>: fixed-size and streaming.  A <strong>fixed-size</strong> upload is one that
+specifies the size of the object using the <code>content-length</code> request header.
+Manta uses this value directly as the maximum object size.  A <strong>streaming</strong>
+upload is specified using the <code>transfer-encoding: chunked</code> header.  In this
+case, the space that Manta allocates up front (and validates) is given by the
+<code>max-content-length</code> header, if provided, or else a server-side, configurable
+default value.  The <code>storage.defaultMaxStreamingSizeMB</code> property in Muskie&#8217;s
+configuration file determines this value.  This is typically populated from the
+<code>MUSKIE_DEFAULT_MAX_STREAMING_SIZE_MB</code> SAPI property.  The typical value is 5120
+MB.  <strong>This is documented in the Manta API, so changing it may break working
+clients.</strong>  Note that this default is sometimes too large in some development
+environments, which can cause streaming uploads to fail with this message.  An
+object PUT must specify either <code>transfer-encoding: chunked</code> or <code>content-length</code>.</p>
+</div>
+<div class="paragraph">
+<p>To understand a specific instance of this error, ask:</p>
+</div>
+<div class="ulist">
+<ul>
+<li>
+<p><strong>Does the size in the error message match what you (and the end user)
+expected would be required for this request?</strong> The process by which Manta
+determines this size is described above.  If this does not match what you
+and the end user expect, that may reflect a bug.  (More commonly, end users
+may not understand the semantics of <code>content-length</code> and <code>max-content-length</code>
+or operators don&#8217;t understand the <code>defaultMaxStreamingSizeMB</code> default value.
+Again, see above and the linked API documentation for an explanation of
+those.)</p>
+</li>
+<li>
+<p>If the value matches what you expect, <strong>does Manta actually have that much
+space?</strong>  This question is more complex than it sounds.  Keep in mind that:</p>
+<div class="ulist">
+<ul>
+<li>
+<p>Manta will only consider storage zones currently using less than a
+configurable maximum amount of space.  This is determined by the
+<code>storage.maxUtilizationPct</code> property of Muskie configuration files, which
+comes from the <code>MUSKIE_MAX_UTILIZATION_PCT</code> SAPI property.  For requests from
+operator accounts, the <code>storage.maxOperatorUtilizationPct</code> property is used
+instead, which comes from the <code>MUSKIE_MAX_OPERATOR_UTILIZATION_PCT</code> SAPI
+property.</p>
+</li>
+<li>
+<p>Multiple copies are written for each new object.  The number of copies is
+determined by the <code>durability-level</code> header that is specified by the client.
+All copies of the object must be assigned to separate storage zones.  The
+requested amount of space must be present on as many storage zones are there
+are supposed to be copies created.</p>
+</li>
+<li>
+<p>If this is a multi-datacenter deployment (i.e., if the <code>storage.multiDC</code>
+Muskie configuration property (which comes from the <code>MUSKIE_MULTI_DC</code> SAPI
+property) is set to a true value), then copies must be spread across
+datacenters as well.  If the number of copies is less than the number of
+datacenters (e.g., 2 copies in a 3-datacenter deployment), then all copies
+must be placed into separate datacenters (so there must be a storage zone in
+each datacenter with enough capacity).  If the number of copies is at least
+the number of datacenters, at least one copy must be placed in each
+datacenter.</p>
+</li>
+</ul>
+</div>
+</li>
+</ul>
+</div>
+<div class="paragraph">
+<p>Example: in the common case of <code>durability-level: 2</code> (the default) in a multi-DC
+deployment with <code>content-length</code> of 10 GB, there must be 10 GB of space
+available on at least one storage zone <em>in each of two datacenters</em>.  The
+request could fail with this error even if there are two storage zones with
+enough space if those storage zones are all in the same datacenter.</p>
 </div>
 <div class="paragraph">
-<p>Streaming uploads are specified using the <code>transfer-encoding: chunked</code> header.
-In this case, the space allocated up front (and validated) is specified by the
-<code>max-content-length</code> header.  If that header is missing, a default value is used
-<em>that is sometimes too large in some development environments</em>, which can cause
-streaming uploads to fail in development environments.</p>
+<p>The <code>mpicker</code> tool can be used to determine how much space is available on each
+storage zone.  The <code>mpicker poll</code> command summarizes available space on each
+storage zone that&#8217;s under the configured utilization percentage.  For example:</p>
+</div>
+<div class="listingblock">
+<div class="content">
+<pre class="highlight"><code class="language-text" data-lang="text">[root@380920d9 (webapi) ~]$ /opt/smartdc/muskie/bin/mpicker poll
+polling options:
+ max percentage utilization: 92
+
+DATACENTER MANTA_STORAGE_ID          %USED         AVAIL_MB      TIMESTAMP
+staging-3  3.stor.staging.joyent.us  91            197218        2019-04-10T21:15:35.726Z
+staging-2  2.stor.staging.joyent.us  87            306039        2019-04-10T21:15:35.221Z
+staging-1  1.stor.staging.joyent.us  81            456521        2019-04-10T21:15:37.506Z
+[root@380920d9 (webapi) ~]$</code></pre>
+</div>
+</div>
+<div class="paragraph">
+<p>The <code>mpicker choose</code> command can be used to simulate Manta&#8217;s storage allocation
+behavior for a request of a given size.  Here&#8217;s an example request for a size
+that would fail, given the above output:</p>
+</div>
+<div class="listingblock">
+<div class="content">
+<pre class="highlight"><code class="language-text" data-lang="text">[root@380920d9 (webapi) ~]$ /opt/smartdc/muskie/bin/mpicker poll -j | /opt/smartdc/muskie/bin/mpicker choose -s 310000
+replicas requested: 2
+size requested: 310000 MB
+storage server count by datacenter:
+        staging-3: 1 (0 available)
+        staging-2: 1 (0 available)
+        staging-1: 1 (1 available)
+total storage server count: 3 (1 available)
+
+could not choose storage node set: 2 copies requested, but only 1 DC(s) have sufficient space</code></pre>
+</div>
+</div>
+<div class="paragraph">
+<p>If you run <code>mpicker choose</code> in this way using the same size as you see in the
+"No space available for &#8230;&#8203; " message, you&#8217;d typically expected to see the same
+error.</p>
 </div>
 <div class="paragraph">
-<p>If an object PUT does not specify <code>transfer-encoding: chunked</code>, then it must
-specify <code>content-length</code>, in which case that value is used for allocation (and
-validation).</p>
+<p>The <code>mpicker</code> command has a number of options to control the output and simulate
+different conditions.  See the help output for details.</p>
 </div>
 </div>
 </div>
@@ -2746,7 +2936,7 @@ Codes</a> on Wikipedia</p>
 <div class="paragraph">
 <p>Here we cover only status codes with particular meanings within Manta or that are commonly used within Manta.</p>
 </div>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 33.3333%;">
 <col style="width: 33.3333%;">
@@ -2811,6 +3001,11 @@ Codes</a> on Wikipedia</p>
 <td class="tableblock halign-left valign-top"><p class="tableblock">The client issued a conditional request and the conditions were not true.  (For example, this could have been a PUT-if-the-object-does-not-already-exist, and the object already existed.)</p></td>
 </tr>
 <tr>
+<td class="tableblock halign-left valign-top"><p class="tableblock">413</p></td>
+<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Request Entity Too Large</code></p></td>
+<td class="tableblock halign-left valign-top"><p class="tableblock">The client attempted a streaming upload and sent more bytes than were allowed based on the <code>max-content-length</code> header.  See <a href="#_request_has_exceeded_bytes">"Request has exceeded &#8230;&#8203; bytes"</a> for details.</p></td>
+</tr>
+<tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock">429</p></td>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Too Many Requests</code></p></td>
 <td class="tableblock halign-left valign-top"><p class="tableblock">The client is being rate-limited by the server because it issued too many requests in too short a period.</p></td>
@@ -2836,14 +3031,9 @@ Codes</a> on Wikipedia</p>
 <td class="tableblock halign-left valign-top"><p class="tableblock">This code generally indicates that the system is overloaded and cannot process more work.  In practice, this currently means that a particular metadata shard&#8217;s queue is full, that Muskie took too long to respond to the request, or that there aren&#8217;t enough working storage nodes with enough disk space to satisfy this upload.</p></td>
 </tr>
 <tr>
-<td class="tableblock halign-left valign-top"><p class="tableblock">504</p></td>
-<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Gateway Timeout</code></p></td>
-<td class="tableblock halign-left valign-top"><p class="tableblock">Similar to 502.</p></td>
-</tr>
-<tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock">507</p></td>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Not Enough Space</code></p></td>
-<td class="tableblock halign-left valign-top"><p class="tableblock">The Manta deployment is out of physical disk space for new objects.</p></td>
+<td class="tableblock halign-left valign-top"><p class="tableblock">The Manta deployment is out of physical disk space for new objects.  See <a href="#_not_enough_free_space_for_mb">"Not enough free space for &#8230;&#8203; MB"</a> for details.</p></td>
 </tr>
 </tbody>
 </table>
@@ -2885,7 +3075,7 @@ Codes</a> on Wikipedia</p>
 <div class="paragraph">
 <p>Here we cover only headers with particular meanings within Manta or that are commonly used within Manta.</p>
 </div>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 25%;">
 <col style="width: 25%;">
@@ -3054,7 +3244,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </div>
 <div class="sect3">
 <h4 id="_general_muskie_provided_properties">General Muskie-provided properties</h4>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 33.3333%;">
 <col style="width: 33.3333%;">
@@ -3100,7 +3290,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </tr>
 <tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>req.headers</code></p></td>
-<td class="tableblock halign-left valign-top"><div><div class="listingblock">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
 <div class="content">
 <pre class="highlight"><code class="language-json" data-lang="json">{
     "accept": "*/*",
@@ -3119,7 +3309,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </tr>
 <tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>req.caller</code></p></td>
-<td class="tableblock halign-left valign-top"><div><div class="listingblock">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
 <div class="content">
 <pre class="highlight"><code class="language-json" data-lang="json">{
     "login": "poseidon",
@@ -3168,7 +3358,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </tr>
 <tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>res.headers</code></p></td>
-<td class="tableblock halign-left valign-top"><div><div class="listingblock">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
 <div class="content">
 <pre class="highlight"><code class="language-json" data-lang="json">{
     "last-modified": "Sat, 22 Mar 2014 01:17:01 GMT",
@@ -3194,7 +3384,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </div>
 <div class="sect3">
 <h4 id="_muskie_provided_properties_for_debugging_only">Muskie-provided properties for debugging only</h4>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 33.3333%;">
 <col style="width: 33.3333%;">
@@ -3240,7 +3430,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </tr>
 <tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>req.timers</code></p></td>
-<td class="tableblock halign-left valign-top"><div><div class="listingblock">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
 <div class="content">
 <pre class="highlight"><code class="language-json" data-lang="json">{
     "earlySetup": 32,
@@ -3277,7 +3467,7 @@ HTTP request.  Other log entries have other fields.)</p>
 </tr>
 <tr>
 <td class="tableblock halign-left valign-top"><p class="tableblock"><code>sharksContacted</code></p></td>
-<td class="tableblock halign-left valign-top"><div><div class="listingblock">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
 <div class="content">
 <pre class="highlight"><code class="language-json" data-lang="json">[ {
   "shark": "1.stor.staging.joyent.us",
@@ -3294,7 +3484,7 @@ HTTP request.  Other log entries have other fields.)</p>
 } ]</code></pre>
 </div>
 </div></div></td>
-<td class="tableblock halign-left valign-top"><div><div class="paragraph">
+<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
 <p>This field should be present for Manta requests that make requests to individual storage nodes.  The value is an array of storage nodes contacted as part of the request, including the result of this subrequest, when it started, and how long it took.</p>
 </div>
 <div class="paragraph">
@@ -3308,8 +3498,8 @@ HTTP request.  Other log entries have other fields.)</p>
 </table>
 </div>
 <div class="sect3">
-<h4 id="__a_href_https_github_com_trentm_node_bunyan_core_fields_bunyan_a_provided_properties"><a href="https://github.com/trentm/node-bunyan#core-fields">Bunyan</a>-provided properties</h4>
-<table class="tableblock frame-all grid-all spread">
+<h4 id="_bunyan_provided_properties"><a href="https://github.com/trentm/node-bunyan#core-fields">Bunyan</a>-provided properties</h4>
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 33.3333%;">
 <col style="width: 33.3333%;">
@@ -3366,7 +3556,7 @@ XXX that should include 503 from <em>No storage nodes available for this request
 them.  You can generally view the manual page with <code>man TOOLNAME</code> in whatever
 context you can run the tool.</p>
 </div>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 25%;">
 <col style="width: 25%;">
@@ -3481,7 +3671,7 @@ context you can run the tool.</p>
 <p>See also: <a href="https://eng.joyent.com/ras/#_glossary">Glossary of hardware terms from
 Joyent&#8217;s RAS specifications</a>.</p>
 </div>
-<table class="tableblock frame-all grid-all spread">
+<table class="tableblock frame-all grid-all stretch">
 <colgroup>
 <col style="width: 50%;">
 <col style="width: 50%;">
@@ -3887,7 +4077,7 @@ can be used to predict when wraparound autovacuums will kick off for each shard.
 </div>
 <div id="footer">
 <div id="footer-text">
-Last updated 2019-03-28 13:49:38 PDT
+Last updated 2018-12-06 09:27:23 PST
 </div>
 </div>
 </body>
-- 
2.21.0

