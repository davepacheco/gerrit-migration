{"project":"joyent/illumos-joyent","branch":"master","id":"I794121734488cf5bfd16a67f2763d8b64d51d21f","number":"3442","subject":"OS-6411 bhyve should obey hvm exclusion Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/3442","commitMessage":"OS-6411 bhyve should obey hvm exclusion\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\n","createdOn":1519326687,"lastUpdated":1519329716,"open":false,"status":"MERGED","comments":[{"timestamp":1519326687,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1519327396,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1519328083,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1519329108,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1519329374,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1519329477,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1519329503,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\nThe build is still clean (since bhyve is excluded from the makefiles)"},{"timestamp":1519329506,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1519329516,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1519329690,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1519329716,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"3","revision":"794121734488cf5bfd16a67f2763d8b64d51d21f","parents":["3e580d6fd7f1de28735598e967bc7d6c4e4a07e0"],"ref":"refs/changes/42/3442/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1519329690,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329477,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329506,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519329516,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1519329716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":98,"deletions":-69},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":104,"sizeDeletions":-82},"patchSets":[{"number":"1","revision":"135db8db3efcfe61c3eb6aa215d5302f32a8b119","parents":["aedc79a5191058147e53a0ed06346ca4933a4512"],"ref":"refs/changes/42/3442/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1519326687,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":622,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"it looks like this is unused"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":622,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yeah, that was fixed in a subsequent commit.  I\u0027ll clean it up here."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":969,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Is there a reason that this isn\u0027t held until after vmm_sol_glue_cleanup() is finished?  Likewise, I\u0027d think that it would be held during vmm_attach() to prevent concurrent attach and/or detach.  Maybe that exclusion is handled by the caller."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":969,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It\u0027s held until the end in the current code, so I\u0027ll change this to reflect it."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":99,"deletions":-69},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":105,"sizeDeletions":-82},{"number":"2","revision":"d454cc49607b86996b027c17afef1f2b5e7478d8","parents":["3e580d6fd7f1de28735598e967bc7d6c4e4a07e0"],"ref":"refs/changes/42/3442/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1519329374,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329506,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519329516,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329477,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":98,"deletions":-69},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":104,"sizeDeletions":-82},{"number":"3","revision":"794121734488cf5bfd16a67f2763d8b64d51d21f","parents":["3e580d6fd7f1de28735598e967bc7d6c4e4a07e0"],"ref":"refs/changes/42/3442/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1519329690,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329506,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519329516,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1519329716,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519329477,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":98,"deletions":-69},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":104,"sizeDeletions":-82}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}