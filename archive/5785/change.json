{"project":"joyent/sdc-cloudapi","branch":"master","id":"I5c3d878c80569f1df76af1a44cb3916e43c420b1","number":"5785","subject":"TRITON-9 affinity is racy Reviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e Approved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/5785","commitMessage":"TRITON-9 affinity is racy\nReviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\nApproved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\n","createdOn":1552478896,"lastUpdated":1554478934,"open":false,"status":"MERGED","comments":[{"timestamp":1552478896,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1552496287,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1552947881,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1552947917,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1553161421,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\nI assume all test passing fine ... otherwise consider the IA+1 not present ;-)"},{"timestamp":1553603700,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1553603739,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1554222768,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1554222805,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1554402383,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 5."},{"timestamp":1554402423,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1554402484,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 5:\n\nMost recent change is updating the tests to match the fact that feedback from dapi is now immediate (it\u0027s in called in vmapi) rather than digging up a failed job (when dapi used to be called from the provision workflow)."},{"timestamp":1554478433,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1554478931,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1554478934,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Marsell Kukuljevic"}],"currentPatchSet":{"number":"6","revision":"0a07ee22a45ea51b8229f54ef998aa47eb9d3e66","parents":["e4378701f9a26063218763573bc415ad9cc61cdb"],"ref":"refs/changes/85/5785/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1554478931,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554402423,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1554478934,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":86,"deletions":-24}],"sizeInsertions":215,"sizeDeletions":-1182},"patchSets":[{"number":"1","revision":"f98c2ea60800122356b1ec077ca35444e8b73640","parents":["7b9edc12198e2c1286c36d5fff2fdcbb566fca30"],"ref":"refs/changes/85/5785/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1552478896,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496287,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":141,"deletions":-15}],"sizeInsertions":274,"sizeDeletions":-1174},{"number":"2","revision":"52acb7a8edc8f10c3dab28ab47558372ef93733c","parents":["b23fbcb19b93215c05480b7fd0712020ee79753c"],"ref":"refs/changes/85/5785/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1552947881,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552947917,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":141,"deletions":-15}],"sizeInsertions":270,"sizeDeletions":-1173},{"number":"3","revision":"6576330a06cad1442c5c0318c711ae721df07d73","parents":["574a330b8b612412161387f6e6f649eccf99fabd"],"ref":"refs/changes/85/5785/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1553603700,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552947917,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":141,"deletions":-15}],"sizeInsertions":270,"sizeDeletions":-1173},{"number":"4","revision":"0b6fe10b2b03a8b8b1083c5689e83996dccc494f","parents":["e4378701f9a26063218763573bc415ad9cc61cdb"],"ref":"refs/changes/85/5785/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1554222768,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552947917,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553161421,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":141,"deletions":-15}],"sizeInsertions":270,"sizeDeletions":-1173},{"number":"5","revision":"5c3d878c80569f1df76af1a44cb3916e43c420b1","parents":["e4378701f9a26063218763573bc415ad9cc61cdb"],"ref":"refs/changes/85/5785/5","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1554402383,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554402423,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":86,"deletions":-24}],"sizeInsertions":215,"sizeDeletions":-1182},{"number":"6","revision":"0a07ee22a45ea51b8229f54ef998aa47eb9d3e66","parents":["e4378701f9a26063218763573bc415ad9cc61cdb"],"ref":"refs/changes/85/5785/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1554478931,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554402423,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554478433,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1554478934,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/machines.js","type":"MODIFIED","insertions":12,"deletions":-11},{"file":"lib/triton-affinity.js","type":"MODIFIED","insertions":16,"deletions":-869},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"test/affinity-unit.test.js","type":"MODIFIED","insertions":98,"deletions":-273},{"file":"test/machines/affinity.js","type":"MODIFIED","insertions":86,"deletions":-24}],"sizeInsertions":215,"sizeDeletions":-1182}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}