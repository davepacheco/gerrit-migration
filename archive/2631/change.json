{"project":"joyent/moray","branch":"master","id":"I02475989f340227c253508fd05dce60356f19345","number":"2631","subject":"MORAY-437 Limit the maximum number of queued requests for now Reviewed by: Dave Pacheco \u003cdap@joyent.com\u003e Approved by: Dave Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/2631","commitMessage":"MORAY-437 Limit the maximum number of queued requests for now\nReviewed by: Dave Pacheco \u003cdap@joyent.com\u003e\nApproved by: Dave Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1505947603,"lastUpdated":1507593323,"open":false,"status":"MERGED","comments":[{"timestamp":1505947603,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1505947639,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506103104,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1506104990,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\nI added some notes on the test plan to the ticket."},{"timestamp":1506361612,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1506361618,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1506361638,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506361680,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1506361712,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1506448063,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1506524436,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1506641743,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1506984613,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1506984644,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506984667,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1507049624,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1507136035,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1507136068,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507136087,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6."},{"timestamp":1507136115,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507136192,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6:\n\n(2 comments)\n\nPlease ignore patchset 4. I accidentally pushed the wrong commit ."},{"timestamp":1507136206,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6:\n\ns/patchset 4/patchset 5/"},{"timestamp":1507140267,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1507143123,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6:\n\nThanks for doing that extra testing.  What do you think of filing a ticket to turn your test case into an automated test?\n\nHow about the memory leak testing?"},{"timestamp":1507587695,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6:\n\nI\u0027ve filed MORAY-441, and added memory leak testing notes to the ticket."},{"timestamp":1507589275,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 7."},{"timestamp":1507589312,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\n(Rebased onto Kody\u0027s changes before running the test suite, and had to fix up some conflicts.)"},{"timestamp":1507589313,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507592944,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\nI reran the test suite with against PS7, and it passed without issue."},{"timestamp":1507593148,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1507593198,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1507593323,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"8","revision":"89d18606da8cad0b03023f020d5e113e9bc4561b","parents":["ca2d98812a35f9213b224de4c2d4ff55d6c9b5bd"],"ref":"refs/changes/31/2631/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507593198,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507589313,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1507593323,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/manatee.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":13,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":28,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"7520c73c14bd3cfc17421e4f53f180a0ebb85bdf","parents":["008773346a9f9ce4ada0ad2d78f038d20f432437"],"ref":"refs/changes/31/2631/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1505947603,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505947639,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/errors.js","line":320,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"What do you think about making this an InternalError instead?  Otherwise, it\u0027s a breaking change for consumers that currently attempt to distinguish retryable errors from non-retryable errors based on the error\u0027s name (which is all they can really do today).\n\nAlso, it\u0027s an implementation detail that there\u0027s a queue and it\u0027s full.  I think what we really want to communicate is that we\u0027re overloaded, or just that we can\u0027t handle this request for a transient reason.  That\u0027s pretty close to an InternalError anyway, I think."},{"file":"lib/errors.js","line":320,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Are you saying that this should be an InternalError because it\u0027s not retryable? It looks like we use InternalError currently for invalid SQL and failures to create buckets that are not due to the bucket already existing.\n\nI\u0027m fine with making this another error. I really just wanted to make sure the name and message were useful during debugging. I\u0027d be okay with renaming this to something that indicates that Moray is overloaded/busy."},{"file":"lib/errors.js","line":320,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think this error is retryable, and my concern is that consumers that currently enumerate the set of retryable errors will not know about this error, and they will likely do the wrong thing after this change.  Here\u0027s an example where we try to use this information in Marlin:\nhttps://github.com/joyent/manta-marlin/blob/b8af6a83903a33db529e0c9b62fc6eb6c51d91b2/common/lib/bus.js#L598-L621\n\nI suggested InternalError earlier because that\u0027s what we use for HTTP services for many transient errors, but looking at Marlin, that\u0027s not one of the known-retryable errors anyway.  What do you think about one of the other error codes there?\n\nEither way, I would suggest that the message indicate something about being overloaded, but it doesn\u0027t need to mention a queue because that\u0027s an implementation detail."},{"file":"lib/errors.js","line":320,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"We could make this a NoBackendsError, and make the message something like \"unable to acquire backend due to service being overloaded\".\n\nIn the long term, it might be good to make all of the retryable errors inherit from a TransientFailureError or something, so that clients can do a VError.hasCauseWithName() to determine whether they want to retry the request."},{"file":"lib/errors.js","line":320,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Yes, absolutely.  (Or add an informational property to the error.)  This has been long-wanted (MORAY-182)."},{"file":"lib/errors.js","line":320,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve changed this to be a NoDatabasePeersError, since I realized that NoBackendsError is what cueball returns, and might be confusing to also return from the server."},{"file":"lib/pg.js","line":544,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Should we add an assertion above for this option?"},{"file":"lib/pg.js","line":544,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/pg.js","line":609,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"It feels like this is relying on an implementation detail that\u0027s not necessarily stable.  There are a couple of options here:\n\n- We could track the count of outstanding `acquire` operations separately and check against that.\n- We could implement the limit in node-pooling instead.\n- We could choose to rely on this implementation detail anyway, but I assume the only reason is that we don\u0027t want to bother doing the other approaches and we assume we\u0027re ripping this out with the upcoming cueball-ification work anyway?  In that case, could we add an assertion at L608 that `this.pool.queue` is an array and that `this.pool.queue.length` is a number, so that at least if this changes in an obvious way, we\u0027ll know right away?"},{"file":"lib/pg.js","line":609,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027m okay relying on this implementation detail, since I don\u0027t foresee node-pooling ever having another release, and don\u0027t plan on us ever bumping to a newer version of it, since we\u0027re going to be switching to cueball instead.\n\nI\u0027ve added an assertion that this.pool.queue is an array."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/manatee.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/pg.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":25,"sizeDeletions":0},{"number":"2","revision":"4a787428c9324e2bba1752d306681dbbe7749f76","parents":["008773346a9f9ce4ada0ad2d78f038d20f432437"],"ref":"refs/changes/31/2631/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506361612,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506361638,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/manatee.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/pg.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":27,"sizeDeletions":0},{"number":"3","revision":"813236226d925a144b22d90c4f9156e4f92076e8","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/31/2631/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506361680,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506361638,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/manatee.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/pg.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":27,"sizeDeletions":0},{"number":"4","revision":"76c9924d3d2ffba3b743377039428bfdf41e7208","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/31/2631/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1506984613,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506984644,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/pg.js","line":612,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"It seems like this should probably be wrapped in a `setImmediate` to be consistent about sync vs. async.\n\nSorry that I missed this the last time."},{"file":"lib/pg.js","line":612,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/standalone.js","line":122,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Same -- it seems like this should be wrapped in setImmediate."},{"file":"lib/standalone.js","line":122,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/manatee.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":13,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":26,"sizeDeletions":-4},{"number":"5","revision":"09cda60df5e1517c1a8352709318b9ee86945f9b","parents":["42a5581051507d73236d6868d5f7ff8170fcd9d4"],"ref":"refs/changes/31/2631/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507136035,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507136068,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":201,"deletions":-91},{"file":"lib/control.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/objects/common.js","type":"MODIFIED","insertions":48,"deletions":-12},{"file":"lib/objects/del_many.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/objects/find.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"lib/objects/get.js","type":"MODIFIED","insertions":29,"deletions":-1},{"file":"lib/objects/reindex.js","type":"MODIFIED","insertions":4,"deletions":-10},{"file":"lib/objects/update.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":22,"deletions":0}],"sizeInsertions":321,"sizeDeletions":-116},{"number":"6","revision":"42a5581051507d73236d6868d5f7ff8170fcd9d4","parents":["cb5bc6393b9cbdb9e1b896501b1b46a329210da8"],"ref":"refs/changes/31/2631/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507136087,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507140267,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507136115,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/manatee.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":13,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":28,"sizeDeletions":-4},{"number":"7","revision":"02475989f340227c253508fd05dce60356f19345","parents":["ca2d98812a35f9213b224de4c2d4ff55d6c9b5bd"],"ref":"refs/changes/31/2631/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507589275,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507589313,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/manatee.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":13,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":28,"sizeDeletions":-4},{"number":"8","revision":"89d18606da8cad0b03023f020d5e113e9bc4561b","parents":["ca2d98812a35f9213b224de4c2d4ff55d6c9b5bd"],"ref":"refs/changes/31/2631/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1507593198,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507593148,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1507593323,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507589313,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"lib/manatee.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/pg.js","type":"MODIFIED","insertions":13,"deletions":0},{"file":"lib/standalone.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":3,"deletions":0}],"sizeInsertions":28,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}