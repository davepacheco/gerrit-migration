From 45dd4d67af176604be506b3bcca90d47a49f67c1 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Mon, 4 Dec 2017 18:26:05 -0800
Subject: [PATCH] joyent/node-sshpk#38 want support for more obscure DN OIDs

---
 README.md       | 30 ++++++++++++++++++++++++++++++
 lib/identity.js | 11 +++++++++++
 package.json    |  2 +-
 3 files changed, 42 insertions(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 310c2ee..646f822 100644
--- a/README.md
+++ b/README.md
@@ -614,6 +614,32 @@ Parameters
 
 Returns an Identity instance.
 
+Supported attributes in DNs:
+
+| Attribute name | OID |
+| -------------- | --- |
+| `cn` | `2.5.4.3` |
+| `o` | `2.5.4.10` |
+| `ou` | `2.5.4.11` |
+| `l` | `2.5.4.7` |
+| `s` | `2.5.4.8` |
+| `c` | `2.5.4.6` |
+| `sn` | `2.5.4.4` |
+| `postalCode` | `2.5.4.17` |
+| `serialNumber` | `2.5.4.5` |
+| `street` | `2.5.4.9` |
+| `x500UniqueIdentifier` | `2.5.4.45` |
+| `role` | `2.5.4.72` |
+| `telephoneNumber` | `2.5.4.20` |
+| `description` | `2.5.4.13` |
+| `dc` | `0.9.2342.19200300.100.1.25` |
+| `uid` | `0.9.2342.19200300.100.1.1` |
+| `mail` | `0.9.2342.19200300.100.1.3` |
+| `title` | `2.5.4.12` |
+| `gn` | `2.5.4.42` |
+| `initials` | `2.5.4.43` |
+| `pseudonym` | `2.5.4.65` |
+
 ### `Identity#toString()`
 
 Returns the identity as an LDAP-style DN string.
@@ -633,6 +659,10 @@ Set when `type` is `'host'`, `'user'`, or `'email'`, respectively. Strings.
 
 The value of the first `CN=` in the DN, if any.
 
+### `Identity#o`, `Identity#ou`, etc
+
+The value of the first attribute in the DN with the same name, if any.
+
 Errors
 ------
 
diff --git a/lib/identity.js b/lib/identity.js
index 5e9021f..1a8cefb 100644
--- a/lib/identity.js
+++ b/lib/identity.js
@@ -23,9 +23,20 @@ oids.l = '2.5.4.7';
 oids.s = '2.5.4.8';
 oids.c = '2.5.4.6';
 oids.sn = '2.5.4.4';
+oids.postalCode = '2.5.4.17';
+oids.serialNumber = '2.5.4.5';
+oids.street = '2.5.4.9';
+oids.x500UniqueIdentifier = '2.5.4.45';
+oids.role = '2.5.4.72';
+oids.telephoneNumber = '2.5.4.20';
+oids.description = '2.5.4.13';
 oids.dc = '0.9.2342.19200300.100.1.25';
 oids.uid = '0.9.2342.19200300.100.1.1';
 oids.mail = '0.9.2342.19200300.100.1.3';
+oids.title = '2.5.4.12';
+oids.gn = '2.5.4.42';
+oids.initials = '2.5.4.43';
+oids.pseudonym = '2.5.4.65';
 
 var unoids = {};
 Object.keys(oids).forEach(function (k) {
diff --git a/package.json b/package.json
index a553c66..4195770 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "sshpk",
-  "version": "1.13.1",
+  "version": "1.14.0",
   "description": "A library for finding and using SSH public keys",
   "main": "lib/index.js",
   "scripts": {
-- 
2.21.0

