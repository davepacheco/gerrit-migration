{"project":"joyent/illumos-joyent","branch":"master","id":"I9a27e9327a9c5764a2fd7bc4f5f9ce7bddc512b9","number":"6582","subject":"OS-7881 Add HMAC_SHA1 crypto tests Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/6582","commitMessage":"OS-7881 Add HMAC_SHA1 crypto tests\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\n","createdOn":1562735653,"lastUpdated":1566329297,"open":false,"status":"MERGED","comments":[{"timestamp":1562735653,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1562735804,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1564525787,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(4 comments)"},{"timestamp":1564631487,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1565216934,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1565902778,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3."},{"timestamp":1565977518,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1565982043,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1566328912,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1566329192,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1566329217,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1566329297,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"6","revision":"9a27e9327a9c5764a2fd7bc4f5f9ce7bddc512b9","parents":["1b250b21d8914e6329c3eb14fb7de2b5388917e4"],"ref":"refs/changes/82/6582/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1566329217,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977518,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"SUBM","value":"1","grantedOn":1566329297,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/Makefile.crypto","type":"ADDED","insertions":112,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile","type":"MODIFIED","insertions":11,"deletions":-122},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile.digest","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile.hmac","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/modes/aes/Makefile.subdirs","type":"MODIFIED","insertions":2,"deletions":-89}],"sizeInsertions":477,"sizeDeletions":-214},"patchSets":[{"number":"1","revision":"5d4f1a3b80e9b23b9fe7ac7c8b5df9f77d9ac417","parents":["b322ba367cdb75882f1cede5a8b22c7fd17ced94"],"ref":"refs/changes/82/6582/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1562735653,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":115,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0}],"sizeInsertions":393,"sizeDeletions":-3},{"number":"2","revision":"18cce45b8f0ed4bec19e157a57519f8e035c9382","parents":["b322ba367cdb75882f1cede5a8b22c7fd17ced94"],"ref":"refs/changes/82/6582/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1562735804,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/test/crypto-tests/runfiles/default.run","line":63,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It looks like we have 32-bit and 64-bit versions of the actual tests in the Makefile; however, this only has a bitness neutral version. Which is correct?"},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","line":0,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It looks like a large chunk of this is just a copy of the digest Makefile. Is there any way we can share the contents so they\u0027re not all duplicated?"},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","line":0,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Probably.  Let me think on that (I\u0027ll update the CR once I have something).  The only tricky part when sharing across the various crypto tests is that some of them (currently just aes_cbc_pad) is only present for PKCS#11 (there currently is no equivalent KCF mechanism to test) -- so it\u0027d be nice to make sure that can still work without too many contortions."},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":35,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Where does 1024 come from? How do we know that\u0027s large enough?"},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":35,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"It\u0027s pretty much an arbitrary amount \u0027big enough\u0027 for any of the tests -- all of the current crypto tests use that.  In this case we could probably size it to \u0027hmac_len\u0027 since the output should never be longer than that if you\u0027d prefer that."},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":35,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I just saw it as a magic constant and it wasn\u0027t clear where it was coming from."},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":52,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Any particular reason we print this in this case but not in the digest ones?"},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":52,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Not really -- the AES tests have it, but digest does not.  I have no preference either way.  I could file a bug to make things more consistent (and maybe pretty things up a bit) if you\u0027d like."},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","line":52,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t care either way. I was just confused because it was inconsistent."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":115,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0}],"sizeInsertions":393,"sizeDeletions":-3},{"number":"3","revision":"c6e3cec37e3d55a0ce8b59452c69cfe6bfb46be0","parents":["31891197ecb87e2742aca4828b47451926228841"],"ref":"refs/changes/82/6582/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1565902778,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977518,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/Makefile.crypto","type":"ADDED","insertions":112,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile","type":"MODIFIED","insertions":11,"deletions":-122},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile.digest","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile.hmac","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/modes/aes/Makefile.subdirs","type":"MODIFIED","insertions":2,"deletions":-89}],"sizeInsertions":477,"sizeDeletions":-214},{"number":"4","revision":"750112213a8e76c37dc0a96f85f87a21634b5502","parents":["31891197ecb87e2742aca4828b47451926228841"],"ref":"refs/changes/82/6582/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1565982043,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977518,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/Makefile.crypto","type":"ADDED","insertions":112,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile","type":"MODIFIED","insertions":11,"deletions":-122},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile.digest","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile.hmac","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/modes/aes/Makefile.subdirs","type":"MODIFIED","insertions":2,"deletions":-89}],"sizeInsertions":477,"sizeDeletions":-214},{"number":"5","revision":"e84a3a44184312812ade1b169dd755baa0e61a71","parents":["31891197ecb87e2742aca4828b47451926228841"],"ref":"refs/changes/82/6582/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1566329192,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977518,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/Makefile.crypto","type":"ADDED","insertions":112,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile","type":"MODIFIED","insertions":11,"deletions":-122},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile.digest","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile.hmac","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/modes/aes/Makefile.subdirs","type":"MODIFIED","insertions":2,"deletions":-89}],"sizeInsertions":477,"sizeDeletions":-214},{"number":"6","revision":"9a27e9327a9c5764a2fd7bc4f5f9ce7bddc512b9","parents":["1b250b21d8914e6329c3eb14fb7de2b5388917e4"],"ref":"refs/changes/82/6582/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1566329217,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1565977518,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1566329297,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1566328912,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/test/crypto-tests/runfiles/default.run","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"usr/src/test/crypto-tests/tests/Makefile","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/test/crypto-tests/tests/Makefile.crypto","type":"ADDED","insertions":112,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile","type":"MODIFIED","insertions":11,"deletions":-122},{"file":"usr/src/test/crypto-tests/tests/digest/Makefile.digest","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/Makefile.hmac","type":"ADDED","insertions":21,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/hmac_sha1.c","type":"ADDED","insertions":207,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/hmac/main.c","type":"ADDED","insertions":58,"deletions":0},{"file":"usr/src/test/crypto-tests/tests/modes/aes/Makefile.subdirs","type":"MODIFIED","insertions":2,"deletions":-89}],"sizeInsertions":477,"sizeDeletions":-214}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}