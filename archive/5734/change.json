{"project":"joyent/sdc-sdc","branch":"master","id":"Ia5d5405be1f43a53480083e7adddd5ee7685c35d","number":"5734","subject":"TRITON-897 RFD 34 Triton instance migration Reviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/5734","commitMessage":"TRITON-897 RFD 34 Triton instance migration\nReviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1551981581,"lastUpdated":1555426254,"open":false,"status":"MERGED","comments":[{"timestamp":1551981581,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1551981582,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 0e51ed212557f4edcbf64b3e242cdfe92622f909\n    \n    add migration abort\n    \n    commit 6a4463d1e0b49159a30c20d2eb0afdd351dd9d0a\n    \n    add full migration command\n    \n    commit 95fa3e14945459c9e52907f8bffa9069e7d6da38\n    \n    update progress message handling\n    \n    commit 3defab19ada9b114f5a695269c909f760688f75d\n    \n    use a more modern json when available (for performance)\n    \n    commit d28960ae07b1b3a3c1f5e3b1591e7cf6d58f6676\n    \n    rfd 34 instance migration: add sdc-migrate to headnode GZ"},{"timestamp":1552496790,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1553145155,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1553211531,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1553211558,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1553211560,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 1c8f70cbcca6f12f78810a1fd9858bfc5320b030\n    \n    separate common functionality into functions\n    \n    commit 50e7dd0081ea69269e1757f839fa5c4bfb38a6ca\n    \n    add migration abort\n    \n    commit fbd0b0e771c9d242f31af43193316ff5dd46fd74\n    \n    add full migration command\n    \n    commit abb003ef419f3c13b5e2dbe5e9f22d0bee30fd4f\n    \n    update progress message handling\n    \n    commit 2e5510f5c1c4bb5f1c94b838205179dd2414847a\n    \n    use a more modern json when available (for performance)\n    \n    commit 07efce997c7441d5d658f0a24ba552380cf8edd8\n    \n    rfd 34 instance migration: add sdc-migrate to headnode GZ"},{"timestamp":1553211588,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1553877084,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1554834024,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1555426254,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"3","revision":"a5d5405be1f43a53480083e7adddd5ee7685c35d","parents":["4bcd449d188f5354f41856c7a5754145401e3727"],"ref":"refs/changes/34/5734/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1554834024,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553211588,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1555426254,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/sdc-migrate","type":"ADDED","insertions":705,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":710,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"6c7d76637113d61084a2544b42df38e92e24e58f","parents":["a30c4564221fd4c9c4bb24e4b2094f430326c592"],"ref":"refs/changes/34/5734/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1551981581,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552496790,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/sdc-migrate","line":123,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Minor nit: could factor out the humanize* functions into variables to avoid duplication."},{"file":"bin/sdc-migrate","line":123,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, will do. This will also make it readable as well :)"},{"file":"bin/sdc-migrate","line":440,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Minor nit but is there any way these blocks could be factored out into a function or a variable to avoid duplication?"},{"file":"bin/sdc-migrate","line":440,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes - I will factor out to a separate check_job function."},{"file":"bin/sdc-migrate","line":528,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"trailing space"},{"file":"bin/sdc-migrate","line":528,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"bin/sdc-migrate","line":620,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I could be mis-remembering, but won\u0027t wrapping $@ with quotes pass $@ as all one string in the first argument?\n\nFor example:\n\n    #!/bin/bash\n\n    function foo() {\n        echo len $#\n        echo first arg $1\n        echo second arg $2\n    }\n\n    foo a b\n    foo \"a b\"\n\nPrints:\n\n    len 2\n    first arg a\n    second arg b\n    len 1\n    first arg a b\n    second arg"},{"file":"bin/sdc-migrate","line":620,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"The quoted \"$@\" is a special parameter in Bash, without the double quotes the arguments will be reinterpreted, e.g.:\n\n#!/bin/bash\n\nfunction foo() {\n  echo len $#\n  echo first arg $1\n  echo second arg $2\n}\n\nfoo $@\nfoo \"$@\"\n\n\nWhen running: ./foo.sh c \"d d\"\nit prints:\n\nlen 3\nfirst arg c\nsecond arg d\nlen 2\nfirst arg c\nsecond arg d d\n\nFrom the Bash docs:\n\nWhen the expansion occurs within double quotes, each parameter expands to a separate word.  That is, \"$@\" is equivalent to  \"$1\" \"$2\" ..."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/sdc-migrate","type":"ADDED","insertions":662,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":667,"sizeDeletions":-1},{"number":"2","revision":"6c3a7c2d61829cae1f885e7002eabf6d0a2e092b","parents":["4bcd449d188f5354f41856c7a5754145401e3727"],"ref":"refs/changes/34/5734/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1553211558,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553211588,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/sdc-migrate","type":"ADDED","insertions":705,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":710,"sizeDeletions":-1},{"number":"3","revision":"a5d5405be1f43a53480083e7adddd5ee7685c35d","parents":["4bcd449d188f5354f41856c7a5754145401e3727"],"ref":"refs/changes/34/5734/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1554834024,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553211588,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1553877084,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1555426254,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"bin/sdc-migrate","type":"ADDED","insertions":705,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":710,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}