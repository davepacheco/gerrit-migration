{"project":"joyent/sdc-cn-agent","branch":"master","id":"If595467520e36662a501129f1a480291bc8a74ee","number":"1260","subject":"DOCKER-994 Docker cp failed silently on alpine when copying files out of the container Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"url":"https://cr.joyent.us/1260","commitMessage":"DOCKER-994 Docker cp failed silently on alpine when copying files out of the container\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1484607110,"lastUpdated":1484955274,"open":false,"status":"MERGED","comments":[{"timestamp":1484607110,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 1."},{"timestamp":1484607111,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 7dabfe3f55e6cd2ec877b42c85bc7c9e409fe823\n    \n    Don\u0027t need shell escaping anymore since we\u0027re pasing an array of arguments to zlogin"},{"timestamp":1484607156,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1484676944,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1484685165,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1484693661,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1484698757,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 2."},{"timestamp":1484698758,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 3b172999c7f2a267f45e3b08d83f5d93fa34eeac\n    \n    remove shell-escape from package.json"},{"timestamp":1484698794,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1484699656,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1484951609,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1484951668,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1484951690,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1484951726,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1484951730,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1484955274,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Orlando Vazquez"}],"currentPatchSet":{"number":"5","revision":"322f005ac055f3ec1c1c0922d0c983f424dde533","parents":["7a343f4c7cfc68b8331529c7bbe966b4151e837f"],"ref":"refs/changes/60/1260/5","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484951730,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484698794,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1484699656,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1484951609,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1484955274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"package.json","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":4,"sizeDeletions":-20},"patchSets":[{"number":"1","revision":"3b7c8873d610dbcb22c90a4425d1ef75964b635a","parents":["32807db790eb208ce9b5a1a275c8c88cef96a791"],"ref":"refs/changes/60/1260/1","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484607110,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484607156,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/docker-stdio.js","line":28,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Can we remove that dependency from package.json too since it seems to be the only place where we use it?"},{"file":"lib/docker-stdio.js","line":303,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"It\u0027s not clear to me why escaping is not needed now, and why we need to remove that. I think having that explained in the associated ticket would help."},{"file":"lib/docker-stdio.js","line":303,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Good call, I\u0027ve updated the ticket with the rationale for this change:\n\nhttps://devhub.joyent.com/jira/browse/DOCKER-994"},{"file":"lib/docker-stdio.js","line":303,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Thanks!"},{"file":"lib/docker-stdio.js","line":306,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Mostly curious and not related to this change: is there a reason why we invoke the `push()` method using that form instead of \"zloginTarArgs.push(tar)\"?"},{"file":"lib/docker-stdio.js","line":306,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I basically want to append to the end of the array:\n\n    \u003e a \u003d [];\n    []\n    \u003e a.push([1,2,3])\n    1\n    \u003e a\n    [ [ 1, 2, 3 ] ]\n    \u003e b\u003d [];\n    []\n    \u003e Array.prototype.push.apply(b, [1,2,3]);\n    3\n    \u003e b\n    [ 1, 2, 3 ]"},{"file":"lib/docker-stdio.js","line":306,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Ah sorry, I got confused, thank you for the clarification :)"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19}],"sizeInsertions":4,"sizeDeletions":-19},{"number":"2","revision":"9f48ed2e509ee80d39e3018cadf4b2c6a4a28ee9","parents":["32807db790eb208ce9b5a1a275c8c88cef96a791"],"ref":"refs/changes/60/1260/2","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484698757,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484698794,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1484699656,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1484951609,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"package.json","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":4,"sizeDeletions":-20},{"number":"3","revision":"f595467520e36662a501129f1a480291bc8a74ee","parents":["32807db790eb208ce9b5a1a275c8c88cef96a791"],"ref":"refs/changes/60/1260/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484951668,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484698794,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1484699656,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1484951609,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"package.json","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":4,"sizeDeletions":-20},{"number":"4","revision":"6b1af881404675f4f551ad9c0734d1eea78f4e07","parents":["7a343f4c7cfc68b8331529c7bbe966b4151e837f"],"ref":"refs/changes/60/1260/4","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484951690,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484698794,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1484699656,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1484951609,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"package.json","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":4,"sizeDeletions":-20},{"number":"5","revision":"322f005ac055f3ec1c1c0922d0c983f424dde533","parents":["7a343f4c7cfc68b8331529c7bbe966b4151e837f"],"ref":"refs/changes/60/1260/5","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1484951730,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1484698794,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1484699656,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1484951609,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1484955274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/docker-stdio.js","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"package.json","type":"MODIFIED","insertions":0,"deletions":-1}],"sizeInsertions":4,"sizeDeletions":-20}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}