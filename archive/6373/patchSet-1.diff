From 53087554226c9a027d45d20c8c1c0b3a3e7efe75 Mon Sep 17 00:00:00 2001
From: Cody Peter Mello <cody.mello@joyent.com>
Date: Thu, 30 May 2019 15:52:53 +0000
Subject: [PATCH] OS-7814 Running top-level "make check" should also check
 src/fw

---
 src/Makefile    | 1 +
 src/fw/Makefile | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/Makefile b/src/Makefile
index 9c7ff263..bb6031c6 100644
--- a/src/Makefile
+++ b/src/Makefile
@@ -475,6 +475,7 @@ check: $(JSLINT) $(SUBDIRS)
 		$(JSSTYLE) $(JSSTYLE_OLDSKOOL_OPTS) $$file; \
 		[[ $$? == "0" ]] || exit 1; \
 	done)
+	@$(MAKE) -C fw check
 	@printf "\nJS style ok!\n"
 
 .PHONY: manifest
diff --git a/src/fw/Makefile b/src/fw/Makefile
index 025c264c..fc4b5972 100644
--- a/src/fw/Makefile
+++ b/src/fw/Makefile
@@ -85,7 +85,7 @@ jsstyle:
 	@printf "\n==> Running jsstyle...\n"
 	@# jsstyle doesn't echo as it goes so we add an echo to each line below
 	@(for file in $(JS_CHECK_TARGETS); do \
-		echo $(PWD)/$$file; \
+		echo $(TOP)/$$file; \
 		$(JSSTYLE) $(JSSTYLE_OPTS) $$file; \
 		[[ $$? == "0" ]] || exit 1; \
 	done)
-- 
2.21.0

