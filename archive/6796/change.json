{"project":"joyent/smartos-live","branch":"master","id":"I768ad7b52ba93ab5879d6a2b0f3a3f4942ad74ad","number":"6796","subject":"OS-7601 want channel support for imgadm Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e","owner":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"url":"https://cr.joyent.us/6796","commitMessage":"OS-7601 want channel support for imgadm\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\n","createdOn":1565884631,"lastUpdated":1568282701,"open":true,"status":"NEW","comments":[{"timestamp":1565884631,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 1."},{"timestamp":1565884638,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 06f5104688b0cf5334292db2ec154d39fc08d50a\n    \n    OS-7601 want channel support for imgadm"},{"timestamp":1565884685,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n /tmp/repo/src/img/test/update.test.js\n /tmp/repo/src/vm/common/nictag.js\n /tmp/repo/src/vm/tests/common.js\n /tmp/repo/src/vm/tests/test-alias.js\n /tmp/repo/src/vm/node_modules/nodeunit-plus/index.js\n /tmp/repo/src/vm/tests/test-bhyve-disk-resize.js\n /tmp/repo/src/vm/tests/test-bhyve-pci.js\n /tmp/repo/src/vm/tests/test-bhyve-pci_slot.js\n /tmp/repo/src/vm/tests/test-cleanup-on-failure.js\n /tmp/repo/src/vm/tests/test-create-filesystems.js\n /tmp/repo/src/vm/tests/test-create.js\n /tmp/repo/src/vm/tests/test-defaults.js\n /tmp/repo/src/vm/tests/test-disk-uuid.js\n /tmp/repo/src/vm/tests/test-docker.js\n /tmp/repo/src/vm/tests/test-firewall.js\n /tmp/repo/src/vm/tests/test-fswatcher.js\n /tmp/repo/src/vm/tests/test-hrtime.js\n /tmp/repo/src/vm/tests/test-indestructible.js\n /tmp/repo/src/vm/tests/test-internal_metadata_namespaces.js\n /tmp/repo/src/vm/tests/test-info.js\n /tmp/repo/src/vm/tests/test-lastexited.js\n /tmp/repo/src/vm/tests/test-openonerrlogger.js\n /tmp/repo/src/vm/tests/test-queue.js\n /tmp/repo/src/vm/tests/test-quota.js\n /tmp/repo/src/vm/tests/test-reboot.js\n /tmp/repo/src/vm/tests/test-reprovision.js\n /tmp/repo/src/vm/tests/test-send-recv.js\n /tmp/repo/src/vm/tests/test-snapshots.js\n /tmp/repo/src/vm/tests/test-spoof-opts.js\n /tmp/repo/src/vm/tests/test-sysinfo.js\n /tmp/repo/src/vm/tests/test-tmpfs.js\n /tmp/repo/src/vm/tests/test-update.js\n /tmp/repo/src/vm/tests/test-vrrp-nics.js\n /tmp/repo/src/vm/tests/test-vminfod.js\n /tmp/repo/src/vm/tests/test-vminfod-zonewatcher.js\n /tmp/repo/src/vm/tests/test-vminfod-zonewatcher-overflow.js\n /tmp/repo/src/vm/tests/test-vminfod-zpoolwatcher.js\n /tmp/repo/src/vm/lib/metadata/agent.js\n /tmp/repo/src/vm/lib/metadata/common.js\n /tmp/repo/src/vm/lib/metadata/crc32.js\n /tmp/repo/src/disklayout.js\n /tmp/repo/src/mkzpool.js\n /tmp/repo/src/smartdc/lib/ntp_config.js\n /tmp/repo/src/node_modules/disklayout.js\n \n 0 error(s), 6 warnings(s)\n make[1]: *** [Makefile:509: check] Error 1\n make[1]: Leaving directory \u0027/tmp/repo/src\u0027\n gmake: *** [Makefile:378: check] Error 2"},{"timestamp":1565890862,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\nI need to fix \u0027make check\u0027 - some of the new tests are tripping it up."},{"timestamp":1565946426,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 2."},{"timestamp":1565946432,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit a8f1e255c4e847c7a0a6bf4fb3ef7d1c081a0741\n    \n    fix \u0027make check\u0027 errors in imgadm tests"},{"timestamp":1565946521,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1566894660,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1566894753,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1566923347,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\n(4 comments)\n\nDo we want to keep a copy of the sdc-clients fork in the upstream repo as well and release it with a specific version number? I\u0027m somewhat weirded out by local modifications here.\n\n - imgadm list and other channel changes don\u0027t have tests\n\nI\u0027m also not really sure how much review you actually want for the specific changes, as presumably it\u0027s a straight backport of already-integrated code. So feel free to ignore my comments as required."},{"timestamp":1566989176,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3:\n\n\u003e (4 comments)\n \u003e \n \u003e Do we want to keep a copy of the sdc-clients fork in the upstream\n \u003e repo as well and release it with a specific version number?\n\nGood question: I don\u0027t know. I\u0027m not sure whether there\u0027s any precedent for out-of-band updates of a node module. We certainly could create a \u0027smartos-live\u0027 branch of sdc-clients, and in there, add a \"8.1.6\" version (the next semver available in the 8.1.x stream) then tag a release that delivers this backport.\n\nThat would involve smartos-live pulling in another node-module, \u0027backoff\u0027, introduced in IMGAPI-484. That\u0027s only an extra 77k afaict, so might be feasible. The weird thing will be though, imgadm in smartos-live would still only contain a subset of that sdc-clients module, due to our deletion of irrelevant sdc-clients content!\n\nI don\u0027t mind doing that if it\u0027ll help future maintenance.\n\n\u003e I\u0027m\n\u003e somewhat weirded out by local modifications here.\n\u003e \n\u003e - imgadm list and other channel changes don\u0027t have tests\n \nThat\u0027s fair. Initially I thought it was only imgadm sources management that warranted new tests, but I\u0027ll add sanity tests elsewhere, thanks.\n\n\u003e I\u0027m also not really sure how much review you actually want for the\n\u003e specific changes, as presumably it\u0027s a straight backport of\n\u003e already-integrated code. So feel free to ignore my comments as\n\u003e required.\n\nYes, it was a straight backport. I\u0027m not sure what\u0027s the best way to visualize that. Here\u0027s a patch showing imgapi.js in smartos-live today (without the changes from this review) with the last modification to imgapi.js from node-sdc-clients, which is:\n\ncommit 93af39d56fba23f40db6b0dc99950286ed47d1f5 (tag: v12.1.0)\nAuthor: Tim Foster \u003ctim.foster@joyent.com\u003e\nDate:   Tue Nov 20 12:10:20 2018 +0000\n\n    TRITON-774 imgapi should allow admin-only imports from URLs\n    Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\n    Approved by: Trent Mick \u003ctrentm@gmail.com\u003e\n\n\nhttps://gist.github.com/timfoster/e394c0fb9ebb16b2c80b9710d55f547e\n\nchanges I have not taken in are related to the following modules\n\n* sshpk\n* smartdc-auth\n* backoff\n\nnotably, we\u0027re not taking the cross-datacenter import work, img cloning, img import from URLs, pushing and importing docker images, none of which seem relevant to SmartOS.\n\nI\u0027ll address your other comments later today - thanks for the review!"},{"timestamp":1567003966,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3:\n\n(4 comments)"},{"timestamp":1567081079,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 4."},{"timestamp":1567081085,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit f02bd00d87aa78ed202841be13a40894f71d2e29\n    \n    update node-sdc-clients to new 8.2.0 version to get channel backport\n    update backoff, required by the above\n    improve tests a little"},{"timestamp":1567081172,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1567081195,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 4:\n\nThis change brings in the 8.2.0 sdc-clients node module, and adds a test for \u0027imgadm list\u0027 showing a source with an associated channel."},{"timestamp":1567170426,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 5."},{"timestamp":1567170434,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit d806c1b0ddd104768ad3e4347c034fb827e179b9\n    \n    fix incorrect removal of comment about this.url\n    double-check sdc-clients/lib/imgapi.js is identical to 8.2.0 copy"},{"timestamp":1567170519,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1567172440,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1567513308,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1567513402,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 7: Commit message was updated."},{"timestamp":1567513403,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1567513408,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 01d3f4ca2c5e28eeec61853ab4fc25feadbb256e\n    \n    fix incorrect removal of comment about this.url\n    double-check sdc-clients/lib/imgapi.js is identical to 8.2.0 copy\n    \n    commit ab60cd1294efe8862941e2056acc79276bc74b82\n    \n    update node-sdc-clients to new 8.2.0 version to get channel backport\n    update backoff, required by the above\n    improve tests a little\n    \n    commit 9a8e62a33924299f9302ca64599a20276cb352fb\n    \n    fix \u0027make check\u0027 errors in imgadm tests\n    \n    commit 72c936fefc3a021d5757b7da927c19f137dd5c00\n    \n    OS-7601 want channel support for imgadm"},{"timestamp":1568282604,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1568282701,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"8","revision":"9d94d49d0d4bf69139c5166bf6f5e973643d364f","parents":["b2222a797cfd65ee44b224ea90f3317725396253"],"ref":"refs/changes/96/6796/8","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1568282604,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567170519,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567172440,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-43},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-79},"patchSets":[{"number":"1","revision":"f311a7c74df44b8ae32aa7d4bad1a717c743a68e","parents":["ba0a7533def990ae0cf481992d6b37a558b4f8ff"],"ref":"refs/changes/96/6796/1","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1565884631,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1565884685,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":128,"deletions":-27},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":106,"deletions":-1}],"sizeInsertions":312,"sizeDeletions":-38},{"number":"2","revision":"4907f36902550b2ba65b64a7fc2526ff7a7c23a9","parents":["ba0a7533def990ae0cf481992d6b37a558b4f8ff"],"ref":"refs/changes/96/6796/2","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1565946426,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1565946521,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":128,"deletions":-27},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":107,"deletions":-1}],"sizeInsertions":313,"sizeDeletions":-38},{"number":"3","revision":"faaa81f91fe3a4ffb225f293378903c92c4ef3b5","parents":["cae0fbeb551c8dce7c3154b3e8b92605b6fff64b"],"ref":"refs/changes/96/6796/3","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1566894660,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1565946521,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/img/lib/sources/source.js","line":63,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"no channel here?"},{"file":"src/img/lib/sources/source.js","line":63,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Good idea, thanks."},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","line":274,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"this comment seems at odds with :286 now"},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","line":274,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Yep, that seems like it was always wrong, even before this change. I\u0027ll delete that comment.\n\nHere\u0027s a snippet:\n\n\u003e url \u003d \u0027https://ook.book.com/foobar?channel\u003dexperimental\u0027\n\u0027https://ook.book.com/foobar?channel\u003dexperimental\u0027\n\u003e var mod_url \u003d require(\u0027url\u0027)\nundefined\n\u003e mod_url.parse(url)\nUrl {\n  protocol: \u0027https:\u0027,\n  slashes: true,\n  auth: null,\n  host: \u0027ook.book.com\u0027,\n  port: null,\n  hostname: \u0027ook.book.com\u0027,\n  hash: null,\n  search: \u0027?channel\u003dexperimental\u0027,\n  query: \u0027channel\u003dexperimental\u0027,\n  pathname: \u0027/foobar\u0027,\n  path: \u0027/foobar?channel\u003dexperimental\u0027,\n  href: \u0027https://ook.book.com/foobar?channel\u003dexperimental\u0027 }\n\u003e var parsed \u003d mod_url.parse(url)\nundefined\n\u003e delete parsed.search\ntrue\n\u003e this.url \u003d mod_url.format(parsed)\n\u0027https://ook.book.com/foobar\u0027\n\u003e parsed.path\n\u0027/foobar?channel\u003dexperimental\u0027\n\u003e"},{"file":"src/img/test/import.test.js","line":107,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"don\u0027t we want to fail the test if we hit an error here?"},{"file":"src/img/test/import.test.js","line":107,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Yes, thanks. Testing that with a dummy TEST_EXPERIMENTAL_ORIGIN, the fix does correctly fails now."},{"file":"src/img/test/import.test.js","line":386,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"style nit: the other exec()s mark their args as err, o, e: can we in these new tests too please?\n\nAnd don\u0027t we want to explicitly check for err?"},{"file":"src/img/test/import.test.js","line":386,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Yep, we can certainly check for err.\n\nIn cases where we have nested execs() we can\u0027t reuse \u0027o\u0027 and \u0027e\u0027 because that fails make check with eg.\n\n/mnt/tank/projects/smartos-live.git/src/img/test/import.test.js(469): warning: identifer e hides an identifier in a parent scope\n/mnt/tank/projects/smartos-live.git/src/img/test/import.test.js(469): warning: identifer o hides an identifier in a parent scope"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":128,"deletions":-27},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":107,"deletions":-1}],"sizeInsertions":313,"sizeDeletions":-38},{"number":"4","revision":"d6404fabbd70eab77f6ef4e08fb8bf35749fc30d","parents":["cae0fbeb551c8dce7c3154b3e8b92605b6fff64b"],"ref":"refs/changes/96/6796/4","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1567081079,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567081172,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-44},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-80},{"number":"5","revision":"5b57e5502eb938ce914b9b2626bd1f91e1389be3","parents":["cae0fbeb551c8dce7c3154b3e8b92605b6fff64b"],"ref":"refs/changes/96/6796/5","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1567170426,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567170519,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567172440,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-43},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-79},{"number":"6","revision":"3e7f198ee6264b3fc4bd54f10fc3b3383992a7a3","parents":["7eb0eafe29887ff7ba5488f083304e8f6cb0382e"],"ref":"refs/changes/96/6796/6","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1567513308,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567170519,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567172440,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-43},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-79},{"number":"7","revision":"768ad7b52ba93ab5879d6a2b0f3a3f4942ad74ad","parents":["7eb0eafe29887ff7ba5488f083304e8f6cb0382e"],"ref":"refs/changes/96/6796/7","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1567513402,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567170519,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567172440,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-43},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-79},{"number":"8","revision":"9d94d49d0d4bf69139c5166bf6f5e973643d364f","parents":["b2222a797cfd65ee44b224ea90f3317725396253"],"ref":"refs/changes/96/6796/8","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1568282604,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1567170519,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1567172440,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/img/CHANGES.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/README.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"src/img/lib/cli.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"src/img/lib/imgadm.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"src/img/lib/sources/imgapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/img/lib/sources/source.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"src/img/man/imgadm.1m.md","type":"MODIFIED","insertions":14,"deletions":0},{"file":"src/img/node_modules/backoff/lib/function_call.js","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/lib/strategy/exponential.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"src/img/node_modules/backoff/node_modules/precond/package.json","type":"MODIFIED","insertions":26,"deletions":-4},{"file":"src/img/node_modules/backoff/package.json","type":"MODIFIED","insertions":34,"deletions":-5},{"file":"src/img/node_modules/sdc-clients/lib/imgapi.js","type":"MODIFIED","insertions":256,"deletions":-43},{"file":"src/img/node_modules/sdc-clients/package.json","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"src/img/package.json","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"src/img/test/import.test.js","type":"MODIFIED","insertions":127,"deletions":-1}],"sizeInsertions":571,"sizeDeletions":-79}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}]}