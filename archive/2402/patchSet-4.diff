commit bfd1aa572e5a13ba13bbf15f96ab0a036a4945c7 (refs/changes/02/2402/4)
Author: Brittany Wald <brittany.wald@joyent.com>
Date:   2017-10-09T17:41:01+00:00 (2 years ago)
    
    MANTA-3371 triggers cannot be installed with any vnodes in read-only mode
    Reviewed by: Joshua M. Clulow <jmc@joyent.com>
    Reviewed by: Richard Bradley <richard.bradley@joyent.com>
    Approved by: Richard Bradley <richard.bradley@joyent.com>

diff --git a/lib/server.js b/lib/server.js
index 51f7ce0..567ed8b 100644
--- a/lib/server.js
+++ b/lib/server.js
@@ -801,7 +801,7 @@ function sql(options) {
             opts: opts
         }, 'sql: entered');
 
-        if (options.ring.ro_) {
+        if (options.ring.ro_ && !opts.readOnlyOverride) {
             log.debug({
                 opts: opts,
                 ro: options.ring.ro_
