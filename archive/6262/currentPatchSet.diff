From 4f695926c9e25d4bf17d07fd19d0e6089c174a90 Mon Sep 17 00:00:00 2001
From: Mike Gerdts <mike.gerdts@joyent.com>
Date: Thu, 16 May 2019 14:15:30 +0000
Subject: [PATCH] bump timeout to 120 seconds

---
 src/vm/node_modules/VM.js | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/vm/node_modules/VM.js b/src/vm/node_modules/VM.js
index 9f5ffbac..3bc5deeb 100644
--- a/src/vm/node_modules/VM.js
+++ b/src/vm/node_modules/VM.js
@@ -149,7 +149,7 @@ var MAX_SNAPNAME_LENGTH = 64;
 var MINIMUM_MAX_SWAP = 256;
 var PROVISION_TIMEOUT = 300;
 var SERVICE_RESTART_TIMEOUT = 60;
-var STOP_TIMEOUT = 60;
+var STOP_TIMEOUT = 120;
 var VM = this;
 var VMINFOD_TIMEOUT = 60 * 1000;
 
@@ -17505,8 +17505,8 @@ function doShutdownStop(vmobj, options, callback)
                 cb();
             });
         }, function waitInstalled(cb) {
-            exports.waitForZoneState(vmobj, 'installed',
-                {timeout: STOP_TIMEOUT}, cb);
+            VM.waitForZoneState(vmobj, 'installed', {timeout: STOP_TIMEOUT},
+                cb);
         }, function zonecfgNoAutoboot(cb) {
             zonecfg(vmobj.uuid, [unset_autoboot], {log: log},
                 function (err, fds) {
-- 
2.21.0

