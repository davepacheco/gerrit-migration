From a8deacdb6f97f058392cb11c956fc9003b0d8bdb Mon Sep 17 00:00:00 2001
From: Sam Gwydir <sam.gwydir@joyent.com>
Date: Tue, 3 Oct 2017 20:20:10 +0000
Subject: [PATCH] MANATEE-371 Want ISM for SysV Shared Memory in Postgres >=
 9.3

---
 .gitmodules                              | 2 +-
 deps/postgresql96                        | 2 +-
 etc/9.6/postgresql.manta.coal.conf       | 2 +-
 etc/9.6/postgresql.manta.lab.conf        | 2 +-
 etc/9.6/postgresql.manta.production.conf | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/.gitmodules b/.gitmodules
index b280899..b302921 100644
--- a/.gitmodules
+++ b/.gitmodules
@@ -6,7 +6,7 @@
 	url = https://github.com/postgres/postgres.git
 [submodule "deps/postgresql96"]
 	path = deps/postgresql96
-	url = https://github.com/gwydirsam/postgres.git
+	url = https://github.com/joyent/postgres.git
 [submodule "deps/pg_repack"]
 	path = deps/pg_repack
 	url = https://github.com/reorg/pg_repack.git
diff --git a/deps/postgresql96 b/deps/postgresql96
index 5b6fe15..5cce8d5 160000
--- a/deps/postgresql96
+++ b/deps/postgresql96
@@ -1 +1 @@
-Subproject commit 5b6fe1575a16956d08623b120f6ccd39714d41ed
+Subproject commit 5cce8d5a1778ce8c52db41794891a90e5fb4d8e5
diff --git a/etc/9.6/postgresql.manta.coal.conf b/etc/9.6/postgresql.manta.coal.conf
index 5170bb8..575dd8f 100644
--- a/etc/9.6/postgresql.manta.coal.conf
+++ b/etc/9.6/postgresql.manta.coal.conf
@@ -125,7 +125,7 @@ shared_buffers = 32MB                   # min 128kB
 #replacement_sort_tuples = 150000       # limits use of replacement selection sort
 #autovacuum_work_mem = -1               # min 1MB, or -1 to use maintenance_work_mem
 #max_stack_depth = 2MB                  # min 100kB
-#dynamic_shared_memory_type = posix     # the default is the first option
+dynamic_shared_memory_type = sysv     # the default is the first option
                                         # supported by the operating system:
                                         #   posix
                                         #   sysv
diff --git a/etc/9.6/postgresql.manta.lab.conf b/etc/9.6/postgresql.manta.lab.conf
index 9bd60ee..026fe94 100644
--- a/etc/9.6/postgresql.manta.lab.conf
+++ b/etc/9.6/postgresql.manta.lab.conf
@@ -125,7 +125,7 @@ maintenance_work_mem = 1GB              # min 1MB
 #replacement_sort_tuples = 150000       # limits use of replacement selection sort
 #autovacuum_work_mem = -1               # min 1MB, or -1 to use maintenance_work_mem
 #max_stack_depth = 2MB                  # min 100kB
-#dynamic_shared_memory_type = posix     # the default is the first option
+dynamic_shared_memory_type = sysv     # the default is the first option
                                         # supported by the operating system:
                                         #   posix
                                         #   sysv
diff --git a/etc/9.6/postgresql.manta.production.conf b/etc/9.6/postgresql.manta.production.conf
index 10f800d..471910f 100644
--- a/etc/9.6/postgresql.manta.production.conf
+++ b/etc/9.6/postgresql.manta.production.conf
@@ -125,7 +125,7 @@ maintenance_work_mem = 4GB              # min 1MB
 #replacement_sort_tuples = 150000       # limits use of replacement selection sort
 #autovacuum_work_mem = -1               # min 1MB, or -1 to use maintenance_work_mem
 #max_stack_depth = 2MB                  # min 100kB
-#dynamic_shared_memory_type = posix     # the default is the first option
+dynamic_shared_memory_type = sysv     # the default is the first option
                                         # supported by the operating system:
                                         #   posix
                                         #   sysv
-- 
2.21.0

