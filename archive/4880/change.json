{"project":"joyent/manta-mako","branch":"master","id":"Ibec43535c914a9455b244cd47bc77697c3423f10","number":"4880","subject":"MANTA-3854 Mako sometimes fails to create manifests due to limitations in \u0027find\u0027 Reviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e Approved by: Trent Mick \u003ctrent.mick@joyent.com\u003e","owner":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"url":"https://cr.joyent.us/4880","commitMessage":"MANTA-3854 Mako sometimes fails to create manifests due to limitations in \u0027find\u0027\nReviewed by: Trent Mick \u003ctrent.mick@joyent.com\u003e\nApproved by: Trent Mick \u003ctrent.mick@joyent.com\u003e\n","createdOn":1537940750,"lastUpdated":1539825358,"open":false,"status":"MERGED","comments":[{"timestamp":1537940750,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 1."},{"timestamp":1537940786,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1537942062,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 2."},{"timestamp":1537942091,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1537997056,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(7 comments)"},{"timestamp":1537997680,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(2 comments)\n\nSorry, I realized that I forgot one or two other things."},{"timestamp":1538081931,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 2:\n\n(8 comments)"},{"timestamp":1538085834,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 3."},{"timestamp":1538085916,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 2:\n\n(5 comments)"},{"timestamp":1538092252,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1538157877,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(4 comments)"},{"timestamp":1538176323,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 4."},{"timestamp":1538176369,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1538177404,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1538178071,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1538178213,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1538181157,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1538419064,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1538524345,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1538548526,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1538548570,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 5."},{"timestamp":1538548620,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1538548676,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1538613124,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5: Code-Review+1\n\n(3 comments)\n\nThanks for the changes here. There are some minor notes on the new awk bits, but I think they\u0027re minor style issues and consider it optional feedback."},{"timestamp":1538615620,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 6."},{"timestamp":1538615658,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1538615816,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 6:\n\nThanks Robert.  I went ahead and took in your suggestions despite the fact that you already gave me a +1.  They\u0027re a bit cleaner and for that reason alone, I think it makes it worth it.  I tested to make sure that the output is unaffected and it is."},{"timestamp":1538615842,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 6:\n\n(2 comments)"},{"timestamp":1538708169,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 6:\n\n(4 comments)"},{"timestamp":1538721007,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 7."},{"timestamp":1538721046,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1538722289,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 7:\n\n(4 comments)"},{"timestamp":1539129247,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1539207890,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 7:\n\n(3 comments)"},{"timestamp":1539643339,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 8."},{"timestamp":1539643399,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1539643499,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 8:\n\n(3 comments)"},{"timestamp":1539717646,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 8:\n\n(1 comment)"},{"timestamp":1539732094,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 9."},{"timestamp":1539732138,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1539733595,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 9:\n\n(1 comment)\n\nClarifying usage of \"MAKO_PROCESS_MANIFEST\" would be very helpful. The only refs in the ticket still use the old 0/1, instead of the current true/false.  Clarifying that usage in any or all of a JIRA issue comment, commit message details, an appropriate doc section (e.g. Perhaps a \"SAPI Configuration\" section in mako\u0027s README.md as a starting place? I don\u0027t see a merged set of Manta SAPI tunables in some doc, e.g. at http://joyent.github.io/manta/#configuration)."},{"timestamp":1539753226,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 10."},{"timestamp":1539753274,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1539753374,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 11."},{"timestamp":1539753430,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1539804015,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 11: Code-Review+1 Integration-Approval+1"},{"timestamp":1539805786,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 12."},{"timestamp":1539805828,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1539805847,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Patch Set 12:\n\nOne more indentation nit that I wanted to clean up, plus I made provisions in the awk script to record statistics for tombstone subdirectories."},{"timestamp":1539806299,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 12: Code-Review+1 Integration-Approval+1"},{"timestamp":1539810476,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Uploaded patch set 13: Commit message was updated."},{"timestamp":1539825358,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Bogart"}],"currentPatchSet":{"number":"13","revision":"bec43535c914a9455b244cd47bc77697c3423f10","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/13","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539810476,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539805828,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1539825358,"by":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"README.md","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":133,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":155,"sizeDeletions":-13},"patchSets":[{"number":"1","revision":"f66bd30007ad5d4bee7cd66ebcf348dcdc7ac6f7","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/1","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1537940750,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1537940786,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":90,"deletions":-9},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":99,"sizeDeletions":-10},{"number":"2","revision":"4e9559e44ee79c4a88b8c9593f56607308dea70a","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/2","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1537942062,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1537942091,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/upload_mako_ls.sh","line":30,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Really should be using [[ for new tests. Also, there\u0027s no checking on the success or failure of MAKO_PROCESS_MANIFEST. What if that value is not there or there\u0027s some failure in the shell pipeline. Is it being unset the equivalent behavior to it failing the tests its used in?"},{"file":"bin/upload_mako_ls.sh","line":30,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"If that environment variable isn\u0027t set, or the file isn\u0027t there, in my opinion, that\u0027s a sign of a very strange problem that (in theory) should never happen.  What would you think about bailing out via a call to \"fatal\"?  While I\u0027m at it, I\u0027m willing to do that for other variable above if you think it\u0027s worth it."},{"file":"bin/upload_mako_ls.sh","line":30,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":30,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, that seems reasonable. At some point we probably should refactor the other parts to do something similar, but that day probably isn\u0027t today."},{"file":"bin/upload_mako_ls.sh","line":30,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"awk fundamentally is using floating point arithmetic and floating point numbers. We\u0027re trying to track the total bytes on a given account. This means that if a single storage node ever has 8 PiB of data, we will start losing accuracy, assuming that awk is using a 64-bit double with 53-bits of mantissa. While this is find for the current level of storage on a compute node, this is a time bomb. Though I don\u0027t know at what point in time that bomb will be set off. It may not be for many years.\n\nThis is especially relevant in cases where the majority of all objects are owned by a single account."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I forgot to mention that compression may also impact this. As it seems like \u0027%s\u0027 from gfind that creates this is a bit different."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"That\u0027s the only reason that I\u0027m including it -- I want to see that difference."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"For this, I think if we switched over to using GNU awk, we can set the precision to quadruple precision (128-bit).  I think this would buy us time.  Unless I\u0027m missing something, it sounds like a potential solution, but feel free to verify my understanding here: https://www.gnu.org/software/gawk/manual/html_node/Setting-precision.html\n\nNote: I\u0027d have to revisit the current mountain gorilla change to add those GNU utilizes."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"That sounds like a reasonable way to try and tackle these problems."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":140,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there a reason that we opted to have the explicit string widths?"},{"file":"bin/upload_mako_ls.sh","line":140,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Only for cosmetic reasons.  I\u0027ll get rid of it."},{"file":"bin/upload_mako_ls.sh","line":140,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":144,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there a reason that we have explicit widths here? Should we have a fixed number of decimal points for floating point values?"},{"file":"bin/upload_mako_ls.sh","line":144,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Only for cosmetic reasons.  I can get rid of that too."},{"file":"bin/upload_mako_ls.sh","line":144,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":152,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"If this fails for some reason, this will result in having an empty file sitting around in the location. Is that the behavior we want?"},{"file":"bin/upload_mako_ls.sh","line":152,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"It\u0027s undesirable.  Thanks for pointing that out.  I\u0027ll add something to delete the file."},{"file":"bin/upload_mako_ls.sh","line":152,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Does GNU find guarantee that the \u0027.\u0027 character will always be the separator? Can the locale influence this as we don\u0027t set any real locale here.\n\nDo we want to assume that a \u0027.\u0027 character will never show up in a file name?"},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"I don\u0027t know if this answers your first question, but that \u0027.\u0027 character is hard coded in GNU find as part of the process of printing the fractional part of the timestamp:\n\n      charsprinted \u003d snprintf (ns_buf, NS_BUF_LEN, \".%09ld0\", (long int)ts.tv_nsec);\n\nFor the second question, my personal opinion is that assuming that a filename won\u0027t contain a \u0027.\u0027 is a reasonable assumption, but if you disagree, let me know."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I see, OK. Well, that\u0027s good at least.\n\nI\u0027m not sure what the right assumption is. I know it would be surprising to find something that did call it. I just wanted to call out the assumption and make sure it was clear. I feel like often these things are not really well understood to be constraints. e.g. there\u0027s a new constraint that mako has on the naming of clients/users as uuids that it wasn\u0027t clear if it did or didn\u0027t have before. I\u0027m not sure we should change it, just that it\u0027s important to make sure that these kinds of things are clear."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"While I personally don\u0027t have a problem with parsing out the \u0027.\u0027 with sed, I did do it with the assumption that file names will not contain a \u0027.\u0027.  Another alternative is simply leave the fractional part of the timestamp in there, but I don\u0027t know what (if anything) else relies on this mako manifest staying faithful to the original format generated by GNU find 4.2.33, where the fractional part was not included."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"The alternative would be to just not bother using sed at all and allow the fractional part of the timestamp to go in to the manifest.  This wouldn\u0027t have an impact on anything that I\u0027m doing here, but if there are other consumers that I\u0027m not aware of, there\u0027s the risk of introducing some kind of breakage."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think what we may want is something a little bit more field aware like awk. Given that we\u0027re using TABs as the field separator, we can set FS to that and then specifically use a function that substitutes on the single field we know about. This does mean that a literal TAB in the file name also puts us at risk, but at least that\u0027s less likely to occur than a \u0027.\u0027 character.\n\nI think the choice to keep the output format the same is the right one."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Alright."},{"file":"bin/upload_mako_ls.sh","line":187,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":190,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Have you verified that gfind in this environment is built in a large file manner and will properly handle 64-bit file sizes?"},{"file":"bin/upload_mako_ls.sh","line":190,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"It looks to me like the numeric values that we care about in the stat buf (bytes and kb) are cast to \u0027uintmax_t\u0027 which is 8 bytes.  This was from analyzing the code and debugging with mdb on the storage node itself.  I do not see a -m64 specifically in the CFLAGS of any makefile, but I think that\u0027s technically fine?"},{"file":"bin/upload_mako_ls.sh","line":190,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It doesn\u0027t need to be built 64-bit, as long as built aware of large file offsets. In that case, the best thing to do would be to test a file whose size is larger than 32-bits."},{"file":"bin/upload_mako_ls.sh","line":190,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Yep.  Tested with files of sizes that require all 64 bits for representation.  GNU find prints the expected value."},{"file":"bin/upload_mako_ls.sh","line":190,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"I used mkfile to create a file whose size was larger than 32-bits and observed that GNU find printed the expected value."},{"file":"sapi_manifests/upload/manifest.json","line":4,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I can\u0027t track down anything in the docs that explains what this key actually does. Can you provide an explanation of why it\u0027s required and what it does? Is this an indication that we need to request master mode in sapi?"},{"file":"sapi_manifests/upload/manifest.json","line":4,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Okay, tracking this was a pain (the reading of manifest.json files is actually hidden in sdc-clients/lib/sapi.js). To the best of my understanding these `\"master\": true` refs in various sapi mamifest.json files (mostly in Manta-y repos) are vestigial. I\u0027m not sure they were ever used, but I haven\u0027t grokked that much of the SAPI history."},{"file":"sapi_manifests/upload/manifest.json","line":4,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"However, I\u0027m wary of just removing it without testing that it doesn\u0027t make a diff for the remote SAPI master thing."},{"file":"sapi_manifests/upload/manifest.json","line":4,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"My understanding of the parameter was obtained from https://mo.joyent.com/docs/sapi/master/#multi-dc-mode, which as I understood it means that the SAPI service moray in the mater datacenter should be consulted for SAPI data.  I spoke with Trent briefly about it before headed home for the weekend and he questioned whether the work to implement cross-DC functionality in this regard was even completely done.  I think some investigation there is probably needed.  Without a multi-datacenter config to test on, I wouldn\u0027t be confident what the behavior is even if I did know that part of the code path (which I don\u0027t).\n\nWould it be reasonable to file a ticket to track this question not just for this service but for all services that have the parameter and proceed for the time being?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":89,"deletions":-9},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":98,"sizeDeletions":-10},{"number":"3","revision":"7e93eeb6a8fce7cf2dcea210ceae28bcc5f654e3","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/3","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1538085834,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1538092252,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":94,"deletions":-9},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":103,"sizeDeletions":-10},{"number":"4","revision":"710d6abc97c999a0f4fba9a00ae37c2431df0b8f","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/4","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1538176323,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1538176369,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/upload_mako_ls.sh","line":31,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The other instances of this use the environment first and then fall back to the hardcoded value. I assume it was intentional that we removed the environmental override?"},{"file":"bin/upload_mako_ls.sh","line":31,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"You read that correctly.  I could not think of a single reason why we would ever want to consult anything other than the file itself and it didn\u0027t make sense to me to allow an environment variable override just because \"everybody\u0027s doing it\" in this case."},{"file":"bin/upload_mako_ls.sh","line":31,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think it would be better to call this out as gawk to make it clearer that we\u0027re using GNU awk and not just the PATH to make sure it\u0027s there. This would also safeguard against a case where if a future image was erroneous and missing GNU awk and doesn\u0027t fall back to the standard OS awk."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"If that\u0027s what you\u0027d prefer..."},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"We\u0027re relying on features from GNU awk, so it\u0027s useful to make it clear that\u0027s the fact in the invocation. To someone who\u0027s not familiar with it, I think it\u0027s not clear that the feature is GNU-specific. Thanks for making the change."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":94,"deletions":-9},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":103,"sizeDeletions":-10},{"number":"5","revision":"d6cf51e4f375c644a1d901a582d1dcc063031dfe","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/5","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1538548570,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1538613124,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1538548620,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/upload_mako_ls.sh","line":181,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"FWIW, could do this with just setting FS\u003d\"\\t\" or -F. Either way is fine."},{"file":"bin/upload_mako_ls.sh","line":181,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":183,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This can also be done with OFS\u003d\"\\t\" then just print x[1], x[2], etc. but either way is fine."},{"file":"bin/upload_mako_ls.sh","line":183,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":112,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":121,"sizeDeletions":-11},{"number":"6","revision":"9aa8e7b42fd6ba55420a56d19da1c0caed361f7d","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/6","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1538615620,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1538615658,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":48,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"If we\u0027re changing the node image should we not also update the version of node to something that is actually supported (e.g. 4.x or 6.x)"},{"file":"Makefile","line":48,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Will touch base with some of the others to help get a feel for the cost in terms of  testing and risks involved either way and will get back to you."},{"file":"bin/upload_mako_ls.sh","line":107,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"s/build/builds perhaps?"},{"file":"bin/upload_mako_ls.sh","line":107,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":121,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"s/along/along with maybe?"},{"file":"bin/upload_mako_ls.sh","line":121,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":183,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"It appears find has always been called, but perhaps we should profile the impact that this has on disk I/O at some point?"},{"file":"bin/upload_mako_ls.sh","line":183,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"I have filed: https://jira.joyent.us/browse/MANTA-3979"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":120,"sizeDeletions":-11},{"number":"7","revision":"716898885647b6631ae04200a4dccddc2a8a2d7d","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/7","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1538721007,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1539129247,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1538721046,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":50,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\"minimal-multiarch 18.1.0\""},{"file":"Makefile","line":50,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"bin/upload_mako_ls.sh","line":31,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Shouldn\u0027t have the `-ga` here. The input is expected to be a simple JSON object. `-ga` is about stream processing on a number of JSON objects.\n\nYou could also change that to `json -f /opt/smartdc/mako/etc/upload_config.json process_manifest` if you like. The platform\u0027s `json` command updated to json 5.1.1 in 20121121. json version 4 added the `-f FILE` option.\n\n(Frankly, the same argument goes for the other `json -ga` usages above, but that\u0027s not something you need to change for this commit.)"},{"file":"bin/upload_mako_ls.sh","line":31,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"Done"},{"file":"sapi_manifests/upload/template","line":2,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Totally a nit: Was there a reason to use 0/1 vs false/true? There isn\u0027t much prior art either way that I see in at least the Manta in eng staging. There are these boolean-y SAPI metadata vars:\n\n```\n  \"MPU_ENABLE\": true,\n      \"MANTA_TLS_INSECURE\": \"1\",\n      \"MUSKIE_MULTI_DC\": true,\n```"},{"file":"sapi_manifests/upload/template","line":2,"reviewer":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"message":"I think that\u0027s a very valuable nit.  Given that true/false works in the way that we\u0027d expect, I\u0027m going to use that."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":120,"sizeDeletions":-11},{"number":"8","revision":"85d2b8be85a8edd829255d47412f4e8620867d56","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/8","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539643339,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539643399,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":48,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This latest patchset changed the sdcnode version from 0.10 to 6.x. Was that intentional?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":122,"sizeDeletions":-13},{"number":"9","revision":"4ec82fbfdad9433a3182212df87241ec187dd2ce","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/9","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539732094,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539732138,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/upload_mako_ls.sh","line":126,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Sorry to come up with nits. This file is otherwise using spaces for indentation. Consistency (either way) within the file/repo would be good."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":121,"sizeDeletions":-12},{"number":"10","revision":"5ab9f2045391e16101a479d5f18d79c1b3cbe1ee","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/10","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539753226,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539753274,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"README.md","type":"MODIFIED","insertions":11,"deletions":0},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":132,"sizeDeletions":-12},{"number":"11","revision":"a1a8ec06bd2fe8bd8c37d65bb3ceb92837fe2c17","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/11","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539753374,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539753430,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1539804015,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1539804015,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"README.md","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":111,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":133,"sizeDeletions":-13},{"number":"12","revision":"2c170c7a17bdbde81373cdf27fd93f051c108e5f","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/12","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539805786,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539805828,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"README.md","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":133,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":155,"sizeDeletions":-13},{"number":"13","revision":"bec43535c914a9455b244cd47bc77697c3423f10","parents":["83a52a082b4a85ded434184bbec89b4dae657953"],"ref":"refs/changes/80/4880/13","uploader":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"createdOn":1539810476,"author":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1539805828,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1539806299,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1539825358,"by":{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"README.md","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"bin/upload_mako_ls.sh","type":"MODIFIED","insertions":133,"deletions":-10},{"file":"sapi_manifests/upload/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/upload/template","type":"ADDED","insertions":3,"deletions":0}],"sizeInsertions":155,"sizeDeletions":-13}],"allReviewers":[{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Robert Bogart","email":"Robert.bogart@joyent.com","username":"rhb2"}]}