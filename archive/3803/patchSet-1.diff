From 787e20e5de4fb0d95f6d5094cf829d248406f1f4 Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Wed, 11 Apr 2018 11:09:03 -0700
Subject: [PATCH] OS-6887 test-vm "test log archiving" failure: new console.log
 and platform.log surprised test case

---
 src/vm/tests/test-docker.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/vm/tests/test-docker.js b/src/vm/tests/test-docker.js
index 8f2af6dd..d6fe538b 100644
--- a/src/vm/tests/test-docker.js
+++ b/src/vm/tests/test-docker.js
@@ -1080,8 +1080,10 @@ test('test log archiving', function (t) {
         }, function (cb) {
             var log_dir = '/zones/' + state.uuid + '/logs';
 
-            // ensure we have 2 log files now
+            // Ensure we have 2 "stdio.log*" files now.
             fs.readdir(log_dir, function (err, files) {
+                files = files.filter(
+                    function (f) { return f.indexOf('stdio.log') === 0; });
                 t.ok(files.length === 2, 'vm logs: ' + JSON.stringify(files));
                 cb();
             });
-- 
2.21.0

