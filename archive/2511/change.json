{"project":"joyent/node-fash","branch":"master","id":"I73c51031814689fc4492d298f6a8a3c6f0e7825e","number":"2511","subject":"MANTA-3411 node-fash does not operate on vnode zero appropriately Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e","owner":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"url":"https://cr.joyent.us/2511","commitMessage":"MANTA-3411 node-fash does not operate on vnode zero appropriately\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e\n","createdOn":1504809796,"lastUpdated":1505924803,"open":false,"status":"MERGED","comments":[{"timestamp":1504809796,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 1."},{"timestamp":1505331278,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 2."},{"timestamp":1505338657,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 2:\n\n(8 comments)"},{"timestamp":1505339664,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1505349053,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 3."},{"timestamp":1505352462,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1505409386,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 4."},{"timestamp":1505410059,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 4: Code-Review+1\n\nThank you for the changes!"},{"timestamp":1505774171,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Code-Review+1\n\n(2 comments)"},{"timestamp":1505778644,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 5."},{"timestamp":1505782100,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1505923883,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1505924556,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1505924803,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Brittany Wald"}],"currentPatchSet":{"number":"6","revision":"73c51031814689fc4492d298f6a8a3c6f0e7825e","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/6","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505924556,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505782100,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505923883,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1505924803,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":1,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":111,"deletions":0}],"sizeInsertions":113,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"7dc6d3f2a45d0ccc8a120ff3fe2a93495c47934f","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/1","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1504809796,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":119,"deletions":0}],"sizeInsertions":121,"sizeDeletions":-1},{"number":"2","revision":"2e55d11354e5d2e31d793acaa2b2c280d233ca0d","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/2","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505331278,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"REWORK","comments":[{"file":"lib/common.js","line":94,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I am a little confused about the purpose of this entire code block, really.\n\nThe return type of \"jsprim.parseInteger()\" is either a valid Number or an instance of Error.  The Error case is ruled out by the \"instanceof\" check on L85-86, so here the value of \"parsedElement\" _must_ be a number."},{"file":"lib/common.js","line":94,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"You\u0027re right, I thought that I needed to check for the rest of the characters in the string of integers, but the parseInteger documentation indicates that is unnecessary.  I will make and test those changes."},{"file":"test/leveldb.test.js","line":183,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"superfluous \"return\"?"},{"file":"test/leveldb.test.js","line":189,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"superfluous \"return\"?"},{"file":"test/leveldb.test.js","line":194,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Where is \"count\" used?"},{"file":"test/leveldb.test.js","line":204,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I think you could just pass \"cb\" directly here in place of \"remapCb\" since it does nothing but pass on the first argument.  Though it is not _technically_ necessary, I think it is probably good hygiene to provide a callback to the in-memory backend also; e.g.\n\n    function remap_inmem(_, cb) {\n        _.hInMem.remapVnode(PNODES[1], 0, cb);\n    },\n    function remap_level(_, cb) {\n        _.hLevel.remapVnode(PNODES[1], 0, cb);\n    },\n    ..."},{"file":"test/leveldb.test.js","line":209,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"We\u0027re not actually trying to return a value here, so please break this up into:\n\n    cb(err);\n    return;"},{"file":"test/leveldb.test.js","line":213,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Just make this a 4 space indent."},{"file":"test/leveldb.test.js","line":214,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"superfluous \"return\""}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":119,"deletions":0}],"sizeInsertions":122,"sizeDeletions":-2},{"number":"3","revision":"fa6bba9adfb2034ddbe8cc017f9a0748676f278d","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/3","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505349053,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"REWORK","comments":[{"file":"test/leveldb.test.js","line":663,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"need a \"return;\" after this cb() invocation"},{"file":"test/leveldb.test.js","line":667,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"need a \"return;\" after this cb() invocation also"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":1,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":115,"deletions":0}],"sizeInsertions":117,"sizeDeletions":-7},{"number":"4","revision":"71482d5baab3594bc5c64763929f23825c489199","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/4","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505409386,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505774171,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505410059,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"comments":[{"file":"test/leveldb.test.js","line":216,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Here and below, you can use:\n\n    t.ifError(err, \u0027all steps should succeed\u0027);"},{"file":"test/leveldb.test.js","line":539,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This could just be written as:\n\n    t.ok((vnodeArray.indexOf(0) !\u003d\u003d -1),\n        \u0027vnode 0 is not in the vnode array\u0027);"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":1,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":117,"deletions":0}],"sizeInsertions":119,"sizeDeletions":-7},{"number":"5","revision":"cba668a8da8c083437f7e5632424a14950104411","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/5","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505778644,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505782100,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505923883,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":1,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":111,"deletions":0}],"sizeInsertions":113,"sizeDeletions":-7},{"number":"6","revision":"73c51031814689fc4492d298f6a8a3c6f0e7825e","parents":["07ba3ae5e7338e53c08891af874e386b3282765f"],"ref":"refs/changes/11/2511/6","uploader":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"createdOn":1505924556,"author":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505782100,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1505924803,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505923883,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":1,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/leveldb.test.js","type":"MODIFIED","insertions":111,"deletions":0}],"sizeInsertions":113,"sizeDeletions":-7}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}]}