From be50ee5bdd1140768c9e4fbd7af1a63669f0a74f Mon Sep 17 00:00:00 2001
From: Chris Burroughs <chris.burroughs@joyent.com>
Date: Wed, 23 Nov 2016 16:27:02 -0500
Subject: [PATCH] ./bin/triton fwrule get 172b1c32-2edd-4cfa-ac70-b2bcd0be0c5c

---
 lib/do_fwrule/do_get.js | 31 ++++++++++++++++++-------------
 1 file changed, 18 insertions(+), 13 deletions(-)

diff --git a/lib/do_fwrule/do_get.js b/lib/do_fwrule/do_get.js
index b919036..474c415 100644
--- a/lib/do_fwrule/do_get.js
+++ b/lib/do_fwrule/do_get.js
@@ -33,21 +33,26 @@ function do_get(subcmd, opts, args, cb) {
     }
 
     var id = args[0];
-    var cli = this.top;
+    var tritonapi = this.top.tritonapi;
 
-    cli.tritonapi.getFirewallRule(id, function onRule(err, fwrule) {
-        if (err) {
-            cb(err);
-            return;
+    common.cliSetupTritonApi({cli: this.top}, function onSetup(setupErr) {
+        if (setupErr) {
+            cb(setupErr);
         }
-
-        if (opts.json) {
-            console.log(JSON.stringify(fwrule));
-        } else {
-            console.log(JSON.stringify(fwrule, null, 4));
-        }
-
-        cb();
+        tritonapi.getFirewallRule(id, function onRule(err, fwrule) {
+            if (err) {
+                cb(err);
+                return;
+            }
+
+            if (opts.json) {
+                console.log(JSON.stringify(fwrule));
+            } else {
+                console.log(JSON.stringify(fwrule, null, 4));
+            }
+
+            cb();
+        });
     });
 }
 
-- 
2.21.0

