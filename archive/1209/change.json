{"project":"joyent/sdc-docker","branch":"master","id":"Iab9fa794765779e4359347041f5eab8d07245799","number":"1209","subject":"DOCKER-929 Support the docker v2.2 manifest format Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/1209","commitMessage":"DOCKER-929 Support the docker v2.2 manifest format\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1483637742,"lastUpdated":1500919409,"open":false,"status":"MERGED","comments":[{"timestamp":1483637742,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1483637793,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1483638616,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nOverview:\n\n* added new v2 docker model, but kept around existing v1 model for existing images\n * pull, build and commit will now only work with v2 model\n * run, inspect, rmi, history will work with either model, but preferring v2 over v1\n\n* major files changes:\n - models: I\u0027d start with the images model v2, to get overview of data changes\n - backend/images.js: mostly updating for new v2 model, plus supporting old v1 model\n\nTests:\n - I still need to finish writing v1/v2 tests (i.e. where images exist in one/both moray buckets)"},{"timestamp":1483988843,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1483988889,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nAdded test case targetting v1/v2 mixed images."},{"timestamp":1483988895,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486169155,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1486169197,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1489121167,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 4."},{"timestamp":1489121169,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 2bb582b6aca666a700d914f553c9b842b0fe7e4e\n    \n    Remove unused variable\n    \n    commit 4ff1a41af3c9ba4e41396d5fca85f1f2e27bce1c\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1489121209,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1489121220,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1489121221,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit af33d1b75d4e43b044cbbd6d99e87ba27b56d026\n    \n    Remove unused variable\n    \n    commit 46b088bdcd5fc913da0c022ff3adbdbca7dc94a1\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1489121261,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1492552514,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\n(32 comments)"},{"timestamp":1492552549,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\nI still need to play with this to grok some parts."},{"timestamp":1492622958,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 6."},{"timestamp":1492622960,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit e067f5d75bed3d7309b05a4ce86c05c3caf75703\n    \n    update copyright dates\n    \n    commit 180ce418ee4e9132e95734ea148347b476ba3d53\n    \n    Remove unused variable\n    \n    commit fbdaaadef98ea3134d4d771524ae7278c490c364\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1492622996,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493338785,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 5:\n\n(32 comments)"},{"timestamp":1493338815,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 7."},{"timestamp":1493338818,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit db12585c975cee356ac47b9797dae86ca5dc0cc6\n    \n    only use encodeURIComponent for the pull image url\n    \n    commit 09e0daca8ee255d7a84b7c39b0eb40bca8891f07\n    \n    update comments and assert uuid\n    \n    commit 4513cbd0da6c2d1a86ef746b353faabb7fea2fb2\n    \n    use underscore naming for admin endpoint \u0027/admin/images_v2\u0027\n    \n    commit 60760a69e9bd690d55d267dae25c56827173a58f\n    \n    update error message for tagging an old (deprecated) image\n    \n    commit 86d86c45d4f08c96f1380c0967f6502f7464b96e\n    \n    fix missing \u0027:\u0027 in \u0027sha256:\u0027 digest\n    \n    commit 8eeeab44bebbe18ec4a8f303cc8c720119b99e2d\n    \n    Update comments around v1/v2 images\n    \n    commit 2c41ef8f2b7de07001c6869411d01e19d5955072\n    \n    update imgFromDigest to use ImageV2.get, instead of ImageV2.list\n    \n    commit 754895fe7f20573f1f04b527fc2aea987a6a7f8b\n    \n    remove digest lookup in imgFromName, it\u0027s already done in _imgFromNameOrDigest\n    \n    commit 313e0d7a525573b5a24d7dea0a4a98e9fdb564ca\n    \n    update image ambiguity notes on docker_image_v1\n    \n    commit df6f33c1521bbd7b67f30538347d37cf54cfe56a\n    \n    use moray.get instead of moray.list, remove imgFromImgInfo(V2) functions\n    \n    commit f6edf549a78000493abd98815a04f655c5d997cb\n    \n    move log statement after err check, to avoid undefined imgs.length\n    \n    commit 60ebcc5da37170073c1d722c48f51e7346a96b37\n    \n    use 3-space indent for scratch image manifest, keeps it consistent with docker\n    \n    commit 5edcede967dc8570cf2cfd32ddb793a3264d7ae5\n    \n    rename \u0027skip_v1_images\u0027 option to \u0027skipV1Images\u0027\n    \n    commit 5870aad329a7a98343b6069cbb7942b86d57b187\n    \n    handle docker pull timeout cases where no error was given\n    \n    commit 7f6abafda47f77e2b7c0291af1589036aad1069f\n    \n    update imgmanifest reference in package.json\n    \n    commit a3431330aa7b67661f48e7aa2ebc02560a8c2368\n    \n    update copyright dates\n    \n    commit 89e4eec601fbf31b86b002846137a3f3ff9e1db1\n    \n    Remove unused variable\n    \n    commit 136310bf9c340b3c3a862eae8ed99b7061197c67\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1493338853,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1493848737,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 8."},{"timestamp":1493848739,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit fb4357845708c9933f388f2eb9d9f2323f9094ff\n    \n    add ImageFileTooBigError for large image files\n    \n    commit b98083a4c541ee4c1e57ac6d377a3476e8a8fa7d\n    \n    tests: fix cleanup of tagged images\n    \n    commit 56f52cb4a523d4c93d03e5314d179af342a59165\n    \n    docker commit - fix lookup of image by digest\n    \n    commit bfd6a465c1e608d35f75c96bb9fea565cc3f9e30\n    \n    update test for image filtering to handle different cli versions\n    \n    commit 48c0e2fac4d92c16ab45e230dfadfa0ad7669eb1\n    \n    image ancestry can point to a non-existing reference for v2.1 images\n    \n    commit e5629a222de89c3093b781a27633628662e714f4\n    \n    add a \u0027dockerImageVersion\u0027 field onto the ImageV2 model"},{"timestamp":1493848775,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494298115,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 9."},{"timestamp":1494298117,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit cb4cd123e170aff5cfa73b1915a33e3dc1a58b43\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027"},{"timestamp":1494298148,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1495042266,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 9:\n\n(3 comments)\n\n# BUG 1: parent\n\nNeed to do a check that the top image to be deleted isn\u0027t a parent for\nany other images before deleting.\n\nHere is the error that Docker-docker shows:\n\n```\nubuntu@docker112:~$ docker rmi 8d618cb3926b\nError response from daemon: conflict: unable to delete 8d618cb3926b (cannot be forced) - image has dependent child images\n```\n\nThe easiest test case I know of is to do a `docker build` with something\nlike:\n\n```\nFROM alpine:latest\nLABEL one\u003d1\nLABEL two\u003d1\n```\n\nthen get the second from the top image id from `docker history`, and\ntry to `docker rmi` that id. It should fail with that error. `docker rmi -f`\nshould also fail.\n\n\n# BUG 2: ownUuidRefCount bug\n\nhttps://gist.github.com/trentm/a76b087796f5e0643b359ec7d249391a\n\nI have a patch for this -\u003e pushed to the DOCKER-929 branch of sdc-docker.git.\n\n# BUG 3: should not untag before VM usage checks\n\n```\n$ docker --tls images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nalpine              3.5                 02674b9cb179        6 days ago          1.97MB\nalpine              latest              02674b9cb179        6 days ago          1.97MB\n\n$ docker --tls ps  -a\nCONTAINER ID  IMAGE       COMMAND      CREATED        STATUS                   PORTS  NAMES\n7382eb24cc07  alpine:3.5  \"sleep 3600\" 9 minutes ago  Up 9 minutes                    alp1\n0fa9508cd786  alpine:3.5  \"/bin/sh\"    16 hours ago   Exited (0) 15 hours ago         alp0\n\n$ docker --tls rmi alpine:3.5      # this is a bug\nUntagged: alpine:3.5\n```\n\nThat should error about \u0027alpine:3.5\u0027 being used by a container.\nNote that untagging of \"alpine:latest\" should still work.\n\nTODO: test case for this using joyentunsupport/... test images so it doesn\u0027t\nbreak when alpine:latest moves past 3.5.\n\n\n# BUG 4: `docker rmi -f \u003cname\u003e` should untag if there is a running container using this image\n\n```\n$ docker --tls ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\nd19b5abe1982        busybox:latest      \"sleep 3600\"        26 seconds ago      Up 14 seconds                           bb0\n\n$ docker --tls rmi busybox:latest\nError response from daemon: Conflict, cannot delete busybox:latest because the running container d19b5abe1982 is using it, stop it and use -f to force (491af262-2aa2-48e7-bffd-6c60ac3e0d1e)\n\n$ docker --tls rmi -f busybox:latest\nError response from daemon: Conflict, cannot force delete busybox:latest because the running container d19b5abe1982 is using it, stop it and use -f to force (68b64ba6-ecbf-48b6-9f25-2dc5273c994b)\n```\n\nShould that \u0027-f\u0027 force have worked?\nWith docker 1.12 and \u0027-f\u0027 it will untag the image, leaving the untagged image\nthere:\n\n```\nubuntu@docker112:~$ docker rmi -f busybox:latest\nUntagged: busybox:latest\nUntagged: busybox@sha256:c79345819a6882c31b41bc771d9a94fc52872fa651b36771fbe0c8461d7ee558\n\nubuntu@docker112:~$ docker images\nREPOSITORY                     TAG                 IMAGE ID            CREATED             SIZE\n\u003cnone\u003e                         \u003cnone\u003e              c75bebcdd211        42 hours ago        1.106 MB\n...\n```\n\nNote that Docker docker (at least with v1.12) has consistency issues. You *can*\nforce delete the image for a *stopped* container (not a running one), and then\nstart it again, such that you have a container running with an image that isn\u0027t\nlisted in `docker images -a`. IOW, there is a limit to how closely we should\nfollow Docker behaviour.\n\n\n# BUG 5: to discuss about deleting IMGAPI layers before Docker images\n\n`deleteImgapiLayers` runs before `deleteDockerImages`. This deletes from docker\nbuckets after deleting from IMGAPI. I think it should be other way around. Would\nrather have orphans in IMGAPI than have entries in docker_images_v2 without\ntheir layers. Thoughts?"},{"timestamp":1498256792,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 10."},{"timestamp":1498256794,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit 88b947ac7814e3ef4c1285eb69b80cf5d5620fb9\n    \n    add test case for provisioning from a docker v1 image.\n    \n    commit 1d4acb3c15d056d0465fe86222e6281046ee1dfd\n    \n    add docs to helpers.createDockerContainer, add param to select the image.\n    \n    commit c948a5d50fd41f91e79e81eb110335aa0a337591\n    \n    update docker rmi handling, add tests for docker rmi\n    \n    commit 11986122e81daee3f6beb7b5c363a65b1f7dab68\n    \n    tests: move removeTestContainers into shared cli code\n    \n    commit 84ce69e17e5bcc518fe6725d86a040093338a07e\n    \n    fix image lookup by config digest, add tests\n    \n    commit 1fec9ce8b6d36d7895e4407d3eb4bc9c58d8ef53\n    \n    image os param should be an optional field\n    \n    commit 0d98d1232ecf3eb1618a9d2a17048b73c4babee7\n    \n    add more logging to pull image workflow\n    \n    commit ee6b2a547a6e08011d4f9cab4b1f5b21d1a4e242\n    \n    add digest and uncompressedDigest for the docker build scratch image\n    \n    commit bd5e1dc4caf7a91417d1c48e2666dbf3526e1058\n    \n    correct the size of docker history entries\n    \n    commit 91510952ae9fb8c06eb12154bebd2a36379eee65\n    \n    add comments to docker_images_v2 model variable names\n    \n    commit 93ecad2e43f7c1b38ea9e06a4d133cd0da68abf4\n    \n    swap around deletion of imgapi layers and docker images, so docker images are\n    always deleted first - as it\u0027s better to have an orphaned imgapi layer than an\n    orphaned docker_images_v2 entry. Benefit here is that we also get to drop the\n    refCountFromImgapiUuid handling - i.e. this makes things simpler.\n    \n    commit f0654e98332620d0a5a37898720b679ae4e24480\n    \n    add test case for `docker rmi` with image/layer counting\n    \n    commit 7264c8da867e23f5cb4ba0e0e377512adf7bdfb2\n    \n    unset the DRY_RUN testing var for `docker rmi`\n    \n    commit 6395b7d36367e585a0ca197f4194e6b527841e87\n    \n    fix docker rmi issue (BUG 2) discussed in https://gist.github.com/trentm/a76b087796f5e0643b359ec7d249391a (issue where an IMGAPI layer that should be deleted is not deleted)\n    \n    commit dcad8902e1dab394ccd462040e58001882c1b4cd\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit 63b0bf7ba472cbe705bb4017c4735aa44d343592\n    \n    add ImageFileTooBigError for large image files\n    \n    commit b4a1e5becf172034b37f30dfb6f09658cc118fea\n    \n    tests: fix cleanup of tagged images\n    \n    commit c756b88712502f568a1444d7ac693cdd94213869\n    \n    docker commit - fix lookup of image by digest\n    \n    commit b437c47491ef5bba702563cfffe615804263be49\n    \n    update test for image filtering to handle different cli versions\n    \n    commit 2265b86a129eb8cfe80699d7323afe16efd141f0\n    \n    image ancestry can point to a non-existing reference for v2.1 images\n    \n    commit db615d2fcc6a63915b9e40851f604b2300df4d67\n    \n    add a \u0027dockerImageVersion\u0027 field onto the ImageV2 model\n    \n    commit f17b5f99b8cc0b01d7125d0976f7406ac5b07b2b\n    \n    only use encodeURIComponent for the pull image url\n    \n    commit 932e0bd3fa35a018a77c1dc745af1c5f62461b34\n    \n    update comments and assert uuid\n    \n    commit c4b7a8356166025a8c8dac8c50216d9317ae7a0e\n    \n    use underscore naming for admin endpoint \u0027/admin/images_v2\u0027\n    \n    commit db17591bff5a5f5c6781b83cfabe7b35853170d3\n    \n    update error message for tagging an old (deprecated) image\n    \n    commit 0aca5737de4ac7ceb87e2751d6078f66634ed923\n    \n    fix missing \u0027:\u0027 in \u0027sha256:\u0027 digest\n    \n    commit ca10b2fb28f3497b0c693050411a32acc8fa8e59\n    \n    Update comments around v1/v2 images\n    \n    commit 825137867339368c3789574dc699931efb636093\n    \n    update imgFromDigest to use ImageV2.get, instead of ImageV2.list\n    \n    commit a61d934546db7fddf12c62ef6d1240d068564e67\n    \n    remove digest lookup in imgFromName, it\u0027s already done in _imgFromNameOrDigest\n    \n    commit e921c4cb47dd35b5a9c4a9707b1b2d0190793733\n    \n    update image ambiguity notes on docker_image_v1\n    \n    commit 78cb0775416aebce8fa28b88878f07330db4f354\n    \n    use moray.get instead of moray.list, remove imgFromImgInfo(V2) functions\n    \n    commit e416a39a747c1c11c87b10ff3265a247eea22aa8\n    \n    move log statement after err check, to avoid undefined imgs.length\n    \n    commit 7465f7bf1d3c6b081f9268e9ae379635a2fcfd70\n    \n    use 3-space indent for scratch image manifest, keeps it consistent with docker\n    \n    commit 3174a2112a88afe2de8b5326b8a4338c83d76bb0\n    \n    rename \u0027skip_v1_images\u0027 option to \u0027skipV1Images\u0027\n    \n    commit 97d625bda6fdc659b5488414ffc1c1add0f52110\n    \n    handle docker pull timeout cases where no error was given\n    \n    commit aa7f243781084f4995dfeefacb4abbf36f0fb74a\n    \n    update imgmanifest reference in package.json\n    \n    commit 60784d8fea4ec0c3303026263d62c894d310208b\n    \n    update copyright dates\n    \n    commit a71be2e2fa228fb438819656b1ab33fdff7a1d1f\n    \n    Remove unused variable\n    \n    commit b42bbc1222dbcaf1e3fef7c26e884c6ccb1602d3\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1498256841,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1499275995,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 11."},{"timestamp":1499275996,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 42538164a4d784bb9ecb564e4f2159a57cd151e9\n    \n    allow errors that don\u0027t match the regular expression\n    \n    commit b700e42234082871842d979e96a98f0afba2882f\n    \n    tweak tests to force/bump build version\n    \n    commit 57f625290b7c60d1d3189d0ae9d4789f95a4239c\n    \n    tweak tests to force/bump build version\n    \n    commit b112e0913cec0f80ff472c8caab20c738cea4e7e\n    \n    fix docker rmi of an image that has dependent children\n    \n    commit 034aa217dfaea23fb7b3234eefe9cd3e1252f45a\n    \n    add test case for provisioning from a docker v1 image.\n    \n    commit dd515658917eab9f910c0c37081492bf69d9d42b\n    \n    add docs to helpers.createDockerContainer, add param to select the image.\n    \n    commit 6d8cd1412b751660c51ff7f52628ec6b40631749\n    \n    update docker rmi handling, add tests for docker rmi\n    \n    commit f817de2eb8732dc86756fd2d37e363184699367c\n    \n    tests: move removeTestContainers into shared cli code\n    \n    commit 1022fa8e80a26ace7e56d2dacaa7ffcbdbeddc82\n    \n    fix image lookup by config digest, add tests\n    \n    commit 118847ac5d4e7fa072da17404a262b92d122fe1c\n    \n    image os param should be an optional field\n    \n    commit 08910c66c5e81636e866e2fb573442686c413fa7\n    \n    add more logging to pull image workflow\n    \n    commit 7bf9d58bc49e82446d757d27e738396a1dc6c6db\n    \n    add digest and uncompressedDigest for the docker build scratch image\n    \n    commit 95afae0347fc408224d2979e2e3ef484511904fe\n    \n    correct the size of docker history entries\n    \n    commit 1f762408ee791904dd5c642861951b39ab194e3d\n    \n    add comments to docker_images_v2 model variable names\n    \n    commit ba98e8d2990a6fb1e3f394dd7ef3b377d5f2244f\n    \n    swap around deletion of imgapi layers and docker images, so docker images are\n    always deleted first - as it\u0027s better to have an orphaned imgapi layer than an\n    orphaned docker_images_v2 entry. Benefit here is that we also get to drop the\n    refCountFromImgapiUuid handling - i.e. this makes things simpler.\n    \n    commit 5047e374e5c2cdd2ae11fff4528ff693729aacc5\n    \n    add test case for `docker rmi` with image/layer counting\n    \n    commit ef441399d1d8c1bb1869bdff5b5ab37e2dfb7b0d\n    \n    unset the DRY_RUN testing var for `docker rmi`\n    \n    commit 23dc85e20db928ee0b8e2a18e3c756e838519182\n    \n    fix docker rmi issue (BUG 2) discussed in https://gist.github.com/trentm/a76b087796f5e0643b359ec7d249391a (issue where an IMGAPI layer that should be deleted is not deleted)\n    \n    commit 58a21c13b0756d67ebf6e6dd32aed649491b0e1a\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit d529e6e535f25b6e8b720744e20bcde461b7be7c\n    \n    add ImageFileTooBigError for large image files\n    \n    commit 62ec0ef1d785bc75ee18657bb988650490c542c5\n    \n    tests: fix cleanup of tagged images\n    \n    commit 58d89951e42c4533a92df530bad19f70ef999d74\n    \n    docker commit - fix lookup of image by digest\n    \n    commit 371b61386a35a871ae6b1dece3a9e8318f0422e4\n    \n    update test for image filtering to handle different cli versions\n    \n    commit 5ef0c8c076dcbf6d4dbc05a094474543e1e9c89f\n    \n    image ancestry can point to a non-existing reference for v2.1 images\n    \n    commit df1884a3f1900841a64da8a4285d4b2e34f33955\n    \n    add a \u0027dockerImageVersion\u0027 field onto the ImageV2 model\n    \n    commit 8bb4409350cb25e6e3b5a08d5f70bd1af68d5399\n    \n    only use encodeURIComponent for the pull image url\n    \n    commit feb953b7c4c1a6c4949852f1bf93c35526a8124f\n    \n    update comments and assert uuid\n    \n    commit 6b5712ede17dc7f62ead7d326680fb86ab2fab3b\n    \n    use underscore naming for admin endpoint \u0027/admin/images_v2\u0027\n    \n    commit 30d4f7ef059c13201f999433fd5e20389482413c\n    \n    update error message for tagging an old (deprecated) image\n    \n    commit e2c782723459936661e831b0962f87e91bfa2cbe\n    \n    fix missing \u0027:\u0027 in \u0027sha256:\u0027 digest\n    \n    commit 06cc4473024768b3ddc975b7f2cb55290924e64b\n    \n    Update comments around v1/v2 images\n    \n    commit 27c34518f296a7732d652b996d414f8a91cb8297\n    \n    update imgFromDigest to use ImageV2.get, instead of ImageV2.list\n    \n    commit e07d126bbb0330bd08bdb8df827e4ce340c5a650\n    \n    remove digest lookup in imgFromName, it\u0027s already done in _imgFromNameOrDigest\n    \n    commit 85d54ce2948644de1e469560d5bb221bca2a0b5e\n    \n    update image ambiguity notes on docker_image_v1\n    \n    commit 37b4bb4749ccd617dd4167c160c16a64db19c77e\n    \n    use moray.get instead of moray.list, remove imgFromImgInfo(V2) functions\n    \n    commit cd46fd4603fe92bc291d5d64c6d841ae23a8ef49\n    \n    move log statement after err check, to avoid undefined imgs.length\n    \n    commit 5caa1753d69fdae0babc32155faf83127d0f455a\n    \n    use 3-space indent for scratch image manifest, keeps it consistent with docker\n    \n    commit 7dd95e79747336cd3ee3636fa559a20e15702055\n    \n    rename \u0027skip_v1_images\u0027 option to \u0027skipV1Images\u0027\n    \n    commit b3445757a8ed2fdd89e83b0d5c1be800c91ca54b\n    \n    handle docker pull timeout cases where no error was given\n    \n    commit 32b9ada0a53c090432d1d0e673dc337078e90316\n    \n    update imgmanifest reference in package.json\n    \n    commit b0f12c800d3c1e9a4036d53774cf35bcf73d42ec\n    \n    update copyright dates\n    \n    commit 4e99ce4765b3d78a502074046629e55b818ec908\n    \n    Remove unused variable\n    \n    commit e987736a242116e2b4fb189ff03e383a48204040\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1499276025,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500408869,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 12."},{"timestamp":1500408871,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit 7ab30d65d089d542f002eb3f6e6d43c54beda5ed\n    \n    tests: add sleep command to v1-v2 images test to avoid fast ending process"},{"timestamp":1500408900,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500580298,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 13: Patch Set 12 was rebased"},{"timestamp":1500580363,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13:\n\n\"make check\" passed ok"},{"timestamp":1500585768,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 13: Code-Review+1 Integration-Approval+1"},{"timestamp":1500585889,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 14: Patch Set 13 was rebased"},{"timestamp":1500585923,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14:\n\n\"make check\" passed ok"},{"timestamp":1500586000,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 15."},{"timestamp":1500586043,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15:\n\n\"make check\" passed ok"},{"timestamp":1500586100,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 16."},{"timestamp":1500586102,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 16:\n\nNew commits:\n    \n    commit 54cc96df672086281515e95077dfccaabb9c4c62\n    \n    tests: add sleep command to v1-v2 images test to avoid fast ending process\n    \n    commit fbd9a6c90e06171cefc53f4471f8cdef9183f55d\n    \n    allow errors that don\u0027t match the regular expression\n    \n    commit 30a546516b4389c5c69ac94eea5f60d42d8c432a\n    \n    tweak tests to force/bump build version\n    \n    commit 7307cd879c6a3f75e9b1c14521df41b55a8dfc43\n    \n    tweak tests to force/bump build version\n    \n    commit 62d6257ccd049b7cecf7cc36edcd736fbf6f297a\n    \n    fix docker rmi of an image that has dependent children\n    \n    commit 0ad43a7b30c6d8662dc15a1fcc80c0021cbc7d58\n    \n    add test case for provisioning from a docker v1 image.\n    \n    commit c1087207a080ef83f31ac0c0e0232c65c23bc7cf\n    \n    add docs to helpers.createDockerContainer, add param to select the image.\n    \n    commit 782a0a36350f081546488fb126cf8fe3b0de37e6\n    \n    update docker rmi handling, add tests for docker rmi\n    \n    commit e7c03ed9beb529838a6c9fe5ae05666d04b6ae2f\n    \n    tests: move removeTestContainers into shared cli code\n    \n    commit 6edf8def99781e1bb879651261af01a483eea97e\n    \n    fix image lookup by config digest, add tests\n    \n    commit 890450b69df3faec722cfd10c0af9ef7aa161e8d\n    \n    image os param should be an optional field\n    \n    commit abf3913a8d2ca15e7e114b36155d0ed7484ada33\n    \n    add more logging to pull image workflow\n    \n    commit b515d795df869718ce2887de884e75f42c222747\n    \n    add digest and uncompressedDigest for the docker build scratch image\n    \n    commit fc5bfb313869c3ed3f45dea5ce38a1bd1006f2bd\n    \n    correct the size of docker history entries\n    \n    commit 1aee268b9706221d81e0fdacfce6180cc4873691\n    \n    add comments to docker_images_v2 model variable names\n    \n    commit a5d88bc661fbcd23785ec4f077cdc156486a7be9\n    \n    swap around deletion of imgapi layers and docker images, so docker images are\n    always deleted first - as it\u0027s better to have an orphaned imgapi layer than an\n    orphaned docker_images_v2 entry. Benefit here is that we also get to drop the\n    refCountFromImgapiUuid handling - i.e. this makes things simpler.\n    \n    commit 6e51f914cbe4c9afa018556216c4dd6e9fd5751a\n    \n    add test case for `docker rmi` with image/layer counting\n    \n    commit c1b711c0b4862eea72fe26a94ce091a5eb949fc9\n    \n    unset the DRY_RUN testing var for `docker rmi`\n    \n    commit 907122bee869c0bce817ec834ff02b2791c119d7\n    \n    fix docker rmi issue (BUG 2) discussed in https://gist.github.com/trentm/a76b087796f5e0643b359ec7d249391a (issue where an IMGAPI layer that should be deleted is not deleted)\n    \n    commit 5505a5b82a5b15281e649b0520bfe7aa1cdfbcc3\n    \n    rename \u0027digest\u0027 to \u0027config_digest\u0027\n    \n    commit 455bc624f634813e64e0fa906080dc021fa00090\n    \n    add ImageFileTooBigError for large image files\n    \n    commit b8caba2ba97072f8755e6fdeb6016698e1d281ba\n    \n    tests: fix cleanup of tagged images\n    \n    commit 9637f6bffe852486f56b0a4af1b231b3afe0e3a2\n    \n    docker commit - fix lookup of image by digest\n    \n    commit 431aa7d203273cf9d437b38bce77b3e051ce80da\n    \n    update test for image filtering to handle different cli versions\n    \n    commit 47646f693fddfd53d6ec2b2c19ef3f6591813edf\n    \n    image ancestry can point to a non-existing reference for v2.1 images\n    \n    commit 0882a1d657de68051517f0725d49ad5b9b8e9a8f\n    \n    add a \u0027dockerImageVersion\u0027 field onto the ImageV2 model\n    \n    commit 218fa2becb11748e2e4d0d9df6d42505b656d579\n    \n    only use encodeURIComponent for the pull image url\n    \n    commit 7566833356eae4c6f139e8030d50e38c18351016\n    \n    update comments and assert uuid\n    \n    commit e68f35f749cbfcd9fc5624b0c6e0d9cbd0d68aa3\n    \n    use underscore naming for admin endpoint \u0027/admin/images_v2\u0027\n    \n    commit 2c943c8536256e30e639c1bf6db666a0da707980\n    \n    update error message for tagging an old (deprecated) image\n    \n    commit 0b35cf88b38211271938966941ee1d84437ad43a\n    \n    fix missing \u0027:\u0027 in \u0027sha256:\u0027 digest\n    \n    commit a450826791c7ab5b30e5dc580a292c6cefea9d37\n    \n    Update comments around v1/v2 images\n    \n    commit 47706b52d69fbd71c5dd1f4e487c00236578250e\n    \n    update imgFromDigest to use ImageV2.get, instead of ImageV2.list\n    \n    commit f5c1906f7d32fe6dd8cafdddeb0679a10dd39981\n    \n    remove digest lookup in imgFromName, it\u0027s already done in _imgFromNameOrDigest\n    \n    commit a9b977bda80930921becf9b0bf144db41631b902\n    \n    update image ambiguity notes on docker_image_v1\n    \n    commit c2bf70665c1fe033198205c6ab425fb3c7e89289\n    \n    use moray.get instead of moray.list, remove imgFromImgInfo(V2) functions\n    \n    commit e7c823de88ad709289c4422970a425f2c5454a2e\n    \n    move log statement after err check, to avoid undefined imgs.length\n    \n    commit 27e3a4eaeecf4618432373561c25598699519169\n    \n    use 3-space indent for scratch image manifest, keeps it consistent with docker\n    \n    commit c21c33a7249b1198de40419ed6af615c5a746792\n    \n    rename \u0027skip_v1_images\u0027 option to \u0027skipV1Images\u0027\n    \n    commit a961c7c7a4eac4e9b2fd59015981ffd58eceb861\n    \n    handle docker pull timeout cases where no error was given\n    \n    commit 0c28f8338a4ec30c5d7ea8a530ff1d1b8685fc43\n    \n    update imgmanifest reference in package.json\n    \n    commit 9e810594a082a52a82a1c030db89732b641ec4e7\n    \n    update copyright dates\n    \n    commit 5a585256c8818407f02156437438569e94d00b49\n    \n    Remove unused variable\n    \n    commit 556417883ea18ca5adb7d8987371d5c8ff364608\n    \n    DOCKER-929 Support the docker v2.2 manifest format"},{"timestamp":1500586139,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 16:\n\n\"make check\" passed ok"},{"timestamp":1500586383,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 17: Commit message was updated."},{"timestamp":1500655193,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 18."},{"timestamp":1500655194,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 18:\n\nNew commits:\n    \n    commit c85bc4727bec4f0459170fa87f37f4cc591cc2ee\n    \n    update node-imgmanifest package to 3.0.0"},{"timestamp":1500655234,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 18: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500919362,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 18: Code-Review+1 Integration-Approval+1"},{"timestamp":1500919409,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Todd Whiteman"}],"currentPatchSet":{"number":"18","revision":"ab9fa794765779e4359347041f5eab8d07245799","parents":["bf38a7f08889ec11d5fc87ef660f0163bd6bc593"],"ref":"refs/changes/09/1209/18","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500655193,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500655234,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500919362,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500919362,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1500919409,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231},"patchSets":[{"number":"1","revision":"b1571985459c44ed5be9d81e721afbb83ba25432","parents":["6661b03a65d448d42500b678d60c401c0facfd32"],"ref":"refs/changes/09/1209/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1483637742,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1483637793,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1347,"deletions":-374},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9}],"sizeInsertions":2335,"sizeDeletions":-1112},{"number":"2","revision":"23a5df6baf448a8edf3f90d487ecb796f192f3aa","parents":["6661b03a65d448d42500b678d60c401c0facfd32"],"ref":"refs/changes/09/1209/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1483988843,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1483988895,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1347,"deletions":-374},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":76,"deletions":-6}],"sizeInsertions":2752,"sizeDeletions":-1118},{"number":"3","revision":"caa0c12667fbc5f318cbaa25392dddc710c27344","parents":["94d6db3afeca306b7f2ab4209ea772575d22104d"],"ref":"refs/changes/09/1209/3","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1486169155,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1483988895,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1347,"deletions":-374},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":76,"deletions":-6}],"sizeInsertions":2752,"sizeDeletions":-1118},{"number":"4","revision":"c19f8974e8b2c1cffd7214f67b6a8adbb6e787fe","parents":["c3d0bba5d94aa1d1a9e9ff6a83ea08988d13054c"],"ref":"refs/changes/09/1209/4","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489121167,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489121209,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1332,"deletions":-375},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":76,"deletions":-6}],"sizeInsertions":2737,"sizeDeletions":-1119},{"number":"5","revision":"47789c2e17bd0669ba5205764795cf521eac01ed","parents":["6f2621b5a9d01a3fc4f11f9ab459e1b3d1c625f3"],"ref":"refs/changes/09/1209/5","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1489121220,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1489121209,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"etc/scratch_image.manifest","line":2,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This uses 4-space indent instead of the typical 3-space from Docker Registry. AFAIK, that is fine, but do we want to follow the 3-space thing?"},{"file":"etc/scratch_image.manifest","line":2,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Sure, will 3-space."},{"file":"lib/backends/sdc/images.js","line":91,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"The \"V1\" here has nothing to do with the registry API. Nor really to do with the manifest V2 schema version 1 or 2. That could get a little confusing. :) I don\u0027t have a suggestion right now though."},{"file":"lib/backends/sdc/images.js","line":91,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It\u0027s the sdc-docker image version - i.e. docker_images(_v1) v\u0027s docker_images_v2.\n\nI\u0027ve tried to keep the image naming consistent, i.e. image refers to a sdc_docker_* image model, and both the v1 and v2 models share some property names, to help ease the code migration/upgrade."},{"file":"lib/backends/sdc/images.js","line":162,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027skipV1Images\u0027.\n\nIf anything, \u0027skip_smartos\u0027 should change to \u0027skipSmartos\u0027 or \u0027skipSmartosImages\u0027"},{"file":"lib/backends/sdc/images.js","line":162,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Sure, I\u0027ll change to camelCase."},{"file":"lib/backends/sdc/images.js","line":289,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Should that be after the `err` handling. `imgs` might not be defined if there was an err."},{"file":"lib/backends/sdc/images.js","line":289,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/backends/sdc/images.js","line":306,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could this attempt a zillion parallel moray queries if there are a zillion imgs? Something to take a look at. However, this is no change from what we currently have for V1 images."},{"file":"lib/backends/sdc/images.js","line":306,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Correct, but no change to what was used previously. I\u0027d really like to see a vasync.forEachParallelN method, this problem affects many parts of the code."},{"file":"lib/backends/sdc/images.js","line":306,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Yah... I\u0027d had a start at that a long while back, but didn\u0027t have a perfect patch for it, so it has languished. https://github.com/davepacheco/node-vasync/issues/27"},{"file":"lib/backends/sdc/images.js","line":429,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Was \"ExposedPorts\" a docker build-ism as well?"},{"file":"lib/backends/sdc/images.js","line":429,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"No, I couldn\u0027t find anything that used it, so I removed it. It could probably stay there if your unsure on this."},{"file":"lib/backends/sdc/images.js","line":429,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I\u0027m fine with it removed if we\u0027re pretty sure it isn\u0027t used."},{"file":"lib/backends/sdc/images.js","line":529,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This looks like a good candidate for a *get*:\n- Add a `ImageV2.get({account, digest, log, app}, function (err, img) {})` that uses `getObj` from moray.js.\n- Drop `imgFromImgInfoV2` (and the unused `imgFromImgInfo` export) and just call ImageV2.get() directly.\n\nThoughts?"},{"file":"lib/backends/sdc/images.js","line":529,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/backends/sdc/images.js","line":676,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"The first \"1.\" ambiguity case applies to v2 images as well, right? It is only the second case that is limited to v1."},{"file":"lib/backends/sdc/images.js","line":676,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, I\u0027ll update the comment to be more appropriate."},{"file":"lib/backends/sdc/images.js","line":846,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Should that be a fake *ImageV2* model now?"},{"file":"lib/backends/sdc/images.js","line":846,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It\u0027s either, really an image-like object :P"},{"file":"lib/backends/sdc/images.js","line":944,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Can we call this \"config digest\"? i.e. findByConfigDigest.\n\nWas this step added to the pipeline for perf? `_imgFromNameV2` *would* match `name \u003d \"sha256:...full 64 char digest...\"`, but not as efficiently. Also, given that this func is requiring the \"sha256:\" prefix, there isn\u0027t an ambiguity with `name \u003d \"$image_name\"` because an image name cannot have \":\"."},{"file":"lib/backends/sdc/images.js","line":944,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I think so (or maybe I added this before _imgFromNameV2 did sha256 digest lookups)?\n\nIt doesn\u0027t seem like this function is needed, and I\u0027m sure _imgFromNameV2 could be made smarter for digest cases (avoiding the tag lookup when a digest is used).\n\nRemoving this function, renaming _imageFromNameV2 to be _imgFromNameOrDigest.\n\nNote that I don\u0027t want to use configDigest unless the ImageV2 model itself uses config_digest."},{"file":"lib/backends/sdc/images.js","line":947,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps could guard on `/^sha256:[a-f0-9]{64}$/.test(opts.name)` ?"},{"file":"lib/backends/sdc/images.js","line":947,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Code removed."},{"file":"lib/backends/sdc/images.js","line":1020,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Currently this is only exposed via `imgFromName`. I\u0027m curious when this is used: looking up by *manifest* digest, and whether it would be clearer to explicitly have those code paths state they want to match by manifest digest.\nThere won\u0027t be collisions (this is sha256) so there shouldn\u0027t be a correctness issue."},{"file":"lib/backends/sdc/images.js","line":1020,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"This is only called when rat.digest has a value, that\u0027s currently only when a docker image command uses the manifest digest format, e.g.:\n  docker inspect busybox@sha256:123...987"},{"file":"lib/backends/sdc/images.js","line":1104,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Given that some new v2-only methods are coming without a \"v2\" name on them, I think it would be nice to start changing var names for v1-only things to have \"V1\" in the name.\n\nAlso let\u0027s call this imgFromConfigDigest."},{"file":"lib/backends/sdc/images.js","line":1104,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"When things are explicitly v1, I\u0027ve tried to ensure they are named v1 (if I\u0027ve missed some, let me know).\n\nI think imgFromConfigDigest naming would work well if/when the docker_images_v2.digest was renamed to docker_images_v2.config_digest, which may occur, but it\u0027s going to affect a lot of code (multiple repos) so I\u0027ll want to ensure that is done as a separate change."},{"file":"lib/backends/sdc/images.js","line":1132,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This could be made a ImageV2.get (see comment above suggesting adding a ImageV2.get)."},{"file":"lib/backends/sdc/images.js","line":1132,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/backends/sdc/images.js","line":1177,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"ImageV2 now?"},{"file":"lib/backends/sdc/images.js","line":1177,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It\u0027s either Image or ImageV2 (I have updated the comment)."},{"file":"lib/backends/sdc/images.js","line":1193,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027getImageAncestry\u0027 and \u0027getImageHistory\u0027 top-level funcs is confusing. I guess I\u0027m having trouble with all the different types of objects: model object, inspect format object, perhaps another object format, v1 and v2 variants. \n\nPerhaps overkill (so take this as a nit), but I wonder if strict naming for variables and funcs using these types would be helpful. My \"strict\" naming, I mean defining a short Hungarian-notation-like prefix for each of these different object types, and using those in var names. Shrug. \n\nI also wonder whether a separate lib/backends/sdc/images1.js (or images-v1.js or whatever name) in which to shunt all the deprecated v1 details might help clarify things a bit."},{"file":"lib/backends/sdc/images.js","line":1193,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It is a little confusing. To help explain, the image ancestry is the chain of Image(V2)s (using the parent/child relationship), whilst getImageHistory is the docker view of that ancestry, to show the changes that happened between layers. In other words docker history objects are mostly a subset of the ancestry objects, with history objects also having tag information too.\n\nI find ancestry a better description of the parent/child chain, rather than history.\n\nFor separate images1.js, I did initially look at that, but since these Image objects are used a lot elsewhere in the code (utils.js, sysinfo.js, containers.js, common.js), I found it easier to make the ImageV2 model similar to Image and then re-use/share the existing (80%) of images.js. It\u0027s mostly lookup and delete that have large differences."},{"file":"lib/backends/sdc/images.js","line":1206,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"What is a case where this is expected?\nIs this for intermediate layers in a v2.2 world? I.e. where the Docker Remote API will create synthetic layers for them.\n\nOr is DOCKER-709 one of the cases you mean?"},{"file":"lib/backends/sdc/images.js","line":1206,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It\u0027s for DOCKER-709, I\u0027ve updated the code to use an isV1Image() check."},{"file":"lib/backends/sdc/images.js","line":1333,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Is this the intentional synthetic layers for a v2.2 world? If so, let\u0027s clarify that these aren\u0027t really \"missing\", but that the Docker Remote API is faking these for bwcompat."},{"file":"lib/backends/sdc/images.js","line":1333,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Agree, a little confusing. It was commented as \u0027missing\u0027 as that\u0027s the terminology docker is using/returning for these \u0027synthetic\u0027 images.\n\nUpdated comment."},{"file":"lib/backends/sdc/images.js","line":1400,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Drop this line? There is a \"creating ...\" log line below when actually creating the scratch image."},{"file":"lib/backends/sdc/images.js","line":1400,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Updated log - should have been \u0027looking for existing scratch image\u0027."},{"file":"lib/backends/sdc/images.js","line":1466,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"missing the \":\"?"},{"file":"lib/backends/sdc/images.js","line":1466,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/backends/sdc/images.js","line":1467,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Note to self to check that (correct encoding for hashing) again. Shouldn\u0027t really matter because I doubt there will be non-ascii in the manifest."},{"file":"lib/backends/sdc/images.js","line":1467,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I found it had to be \u0027binary\u0027 (as set in IMGAPI and docker build), otherwise it will produce an incorrect digest."},{"file":"lib/backends/sdc/images.js","line":2036,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Should that read \"in more than one repository\"? because the check is \"\u003e 1\"."},{"file":"lib/backends/sdc/images.js","line":2036,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"It matches docker\u0027s error message:\nError response from daemon: conflict: unable to delete 00f017a8c2a6 (must be forced) - image is referenced in one or more repositories"},{"file":"lib/backends/sdc/images.js","line":2721,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This is an interesting limitation. Are we sure we want to disallow that?  At least the message would need clarification. IIUC, this \"v1\" is about v2.1 format image manifests... which isn\u0027t something the user would really know about.\n\nAlso does re-pulling work/help if the image exists in the v1 \"docker_images\" bucket?"},{"file":"lib/backends/sdc/images.js","line":2721,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, this \"v1\" message may be unclear to the user (as there is no indicator as to what a v1 image is). For me (or sdc-docker rather) a \"v1\" image is any image in the old \"docker_images\" bucket (deprecated).\n\nUpdated to use a \u0027this image is deprecated\u0027 message.\n\nRe-pulling the image will work, as that will pull a new image into the docker_images_v2 bucket, which can lead to two images using the same name (e.g. \u0027busybox\u0027), but note that a (docker_images_) v2 image gets priority over a (docker_images) v1 image of the same name."},{"file":"lib/endpoints/admin/image-tags-v2.js","line":18,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Why change the endpoints? The only way I could see there being confusion is if the older v1 pull-image workflow was called on a newer sdc-docker instance. Is that why?"},{"file":"lib/endpoints/admin/image-tags-v2.js","line":18,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, and to keep it consistent, all the endpoints were changed.\n\nThis would also be good if we ever had to re-instate the old image endpoints (i.e. so it could still work with an older IMGAPI / docker build)."},{"file":"lib/endpoints/admin/images-v2.js","line":17,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"hyphens in the URL path here, underscores in https://cr.joyent.us/#/c/1209/5/lib/endpoints/admin/image-tags-v2.js\nLet\u0027s pick one style."},{"file":"lib/endpoints/admin/images-v2.js","line":17,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/endpoints/admin/images-v2.js","line":53,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Hrm... no validation at all here. Not sure how I feel about that. :)"},{"file":"lib/endpoints/admin/images-v2.js","line":53,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"You should feel pretty good, since that\u0027s what it was doing before (and you wrote it) :P\n\nThe ImageV2.create does validation (via \"new ImageV2\") on these parameters."},{"file":"lib/models/image-tag-v2.js","line":40,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"New anchor: \"#overview\""},{"file":"lib/models/image-tag-v2.js","line":40,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/models/image-tag-v2.js","line":54,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"uuid"},{"file":"lib/models/image-tag-v2.js","line":54,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/models/image-v2.js","line":32,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"We taked about calling this \u0027config_digest\u0027 for clarity, and with the \u0027digest\u0027 variable name in code below."},{"file":"lib/models/image-v2.js","line":32,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Using \u0027config_digest\u0027 would be okay - it\u0027ll require changes to the other repos as well (IMGAPI, cn-agent, imgManifest), so if/when we make this change I\u0027d prefer to keep it as isolated as possible (to ensure no regressions)."},{"file":"lib/models/image-v2.js","line":115,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"All these accessors feel like that add to the confusion."},{"file":"lib/models/image-v2.js","line":115,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"How so, or rather which ones in particular? Note: This follows the docker_images getter styles."},{"file":"lib/models/image-v2.js","line":115,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Yah. It is fine."},{"file":"lib/models/image.js","line":12,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Really need an update to the top doc here explaining that is end of lifed... and pointing to image-v2.js."},{"file":"lib/models/image.js","line":12,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Good idea - done."},{"file":"test/integration/helpers.js","line":1391,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Are you sure we want to encodeURIComponent here? E.g.:\n\n\u003e encodeURIComponent(\u0027trent/foo\u0027)\n\u0027trent%2Ffoo\u0027\n\nPerhaps this instead:\n\n\u003e encodeURI(\u0027trent/foo\u0027)\n\u0027trent/foo\u0027"},{"file":"test/integration/helpers.js","line":1391,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"I wanted encodeURIComponent for pull image (line 1435), but it should not be needed for the inspect calls (line 1406 and 1483), so I\u0027ll revert those 2 inspect calls to just use \u0027name\u0027."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1332,"deletions":-375},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":76,"deletions":-6}],"sizeInsertions":2737,"sizeDeletions":-1119},{"number":"6","revision":"45cadfaa9adeba4429b03ca81e505b42f4348682","parents":["eadaa0a85cef3ae6a18c685392638f0c2a654fb9"],"ref":"refs/changes/09/1209/6","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1492622958,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492622996,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-315},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1332,"deletions":-375},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":11,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":322,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":5,"deletions":-117},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":28,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":77,"deletions":-7}],"sizeInsertions":2742,"sizeDeletions":-1124},{"number":"7","revision":"34632b7ca3c0a591d4103fe4603284dab4e16b6c","parents":["6a9b4b5b5ff302bebfca05a482b3c38a5c1d45b2"],"ref":"refs/changes/09/1209/7","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1493338815,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493338853,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":156,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1283,"deletions":-384},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":339,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":40,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":74,"deletions":-4}],"sizeInsertions":2729,"sizeDeletions":-1130},{"number":"8","revision":"a1f231569d2f67e00eac3d54be4cdfc9ce4682ac","parents":["6a9b4b5b5ff302bebfca05a482b3c38a5c1d45b2"],"ref":"refs/changes/09/1209/8","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1493848737,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1493848775,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":156,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1299,"deletions":-384},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":351,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":40,"deletions":-87},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":74,"deletions":-4}],"sizeInsertions":2785,"sizeDeletions":-1135},{"number":"9","revision":"8fae89d997d9ef6d336ecdbe96c7594eef9c8cfd","parents":["6a9b4b5b5ff302bebfca05a482b3c38a5c1d45b2"],"ref":"refs/changes/09/1209/9","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1494298115,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494298148,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1301,"deletions":-384},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":352,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":41,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":18,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":341,"deletions":0},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":74,"deletions":-4}],"sizeInsertions":2790,"sizeDeletions":-1136},{"number":"10","revision":"0a06a10db82585ab5d3e56484cd05a545d33cf32","parents":["b63aa447c165fa1212ff42c41246bb7d630aeabd"],"ref":"refs/changes/09/1209/10","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1498256792,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1498256841,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1327,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":221,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":490,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":11,"deletions":-7}],"sizeInsertions":3589,"sizeDeletions":-1233},{"number":"11","revision":"fef5debebb3f69fc5c9724e07450291cde710201","parents":["edb2de0e0d5cbe79b5d78340e39527a3ed8b35ee"],"ref":"refs/changes/09/1209/11","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1499275995,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1499276025,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":490,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3631,"sizeDeletions":-1232},{"number":"12","revision":"2035e42933a3701774d4db81237551df33735b37","parents":["edb2de0e0d5cbe79b5d78340e39527a3ed8b35ee"],"ref":"refs/changes/09/1209/12","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500408869,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3634,"sizeDeletions":-1232},{"number":"13","revision":"22309275b72fbf0737fbf94e1a756d8f55a454cc","parents":["d75efa79ca8f887db9b3b38324494db2d6d1248f"],"ref":"refs/changes/09/1209/13","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500580298,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231},{"number":"14","revision":"eb368b01433b707d88df3191ec234d96f4573755","parents":["bf38a7f08889ec11d5fc87ef660f0163bd6bc593"],"ref":"refs/changes/09/1209/14","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500585889,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231},{"number":"15","revision":"81642f21a80e1581fae8195208793b0fb08e41b6","parents":["edb2de0e0d5cbe79b5d78340e39527a3ed8b35ee"],"ref":"refs/changes/09/1209/15","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500586000,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":4,"deletions":-5},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3634,"sizeDeletions":-1232},{"number":"16","revision":"48b40039085b1256f7c71a2bef3450b2521708f5","parents":["bf38a7f08889ec11d5fc87ef660f0163bd6bc593"],"ref":"refs/changes/09/1209/16","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500586100,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231},{"number":"17","revision":"fe63a47c3dfc9d39987dbac4da72dd7fd2eecf31","parents":["bf38a7f08889ec11d5fc87ef660f0163bd6bc593"],"ref":"refs/changes/09/1209/17","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500586383,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500408900,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500585768,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231},{"number":"18","revision":"ab9fa794765779e4359347041f5eab8d07245799","parents":["bf38a7f08889ec11d5fc87ef660f0163bd6bc593"],"ref":"refs/changes/09/1209/18","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1500655193,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500655234,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500919362,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500919362,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1500919409,"by":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/api/commands/build.md","type":"MODIFIED","insertions":3,"deletions":-28},{"file":"docs/api/commands/commit.md","type":"MODIFIED","insertions":76,"deletions":-12},{"file":"docs/api/commands/images.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/api/commands/pull.md","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"docs/api/divergence.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"docs/api/features/repos.md","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"etc/scratch_image.json","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"etc/scratch_image.manifest","type":"ADDED","insertions":16,"deletions":0},{"file":"lib/backends/sdc/build.js","type":"MODIFIED","insertions":157,"deletions":-314},{"file":"lib/backends/sdc/containers.js","type":"MODIFIED","insertions":2,"deletions":-4},{"file":"lib/backends/sdc/images.js","type":"MODIFIED","insertions":1351,"deletions":-390},{"file":"lib/backends/sdc/index.js","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"lib/backends/sdc/utils.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/endpoints/admin/image-tags-v2.js","fileOld":"lib/endpoints/admin/image-tags.js","type":"RENAMED","insertions":14,"deletions":-14},{"file":"lib/endpoints/admin/images-v2.js","type":"ADDED","insertions":79,"deletions":0},{"file":"lib/endpoints/admin/images.js","type":"DELETED","insertions":0,"deletions":-85},{"file":"lib/endpoints/admin/index.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/endpoints/commit.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/endpoints/images.js","type":"MODIFIED","insertions":18,"deletions":-19},{"file":"lib/models/image-tag-v2.js","type":"ADDED","insertions":198,"deletions":0},{"file":"lib/models/image-v2.js","type":"ADDED","insertions":354,"deletions":0},{"file":"lib/models/image.js","type":"MODIFIED","insertions":9,"deletions":-118},{"file":"lib/models/index.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/wfapi/index.js","type":"MODIFIED","insertions":6,"deletions":-7},{"file":"lib/wfapi/workflows/pull-image-v2.js","fileOld":"lib/wfapi/workflows/pull-image.js","type":"RENAMED","insertions":48,"deletions":-88},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"sapi_manifests/docker/template","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/integration/api-build.test.js","type":"MODIFIED","insertions":244,"deletions":-6},{"file":"test/integration/api-images-v1-v2.test.js","type":"ADDED","insertions":493,"deletions":0},{"file":"test/integration/api-images.test.js","type":"MODIFIED","insertions":29,"deletions":-3},{"file":"test/integration/cli-attach.test.js","type":"MODIFIED","insertions":6,"deletions":-39},{"file":"test/integration/cli-copy.test.js","type":"MODIFIED","insertions":2,"deletions":-30},{"file":"test/integration/cli-filters.test.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"test/integration/cli-image-rmi.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/integration/cli-image-tag.test.js","type":"MODIFIED","insertions":9,"deletions":-11},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":101,"deletions":-9},{"file":"test/lib/cli.js","type":"MODIFIED","insertions":47,"deletions":-8},{"file":"test/lib/common.js","type":"MODIFIED","insertions":7,"deletions":-7}],"sizeInsertions":3633,"sizeDeletions":-1231}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}