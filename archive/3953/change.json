{"project":"joyent/sdc-cloudapi","branch":"master","topic":"MANTA-3672","id":"I3009043ab2416349eb9a5622d60846174dce50ef","number":"3953","subject":"MANTA-3672 want support for cross-account RBAC role membership Reviewed by: Trent Mick \u003ctrentm@joyent.com\u003e Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/3953","commitMessage":"MANTA-3672 want support for cross-account RBAC role membership\nReviewed by: Trent Mick \u003ctrentm@joyent.com\u003e\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1526345347,"lastUpdated":1526598359,"open":false,"status":"MERGED","comments":[{"timestamp":1526345347,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1526345383,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526419686,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(11 comments)\n\nLooks good. Just nits."},{"timestamp":1526425315,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1526425322,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1526425352,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526428244,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\nNeeds a rebase."},{"timestamp":1526429112,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1526429149,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1526437290,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(3 comments)"},{"timestamp":1526441768,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1526441803,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526443367,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1526480910,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Code-Review+1\n\n(23 comments)\n\nAlso just trivialities, and some ignorable bikesheds."},{"timestamp":1526505816,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 5."},{"timestamp":1526505823,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4:\n\n(9 comments)"},{"timestamp":1526505850,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526506280,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1526507637,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1526508551,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 6."},{"timestamp":1526508585,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526508865,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1526508977,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1526509012,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"},{"timestamp":1526510297,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1526512525,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"},{"timestamp":1526598359,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Topic set to MANTA-3672"}],"currentPatchSet":{"number":"7","revision":"497bcf9395a92564a9fd268e818f9afc0e0cb64b","parents":["e597ffe258d510defbd4eadef2b0b4d07b903b47"],"ref":"refs/changes/53/3953/7","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526508977,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526508585,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526510297,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1526512525,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":113,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":357,"deletions":-108},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":273,"deletions":-3}],"sizeInsertions":914,"sizeDeletions":-205},"patchSets":[{"number":"1","revision":"d1048435500d47110082e1a8a9b58fc204b897f5","parents":["265c8bec582b8b6351f8ff0c49f54944646b77d3"],"ref":"refs/changes/53/3953/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526345347,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526345383,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":2153,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"That\u0027ll be \"cloudapi/9.0.0\" now, FWIW."},{"file":"docs/index.md","line":2448,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Should eventually change these to \u0027Accept-Version\u0027. I don\u0027t recall if the old \u0027Api-Version\u0027 still works. Anyway, doesn\u0027t have to be updated for this change."},{"file":"docs/index.md","line":2448,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I\u0027ll update the ones I touched, since Api-Version doesn\u0027t work any more. We should come back around and update all of these though."},{"file":"lib/roles.js","line":8,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"update copyright year, here and the other files"},{"file":"lib/roles.js","line":180,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Include \u0027type\u0027 property name here?"},{"file":"lib/roles.js","line":215,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"All this pre-existing DWIM\u0027ing is just gross."},{"file":"test/analytics.test.js","line":132,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027~8\u0027"},{"file":"test/auth.test.js","line":45,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"~8"},{"file":"test/users.test.js","line":138,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"From the cloudapi docs (\"API Versions\" section):\n```\nFor new applications using CloudAPI SDKs, it is recommended that one explicitly\naccept a particular major version, e.g. `Accept-Version: ~8`, so that\nfuture CloudAPI backward incompatible changes (always done with a *major*\nversion bump) don\u0027t break your application.\n```\n\nSo please \u0027~8\u0027 here."},{"file":"test/users.test.js","line":1074,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027~9\u0027"},{"file":"test/users.test.js","line":1105,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"\u0027~9\u0027 and likewise below"},{"file":"test/users.test.js","line":1266,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This code is written now, but I *think* one could have used t.deepEqual and just reproduced the expected body. I\u0027m not sure if there is an array ordering being undefined issue with that. Anyway."},{"file":"test/users.test.js","line":1266,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Yeah I didn\u0027t want to rely on ordering for the members array, but you\u0027re right that the policies one could just be deepEqual. Could also call .sort() first on the members."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":111,"deletions":-31},{"file":"lib/roles.js","type":"MODIFIED","insertions":346,"deletions":-100},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":224,"deletions":-2}],"sizeInsertions":851,"sizeDeletions":-194},{"number":"2","revision":"c0b9a7e80b29cb25291c3fa9eb4a1c311102a918","parents":["265c8bec582b8b6351f8ff0c49f54944646b77d3"],"ref":"refs/changes/53/3953/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526425315,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526425352,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526428244,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526428244,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":112,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":347,"deletions":-101},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":225,"deletions":-3}],"sizeInsertions":854,"sizeDeletions":-197},{"number":"3","revision":"83b60efe4edf0a36fc8231835c12fe6513e19c06","parents":["e597ffe258d510defbd4eadef2b0b4d07b903b47"],"ref":"refs/changes/53/3953/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526429112,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526425352,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526428244,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526428244,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/roles.js","line":90,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This doesn\u0027t protect against an array of nulls, or an array of arrays. You want:\n\n    if (typeof (policy) !\u003d\u003d \u0027object\u0027 || policy \u003d\u003d\u003d null || \n        Array.isArray(policy)) {"},{"file":"lib/roles.js","line":132,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Same as above."},{"file":"test/users.test.js","line":1062,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"You may want to test non-object types, too (array of numbers, array of nulls, array of arrays)."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":112,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":347,"deletions":-101},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":225,"deletions":-3}],"sizeInsertions":854,"sizeDeletions":-197},{"number":"4","revision":"783d5c6dafcafe28f724e6224a1872153081c11a","parents":["e597ffe258d510defbd4eadef2b0b4d07b903b47"],"ref":"refs/changes/53/3953/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526441768,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526443367,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526441803,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526480910,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"comments":[{"file":"docs/index.md","line":2117,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Unless I missed it, the docs don\u0027t explain anywhere what the distinction between these two is. Wondering users gonna wonder."},{"file":"docs/index.md","line":2117,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Yeah... the feature is not gonna work with CloudAPI itself any time soon, is the issue, so I intend to document it only on the Manta side to start with and just leave it specified here with no explanation for now."},{"file":"lib/app.js","line":277,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"While this may be true, shouldn\u0027t the version in package.json get an update for this change?"},{"file":"lib/app.js","line":277,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Should it take a major roll too? Or just a minor bump? We are keeping backwards compat with the old API ver, so..."},{"file":"lib/app.js","line":277,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I think it would be nice to bump package.json to have a matching major ver. \"Nice\" isn\u0027t a requirement from the API\u0027s point of view, but my idea was to have the API version locked to just the major ver, but otherwise have the package.json version match. The package.json version *is* exposed in the \"Server\" header, fwiw.\n\nSo, yes, I\u0027d bump package.jso ver to \"9.0.0\"."},{"file":"lib/membership.js","line":223,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Why not shove this at the top of the file?\n\nI\u0027m unsure V8 is smart enough to compile the regex only once, not that it\u0027ll make a difference here."},{"file":"lib/membership.js","line":223,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/membership.js","line":227,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name func"},{"file":"lib/membership.js","line":227,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/membership.js","line":254,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name func\n\n(sorry!)"},{"file":"lib/membership.js","line":346,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Total bikeshed, so skip if it\u0027s not your taste -- you could do the same with:\n\nmap[member.id] \u003d map[member.id] || member;"},{"file":"lib/membership.js","line":350,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name func"},{"file":"lib/membership.js","line":361,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I\u0027m guessing you\u0027re not a fan of the ternary operator. :p"},{"file":"lib/membership.js","line":361,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I more wanted to leave this open for future expansion... but idk, there would be a bunch of other things to change too."},{"file":"lib/roles.js","line":102,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Isn\u0027t this the same as:\n\nif (!UUID.test(policy.id)) {\n\n?"},{"file":"lib/roles.js","line":102,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"No, because RegExp#test() stringifies its argument, so you could give e.g. [\u0027uuid\u0027] and it would accept it if you only did UUID_RE.test()"},{"file":"lib/roles.js","line":146,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I think this would be better below the switch block."},{"file":"lib/roles.js","line":146,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/roles.js","line":151,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Shorter:\n\nif (member.type !\u003d\u003d \u0027subuser\u0027 \u0026\u0026 member.type !\u003d\u003d \u0027account\u0027)"},{"file":"lib/roles.js","line":151,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Once again, I wanted to leave this open for easy future expansion. Maybe it doesn\u0027t matter. Haha"},{"file":"lib/roles.js","line":162,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"As above."},{"file":"lib/roles.js","line":176,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Can also do a typeof(member.default) !\u003d\u003d \u0027boolean\u0027"},{"file":"lib/roles.js","line":176,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/roles.js","line":222,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":251,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":286,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":303,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":313,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":316,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Get rid of the else, and it\u0027s one less level of indentation below."},{"file":"lib/roles.js","line":317,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":348,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":427,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"},{"file":"lib/roles.js","line":459,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"name"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":112,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":351,"deletions":-101},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":273,"deletions":-3}],"sizeInsertions":906,"sizeDeletions":-197},{"number":"5","revision":"2ba56bd2db1da615aa326e68588fd7792b27a370","parents":["265c8bec582b8b6351f8ff0c49f54944646b77d3"],"ref":"refs/changes/53/3953/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526505816,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526506280,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526505850,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":113,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":357,"deletions":-108},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":273,"deletions":-3}],"sizeInsertions":913,"sizeDeletions":-204},{"number":"6","revision":"3009043ab2416349eb9a5622d60846174dce50ef","parents":["265c8bec582b8b6351f8ff0c49f54944646b77d3"],"ref":"refs/changes/53/3953/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526508551,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526508585,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":113,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":357,"deletions":-108},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":273,"deletions":-3}],"sizeInsertions":914,"sizeDeletions":-205},{"number":"7","revision":"497bcf9395a92564a9fd268e818f9afc0e0cb64b","parents":["e597ffe258d510defbd4eadef2b0b4d07b903b47"],"ref":"refs/changes/53/3953/7","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1526508977,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526510297,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1526512525,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526508585,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1526508865,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":167,"deletions":-58},{"file":"lib/app.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/membership.js","type":"MODIFIED","insertions":113,"deletions":-32},{"file":"lib/roles.js","type":"MODIFIED","insertions":357,"deletions":-108},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/analytics.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/auth.test.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/users.test.js","type":"MODIFIED","insertions":273,"deletions":-3}],"sizeInsertions":914,"sizeDeletions":-205}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}