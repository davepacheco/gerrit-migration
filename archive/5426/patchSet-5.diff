commit bd5b302115acc7bf0c4f241d97192bba2dbda491 (refs/changes/26/5426/5)
Author: Bryan Cantrill <bryan@joyent.com>
Date:   2019-02-12T02:36:43+00:00 (8 months ago)
    
    OS-7535 allow platform builds on base-64 image

diff --git a/Makefile.gcc b/Makefile.gcc
index 754dc83..b1e698a 100644
--- a/Makefile.gcc
+++ b/Makefile.gcc
@@ -27,7 +27,13 @@ PREFIX = /usr/gcc/$(GCC_VER)
 
 AUTOCONF_PREFIX = $(PREFIX)
 
+#
+# We set --enable-bootstrap to allow the build to mismatch the host
+#
 AUTOCONF_OPTS += \
+	--enable-bootstrap \
+	--build=i386-pc-solaris2.11 \
+	--host=i386-pc-solaris2.11 \
 	--with-ld=/usr/bin/ld \
 	--without-gnu-ld \
 	--with-gnu-as \
diff --git a/binutils/Makefile b/binutils/Makefile
index d956806..cbfe686 100644
--- a/binutils/Makefile
+++ b/binutils/Makefile
@@ -34,6 +34,8 @@ CFLAGS += $(CPPFLAGS)
 TARBALL =		$(VER).tar.bz2
 TARBALL_COMPRESS =	-j
 AUTOCONF_OPTS = \
+	--build=i386-pc-solaris2.11 \
+	--host=i386-pc-solaris2.11 \
 	--prefix=/usr/gnu \
 	--enable-64-bit-bfd \
 	--program-prefix=g
diff --git a/node.js/Makefile b/node.js/Makefile
index 0724322..2edc13e 100644
--- a/node.js/Makefile
+++ b/node.js/Makefile
@@ -18,7 +18,7 @@
 #
 # CDDL HEADER END
 #
-# Copyright 2018 Joyent, Inc.
+# Copyright 2019 Joyent, Inc.
 #
 
 MAJOR_VER =	0.10
@@ -33,7 +33,7 @@ VERSIONJS =	$(NODE_ROOT)/node_modules/platform_node_version.js
 # ../deps/v8/src/objects.h:5188:44: error: left operand of shift expression
 # '(-1 << 3)' is negative
 #
-CXXFLAGS +=	-fpermissive
+CXXFLAGS += -fpermissive
 
 #
 # https://github.com/nodejs/node/issues/6272
@@ -81,6 +81,7 @@ AUTOCONF_OPTS += \
 AUTOCONF_CFLAGS =	CFLAGS="$(CPPFLAGS) $(CFLAGS)"
 AUTOCONF_LIBS =
 AUTOCONF_ENV +=		CXXFLAGS="$(CPPFLAGS) $(CFLAGS) $(CXXFLAGS)"
+AUTOCONF_ENV +=		CXXFLAGS.host="$(CPPFLAGS) $(CFLAGS) $(CXXFLAGS)"
 
 #
 # Jump through hoops to get the locally-run build tools to build with the
