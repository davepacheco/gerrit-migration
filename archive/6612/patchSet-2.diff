From 0956443bd2a17453bd007acebbe0443ea43e8fd6 Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Tue, 16 Jul 2019 17:00:17 -0700
Subject: [PATCH] TRITON-1818 explicitly specify PEM key format for keys
 generated by ssh-keygen

---
 lib/ssh.js   | 5 +++--
 package.json | 2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/lib/ssh.js b/lib/ssh.js
index 628d7fa..c6eba84 100644
--- a/lib/ssh.js
+++ b/lib/ssh.js
@@ -5,7 +5,7 @@
  */
 
 /*
- * Copyright (c) 2014, Joyent, Inc.
+ * Copyright 2019 Joyent, Inc.
  */
 
 /*
@@ -34,7 +34,8 @@ exports.generateKey = function generateKey(keyfile, cb) {
 	async.waterfall([
 		function (subcb) {
 			var cmd = sprintf(
-			    '/usr/bin/ssh-keygen -t rsa -f %s -N ""', keyfile);
+			    '/usr/bin/ssh-keygen -t rsa -m PEM -f %s -N ""',
+			    keyfile);
 
 			log.info({ cmd: cmd }, 'generating SSH key');
 
diff --git a/package.json b/package.json
index 74c2065..e8c6823 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
     "name": "manta-deployment",
     "description": "Manta deployment configuration",
-    "version": "0.0.4",
+    "version": "0.0.5",
     "author": "Joyent (joyent.com)",
     "license": "MPL-2.0",
     "private": true,
-- 
2.21.0

