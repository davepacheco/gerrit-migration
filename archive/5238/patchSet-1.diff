commit af20d85e8f0d5f0cd5d01d3926fa9ea732c61658 (refs/changes/38/5238/1)
Author: Josh Wilsdon <josh@wilsdon.ca>
Date:   2018-12-13T17:19:45-08:00 (10 months ago)
    
    TRITON-1036 vmapi should reject invalid image uuids for reprovision

diff --git a/lib/endpoints/vms.js b/lib/endpoints/vms.js
index 529b274..0bc4426 100644
--- a/lib/endpoints/vms.js
+++ b/lib/endpoints/vms.js
@@ -672,6 +672,12 @@ function reprovisionVm(req, res, next) {
             error));
     }
 
+    if (!common.validUUID(req.params.image_uuid)) {
+        var error = [ errors.invalidUuidErr('image_uuid') ];
+        return next(new errors.ValidationFailedError('Invalid Parameters',
+            error));
+    }
+
     req.app.wfapi.createReprovisionJob(req, function (err, juuid) {
         if (err) {
             return next(err);
diff --git a/package.json b/package.json
index 95e3989..a4df7f3 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "vmapi",
   "description": "VMs API",
-  "version": "9.6.5",
+  "version": "9.6.6",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
