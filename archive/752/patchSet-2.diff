From e60c115be219a542f8fc4638cbfdfc9b87a85bc2 Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Thu, 20 Oct 2016 14:40:25 -0700
Subject: [PATCH] DOCKER-953 'docker pull' error message for a download error
 says "Internal error"

---
 lib/backends/sdc/images.js | 5 +++++
 package.json               | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/lib/backends/sdc/images.js b/lib/backends/sdc/images.js
index 54ae62d..b73b65f 100644
--- a/lib/backends/sdc/images.js
+++ b/lib/backends/sdc/images.js
@@ -1429,6 +1429,11 @@ function pullImage(opts, callback) {
                     + 'to pull %s (%s)', opts.rat.index.name,
                     opts.rat.remoteName, opts.req_id)
             };
+        } else if (err.code === 'DownloadError') {
+            // E.g. A `DownloadError` from docker-registry-client.
+            payload = {
+                status: format('Error downloading %s: %s', imgName, err.message)
+            };
         } else if (err.code === 'NotImplemented') {
             // E.g. OAuth auth to a Docker Registry before DOCKER-771.
             payload = {
diff --git a/package.json b/package.json
index 0a85850..681eb91 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "sdc-docker",
-  "version": "0.3.0",
+  "version": "0.3.1",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
-- 
2.21.0

