From b81db1e8f4fb4ce1e3bf7f8053643f62803cf4fe Mon Sep 17 00:00:00 2001
From: Jerry Jelinek <jerry.jelinek@joyent.com>
Date: Wed, 2 Aug 2017 17:21:37 +0000
Subject: [PATCH] OS-6238 panic in lxpr_access Reviewed by: Patrick Mooney
 <patrick.mooney@joyent.com> Approved by: Patrick Mooney
 <patrick.mooney@joyent.com>

---
 usr/src/uts/common/brand/lx/os/lx_pid.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/usr/src/uts/common/brand/lx/os/lx_pid.c b/usr/src/uts/common/brand/lx/os/lx_pid.c
index 34622f3c6f..8439a23e58 100644
--- a/usr/src/uts/common/brand/lx/os/lx_pid.c
+++ b/usr/src/uts/common/brand/lx/os/lx_pid.c
@@ -284,7 +284,7 @@ int
 lx_lpid_lock(pid_t lpid, zone_t *zone, lx_pid_flag_t flag, proc_t **pp,
     kthread_t **tp)
 {
-	proc_t *p = NULL;
+	proc_t *p;
 	kthread_t *t;
 	id_t tid = 0;
 
@@ -293,6 +293,7 @@ lx_lpid_lock(pid_t lpid, zone_t *zone, lx_pid_flag_t flag, proc_t **pp,
 	ASSERT(zone != NULL && zone->zone_brand == &lx_brand);
 
 retry:
+	p = NULL;
 	if (lpid == 1) {
 		pid_t initpid;
 
-- 
2.21.0

