{"project":"joyent/sdcadm","branch":"master","id":"Ifde3068854da34d1bf54ac00daab0dbd4d62c66c","number":"101","subject":"TOOLS-1471 sdcadm up dockerlogger/post-setup docker ur refactoring Reviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/101","commitMessage":"TOOLS-1471 sdcadm up dockerlogger/post-setup docker ur refactoring\nReviewed by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1468949222,"lastUpdated":1470050407,"open":false,"status":"MERGED","comments":[{"timestamp":1468949222,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1468995722,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 1:\n\n(6 comments)"},{"timestamp":1469002433,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1469002513,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\n(6 comments)\n\nThanks for taking a look. All the suggested changes applied."},{"timestamp":1469087091,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 2: Code-Review+1\n\nCode looks good!  Test plan?"},{"timestamp":1469101199,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1469114909,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1469115573,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\n\u003e Uploaded patch set 4.\n\nOK, looks like I\u0027ve messed up this by pushing a change for 117 here"},{"timestamp":1469116428,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 5."},{"timestamp":1469116679,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\n\u003e Uploaded patch set 5.\n\nLooks like I unfucked it by amending the commit date, which allowed me to push a new patch-set on top of the invalid one I pushed by mistake"},{"timestamp":1469118084,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\n\u003e Code looks good!  Test plan?\n\nRe: test plan. I already got a build at https://jenkins.joyent.us/job/sdcadm/748/. I\u0027m holding on b/c I only see docker installed into staging2, and I dunno if we want to setup or not docker into staging1, or just go ahead and update staging2, which would be fine and install dockerlogger so I would be perfectly able to test the change. Thoughts?\n\nOther than that, tested both at my local HN using COAL (Updated system since November 2014) and into a fresh build. So far, so good."},{"timestamp":1469134803,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 5:\n\nI\u0027m pretty sure Docker _is_ installed in \"staging-1\".  I installed some containers to test a Gerrit upgrade recently."},{"timestamp":1469176607,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\n\u003e I\u0027m pretty sure Docker _is_ installed in \"staging-1\".  I installed\n \u003e some containers to test a Gerrit upgrade recently.\n\ndocker, but w/o dockerlogger. Anyway, now both are installed. Console output of testing added to JIRA issue. So far so good."},{"timestamp":1469205405,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1469574358,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1470050363,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1470050372,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"},{"timestamp":1470050407,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"6","revision":"fde3068854da34d1bf54ac00daab0dbd4d62c66c","parents":["7b1e650bfb9eef950535ac9ea25e1deb5cfaddd1"],"ref":"refs/changes/01/101/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1470050363,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469087091,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469205405,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469574358,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1470050372,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104},"patchSets":[{"number":"1","revision":"d977442ceab56e7dedb7ba0a2269f77b42c484c0","parents":["0b6367a90e59810500faa0352f44d28f9f9fb6fb"],"ref":"refs/changes/01/101/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1468949222,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","comments":[{"file":"lib/post-setup/docker.js","line":75,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"This appears to be set unconditionally to a new array on L472.  You should set it to \"null\" here, so that we can attempt to catch any accidental future changes that break the population of the array."},{"file":"lib/post-setup/docker.js","line":75,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/post-setup/docker.js","line":503,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"You should check this value with \"assert.uuid()\"."},{"file":"lib/post-setup/docker.js","line":503,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/post-setup/docker.js","line":513,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"superfluous \"return\""},{"file":"lib/post-setup/docker.js","line":513,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-dockerlogger.js","line":87,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I would set this one to \"null\" as well, for the same reasons as in the other file."},{"file":"lib/procedures/update-dockerlogger.js","line":87,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-dockerlogger.js","line":274,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I would check this with \"assert.uuid()\" as well."},{"file":"lib/procedures/update-dockerlogger.js","line":274,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/procedures/update-dockerlogger.js","line":284,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"superfluous \"return\""},{"file":"lib/procedures/update-dockerlogger.js","line":284,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104},{"number":"2","revision":"2b32625e1eadb4ebc8a674d4e3a49f144a65c0c3","parents":["0b6367a90e59810500faa0352f44d28f9f9fb6fb"],"ref":"refs/changes/01/101/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1469002433,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469087091,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104},{"number":"3","revision":"7f30f52baec3010037c3876cc57cf6a304a1f637","parents":["b6a75087b6602152fc900399e87153eba79995b0"],"ref":"refs/changes/01/101/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1469101199,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469087091,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104},{"number":"4","revision":"5eef34c4b908e140f5667f869b674e06b5d1f5b8","parents":["b6a75087b6602152fc900399e87153eba79995b0"],"ref":"refs/changes/01/101/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1469114909,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/sdcadm.js","type":"MODIFIED","insertions":16,"deletions":-1}],"sizeInsertions":16,"sizeDeletions":-1},{"number":"5","revision":"75b02207e350e368ecb710bf5bcd9a881c4ed023","parents":["b6a75087b6602152fc900399e87153eba79995b0"],"ref":"refs/changes/01/101/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1469116428,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469087091,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469205405,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469574358,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104},{"number":"6","revision":"fde3068854da34d1bf54ac00daab0dbd4d62c66c","parents":["7b1e650bfb9eef950535ac9ea25e1deb5cfaddd1"],"ref":"refs/changes/01/101/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1470050363,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469087091,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469205405,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469574358,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1470050372,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/post-setup/docker.js","type":"MODIFIED","insertions":19,"deletions":-52},{"file":"lib/procedures/update-dockerlogger.js","type":"MODIFIED","insertions":17,"deletions":-52}],"sizeInsertions":36,"sizeDeletions":-104}],"allReviewers":[{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}