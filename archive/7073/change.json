{"project":"joyent/smartos-live","branch":"master","id":"I0d922dd0266bd882fe474711ac200abff617d634","number":"7073","subject":"OS-8030 vminfod does not offer a way to tell if a vm is fully provisioned","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/7073","commitMessage":"OS-8030 vminfod does not offer a way to tell if a vm is fully provisioned\n","createdOn":1572652958,"lastUpdated":1572893958,"open":true,"status":"NEW","comments":[{"timestamp":1572652958,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1572652959,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 54c8922ee2c86c71e917d4e8607b202e6d168207\n    \n    OS-8030 vminfod does not offer a way to tell if a vm is fully provisioned"},{"timestamp":1572652988,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nTest suite is still passing after this change:\n\n#\n#  TEST COMPLETE IN 4956 SECONDS, SUMMARY:\n#\n# PASS: 5145 / 5145\n#\n# log files available in: /tmp/vmtest.1572625585.35075"},{"timestamp":1572653355,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1572695378,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\nHave you tested that during a vmadm reprovision the state is also correct?"},{"timestamp":1572893958,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nvmadm reprovision is not setting this new \"vmobj.provisioning\" marker (reprovisioning uses a different code path), so there should be no change for the reprovisioning action.\n\nThis begs the question of whether vmadm reprovision should set the \"vmobj.provisioning\" marker, but I don\u0027t see that as necessary, at least for vmadm events - which was the use case I am concerned about, for which reprovision acts more like an update."}],"currentPatchSet":{"number":"1","revision":"0d922dd0266bd882fe474711ac200abff617d634","parents":["0154453ee44db92440f7dfd682d8ffe2f9b63723"],"ref":"refs/changes/73/7073/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1572652958,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","comments":[{"file":"src/vm/node_modules/VM.js","line":9015,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"@dave please double-check that these are the correct options to be using here for the vs.watchForChanges() call."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":66,"deletions":-13},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"src/vm/node_modules/vmload/index.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/vm/package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-15},"patchSets":[{"number":"1","revision":"0d922dd0266bd882fe474711ac200abff617d634","parents":["0154453ee44db92440f7dfd682d8ffe2f9b63723"],"ref":"refs/changes/73/7073/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1572652958,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","comments":[{"file":"src/vm/node_modules/VM.js","line":9015,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"@dave please double-check that these are the correct options to be using here for the vs.watchForChanges() call."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":66,"deletions":-13},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"src/vm/node_modules/vmload/index.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/vm/package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":77,"sizeDeletions":-15}],"allReviewers":[{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}]}