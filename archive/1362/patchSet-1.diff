From 757568d1a11ef0bf484e0f14a6672f3d59391444 Mon Sep 17 00:00:00 2001
From: Alex Wilson <alex.wilson@joyent.com>
Date: Fri, 27 Jan 2017 09:50:11 -0800
Subject: [PATCH] joyent/node-cueball#70 crash in ConnectionSet during
 reliability testing

---
 lib/pool-monitor.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/pool-monitor.js b/lib/pool-monitor.js
index 779cf32..e6041d4 100644
--- a/lib/pool-monitor.js
+++ b/lib/pool-monitor.js
@@ -78,7 +78,7 @@ CueBallPoolMonitor.prototype.toKangOptions = function () {
 		var obj = {};
 		obj.backends = pool.p_backends;
 		obj.connections = {};
-		var ks = pool.p_keys;
+		var ks = pool.p_keys.slice();
 		Object.keys(pool.p_connections).forEach(function (k) {
 			if (ks.indexOf(k) === -1)
 				ks.push(k);
@@ -118,7 +118,7 @@ CueBallPoolMonitor.prototype.toKangOptions = function () {
 		obj.backends = cset.cs_backends;
 		obj.fsms = {};
 		obj.connections = Object.keys(cset.cs_connections);
-		var ks = cset.cs_keys;
+		var ks = cset.cs_keys.slice();
 		Object.keys(cset.cs_fsms).forEach(function (k) {
 			if (ks.indexOf(k) === -1)
 				ks.push(k);
-- 
2.21.0

