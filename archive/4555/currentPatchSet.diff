commit 9c98759e708ae1de8080770a2588ac89c284ae80 (refs/changes/55/4555/4)
Author: Trent Mick <trentm@gmail.com>
Date:   2018-10-30T14:02:37-07:00 (11 months ago)
    
    MANTA-3830 mime ReDoS vuln that affects muskie

diff --git a/lib/server.js b/lib/server.js
index c23229d..425f2b8 100644
--- a/lib/server.js
+++ b/lib/server.js
@@ -193,8 +193,10 @@ function createServer(options, clients, name) {
     server.pre(function cleanupContentType(req, res, next) {
         var ct = req.headers['content-type'];
         /* JSSTYLED */
-        if (ct && !/.*\/.*/.test(ct))
-            req.headers['content-type'] = mime.lookup(ct);
+        if (ct && !/.*\/.*/.test(ct)) {
+            req.headers['content-type'] = mime.getType(ct) ||
+                'application/octet-stream';
+        }
         next();
     });
 
diff --git a/package.json b/package.json
index baa5714..6e7a719 100644
--- a/package.json
+++ b/package.json
@@ -33,7 +33,7 @@
         "lstream": "0.0.4",
         "mahi": "2.2.0",
         "marlin": "git+https://github.com/joyent/manta-marlin.git#master",
-        "mime": "1.2.11",
+        "mime": "2.3.1",
         "moray": "3.4.1",
         "moray-filter": "1.0.0",
         "once": "1.3.0",
