commit f9ba38f2e565487fb3ec47d4d13ee5befec0bdc7 (refs/changes/55/4555/2)
Author: Trent Mick <trentm@gmail.com>
Date:   2018-08-09T12:59:47-07:00 (1 year, 2 months ago)
    
    MANTA-3830 mime ReDoS vuln that affects muskie

diff --git a/lib/server.js b/lib/server.js
index df6a1d1..10765ec 100644
--- a/lib/server.js
+++ b/lib/server.js
@@ -189,8 +189,10 @@ function createServer(options, clients, name) {
     server.pre(function cleanupContentType(req, res, next) {
         var ct = req.headers['content-type'];
         /* JSSTYLED */
-        if (ct && !/.*\/.*/.test(ct))
-            req.headers['content-type'] = mime.lookup(ct);
+        if (ct && !/.*\/.*/.test(ct)) {
+            req.headers['content-type'] = mime.getType(ct) ||
+                'application/octet-stream';
+        }
         next();
     });
 
diff --git a/package.json b/package.json
index 0b04a23..150e4f3 100644
--- a/package.json
+++ b/package.json
@@ -33,7 +33,7 @@
         "lstream": "0.0.4",
         "mahi": "2.1.0",
         "marlin": "git+https://github.com/joyent/manta-marlin.git#master",
-        "mime": "1.2.11",
+        "mime": "2.3.1",
         "moray": "3.4.1",
         "moray-filter": "1.0.0",
         "once": "1.3.0",
