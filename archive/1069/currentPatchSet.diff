From 94fdc1d3b2633df350a7e7c7d74deef401a1c10f Mon Sep 17 00:00:00 2001
From: Todd Whiteman <todd.whiteman@joyent.com>
Date: Mon, 5 Dec 2016 16:49:04 -0800
Subject: [PATCH] joyent/sdc-docker#103 docker build --force-rm=true should
 always remove intermediate containers

---
 lib/backends/sdc/build.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/backends/sdc/build.js b/lib/backends/sdc/build.js
index 1b9c4cf..13949fa 100644
--- a/lib/backends/sdc/build.js
+++ b/lib/backends/sdc/build.js
@@ -507,7 +507,7 @@ function buildImage(opts, callback) {
     function cleanup(err, cb) {
         if (vmUuid) {
             // Cleanup according to the user's cleanup rules.
-            if ((!err && dockerOpts.rm) || (err && dockerOpts.forcerm)) {
+            if ((!err && dockerOpts.rm) || dockerOpts.forcerm) {
                 // Ensure the vm is deleted.
                 log.debug('Removing the build container');
                 deleteVm(vmUuid, function (deleteErr) {
-- 
2.21.0

