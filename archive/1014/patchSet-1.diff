commit e9d33eab7bf80704641c8746b25196442e0641ce (refs/changes/14/1014/1)
Author: Chris Burroughs <chris.burroughs@joyent.com>
Date:   2016-11-30T13:56:05-05:00 (2 years, 10 months ago)
    
    ./bin/triton key get 40:dc:b0:2d:5b:5a:8d:17:87:bf:b6:f9:47:78:e2:03

diff --git a/lib/do_key/do_get.js b/lib/do_key/do_get.js
index 92fd43a..e519358 100644
--- a/lib/do_key/do_get.js
+++ b/lib/do_key/do_get.js
@@ -35,22 +35,27 @@ function do_get(subcmd, opts, args, cb) {
     var id = args[0];
     var cli = this.top;
 
-    cli.tritonapi.cloudapi.getKey({
-        // Currently `cloudapi.getUserKey` isn't picky about the `name` being
-        // passed in as the `opts.fingerprint` arg.
-        fingerprint: id
-    }, function onKey(err, key) {
-        if (err) {
-            cb(err);
-            return;
+    common.cliSetupTritonApi({cli: this.top}, function onSetup(setupErr) {
+        if (setupErr) {
+            cb(setupErr);
         }
-
-        if (opts.json) {
-            console.log(JSON.stringify(key));
-        } else {
-            console.log(common.chomp(key.key));
-        }
-        cb();
+        cli.tritonapi.cloudapi.getKey({
+            // Currently `cloudapi.getUserKey` isn't picky about the
+            // `name` being passed in as the `opts.fingerprint` arg.
+            fingerprint: id
+        }, function onKey(err, key) {
+            if (err) {
+                cb(err);
+                return;
+            }
+
+            if (opts.json) {
+                console.log(JSON.stringify(key));
+            } else {
+                console.log(common.chomp(key.key));
+            }
+            cb();
+        });
     });
 }
 
