{"project":"joyent/smartos-live","branch":"master","id":"Ie4657af54fdadc8386be883f6cb772def9012d4c","number":"6122","subject":"OS-7747 vmadm looking only for \"stopped\" event when VM has failed Reviewed by: Dave Eddy \u003cdave.eddy@joyent.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/6122","commitMessage":"OS-7747 vmadm looking only for \"stopped\" event when VM has failed\nReviewed by: Dave Eddy \u003cdave.eddy@joyent.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1555483423,"lastUpdated":1555538184,"open":false,"status":"MERGED","comments":[{"timestamp":1555483423,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1555483424,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit df0f1c028c808a47cc54d57ae753e4c14fa07e7f\n    \n    fix halt when VM is failed"},{"timestamp":1555483474,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555528090,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1: Code-Review+1\n\n(1 comment)\n\nAs far as the code itself, it looks good.  I had 1 small nit in the test file but that is completely optional and doesn\u0027t change the functionality.\n\n\nEven though the change itself is small, it\u0027s impact can be big.  I\u0027d prefer the whole test suite was run just to make sure there are no unintended side-effects from this before I give it IA."},{"timestamp":1555528962,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1: Integration-Approval+1"},{"timestamp":1555528970,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1: -Integration-Approval"},{"timestamp":1555529014,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\n\u003e Even though the change itself is small, it\u0027s impact can be big.  I\u0027d prefer the whole test suite was run just to make sure there are no unintended side-effects from this before I give it IA.\n\nI did run the whole test suite but unfortunately it doesn\u0027t pass currently even without these changes. There were no *new* failures though."},{"timestamp":1555529599,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1555537818,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Integration-Approval+1"},{"timestamp":1555538178,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1555538184,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"2","revision":"e4657af54fdadc8386be883f6cb772def9012d4c","parents":["ad632fe2cc950e085a9f700dbef3664665739299"],"ref":"refs/changes/22/6122/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1555538178,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555483474,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555528090,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555537818,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1555538184,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/vm/tests/test-cleanup-failed.js","type":"ADDED","insertions":55,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"c1d914b95a62a0f315a40c5de24e67369c482a96","parents":["ad632fe2cc950e085a9f700dbef3664665739299"],"ref":"refs/changes/22/6122/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1555483423,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555483474,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555537818,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555528090,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"src/vm/tests/test-cleanup-failed.js","line":33,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: you can import `common` above\n\n var common \u003d require(\u0027./common.js\u0027);\n\nand then use `common.ifError` for a cleaner line of code:\n\n common.ifError(t, err, \u0027running zonecfg\u0027);\n\nit automatically adds \"success\" to the string you give it, or the error message if there was one."},{"file":"src/vm/tests/test-cleanup-failed.js","line":33,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Thanks. I think I\u0027ll leave it in this case because I\u0027d really like to get the stderr + stdout when there\u0027s a problem."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/vm/tests/test-cleanup-failed.js","type":"ADDED","insertions":55,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-1},{"number":"2","revision":"e4657af54fdadc8386be883f6cb772def9012d4c","parents":["ad632fe2cc950e085a9f700dbef3664665739299"],"ref":"refs/changes/22/6122/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1555538178,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555483474,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555537818,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1555538184,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555528090,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"src/vm/tests/test-cleanup-failed.js","type":"ADDED","insertions":55,"deletions":0}],"sizeInsertions":56,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}