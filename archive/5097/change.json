{"project":"joyent/triton-grafana","branch":"master","topic":"MANTA-3992","id":"I8d593695131f282f863c2980607d048f709ee1da","number":"5097","subject":"TRITON-1694 create Triton Grafana image Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Reviewed by: Alex Wilson \u003calex.wilson@joyent.com\u003e Reviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e Approved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e","owner":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"url":"https://cr.joyent.us/5097","commitMessage":"TRITON-1694 create Triton Grafana image\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nReviewed by: Alex Wilson \u003calex.wilson@joyent.com\u003e\nReviewed by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\nApproved by: Josh Wilsdon \u003cjosh@wilsdon.ca\u003e\n","createdOn":1542851894,"lastUpdated":1561415284,"open":false,"status":"MERGED","comments":[{"timestamp":1542851894,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 1."},{"timestamp":1542851916,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543539253,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 2."},{"timestamp":1543539275,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n xmllint --noout --path tools/ --dtdvalid tools/service_bundle.dtd.1 smf/manifests/graf-proxy.xml\n xmllint --noout --path tools/ --dtdvalid tools/service_bundle.dtd.1 smf/manifests/grafana.xml\n xmllint --noout --path tools/ --dtdvalid tools/service_bundle.dtd.1 smf/manifests/nginx.xml\n /tmp/repo/build/node/bin/node node_modules/.bin/eslint  lib/proxy.js lib/util.js lib/auth.js lib/ufds.js test/auth.test.js\n \n /tmp/repo/test/auth.test.js\n    95:4  error  Expected a block comment instead of consecutive line comments                          multiline-comment-style\n   185:7  error  \u0027errExpected\u0027 is assigned a value but never used. Allowed unused vars must match /^_/  no-unused-vars\n \n âœ– 2 problems (2 errors, 0 warnings)\n   1 error, 0 warnings potentially fixable with the `--fix` option.\n \n tools/mk/Makefile.targ:201: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1543543520,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 3."},{"timestamp":1543543539,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544482071,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 4."},{"timestamp":1544482096,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544665998,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 5."},{"timestamp":1544666022,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544744843,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5:\n\nAlways in CRs from me you can feel free to pass over things marked \"nit\"s.\nPendantry shouldn\u0027t get in the way moving forward on reviews and commits.\n\n\n- README \"Architecture\" section: Perhaps mention that only UFDS accounts\n  that are members of the \"operators\" group are allowed in.\n  Oh, I see this is mentioned later in the \"Security\" section.\n\n- README architecture: Worth pointing to http://docs.grafana.org/auth/auth-proxy/\n  here or in lib/auth.js somewhere?\n  \n- nginx:\n    - Do you know if we use it for TLS termination in other services?\n\n    - Was there a particular reason to include and build nginx rather than use\n      pkgsrc\u0027s nginx? -\u003e auth_request usage. Perhaps mention this in\n      the README\u0027s architecture section.\n    \n    - It looks like the nginx config was copied from mako\u0027s nginx. Have you\n      compared settings to, say, the default nginx config in pkgsrc\u0027s nginx.\n      E.g. something like `client_max_body_size 0;` suits mako which streams\n      monster object files, but perhaps removes a guard that could protect\n      DOS\u0027ing of grafana. I could totally be wrong, however, because I\n      rarely configure an nginx.\n    \n    - nit: Looks like current dep is 1.14.0. 1.14.2 was released a few days ago,\n      FWIW.\n\n- testing:\n    - If it \"just works\", would it be possible to change from tape to tap?\n      See https://github.com/joyent/rfd/blob/master/rfd/0139/README.md for\n      longer details.\n      One issue with tap is its huge set of installed deps. One workaround\n      (albeit with its own maint issues) is using \"@smaller/tap\" which elides\n      deps and facilities for coverage testing. This is also discussed in\n      RFD 139.\n      CloudAPI and PAPI have moved to @smaller/tap, FWIW:\n      \n            $ grep smaller */package.json\n            sdc-cloudapi/package.json:        \"@smaller/tap\": \"11.1.4-1.0.0\",\n            sdc-papi/package.json:    \"@smaller/tap\": \"11.1.4-1.0.0\"\n\n- path: /opt/triton/grafana/grafana/dashboards\n    Nit: Curious why moving the dashboards dir for grafana provisioning from the\n    top dir to inside the grafana/ subdir. Yes it relates to grafana, but so\n    does the rest of stuff for this zone, more or less. Again, just a nit.\n    \n\n- \u0027grafana\u0027 SMF manifest has:\n\n        \u003cexec_method\n            type\u003d\"method\"\n            name\u003d\"start\"\n            exec\u003d\"/opt/triton/grafana/grafana/bin/solaris-amd64/grafana-server --homepath /opt/triton/grafana/grafana --config /data/grafana/conf/grafana.ini \u0026amp;\"\n            timeout_seconds\u003d\"30\"\u003e\n            \u003cmethod_context working_directory\u003d\"/opt/triton/grafana\"\u003e\n    \n    SHould the \"working_directory\" get the extra \"grafana/\" subdir to match the\n    given \"--homepath\"? Ditto for the restart and stop methods.\n\n- nit: UFDS terminology: \"primary\" and \"secondary\" is new to me. Have you seen\n  that used for UFDS in other places?\n  \n  I realize one should avoid \"slave\" in terminology. I\u0027ve tended to \"master\"\n  and \"local\" for its terminology, e.g.\n  https://github.com/joyent/sdc-sdc/blob/7422e93f20451b20df476d43d7d89dbad1af5e98/lib/sdc-useradm.js#L193-L252\n  \n        # sdc-useradm ping --master\n        pong\n\n\n# proxy.js\n\n- logger: `level: \u0027debug\u0027`\n    In general I think apps should log at \"info\" level by default.\n  \n    Something like:\n    - FATAL: who uses this?!\n    - ERROR: something is wrong and should probably be looked at (but don\u0027t bet on it). This is where you can ensure error details get logged if they aren\u0027t on the VError object.\n    - WARN: something is wrong, but we\u0027re just going to carry on\n    - INFO: interesting points of processing by the application (within reason)\n    - DEBUG: more interesting points of processing by the app code, useful for the maintainer of that app\n    - TRACE: all library logging and extra crap the app developer throws in\n\n- logger: `\tserializers: bunyan.stdSerializers`\n  This *could* use restify bunyan serializers:\n  \n        serialiazers: restify.bunyan.serializers\n        \n    which adds serializers for \u0027client_req\u0027 and \u0027client_res\u0027. But not necessary\n    here I don\u0027t think because I\u0027m guessing the proxy\u0027s usage isn\u0027t going to\n    be using a restify *client*.\n\n- Bonus points for:\n\n        // HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n        res.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n\n- Restify server request logger setup: use the \"requestLogger\" restify plugin.\n  So instead of:\n  \n\tconst server \u003d restify.createServer();\n\tserver.get(\u0027/Auth\u0027, proxyStart, setUfds, auth.authenticate);\n\n\treturn server;\n\n\t// Set necessary request fields\n\tfunction proxyStart(req, res, next) {\n\t\treq.req_id \u003d uuid();\n\t\treq.config \u003d config;\n\t\treq.log \u003d config.log;\n\t\tconfig.log.info({req: req, req_id: req.req_id},\n\t\t\t\u0027start proxy request\u0027);\n\n\t\t// HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n\t\tres.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n\n\t\tnext();\n\t}\n\n    I\u0027d suggest something like:\n    \n        const server \u003d restify.createServer({\n            // Typically have a name, but not sure if it gets in the way of\n            // proxying.\n            name: \u0027graf-proxy\u0027,\n            log: config.log\n        });\n        \n        // This handles setting `req.req_id` and creating a `req.log` child\n        // logger with that `req_id`.\n        server.use(restify.requestLogger());\n        \n        // For setting the HSTS header, we could `server.use` to apply it\n        // to all requests instead of just those routed to \u0027/Auth\u0027.\n        server.use(function hstsHeader(req, res, next) {\n            // HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n            res.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n            next();\n        });\n        \n        // Instead of the \u0027start proxy request\u0027 log.info we could setup\n        // \"audit\" logging that we typically have on all our APIs. There\n        // is the default \"auditLogger\" plugin in restify or the most\n        // tweaked one I know of currently is the SAPI one I adapted from the\n        // restify 4.x plugin to handle some cases:\n        // https://github.com/joyent/sdc-sapi/blob/master/lib/server/sapi.js#L182-L198\n        // https://github.com/joyent/sdc-sapi/blob/master/lib/server/audit.js\n        \n- nit: Why capitalized \"Auth\" in \u0027/Auth\u0027 route? I\u0027m not sure I know of another\n  route with capitals in Triton or Manta APIs.\n\n\n# auth.js\n\n- nit: `const auth \u003d require(\u0027basic-auth\u0027);` would be clearer imported as `basicAuth`.\n\n- `res.header(\u0027WWW-Authenticate\u0027, \u0027Basic realm\u003d\"Joyent Grafana\"\u0027);`\n  My limited understanding is that the \"realm\" value can/should vary as the\n  user database varies. E.g. there would ideally be one realm for all of\n  SPC, and a separate one for all of JPC, and a separate one for any\n  indenpendent Triton DC \"cloud\" (i.e. those with linked UFDSs).\n  We don\u0027t have a \"cloud\" string concept in Triton, so there isn\u0027t a perfect\n  answer here. https://tools.ietf.org/html/rfc2617#page-3 says the\n  root URL is part of the protection space so there is no security issue\n  with a static realm value.  In other words, I\u0027ve no point here. I was\n  just learning about \"realm\". :)\n\n- From node-ufds/lib/index.js on \"getUser\":\n\n        * This function is extremely imprecise and should not be used.  In\n        * particular, the function will return an account where \"login\" matches\n        * _either_ the UUID _or_ the login field.  Callers should be explicit about\n        * the type of identifier used in a lookup, which is possible via the\n        * improved \"getUserEx()\" method.\n\n- nit: `return next(setAuthHeader());`\n    A style preference at least some of us have been moving to is to separate\n    those:\n  \n        next(setAuthHeader());\n        return;\n    \n    The reasoning is that the return value of `next()` is *not* relevant.\n    The `return;` is just control flow and the intention is to return\n    nothing.\n    \n    Then you can avoid the `return null;` to make lint happy.\n\n- Some notes on this in a couple of places:\n\n            req.log.fatal(err,\n                    \u0027Error while retrieving user via UFDS\u0027);\n            return next(new errors.InternalError(\n                    \u0027System Error: \u0027 + err.message));\n\n    - I think \"fatal\" is heavy here.\n    - Including `err.message` in the InternalError might expose internal\n      implementation details to the caller I think, right?\n    - I wonder if we can log the error details without exposing internal\n      details to the user.  The *latest* restify-errors (v6) is using vanilla\n      VError objects, which would be nice, but this restify is using\n      restify-errors v5. Perhaps this would work:\n      \n            next(new errors.InternalError(err, \u0027could not retrieve user\u0027));\n\n      If things work the way I think they should then the external response\n      will not show details about `err` but our audit logger *will* (see\n      note above about an audit logger).\n    \n- nit: Perhaps bring \"\u0027Your password has expired\u0027\" out to a top const as well?\n\n\n- On:\n\n        req.log.error({username: username},\n                INSUFFICIENT_PERMISSION_MESSAGE);\n        return next(new errors.ForbiddenError(\n                INSUFFICIENT_PERMISSION_MESSAGE));\n\n    Similar to above, given audit logging, we could drop the extra\n    `req.log.error` call.\n\n- On:\n\n        // Set headers needed by grafana\n        const headers \u003d {};\n        headers[\u0027Content-Type\u0027] \u003d \u0027json\u0027;\n        headers[AUTH_USERNAME_HEADER] \u003d user.login;\n        headers[AUTH_EMAIL_HEADER] \u003d user.email;\n        // Given name is optional in UFDS\n        headers[AUTH_NAME_HEADER] \u003d user.givenname || \u0027\u0027;\n        const responseObj \u003d {\n                code: \u0027OK\u0027,\n                message: \u0027Access Granted\u0027\n        };\n        res.send(200, responseObj, headers);\n        return next();\n\n    - That should be \"application/json\" for Content-Type, right?\n    - What is the spec for that response object? Is that something required\n      by Grafana? If not, what about using an empty body?\n      \n            res.header(AUTH_USERNAME_HEADER, user.login);\n            ... other headers\n            res.send(200)\n            next();"},{"timestamp":1545098998,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 6."},{"timestamp":1545099019,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545099058,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 6:\n\n\u003e - README \"Architecture\" section: Perhaps mention that only UFDS accounts\n\u003e that are members of the \"operators\" group are allowed in.\n\u003e Oh, I see this is mentioned later in the \"Security\" section.\n\nDone.\n\n\u003e - README architecture: Worth pointing to http://docs.grafana.org/auth/auth-proxy/\n\u003e   here or in lib/auth.js somewhere?\n  \nAdded to both files.\n\n\u003e - nginx:\n\u003e    - Do you know if we use it for TLS termination in other services?\n\nMy understanding is that we tend to use HAProxy - though I am not sure how\ndifficult it would be to set up an auth subrequest of the type I do here.\n\n\u003e    - Was there a particular reason to include and build nginx rather than use\n\u003e    pkgsrc\u0027s nginx? -\u003e auth_request usage. Perhaps mention this in\n\u003e    the README\u0027s architecture section.\n\nClarified.\n\n\u003e    - It looks like the nginx config was copied from mako\u0027s nginx. Have you\n\u003e    compared settings to, say, the default nginx config in pkgsrc\u0027s nginx.\n\u003e    E.g. something like `client_max_body_size 0;` suits mako which streams\n\u003e    monster object files, but perhaps removes a guard that could protect\n\u003e    DOS\u0027ing of grafana. I could totally be wrong, however, because I\n\u003e    rarely configure an nginx.\n \nYou\u0027re correct that I copied it from mako - I\u0027ve compared to the pkgsrc config\nand cleaned it up a little/removed `client_max_body_size 0;`.\n\n\u003e    - nit: Looks like current dep is 1.14.0. 1.14.2 was released a few days ago,\n\u003e    FWIW.\n\nI can do an update once we determine that this is ready to be integrated.\n\n\u003e - testing:\n\u003e   - If it \"just works\", would it be possible to change from tape to tap?\n\u003e   See https://github.com/joyent/rfd/blob/master/rfd/0139/README.md for\n\u003e   longer details.\n\u003e   One issue with tap is its huge set of installed deps. One workaround\n\u003e   (albeit with its own maint issues) is using \"@smaller/tap\" which elides\n\u003e   deps and facilities for coverage testing. This is also discussed in\n\u003e   RFD 139.\n\u003e   CloudAPI and PAPI have moved to @smaller/tap, FWIW:\n\u003e\n\u003e           $ grep smaller */package.json\n\u003e           sdc-cloudapi/package.json:        \"@smaller/tap\": \"11.1.4-1.0.0\",\n\u003e           sdc-papi/package.json:    \"@smaller/tap\": \"11.1.4-1.0.0\"\n\nMoved to \"@smaller/tap.\"\n\n\u003e - path: /opt/triton/grafana/grafana/dashboards\n\u003e Nit: Curious why moving the dashboards dir for grafana provisioning from the\n\u003e top dir to inside the grafana/ subdir. Yes it relates to grafana, but so\n\u003e does the rest of stuff for this zone, more or less. Again, just a nit.\n\nFair enough. I\u0027ve moved it.\n\n\u003e - \u0027grafana\u0027 SMF manifest has:\n\n\u003e       \u003cexec_method\n\u003e            type\u003d\"method\"\n\u003e            name\u003d\"start\"\n\u003e            exec\u003d\"/opt/triton/grafana/grafana/bin/solaris-amd64/grafana-server --homepath /opt/triton/grafana/grafana --config /data/grafana/conf/grafana.ini \u0026amp;\"\n\u003e            timeout_seconds\u003d\"30\"\u003e\n\u003e            \u003cmethod_context working_directory\u003d\"/opt/triton/grafana\"\u003e\n    \n\u003e    SHould the \"working_directory\" get the extra \"grafana/\" subdir to match the\n\u003e    given \"--homepath\"? Ditto for the restart and stop methods.\n\nGood catch. Testing tells me that it doesn\u0027t matter, but I did intend for them\nto match. Fixed.\n\n\u003e - nit: UFDS terminology: \"primary\" and \"secondary\" is new to me. Have you seen\n\u003e that used for UFDS in other places?\n\u003e\n\u003e I realize one should avoid \"slave\" in terminology. I\u0027ve tended to \"master\"\n\u003e and \"local\" for its terminology, e.g.\n\u003e https://github.com/joyent/sdc-sdc/blob/7422e93f20451b20df476d43d7d89dbad1af5e98/lib/sdc-useradm.js#L193-L252\n\u003e       # sdc-useradm ping --master\n\u003e       pong\n\nAs you guessed, I\u0027m trying to avoid \"slave\". Changed to \"master\" and \"local,\"\nhere and in the TRITON-947 ticket.\n\n# proxy.js\n\n\u003e - logger: `level: \u0027debug\u0027`\n\u003e   In general I think apps should log at \"info\" level by default.\n\u003e\n\u003e   Something like:\n\u003e   - FATAL: who uses this?!\n\u003e   - ERROR: something is wrong and should probably be looked at (but don\u0027t bet on it). This is where you can ensure error details get logged if they aren\u0027t on the VError object.\n\u003e   - WARN: something is wrong, but we\u0027re just going to carry on\n\u003e   - INFO: interesting points of processing by the application (within reason)\n\u003e   - DEBUG: more interesting points of processing by the app code, useful for the maintainer of that app\n\u003e   - TRACE: all library logging and extra crap the app developer throws in\n\nDone.\n\n\u003e - logger: `\tserializers: bunyan.stdSerializers`\n\u003e This *could* use restify bunyan serializers:\n\u003e\n\u003e     serialiazers: restify.bunyan.serializers\n\u003e\n\u003e   which adds serializers for \u0027client_req\u0027 and \u0027client_res\u0027. But not necessary\n\u003e   here I don\u0027t think because I\u0027m guessing the proxy\u0027s usage isn\u0027t going to\n\u003e   be using a restify *client*.\n\nMight as well - done.\n\n\u003e - Bonus points for:\n\u003e\n\u003e     // HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n\u003e     res.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n\nI can\u0027t take credit! This is just copied from your mo-proxy code.\n\n\u003e - Restify server request logger setup: use the \"requestLogger\" restify plugin.\n\u003e So instead of:\n\u003e\n\u003e     const server \u003d restify.createServer();\n\u003e     server.get(\u0027/Auth\u0027, proxyStart, setUfds, auth.authenticate);\n\u003e     \n\u003e     return server;\n\u003e     \n\u003e     // Set necessary request fields\n\u003e     function proxyStart(req, res, next) {\n\u003e       req.req_id \u003d uuid();\n\u003e       req.config \u003d config;\n\u003e       req.log \u003d config.log;\n\u003e       config.log.info({req: req, req_id: req.req_id},\n\u003e         \u0027start proxy request\u0027);\n\u003e     \n\u003e       // HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n\u003e       res.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n\u003e        \n\u003e       next();\n\u003e     }\n\u003e\n\u003e I\u0027d suggest something like:\n\u003e    \n\u003e       const server \u003d restify.createServer({\n\u003e           // Typically have a name, but not sure if it gets in the way of\n\u003e           // proxying.\n\u003e           name: \u0027graf-proxy\u0027,\n\u003e           log: config.log\n\u003e       });\n\u003e        \n\u003e       // This handles setting `req.req_id` and creating a `req.log` child\n\u003e       // logger with that `req_id`.\n\u003e       server.use(restify.requestLogger());\n\u003e        \n\u003e       // For setting the HSTS header, we could `server.use` to apply it\n\u003e       // to all requests instead of just those routed to \u0027/Auth\u0027.\n\u003e       server.use(function hstsHeader(req, res, next) {\n\u003e           // HSTS (needed for A+ rating on \u003cssllabs.com/ssltest\u003e)\n\u003e           res.setHeader(\u0027Strict-Transport-Security\u0027, \u0027max-age\u003d31536000\u0027);\n\u003e           next();\n\u003e       });\n\u003e       \n\u003e       // Instead of the \u0027start proxy request\u0027 log.info we could setup\n\u003e       // \"audit\" logging that we typically have on all our APIs. There\n\u003e       // is the default \"auditLogger\" plugin in restify or the most\n\u003e       // tweaked one I know of currently is the SAPI one I adapted from the\n\u003e       // restify 4.x plugin to handle some cases:\n\u003e       // https://github.com/joyent/sdc-sapi/blob/master/lib/server/sapi.js#L182-L198\n\u003e       // https://github.com/joyent/sdc-sapi/blob/master/lib/server/audit.js\n\u003e\n\nDone. I\u0027ve added a vanilla auditLogger until our modified one gets put in a\nmodule.\n\n\u003e - nit: Why capitalized \"Auth\" in \u0027/Auth\u0027 route? I\u0027m not sure I know of another\n\u003e route with capitals in Triton or Manta APIs.\n\nChanged to lowercase.\n\n# auth.js\n\n\u003e - nit: `const auth \u003d require(\u0027basic-auth\u0027);` would be clearer imported as `basicAuth`.\n\nDone.\n\n\u003e - `res.header(\u0027WWW-Authenticate\u0027, \u0027Basic realm\u003d\"Joyent Grafana\"\u0027);`\n\u003e My limited understanding is that the \"realm\" value can/should vary as the\n\u003e user database varies. E.g. there would ideally be one realm for all of\n\u003e SPC, and a separate one for all of JPC, and a separate one for any\n\u003e indenpendent Triton DC \"cloud\" (i.e. those with linked UFDSs).\n\u003e We don\u0027t have a \"cloud\" string concept in Triton, so there isn\u0027t a perfect\n\u003e answer here. https://tools.ietf.org/html/rfc2617#page-3 says the\n\u003e root URL is part of the protection space so there is no security issue\n\u003e with a static realm value.  In other words, I\u0027ve no point here. I was\n\u003e just learning about \"realm\". :)\n\nThis is interesting. Do you think I should change the static string to something\nelse?\n\n\u003e - From node-ufds/lib/index.js on \"getUser\":\n\u003e\n\u003e      * This function is extremely imprecise and should not be used.  In\n\u003e      * particular, the function will return an account where \"login\" matches\n\u003e      * _either_ the UUID _or_ the login field.  Callers should be explicit about\n\u003e      * the type of identifier used in a lookup, which is possible via the\n\u003e      * improved \"getUserEx()\" method.\n\nFixed.\n\n\u003e - nit: `return next(setAuthHeader());`\n\u003e   A style preference at least some of us have been moving to is to separate\n\u003e   those:\n\u003e  \n\u003e      next(setAuthHeader());\n\u003e      return;\n\u003e    \n\u003e   The reasoning is that the return value of `next()` is *not* relevant.\n\u003e   The `return;` is just control flow and the intention is to return\n\u003e   nothing.\n\u003e    \n\u003e   Then you can avoid the `return null;` to make lint happy.\n\nFixed.\n\n\u003e - Some notes on this in a couple of places:\n\u003e\n\u003e           req.log.fatal(err,\n\u003e                   \u0027Error while retrieving user via UFDS\u0027);\n\u003e           return next(new errors.InternalError(\n\u003e                   \u0027System Error: \u0027 + err.message));\n\u003e\n\u003e   - I think \"fatal\" is heavy here.\n\u003e   - Including `err.message` in the InternalError might expose internal\n\u003e   implementation details to the caller I think, right?\n\u003e   - I wonder if we can log the error details without exposing internal\n\u003e   details to the user.  The *latest* restify-errors (v6) is using vanilla\n\u003e   VError objects, which would be nice, but this restify is using\n\u003e   restify-errors v5. Perhaps this would work:\n\u003e    \n\u003e          next(new errors.InternalError(err, \u0027could not retrieve user\u0027));\n\u003e\n\u003e    If things work the way I think they should then the external response\n\u003e    will not show details about `err` but our audit logger *will* (see\n\u003e    note above about an audit logger).\n\nFixed - changed \u0027fatal\u0027 to \u0027error,\u0027 removed transmission of err to user by using\nthe pattern you suggest. I am importing restify-errors v6 here, so all should be\nwell.\n    \n\u003e - nit: Perhaps bring \"\u0027Your password has expired\u0027\" out to a top const as well?\n\nDone.\n\n\u003e - On:\n\n\u003e       req.log.error({username: username},\n\u003e               INSUFFICIENT_PERMISSION_MESSAGE);\n\u003e       return next(new errors.ForbiddenError(\n\u003e               INSUFFICIENT_PERMISSION_MESSAGE));\n\u003e\n\u003e    Similar to above, given audit logging, we could drop the extra\n\u003e    `req.log.error` call.\n\nRemoved all occurrences of duplicate logging.\n\n\u003e - On:\n\u003e\n\u003e       // Set headers needed by grafana\n\u003e       const headers \u003d {};\n\u003e       headers[\u0027Content-Type\u0027] \u003d \u0027json\u0027;\n\u003e       headers[AUTH_USERNAME_HEADER] \u003d user.login;\n\u003e       headers[AUTH_EMAIL_HEADER] \u003d user.email;\n\u003e       // Given name is optional in UFDS\n\u003e       headers[AUTH_NAME_HEADER] \u003d user.givenname || \u0027\u0027;\n\u003e       const responseObj \u003d {\n\u003e               code: \u0027OK\u0027,\n\u003e               message: \u0027Access Granted\u0027\n\u003e       };\n\u003e       res.send(200, responseObj, headers);\n\u003e       return next();\n\u003e\n\u003e   - That should be \"application/json\" for Content-Type, right?\n\u003e   - What is the spec for that response object? Is that something required\n\u003e   by Grafana? If not, what about using an empty body?\n\u003e     \n\u003e           res.header(AUTH_USERNAME_HEADER, user.login);\n\u003e           ... other headers\n\u003e           res.send(200)\n\u003e           next();\n\nFixed and fixed."},{"timestamp":1545272618,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 7."},{"timestamp":1545272638,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545272842,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 7:\n\nPatch set 7: switched audit logger to triton-audit-logger. Note that we are now also using 64-bit sdcnode v6, as this allows both building grafana and mdb support.\n\nI believe the most recent grafana release now requires node 8 - so we will eventually have to find a workaround, such as using separate node binaries to build grafana and to run the graf-proxy."},{"timestamp":1545859692,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Topic set to MANTA-3992"},{"timestamp":1546560594,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 8."},{"timestamp":1546560630,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1546560658,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 8:\n\nComments and responses from Alex Wilson here:\n\u003e hmm... so this is kind of a nit, and I don\u0027t necessarily think you should go\n\u003e back and do it right away, but these error message constants you have here -- a\n\u003e more idiomatic way to do it is to make an error that inherits from the restify\n\u003e errors for each of these cases\n\n\u003e doing it that way also gives you a programmatic name for each of the errors,\n\u003e which is important in public-facing APIs (but doesn\u0027t matter for this realy)\n\nDone - added errors.js file.\n\n\u003e re: the HSTS header, why not inject that in the nginx config?\n\nDone.\n\n\u003e also I kind of think I would prefer the nginx config in its own file that\n\u003e setup.sh subsitutes in\n\u003e rather than part of setup.sh\n\u003e makes it easier to find\n\n\u003e it might even be nice for the grafana config files too, though they\u0027re a bit shorter so idk\n\nDone and done.\n\n\u003e also don\u0027t forget to verify that logadm is doing what you expect (after the sdc_log_rotation_add calls)\n\u003e there are some nasty gotchas with those and SMF services\n\u003e especially with * substitutions in them\n\u003e like if the file doesn\u0027t already exist at the time that runs it will put the * into the logadm config\n\u003e and that doesn\u0027t quite do what you expect sometimes\n\n\u003e I mean verify by hand by making an image and going and poking at logadm\n\u003e we\u0027ve had a lot of issues where new images ended up rotating their logs twice or deleting them early\n\u003e and causing empty logs to get uploaded into manta\n\u003e or no logs at all\n\u003e and it ends up taking until you really need them to notice they\u0027re not there\n\nEverything looks fine after a fresh provision - the real filenames, not \"\\*\",\nget put into the logadm config, each config gets written once, and the configs\nmatch the template from `sdc_log_rotation_add` in `util.sh`. \n\n\u003e that sleep 1 with grafana concerns me a bit\n\u003e we can\u0027t retry the second request?\n\u003e what happens if it fails?\n\u003e the script exits non-zero and we restart mdata:exec?\n\u003e I worry that production machines are gona have different timing there to your lab boxes\n\u003e particularly the older r510s\n\u003e like the ones in jpc and stuff\n\u003e do you know roughly how bad it is for mdata:exec to run this twice?\n\u003e what currently happens?\n\u003e \n\u003e but it\u0027s worth having done the experiment to see just what happens before pushing to prod\n\u003e in case something does go wrong and you have to diagnose it\n\u003e mdata:execute restarting on some services is catastrophic\n\u003e on others it mostly gets away with it\n\nI\u0027ve added retry logic to the request you reference. I\u0027ve also made the setup.sh\nscript idempotent, just to help keep things clean.\n\n\u003e it might be worth putting an engines requirement of node\u003e\u003d6.x in your package.json btw\n\u003e since you\u0027re using const with \u0027use strict\u0027;, node 4.x and earlier won\u0027t run your stuff at all (iirc)\n\u003e definitely early 4.x won\u0027t\n\nDone.\n\n\u003e does the prometheus service setup not write a PROMETHEUS_SERVICE / prometheus_domain sapi property?\n\u003e the domain and SERVICE properties are the usual canonical ways to refer to another service by name\n\u003e rather than doing prometheus.${dc_name}.${dns_domain}\n\u003e sdcadm usually writes them after it does the service setup\n\u003e the nice part about having them imho is it lets services with optional deps on\n\u003e each other detect when the other one might be available more easily\n\u003e e.g. cloudapi can detect whether you\u0027ve ever set up CNS in your datacentre by looking for CNS_SERVICE\n\nTrent is in favor of leaving this out - with the reasoning that it\u0027s better not\nto introduce a dependency on a config var if the service can figure out the\nvalue itself.\n\nNote also that a service can detect if another service has been set up by\nquerying sapi\u0027s listServices endpoint, so these variables are not necessary for\nthis purpose."},{"timestamp":1550713490,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 9."},{"timestamp":1550713509,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550777779,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 10."},{"timestamp":1550777798,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550793039,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 11."},{"timestamp":1550793057,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1551141961,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 12."},{"timestamp":1551141981,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1560201880,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 13."},{"timestamp":1560201902,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1560201947,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 13:\n\nThe latest patchset is a comprehensive overhaul. See new ticket for testing notes."},{"timestamp":1560202360,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 14."},{"timestamp":1560202388,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n xmllint --noout --path deps/eng/tools/ --dtdvalid deps/eng/tools/service_bundle.dtd.1 smf/manifests/graf-proxy.xml\n xmllint --noout --path deps/eng/tools/ --dtdvalid deps/eng/tools/service_bundle.dtd.1 smf/manifests/grafana.xml\n xmllint --noout --path deps/eng/tools/ --dtdvalid deps/eng/tools/service_bundle.dtd.1 smf/manifests/nginx.xml\n /tmp/repo/build/node/bin/node node_modules/.bin/eslint  lib/ufds.js lib/util.js lib/auth.js lib/proxy.js lib/errors.js test/auth.test.js\n bash -n boot/configure.sh\n bash -n boot/setup.sh\n bash -n bin/update-named.sh\n bash -n /tmp/repo/test/runtests\n /tmp/repo/build/node/bin/node deps/eng/tools/bashstyle boot/configure.sh\n /tmp/repo/build/node/bin/node deps/eng/tools/bashstyle boot/setup.sh\n /tmp/repo/build/node/bin/node deps/eng/tools/bashstyle bin/update-named.sh\n /tmp/repo/build/node/bin/node deps/eng/tools/bashstyle /tmp/repo/test/runtests\n deps/eng/tools/check-copyright -q\n error: CONTRIBUTING.md: copyright year not updated to 2018: \u0027    Copyright 2019 Joyent, Inc.\u0027\n error: Makefile: copyright year not updated to 2018: \u0027# Copyright 2019 Joyent, Inc.\u0027\n error: README.md: copyright year not updated to 2018: \u0027    Copyright 2019 Joyent, Inc.\u0027\n error: bin/update-named.sh: copyright year not updated to 2018: \u0027# Copyright 2019 Joyent, Inc.\u0027\n error: boot/configure.sh: copyright year not updated to 2018: \u0027# Copyright 2019 Joyent, Inc.\u0027\n error: boot/setup.sh: copyright year not updated to 2018: \u0027# Copyright 2019 Joyent, Inc.\u0027\n error: lib/auth.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: lib/errors.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: lib/proxy.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: lib/ufds.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: lib/util.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: smf/manifests/graf-proxy.xml: copyright year not updated to 2018: \u0027    Copyright 2019 Joyent, Inc.\u0027\n error: smf/manifests/grafana.xml: copyright year not updated to 2018: \u0027    Copyright 2019 Joyent, Inc.\u0027\n error: smf/manifests/nginx.xml: copyright year not updated to 2018: \u0027    Copyright 2019 Joyent, Inc.\u0027\n error: test/auth.test.js: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: test/runtests: copyright not in RFD 164 form, \u0027# Copyright (c) 2018, Joyent, Inc.\u0027 does not match /Copyright [0-9]{4} Joyent, Inc\\.$/\n error: tools/bashstyle: copyright year not updated to 2018: \u0027 * Copyright 2019 Joyent, Inc.\u0027\n error: tools/mk/Makefile.nginx.defs: copyright year not updated to 2018: \u0027# Copyright 2017, Joyent, Inc.\u0027\n error: tools/mk/Makefile.nginx.targ: copyright year not updated to 2018: \u0027# Copyright (c) 2014, Joyent, Inc.\u0027\n error: tools/obliterate-grafana-service.sh: copyright year not updated to 2018: \u0027# Copyright 2019 Joyent, Inc.\u0027\n gmake: *** [deps/eng/tools/mk/Makefile.targ:292: check-copyright] Error 1"},{"timestamp":1560204910,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Uploaded patch set 15."},{"timestamp":1560204939,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1561414541,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 15: Code-Review+1 Integration-Approval+1\n\n(3 comments)\n\nThis looks pretty great. Thanks so much for doing this!"},{"timestamp":1561414957,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 15:\n\n(3 comments)"},{"timestamp":1561415275,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 16: Commit message was updated."},{"timestamp":1561415284,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Isaac Davis"}],"currentPatchSet":{"number":"16","revision":"ddc3b17e36e1e31869f5611a2e8b498d806aca1c","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/16","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1561415275,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1560204939,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1561415284,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":205,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":169,"deletions":-12},{"file":"bin/update-named.sh","type":"ADDED","insertions":311,"deletions":0},{"file":"boot/configure.sh","type":"ADDED","insertions":36,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":461,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"etc/grafana.ini.in","type":"ADDED","insertions":33,"deletions":0},{"file":"etc/nginx.conf.in","type":"ADDED","insertions":106,"deletions":0},{"file":"etc/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":138,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":105,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":65,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":85,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":17,"deletions":0},{"file":"sapi_manifests/grafana/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/grafana/template","type":"ADDED","insertions":18,"deletions":0},{"file":"sapi_manifests/update-named/manifest.json","type":"ADDED","insertions":4,"deletions":0},{"file":"sapi_manifests/update-named/template","type":"ADDED","insertions":3,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":104,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":101,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":119,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":252,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":164,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":180,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":66,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":4543,"sizeDeletions":-12},"patchSets":[{"number":"1","revision":"40357ff1a9042d1f961e7a1f6a9340b5fbce9fee","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/1","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1542851894,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1542851916,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":189,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":114,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":427,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":163,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":111,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":273,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":147,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5115,"sizeDeletions":-12},{"number":"2","revision":"dd4cda2143556ecf74f73f43f30e4a165b8440f0","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/2","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1543539253,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1543539275,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":189,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":114,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":427,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":163,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":115,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":288,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":133,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5120,"sizeDeletions":-12},{"number":"3","revision":"7f9d07e7951bb81e1afb148784cd96b64dfa2bd5","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/3","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1543543520,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543543539,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":189,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":114,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":427,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":163,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":115,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":287,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":133,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5119,"sizeDeletions":-12},{"number":"4","revision":"649c4c9ae2140b23c1543bfdf2378c4e7460c806","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/4","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1544482071,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544482096,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":189,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":114,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":444,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":163,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":115,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":287,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":133,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5136,"sizeDeletions":-12},{"number":"5","revision":"13804d007974b93b435089554e03e20fdb4f0234","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/5","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1544665998,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544666022,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":189,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":114,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":444,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":163,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":115,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":287,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":133,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5136,"sizeDeletions":-12},{"number":"6","revision":"7d8bf90f637841670628b71df1dd63eac7b10fe7","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/6","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1545098998,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545099019,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":190,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":117,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":444,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":164,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":119,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":28,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5182,"sizeDeletions":-12},{"number":"7","revision":"4e09b05851028541fc0c1096d8e28c36b4393e6b","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/7","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1545272618,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545272638,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":190,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":117,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":444,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":164,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":127,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":29,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5191,"sizeDeletions":-12},{"number":"8","revision":"d0462cf3813eeea5a21df46439e5a77831156236","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/8","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1546560594,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1546560630,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":195,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":134,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":335,"deletions":0},{"file":"config/nginx.conf","type":"ADDED","insertions":97,"deletions":0},{"file":"config_templates/grafana.ini.in","type":"ADDED","insertions":28,"deletions":0},{"file":"config_templates/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"config_templates/triton-datasources.yaml.in","type":"ADDED","insertions":11,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":147,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":127,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":77,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":69,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5326,"sizeDeletions":-12},{"number":"9","revision":"2263c3c85fcc9e10b14db293804cec36f3859806","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/9","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1550713490,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550713509,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":195,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":134,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":335,"deletions":0},{"file":"config/nginx.conf","type":"ADDED","insertions":97,"deletions":0},{"file":"config_templates/grafana.ini.in","type":"ADDED","insertions":28,"deletions":0},{"file":"config_templates/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"config_templates/triton-datasources.yaml.in","type":"ADDED","insertions":11,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":147,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":122,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":71,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":29,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":74,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":85,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":291,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5339,"sizeDeletions":-12},{"number":"10","revision":"070ed9a09cecb4a911405cb70c0b0c3fed1a1ae9","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/10","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1550777779,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550777798,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":195,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":134,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":335,"deletions":0},{"file":"config/nginx.conf","type":"ADDED","insertions":97,"deletions":0},{"file":"config_templates/grafana.ini.in","type":"ADDED","insertions":28,"deletions":0},{"file":"config_templates/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"config_templates/triton-datasources.yaml.in","type":"ADDED","insertions":11,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":142,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":107,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":66,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":19,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":74,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":85,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":257,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5270,"sizeDeletions":-12},{"number":"11","revision":"d45f17d5f615563beca5ed867b4cf3b4e6899a3f","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/11","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1550793039,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550793057,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":195,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":134,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":333,"deletions":0},{"file":"config/nginx.conf","type":"ADDED","insertions":97,"deletions":0},{"file":"config_templates/grafana.ini.in","type":"ADDED","insertions":28,"deletions":0},{"file":"config_templates/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"config_templates/triton-datasources.yaml.in","type":"ADDED","insertions":11,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":142,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":107,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":66,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":19,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":74,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":85,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":257,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.defs","type":"ADDED","insertions":105,"deletions":0},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":87,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.defs","type":"ADDED","insertions":132,"deletions":0},{"file":"tools/mk/Makefile.go_prebuilt.targ","type":"ADDED","insertions":55,"deletions":0},{"file":"tools/mk/Makefile.manpages.defs","type":"ADDED","insertions":128,"deletions":0},{"file":"tools/mk/Makefile.manpages.targ","type":"ADDED","insertions":28,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":34,"deletions":0},{"file":"tools/mk/Makefile.node.defs","type":"ADDED","insertions":110,"deletions":0},{"file":"tools/mk/Makefile.node.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.node_modules.defs","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/mk/Makefile.node_modules.targ","type":"ADDED","insertions":31,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"ADDED","insertions":159,"deletions":0},{"file":"tools/mk/Makefile.node_prebuilt.targ","type":"ADDED","insertions":42,"deletions":0},{"file":"tools/mk/Makefile.smf.defs","type":"ADDED","insertions":40,"deletions":0},{"file":"tools/mk/Makefile.smf.targ","type":"ADDED","insertions":29,"deletions":0},{"file":"tools/mk/Makefile.targ","type":"ADDED","insertions":345,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":5268,"sizeDeletions":-12},{"number":"12","revision":"dccd52d449b82073db3413556cbe09f741201679","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/12","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1551141961,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1551141981,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":212,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":134,"deletions":-12},{"file":"boot/configure.sh","type":"ADDED","insertions":17,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":333,"deletions":0},{"file":"config/nginx.conf","type":"ADDED","insertions":97,"deletions":0},{"file":"config_templates/grafana.ini.in","type":"ADDED","insertions":28,"deletions":0},{"file":"config_templates/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"config_templates/triton-datasources.yaml.in","type":"ADDED","insertions":11,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":142,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":107,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":66,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":86,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":19,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":74,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":66,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":85,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":257,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":166,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":3890,"sizeDeletions":-12},{"number":"13","revision":"290592b39ff398cf4241f01a52442f03cd16f2c4","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/13","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1560201880,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1560201902,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":205,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":169,"deletions":-12},{"file":"bin/update-named.sh","type":"ADDED","insertions":311,"deletions":0},{"file":"boot/configure.sh","type":"ADDED","insertions":36,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":461,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"etc/grafana.ini.in","type":"ADDED","insertions":33,"deletions":0},{"file":"etc/nginx.conf.in","type":"ADDED","insertions":106,"deletions":0},{"file":"etc/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":138,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":105,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":65,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":85,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":17,"deletions":0},{"file":"sapi_manifests/grafana/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/grafana/template","type":"ADDED","insertions":18,"deletions":0},{"file":"sapi_manifests/update-named/manifest.json","type":"ADDED","insertions":4,"deletions":0},{"file":"sapi_manifests/update-named/template","type":"ADDED","insertions":3,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":104,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":101,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":119,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":252,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":164,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":180,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":66,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":4543,"sizeDeletions":-12},{"number":"14","revision":"d1ff7fa1ca8b74f09e17870707918115642936c8","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/14","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1560202360,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1560202388,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":205,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":169,"deletions":-12},{"file":"bin/update-named.sh","type":"ADDED","insertions":311,"deletions":0},{"file":"boot/configure.sh","type":"ADDED","insertions":36,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":461,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"etc/grafana.ini.in","type":"ADDED","insertions":33,"deletions":0},{"file":"etc/nginx.conf.in","type":"ADDED","insertions":106,"deletions":0},{"file":"etc/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":138,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":105,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":65,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":85,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":17,"deletions":0},{"file":"sapi_manifests/grafana/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/grafana/template","type":"ADDED","insertions":18,"deletions":0},{"file":"sapi_manifests/update-named/manifest.json","type":"ADDED","insertions":4,"deletions":0},{"file":"sapi_manifests/update-named/template","type":"ADDED","insertions":3,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":104,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":101,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":119,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":252,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":164,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":180,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":66,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":4543,"sizeDeletions":-12},{"number":"15","revision":"8d593695131f282f863c2980607d048f709ee1da","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/15","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1560204910,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1560204939,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"comments":[{"file":"Makefile","line":13,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"This is an eng.git thing?"},{"file":"Makefile","line":13,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Correct -- it gets used by the eng.git go-downloading scripts."},{"file":"boot/setup.sh","line":383,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"What\u0027s the most number of tries you\u0027ve actually seen this take? Do you have any indication of what we\u0027re waiting on?"},{"file":"boot/setup.sh","line":383,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Not sure offhand, though, IIRC, usually it fails on the first try and succeeds on the second.\n\nThe choice of trying 5 times with 2 seconds in between tries is entirely unscientific, and I intended it to be overkill.\n\nI\u0027ll investigate this more."},{"file":"tools/obliterate-grafana-service.sh","line":31,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"bonus points for the naming here."},{"file":"tools/obliterate-grafana-service.sh","line":31,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Thank Trent -- he wrote this script!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":205,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":169,"deletions":-12},{"file":"bin/update-named.sh","type":"ADDED","insertions":311,"deletions":0},{"file":"boot/configure.sh","type":"ADDED","insertions":36,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":461,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"etc/grafana.ini.in","type":"ADDED","insertions":33,"deletions":0},{"file":"etc/nginx.conf.in","type":"ADDED","insertions":106,"deletions":0},{"file":"etc/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":138,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":105,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":65,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":85,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":17,"deletions":0},{"file":"sapi_manifests/grafana/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/grafana/template","type":"ADDED","insertions":18,"deletions":0},{"file":"sapi_manifests/update-named/manifest.json","type":"ADDED","insertions":4,"deletions":0},{"file":"sapi_manifests/update-named/template","type":"ADDED","insertions":3,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":104,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":101,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":119,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":252,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":164,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":180,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":66,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":4543,"sizeDeletions":-12},{"number":"16","revision":"ddc3b17e36e1e31869f5611a2e8b498d806aca1c","parents":["be9152bf777f18367d78d1c4f0066ab8b094ffcd"],"ref":"refs/changes/97/5097/16","uploader":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"createdOn":1561415275,"author":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1560204939,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561414541,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"SUBM","value":"1","grantedOn":1561415284,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":25,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":12,"deletions":0},{"file":"CHANGES.md","type":"ADDED","insertions":5,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":73,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":205,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":169,"deletions":-12},{"file":"bin/update-named.sh","type":"ADDED","insertions":311,"deletions":0},{"file":"boot/configure.sh","type":"ADDED","insertions":36,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":461,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/grafana","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/nginx","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"etc/grafana.ini.in","type":"ADDED","insertions":33,"deletions":0},{"file":"etc/nginx.conf.in","type":"ADDED","insertions":106,"deletions":0},{"file":"etc/triton-dashboards.yaml.in","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/auth.js","type":"ADDED","insertions":138,"deletions":0},{"file":"lib/errors.js","type":"ADDED","insertions":90,"deletions":0},{"file":"lib/proxy.js","type":"ADDED","insertions":105,"deletions":0},{"file":"lib/ufds.js","type":"ADDED","insertions":65,"deletions":0},{"file":"lib/util.js","type":"ADDED","insertions":85,"deletions":0},{"file":"package.json","type":"ADDED","insertions":32,"deletions":0},{"file":"sapi_manifests/graf-proxy/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/graf-proxy/template","type":"ADDED","insertions":17,"deletions":0},{"file":"sapi_manifests/grafana/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/grafana/template","type":"ADDED","insertions":18,"deletions":0},{"file":"sapi_manifests/update-named/manifest.json","type":"ADDED","insertions":4,"deletions":0},{"file":"sapi_manifests/update-named/template","type":"ADDED","insertions":3,"deletions":0},{"file":"smf/manifests/graf-proxy.xml","type":"ADDED","insertions":104,"deletions":0},{"file":"smf/manifests/grafana.xml","type":"ADDED","insertions":101,"deletions":0},{"file":"smf/manifests/nginx.xml","type":"ADDED","insertions":119,"deletions":0},{"file":"test/auth.test.js","type":"ADDED","insertions":252,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":164,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":180,"deletions":0},{"file":"tools/mk/Makefile.nginx.defs","type":"ADDED","insertions":33,"deletions":0},{"file":"tools/mk/Makefile.nginx.targ","type":"ADDED","insertions":35,"deletions":0},{"file":"tools/obliterate-grafana-service.sh","type":"ADDED","insertions":66,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":4543,"sizeDeletions":-12}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}