{"project":"joyent/illumos-joyent","branch":"master","id":"Ib69647d3aacd223817db151e369b34ec2471cf28","number":"5391","subject":"OS-7447 formalize bhyve resource exclusion Reviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e Approved by: John Levon \u003cjohn.levon@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/5391","commitMessage":"OS-7447 formalize bhyve resource exclusion\nReviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nApproved by: John Levon \u003cjohn.levon@joyent.com\u003e\n","createdOn":1547852238,"lastUpdated":1562341511,"open":false,"status":"MERGED","comments":[{"timestamp":1547852238,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1549488769,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1549490824,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1549900514,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3:\n\n(7 comments)\n\nI like the lease stuff, but I did idly wonder if it could totally subsume drv_holds - they are already pretty similar. Maybe something like you\u0027d lease_create() instead of vmm_drv_hold(), and a new state revoked for when you want to expire the hold altogether.\n\nEither way, it seems worth having a short sentence explaining the difference between the two (lifetime of device versus read lock on vm contents)."},{"timestamp":1550267765,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\n(7 comments)\n\nI disagree about combining holds and leases.  Holds are mostly meant to ensure that a VM will be present, so that other operations (ioport hooks, lease management) can occur. Leases, being (hopefully) cheaper to acquire, are where the brunt of the work occurs.\n\nI can work on move verbiage for the theory comment on that."},{"timestamp":1550268035,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4."},{"timestamp":1550268085,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1550494540,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5:\n\n(4 comments)"},{"timestamp":1550505913,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1550506063,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1550506203,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1550594736,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 6."},{"timestamp":1550594741,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1550594757,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1550595641,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1551104232,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1551210483,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 7:\n\nI\u0027m collecting test notes in the ticket.  If there are specific things you wish to see exercised, please let me know."},{"timestamp":1551210996,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 8: Patch Set 7 was rebased."},{"timestamp":1551221277,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 9."},{"timestamp":1551221363,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 9: Code-Review-1\n\nI\u0027ve added the utility bits for hammering the wrlock, as per jlevon\u0027s suggestion.  The vioapic rendezvous deadlock still remains, so the wad is not yet suitable for merge."},{"timestamp":1555369345,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 10."},{"timestamp":1558385204,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 11: Patch Set 10 was rebased."},{"timestamp":1559549559,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 11:\n\nCatching up here, seems like a bunch of changes happened since the last review I did - any details on why?"},{"timestamp":1559549589,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 11:\n\nugh, wrong code review, please ignore"},{"timestamp":1559602829,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 12."},{"timestamp":1560288070,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 12: -Code-Review\n\nWith OS-7622 getting lined up to land soon (I hope), this should also be closer to ready."},{"timestamp":1560541084,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 13."},{"timestamp":1561059331,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 14: Patch Set 13 was rebased."},{"timestamp":1561060821,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 14:\n\nWith OS-7622 merged, the deadlock issues originally feared with this wad should be addressed."},{"timestamp":1561381562,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 14:\n\n(2 comments)\n\nOnly a couple of nits, rest looks great. Thanks for the comments on the interfaces."},{"timestamp":1561400032,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 14:\n\n(2 comments)"},{"timestamp":1561401992,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 15."},{"timestamp":1561402773,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 16: Patch Set 15 was rebased."},{"timestamp":1561409215,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 16: Code-Review+1"},{"timestamp":1561546268,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 16: Code-Review+1"},{"timestamp":1561675015,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 16: Integration-Approval+1"},{"timestamp":1562338326,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 17: Patch Set 16 was rebased."},{"timestamp":1562338440,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 18: Commit message was updated."},{"timestamp":1562341511,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"18","revision":"b69647d3aacd223817db151e369b34ec2471cf28","parents":["ea9d7b5c804b8f84f0f7f73d8747c06291d0614d"],"ref":"refs/changes/91/5391/18","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1562338440,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561409215,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561546268,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561675015,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"SUBM","value":"1","grantedOn":1562341511,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":3,"deletions":-16},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":628,"sizeDeletions":-217},"patchSets":[{"number":"1","revision":"beffa6d67cd1f8a68044d871b7163fa7f3848687","parents":["cf32565b5768c9bd407a47b06dbbec53a1efd900"],"ref":"refs/changes/91/5391/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1547852238,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":233,"deletions":-80},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":284,"deletions":-117},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":550,"sizeDeletions":-210},{"number":"2","revision":"0cecf3bb3d32e293149bc84aa2014777e459636c","parents":["cf32565b5768c9bd407a47b06dbbec53a1efd900"],"ref":"refs/changes/91/5391/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549488769,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":233,"deletions":-80},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":299,"deletions":-119},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":565,"sizeDeletions":-221},{"number":"3","revision":"c30628e1a28ac25e649c275dfb2ca84e10418af5","parents":["f92efa0bbe42adba606c2523638d6238b731b3f1"],"ref":"refs/changes/91/5391/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549490824,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","comments":[{"file":"usr/src/uts/i86pc/io/viona/viona.c","line":1752,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I wonder if it\u0027s worth mentioning this in the more general description. I think it\u0027d be non-obvious to a new code reader what the dependency of taking a write lock actually is - it\u0027s a fair bit more significant than your typical rwlock, right?\nDo we know - outside of the usual broken drivers - what sort of latencies we can expect from this?"},{"file":"usr/src/uts/i86pc/io/viona/viona.c","line":1752,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"The operations which take the write lock are all pretty serious.  I\u0027d be more inclined to expand the explanation if we had anything resembling hot-add of devices or memory, but until that\u0027s in play, I don\u0027t think it\u0027ll be an issue."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":292,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"continuously\""},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":292,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":360,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"So bumping -\u003evmm_lease_blocker prevents new leases from showing up.\n\nBut what if a client breaks its lease asynchronously here?\nCouldn\u0027t we pick up a kmem free\u0027d lease-\u003evml_expire_func/arg, or indeed anything its expire func references?\n\nDid you consider doing this via a return value instead? i.e. return 1 to break my lease etc."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":360,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I very much like the idea of a return value for synchronously breaking the lease."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":405,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: trailing period?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":405,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":447,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"This comment is a little stale - is it worth keeping?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":447,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nuked, since the \"Locking and Exclusion\" comment has more detail."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1462,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"is it worth asserting that there are no leases with this hold?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1462,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It means walking the whole lease list, but sure, I can do that under DEBUG guard."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1519,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Given this must be the case, why don\u0027t we just get hold from -\u003evml_hold, and not have a hold argument at all?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1519,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I liked the consistency of hold being an argument?  I can change it if you have strong feelings here."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1519,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Not a big deal"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":232,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":299,"deletions":-119},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":13,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":564,"sizeDeletions":-220},{"number":"4","revision":"dcbafd9ba2ba13d4d1a9b9a8a4724bfce30056c5","parents":["f92efa0bbe42adba606c2523638d6238b731b3f1"],"ref":"refs/changes/91/5391/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550268035,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":306,"deletions":-123},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":575,"sizeDeletions":-224},{"number":"5","revision":"99a28370f1a914f22684cf9d3a12cee21d1302c9","parents":["d5a09eef79eda8a53185fd17c5ffc05c5fae807e"],"ref":"refs/changes/91/5391/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550268085,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","comments":[{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":361,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"blurgh, wouldn\u0027t this end up doing an rw_exit() as the wrong thread?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":361,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Well, \"wrong\" could be relative here.  It seems safe, at least today, for acquire/release for RW_READER to be done in different threads.  The man page doesn\u0027t seem to insist so either."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":361,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Well the man page doesn\u0027t insist so for a write lock either...\n\nI guess I\u0027m OK with this but I think it\u0027s definitely worth a comment."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":361,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yep, for both read_lock and write_lock, since they have differing requirements."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1504,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Since you have it, vmm_read_lock() ?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1504,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Sure"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1504,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1516,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"since you have it, vmm_read_unlock() ?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","line":1516,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":305,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":573,"sizeDeletions":-222},{"number":"6","revision":"4538330d2ec21702c2bab525f1a12bb96548686b","parents":["d5a09eef79eda8a53185fd17c5ffc05c5fae807e"],"ref":"refs/changes/91/5391/6","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550594736,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":320,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":588,"sizeDeletions":-222},{"number":"7","revision":"f10a457382150a0555c374838dc7f866fa09c9fa","parents":["9d82cc6e253729bf201a51afdca5e105cf9c8902"],"ref":"refs/changes/91/5391/7","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550594757,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551104232,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550595641,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":320,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":588,"sizeDeletions":-222},{"number":"8","revision":"d80abce7ded92365aecc84833f79d13ac8cea5e2","parents":["46c76a4f2a42a132a2957bec5f12b68322f731a7"],"ref":"refs/changes/91/5391/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1551210996,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551104232,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550595641,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":320,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":588,"sizeDeletions":-222},{"number":"9","revision":"19ab8c5af8f6346e747a7ea7c870471b2708b438","parents":["46c76a4f2a42a132a2957bec5f12b68322f731a7"],"ref":"refs/changes/91/5391/9","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1551221277,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1551221363,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":252,"deletions":-79},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":328,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":650,"sizeDeletions":-226},{"number":"10","revision":"b08081ac45c401ed1fda284459b467e197d30758","parents":["39324c3c3e700905593cf884cb6987cf0db01381"],"ref":"refs/changes/91/5391/10","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555369345,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1551221363,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":234,"deletions":-67},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":328,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":632,"sizeDeletions":-214},{"number":"11","revision":"85d0f6bb65d2736e5045d034bbdb8c7c3a7dbb01","parents":["3661b8884914640088b61ea4b966f0a5ef30e4f8"],"ref":"refs/changes/91/5391/11","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1558385204,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1551221363,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":234,"deletions":-67},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":328,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":632,"sizeDeletions":-214},{"number":"12","revision":"66e2485557f536d0905c754a4dfe4c3734647bec","parents":["36f3bf06b174311a3035c2fd79f71eec859b0849"],"ref":"refs/changes/91/5391/12","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1559602829,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":328,"deletions":-122},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":633,"sizeDeletions":-215},{"number":"13","revision":"d1a268cef3b0d7a6e86f20242b049402c6f6101b","parents":["c3cbf49c8d881ba57710e7e8b70aa6275bc5fc44"],"ref":"refs/changes/91/5391/13","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1560541084,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":622,"sizeDeletions":-210},{"number":"14","revision":"45a7b12851f490a66fd1e015a1903a74ed99ac81","parents":["ec6f18e946abf1cebedfd0d7ca47dd5a5d183ff8"],"ref":"refs/changes/91/5391/14","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1561059331,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","comments":[{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","line":1917,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"This returns ioctl() return, not errno, but the code below seems to imply we\u0027d like the exit code to be errno?\nMaybe the library func should do this?"},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","line":1917,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yeah, I\u0027ll adjust the library function to emit errno on failure."},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","line":3213,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"There\u0027s no real need for this goto any more, if you feel like removing it."},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","line":3213,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Good idea.  I\u0027ll clean this up."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":0,"deletions":-9},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":622,"sizeDeletions":-210},{"number":"15","revision":"6808c935ccbff385218bcf23f290434b19e98e69","parents":["ec6f18e946abf1cebedfd0d7ca47dd5a5d183ff8"],"ref":"refs/changes/91/5391/15","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1561401992,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":3,"deletions":-16},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":628,"sizeDeletions":-217},{"number":"16","revision":"8e8fabc50e7c36800012d52fa447e3762e69ddc8","parents":["3d280bd5aa877a68b01b0b5dc7cb0f92843e8b41"],"ref":"refs/changes/91/5391/16","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1561402773,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561546268,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561409215,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561675015,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":3,"deletions":-16},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":628,"sizeDeletions":-217},{"number":"17","revision":"c655195edda86f9b87be2da3d4ee39aaa41e6cbc","parents":["ea9d7b5c804b8f84f0f7f73d8747c06291d0614d"],"ref":"refs/changes/91/5391/17","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1562338326,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561546268,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561409215,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561675015,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":3,"deletions":-16},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":628,"sizeDeletions":-217},{"number":"18","revision":"b69647d3aacd223817db151e369b34ec2471cf28","parents":["ea9d7b5c804b8f84f0f7f73d8747c06291d0614d"],"ref":"refs/changes/91/5391/18","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1562338440,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1562341511,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561546268,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1561409215,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561675015,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/bhyvectl/bhyvectl.c","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/mapfile-vers","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"usr/src/lib/libvmmapi/common/vmmapi.h","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/uts/i86pc/io/viona/viona.c","type":"MODIFIED","insertions":235,"deletions":-68},{"file":"usr/src/uts/i86pc/io/vmm/vmm.c","type":"MODIFIED","insertions":3,"deletions":-16},{"file":"usr/src/uts/i86pc/io/vmm/vmm.mapfile","type":"MODIFIED","insertions":4,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_dev.c","type":"MODIFIED","insertions":313,"deletions":-116},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/i86pc/sys/vmm_dev.h","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/sys/vmm_drv.h","type":"MODIFIED","insertions":14,"deletions":-4},{"file":"usr/src/uts/i86pc/sys/vmm_impl.h","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":628,"sizeDeletions":-217}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}