{"project":"joyent/illumos-joyent","branch":"master","id":"Ib5ea6ef347c496634bd0eee09ea65ab896a66ef0","number":"2046","subject":"Ignore spaces around the probe specifier name in dtrace\u0027s output.","owner":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"url":"https://cr.joyent.us/2046","commitMessage":"Ignore spaces around the probe specifier name in dtrace\u0027s output.\n\nWhen using one of the tracing options, such as -n, -i, -P, -f, if\nthe probe specifier contains any leading or trailing spaces, then\nthe first line of output produced by dtrace prints the probe name as\nit is (along with the spaces). Moreover, if the probe also includes\na predicate or an action, then also there is a trailing space in the\nprobe name in the output. Following are couple of examples:\n\nlocalhost$ sudo dtrace -n \u0027  syscall:::entry \u0027\ndtrace: description \u0027  syscall:::entry \u0027 matched 482 probes\n\nlcalhost$ sudo dtrace -n \u0027syscall:::entry {@num[probefunc] \u003d count();}\u0027\ndtrace: description \u0027syscall:::entry \u0027 matched 482 probes\n\nThis change skips the leading spaces in the probe name before\nstarting to process them. Also, when splitting the probe name\nfrom the predicate and actions in compile_str(), it uses space\nas one of the separators so that any trailing space after the\nprobe name will also be avoided in the output.\n\nAlso, add a test case (dtraceUtil/tst.TestProbeDescription.d.ksh) - which\nchecks that there are no leading or trailing spaces in the probe name\nin dtrace\u0027s output when used using the -n option.\n","createdOn":1496767721,"lastUpdated":1521963187,"open":true,"status":"NEW","comments":[{"timestamp":1496767721,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Uploaded patch set 1."},{"timestamp":1496769590,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1496770285,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 2:\n\nFirst of all, thanks for creating and maintaining dtrace, it is a real asset to have around :-)\n\nJust to be honest and clear, I have made the exact same changes on NetBSD\u0027s dtrace port and tested there. At the moment I don\u0027t have any Illumos instllations to test it, but hopefully this does not break on Illumos :)\n\nAlso, I noticed the issue and made the changes the way I felt it was best to fix it but if you guys want to do it some other way, that would be fine as well.\n\nFinally, I noticed that this trailing space in the probe name has been there almost since the beginning. So, I am not sure if it is something that you don\u0027t want to change. In which case, just let know and I will close this issue :-)"},{"timestamp":1496941087,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1496959990,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 3: Code-Review-1\n\n(2 comments)\n\nChange looks fine in the abstract (modulo my comments) but please add a dtest test for this -- and also verify that dtest runs correctly with your change."},{"timestamp":1497456325,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1497787997,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Uploaded patch set 5."},{"timestamp":1497788143,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1497790590,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Uploaded patch set 7."},{"timestamp":1497790635,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1498059603,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 9: Patch Set 8 was rebased"},{"timestamp":1498745517,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 10: Patch Set 9 was rebased"},{"timestamp":1499177735,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 11: Patch Set 10 was rebased"},{"timestamp":1499756049,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 11:\n\nAny feedback on the updated patch?"},{"timestamp":1521963179,"reviewer":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"message":"Patch Set 12: Patch Set 11 was rebased"}],"currentPatchSet":{"number":"12","revision":"bb1fe40fad59d17330666a093b62cb8e06f6ee25","parents":["17f15d36c74db52a0de7ea5b7a1a5376ae61ddcd"],"ref":"refs/changes/46/2046/12","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1521963179,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"1d1104e349562d65e2acc159e4bfdae1c52ed069","parents":["c2fb4392b576cba91431f35fe39f6004e3a7e148"],"ref":"refs/changes/46/2046/1","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1496767721,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":14,"deletions":-6}],"sizeInsertions":14,"sizeDeletions":-6},{"number":"2","revision":"81259fa1902007accf8220bd77c19e1e44cb7fbd","parents":["ce7873af10a4be864450768fbba6318fa1b9dd55"],"ref":"refs/changes/46/2046/2","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1496769590,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":14,"deletions":-6}],"sizeInsertions":14,"sizeDeletions":-6},{"number":"3","revision":"dd969cfb285237970f7da022fea78bb6449ba9c2","parents":["8cb9f5acecaded019a9a55454a31dcf4328d0d1b"],"ref":"refs/changes/46/2046/3","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1496941087,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"comments":[{"file":"usr/src/cmd/dtrace/dtrace.c","line":1163,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Should this be using isspace(3C)?"},{"file":"usr/src/cmd/dtrace/dtrace.c","line":1165,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"This is not cstyle -- please run \"cstyle -p\" against this"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":14,"deletions":-6}],"sizeInsertions":14,"sizeDeletions":-6},{"number":"4","revision":"926141874ca6d33fe8b4ab700491c3f19a446004","parents":["ed2be6056f1a63f70c5bb561b80d8b87900dad32"],"ref":"refs/changes/46/2046/4","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1497456325,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":14,"deletions":-6}],"sizeInsertions":14,"sizeDeletions":-6},{"number":"5","revision":"e93fb055617373693bbd8c35d09ba889659d6f79","parents":["ed2be6056f1a63f70c5bb561b80d8b87900dad32"],"ref":"refs/changes/46/2046/5","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1497787997,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":58,"sizeDeletions":-6},{"number":"6","revision":"30ab1baf19e3a3e2d5212076a9d4934f672fea07","parents":["dfae20b5ffcad6bef48ac6df469fe8600ae3d26c"],"ref":"refs/changes/46/2046/6","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1497788143,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":58,"sizeDeletions":-6},{"number":"7","revision":"b5ea6ef347c496634bd0eee09ea65ab896a66ef0","parents":["ed2be6056f1a63f70c5bb561b80d8b87900dad32"],"ref":"refs/changes/46/2046/7","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1497790590,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"8","revision":"d98243785dc803a0782eae5fa9296fb615bb0c24","parents":["dfae20b5ffcad6bef48ac6df469fe8600ae3d26c"],"ref":"refs/changes/46/2046/8","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1497790635,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"9","revision":"11985808a32d901c96b9b29d48e85bedaa22288d","parents":["801662c8982988409b22bce1ab5687ef6d95e4d7"],"ref":"refs/changes/46/2046/9","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1498059603,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"10","revision":"d1aab51bfe3b027e0995a8ec46e15321f368f2f4","parents":["7082e811fdedd165abf44baf5541a279e4645026"],"ref":"refs/changes/46/2046/10","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1498745517,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"11","revision":"e424eaa41cadbd72a89db663b05342e0692a3b44","parents":["75647a92265dde475f2caca5f9d959ecf9f8b633"],"ref":"refs/changes/46/2046/11","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1499177735,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6},{"number":"12","revision":"bb1fe40fad59d17330666a093b62cb8e06f6ee25","parents":["17f15d36c74db52a0de7ea5b7a1a5376ae61ddcd"],"ref":"refs/changes/46/2046/12","uploader":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"createdOn":1521963179,"author":{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1496959990,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":30,"deletions":0},{"file":"usr/src/cmd/dtrace/dtrace.c","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh","type":"ADDED","insertions":44,"deletions":0},{"file":"usr/src/cmd/dtrace/test/tst/common/dtraceUtil/tst.TestProbeDescription.d.ksh.out","type":"ADDED","insertions":1,"deletions":0}],"sizeInsertions":60,"sizeDeletions":-6}],"allReviewers":[{"name":"Abhinav Upadhyay","email":"abhinav@NetBSD.org","username":"abhinav-upadhyay"},{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}]}