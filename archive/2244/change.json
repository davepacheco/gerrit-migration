{"project":"joyent/sdc-volapi","branch":"master","id":"Ic5de1f35519da6dbf798526f2bfc8490cd893fa1","number":"2244","subject":"VOLAPI-19 All VOLAPI endpoints should error when unsupported input parameters are sent with any request Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e Approved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/2244","commitMessage":"VOLAPI-19 All VOLAPI endpoints should error when unsupported input parameters are sent with any request\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\nApproved by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n","createdOn":1500592437,"lastUpdated":1500943947,"open":false,"status":"MERGED","comments":[{"timestamp":1500592437,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1500592438,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 98513c7fe623b2256c1f0a11fa30b4f4f7384049\n    \n    VOLAPI-19 All VOLAPI endpoints should error when unsupported input parameters are sent with any request"},{"timestamp":1500592467,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500604194,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2."},{"timestamp":1500604195,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 53fa1e707379b8d532d5c08900bdfb99b507855b\n    \n    fix rebase\n    \n    commit 2fc09f8bdc24aed6b24619f97e8e4430215fed1d\n    \n    VOLAPI-19 All VOLAPI endpoints should error when unsupported input parameters are sent with any request"},{"timestamp":1500604232,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500664003,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1500939259,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1500939822,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1500940241,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 3."},{"timestamp":1500940242,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 9a72d5beba5c74a98a4f6a10e5c81e342d75d3cd\n    \n    updates based on CR comments"},{"timestamp":1500940266,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500942191,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 4."},{"timestamp":1500942192,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 7b105776b4893c5b3df3f972c7ffca2334a1ca53\n    \n    updates based on CR comments"},{"timestamp":1500942222,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500942290,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1500942445,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 5."},{"timestamp":1500942446,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 13736f37164aefbb9c817601a191c57667857937\n    \n    updates based on CR comments"},{"timestamp":1500942491,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1500943262,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1500943936,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1500943947,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"6","revision":"c5de1f35519da6dbf798526f2bfc8490cd893fa1","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/6","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500943936,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500942491,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"SUBM","value":"1","grantedOn":1500943947,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":56,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":173,"deletions":0}],"sizeInsertions":248,"sizeDeletions":-13},"patchSets":[{"number":"1","revision":"12592cbae48a71fe6319a4b19a609f948571166a","parents":["9311cf68415f757e183e51d27594ac2a7c8f08b7"],"ref":"refs/changes/44/2244/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500592437,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500592467,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/common.js","type":"ADDED","insertions":56,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":85,"deletions":-44},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":161,"deletions":0}],"sizeInsertions":320,"sizeDeletions":-47},{"number":"2","revision":"2e3dd8e53973368028a0f6d6aef98675eec6fecc","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500604194,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500604232,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/common.js","line":13,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I think these two functions were added by DOCKER-1034 to lib/validation/utils.js. I\u0027ll let you chose whether you want to keep them here or there. I think I have a slight preference for keeping them in lib/validation, but I\u0027d be happy to be convinced that keeping them in lib/endpoints is preferable :)"},{"file":"lib/endpoints/common.js","line":13,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"good point, I missed this in the rebase."},{"file":"lib/endpoints/volumes.js","line":1050,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"GetVolumeReferences applies to a single volume, and it doesn\u0027t take any query parameter. It\u0027s lightly documented at https://github.com/joyent/rfd/blob/master/rfd/0026/README.md#getvolumereferences-get-volumesidreferences for CloudAPI, but it should also be documented as a VOLAPI endpoint in the RFD, and we should file a ticket in the \"MVP\" milestone to implement that endpoint at the CloudAPI level if it\u0027s not already done."},{"file":"lib/endpoints/volumes.js","line":1050,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"ok, good to know. Currently passing \"uuid\" and \"owner_uuid\" *do* have an effect, since the volumesMiddlewares.loadVolumeObject will read these parameters. I\u0027ll add a test to ensure those are rejected so they\u0027re never passed to volumesMiddlewares.loadVolumeObject."},{"file":"lib/endpoints/volumes.js","line":1050,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Excellent!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/common.js","type":"ADDED","insertions":56,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":61,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":161,"deletions":0}],"sizeInsertions":296,"sizeDeletions":-12},{"number":"3","revision":"56a9e6581fe711ae434fc1bfea86e5da3ef1a215","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/3","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500940241,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500940266,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":48,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":158,"deletions":0}],"sizeInsertions":225,"sizeDeletions":-13},{"number":"4","revision":"45f1f98109f3374558dd01d5f5319fc9181071f3","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500942191,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500942222,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/volumes.js","line":1055,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"I think req.params.uuid should be mandatory, so we don\u0027t need to have this test and we should check its present with validationUtils.checkMandatoryParams."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":56,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":158,"deletions":0}],"sizeInsertions":233,"sizeDeletions":-13},{"number":"5","revision":"861238c892901765c44e72ceff3cd3be17b9d175","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/5","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500942445,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500942491,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":56,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":173,"deletions":0}],"sizeInsertions":248,"sizeDeletions":-13},{"number":"6","revision":"c5de1f35519da6dbf798526f2bfc8490cd893fa1","parents":["4b30acebe1310f09fad674967048023de3f45a14"],"ref":"refs/changes/44/2244/6","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1500943936,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1500942491,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1500943947,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1500943262,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/endpoints/ping.js","type":"MODIFIED","insertions":18,"deletions":-3},{"file":"lib/endpoints/volume-reservations.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/endpoints/volumes.js","type":"MODIFIED","insertions":56,"deletions":-9},{"file":"test/integration/invalid-parameters.test.js","type":"ADDED","insertions":173,"deletions":0}],"sizeInsertions":248,"sizeDeletions":-13}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}