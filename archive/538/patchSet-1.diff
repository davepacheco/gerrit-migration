From 95ae1518e9c0381109e8409cce8ae3c21ca8c726 Mon Sep 17 00:00:00 2001
From: Jerry Jelinek <jerry.jelinek@joyent.com>
Date: Wed, 28 Sep 2016 20:39:29 +0000
Subject: [PATCH] OS-5685 LTP vhangup02 fails and passes

---
 usr/src/uts/common/brand/lx/syscall/lx_miscsys.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/usr/src/uts/common/brand/lx/syscall/lx_miscsys.c b/usr/src/uts/common/brand/lx/syscall/lx_miscsys.c
index ba986e2742..6deca8b9d7 100644
--- a/usr/src/uts/common/brand/lx/syscall/lx_miscsys.c
+++ b/usr/src/uts/common/brand/lx/syscall/lx_miscsys.c
@@ -278,5 +278,11 @@ lx_vhangup(void)
 {
 	if (crgetuid(CRED()) != 0)
 		return (set_errno(EPERM));
-	return (vhangup());
+
+	/*
+	 * The native vhangup code does nothing except check for the sys_config
+	 * privilege. Since we've already checked our process credentials,
+	 * just succeed.
+	 */
+	return (0);
 }
-- 
2.21.0

