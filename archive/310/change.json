{"project":"joyent/sdc-designation","branch":"master","id":"Ie423cd6bd540f4b71da9dbde4c768c480e53575b","number":"310","subject":"DAPI-322 - More prone to provisioning failure after DAPI-320","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/310","commitMessage":"DAPI-322 - More prone to provisioning failure after DAPI-320\n","createdOn":1471477359,"lastUpdated":1473330343,"open":false,"status":"ABANDONED","comments":[{"timestamp":1471477359,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1471477383,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1471634321,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 1: Code-Review-1\n\nI have a couple of big concerns: firstly, it\u0027s not clear to me that we actually fully understand all of the issues in this logic yet, why we are getting values that seem incorrect, and what to do about it moving forwards. I think we should try to fully understand what\u0027s going on and make a plan before we commit any changes. Happy to have experiments going on in e.g. staging while we nail it down, but I don\u0027t think they should be committed to the repository. Secondly, this commit message is really not ok -- extra lines, no text that even looks like the bug synopsis."},{"timestamp":1471635056,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\nWhat is the problem with extra lines?"},{"timestamp":1471635332,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\nYou are correct about us not understanding the underlying logic, which is why DAPI-320 marked servers with negative values as invalid.\n\nUnfortunately, there are a -lot- of servers out there like that, and this is causing operational problems. While I will add a more detailed commit message, please see the discussion in the DAPI-322 ticket; your feedback there would be appreciated."},{"timestamp":1471641655,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 1:\n\nre: the commit messages, see https://github.com/joyent/eng/blob/master/docs/index.md#commit-comments-and-jira-tickets -- it explains that there should be one line per ticket, with the actual ticket synopsis from JIRA and no other text"},{"timestamp":1471827731,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1473330343,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Abandoned\n\nSince AGENT-1029 has been fixed, this is no longer needed."}],"currentPatchSet":{"number":"2","revision":"e423cd6bd540f4b71da9dbde4c768c480e53575b","parents":["3da0da9b37d064e1d4416ca3a8339c660391cdc5"],"ref":"refs/changes/10/310/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1471827731,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471477383,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1471634321,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":3,"deletions":-3}],"sizeInsertions":12,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"c2583ed301bad5d351f0d93151ebd8b9a6b80459","parents":["3da0da9b37d064e1d4416ca3a8339c660391cdc5"],"ref":"refs/changes/10/310/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1471477359,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1471634321,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471477383,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":3,"deletions":-3}],"sizeInsertions":12,"sizeDeletions":-7},{"number":"2","revision":"e423cd6bd540f4b71da9dbde4c768c480e53575b","parents":["3da0da9b37d064e1d4416ca3a8339c660391cdc5"],"ref":"refs/changes/10/310/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1471827731,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"-1","grantedOn":1471634321,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471477383,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/algorithms/calculate-server-unreserved.js","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/algorithms/calculate-server-unreserved.test.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/algorithms/hard-filter-invalid-servers.test.js","type":"MODIFIED","insertions":3,"deletions":-3}],"sizeInsertions":12,"sizeDeletions":-7}],"allReviewers":[{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}