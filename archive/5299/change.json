{"project":"joyent/node-verror","branch":"master","id":"Iccb8e04a43425bbc4c0467d074ca004d6eeba45f","number":"5299","subject":"joyent/node-verror#63 do not call sprintf with one argument","owner":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"url":"https://cr.joyent.us/5299","commitMessage":"joyent/node-verror#63 do not call sprintf with one argument\n","createdOn":1546459220,"lastUpdated":1547484367,"open":true,"status":"NEW","comments":[{"timestamp":1546459220,"reviewer":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"message":"Uploaded patch set 1."},{"timestamp":1546459223,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1546465222,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)\n\nSeems reasonable to me. Tests pass. I don\u0027t believe there is any implicit promise in the docs (i.e. the README) that this breaks.\n\nBefore:\n\n```\n$ node\n\u003e var v \u003d require(\u0027./\u0027)\nundefined\n\u003e new v(\u0027asdf %s\u0027)\nError: format string \"asdf %s\": conversion specifier \"%s\" at character 6 has no matching argument (too few arguments passed)\n    at jsError (/Users/trentm/joy/node-verror/node_modules/extsprintf/lib/extsprintf.js:173:10)\n    at jsSprintf (/Users/trentm/joy/node-verror/node_modules/extsprintf/lib/extsprintf.js:97:11)\n    at parseConstructorArguments (/Users/trentm/joy/node-verror/lib/verror.js:120:26)\n    at new VError (/Users/trentm/joy/node-verror/lib/verror.js:153:11)\n    at repl:1:1\n    at REPLServer.defaultEval (repl.js:272:27)\n    at bound (domain.js:287:14)\n    at REPLServer.runBound [as eval] (domain.js:300:12)\n    at REPLServer.\u003canonymous\u003e (repl.js:441:12)\n    at emitOne (events.js:82:20)\n\u003e new v(\u0027asdf %s\u0027, undefined)\n{ [VError: asdf undefined]\n  jse_shortmsg: \u0027asdf undefined\u0027,\n  jse_info: {},\n  message: \u0027asdf undefined\u0027 }\n\u003e new v(undefined)\nAssertionError: first argument to VError, SError, or WError constructor must be a string, object, or Error (string) is required\n    at parseConstructorArguments (/Users/trentm/joy/node-verror/lib/verror.js:76:18)\n    at new VError (/Users/trentm/joy/node-verror/lib/verror.js:153:11)\n    at repl:1:1\n    at REPLServer.defaultEval (repl.js:272:27)\n    at bound (domain.js:287:14)\n    at REPLServer.runBound [as eval] (domain.js:300:12)\n    at REPLServer.\u003canonymous\u003e (repl.js:441:12)\n    at emitOne (events.js:82:20)\n    at REPLServer.emit (events.js:169:7)\n    at REPLServer.Interface._onLine (readline.js:203:10)\n\u003e new v(null)\n{ [VError] jse_shortmsg: \u0027\u0027, jse_info: {}, message: \u0027\u0027 }\n```\n\nAfter:\n\n```\n$ node\n\u003e var v \u003d require(\u0027./\u0027)\nundefined\n\u003e new v(\u0027asdf %s\u0027)\n{ [VError: asdf %s] jse_shortmsg: \u0027asdf %s\u0027, jse_info: {}, message: \u0027asdf %s\u0027 }\n\u003e new v(\u0027asdf %s\u0027, undefined)\n{ [VError: asdf undefined]\n  jse_shortmsg: \u0027asdf undefined\u0027,\n  jse_info: {},\n  message: \u0027asdf undefined\u0027 }\n\u003e new v(undefined)\nAssertionError: first argument to VError, SError, or WError constructor must be a string, object, or Error (string) is required\n    at parseConstructorArguments (/Users/trentm/joy/node-verror/lib/verror.js:76:18)\n    at new VError (/Users/trentm/joy/node-verror/lib/verror.js:160:11)\n    at repl:1:1\n    at REPLServer.defaultEval (repl.js:272:27)\n    at bound (domain.js:287:14)\n    at REPLServer.runBound [as eval] (domain.js:300:12)\n    at REPLServer.\u003canonymous\u003e (repl.js:441:12)\n    at emitOne (events.js:82:20)\n    at REPLServer.emit (events.js:169:7)\n    at REPLServer.Interface._onLine (readline.js:203:10)\n\u003e new v(null)\n{ [VError] jse_shortmsg: \u0027\u0027, jse_info: {}, message: \u0027\u0027 }\n```\n\n\nI\u0027m adding dap for his opinion."},{"timestamp":1546468453,"reviewer":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"message":"Uploaded patch set 2."},{"timestamp":1546468456,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1547484367,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\nI weighed in on joyent/node-verror#63 -- I think #57 is a better way to go here and will produce more predictable behavior."}],"currentPatchSet":{"number":"2","revision":"ccb8e04a43425bbc4c0467d074ca004d6eeba45f","parents":["cba94a1255aca4f98f8eb1c2d7f1a2f33266c49f"],"ref":"refs/changes/99/5299/2","uploader":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"createdOn":1546468453,"author":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1546468456,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/verror.js","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":7,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"5fb389a4a5de6ceea6e201249248a9d050e07d50","parents":["cba94a1255aca4f98f8eb1c2d7f1a2f33266c49f"],"ref":"refs/changes/99/5299/1","uploader":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"createdOn":1546459220,"author":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1546459223,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/verror.js","line":120,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"typo"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/verror.js","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":7,"sizeDeletions":0},{"number":"2","revision":"ccb8e04a43425bbc4c0467d074ca004d6eeba45f","parents":["cba94a1255aca4f98f8eb1c2d7f1a2f33266c49f"],"ref":"refs/changes/99/5299/2","uploader":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"createdOn":1546468453,"author":{"name":"Peter Marton","email":"pmarton@netflix.com","username":"hekike"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1546468456,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/verror.js","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":7,"sizeDeletions":0}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Joyent Automation","username":"joyent-automation"}]}