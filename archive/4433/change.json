{"project":"joyent/sdcadm","branch":"master","id":"I4970a5b910c78b3290b31e877627340099643751","number":"4433","subject":"TRITON-551 sdcadm build fails as non-root, trying to create log dir TRITON-552 components using cp -P during their build fail with /usr/bin/cp Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"url":"https://cr.joyent.us/4433","commitMessage":"TRITON-551 sdcadm build fails as non-root, trying to create log dir\nTRITON-552 components using cp -P during their build fail with /usr/bin/cp\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1530018632,"lastUpdated":1530272937,"open":false,"status":"MERGED","comments":[{"timestamp":1530018632,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 1."},{"timestamp":1530018638,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 82c06b7a02e04ac0b6ca831e04bc357b73c089e7\n    \n    TRITON-551 sdcadm build fails as non-root, trying to create log dir\n    TRITON-552 components using mk-shar during their build fail in /usr/bin/cp"},{"timestamp":1530018666,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530034502,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1530101436,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 2."},{"timestamp":1530101442,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit aafc3be05f92fb9a8ede3309b8dd7d17fd4b47cc\n    \n    TRITON-551 sdcadm build fails as non-root, trying to create log dir\n    TRITON-552 components using mk-shar during their build fail in /usr/bin/cp"},{"timestamp":1530101488,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\n\u003e New commits:\n \u003e \n \u003e commit aafc3be05f92fb9a8ede3309b8dd7d17fd4b47cc\n \u003e \n \u003e TRITON-551 sdcadm build fails as non-root, trying to create log dir\n \u003e TRITON-552 components using mk-shar during their build fail in\n \u003e /usr/bin/cp\n\nI was including both fixes in this single push - is that something the grr workflow is ok with?"},{"timestamp":1530102107,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530131542,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1\n\n\u003e I was including both fixes in this single push - is that something the grr workflow is ok with?\n\nAh, then the commit message needs to have both ticket lines, e.g.; https://github.com/joyent/eng/commit/655fa08b2c613065df8180209246a4899c128c67\n\nUnfortunately `grr` doesn\u0027t currently support doing its thing for multiple tickets. It would definitely be good to add.\n\nOne *can* manually update the commit message in gerrit, and then avoid re-running `grr` to not have it screwed up again. :)"},{"timestamp":1530170473,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\n\u003e \u003e I was including both fixes in this single push - is that\n \u003e something the grr workflow is ok with?\n \u003e \n \u003e Ah, then the commit message needs to have both ticket lines, e.g.;\n \u003e https://github.com/joyent/eng/commit/655fa08b2c613065df8180209246a4899c128c67\n \u003e \n \u003e Unfortunately `grr` doesn\u0027t currently support doing its thing for\n \u003e multiple tickets. It would definitely be good to add.\n \u003e \n \u003e One *can* manually update the commit message in gerrit, and then\n \u003e avoid re-running `grr` to not have it screwed up again. :)\n\nAha! I had both lines in my local repository, but didn\u0027t realize grr was torching them. I\u0027ll do that by hand for this commit."},{"timestamp":1530170633,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1530208933,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1530271667,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 4."},{"timestamp":1530271702,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530272195,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1\n\nSince afaik grr can\u0027t do multi-bug commits, I\u0027m re-applying trentm\u0027s CR and IA fom the previous patch set 3. All that changed here is my tweaking the commit message to record Trent\u0027s work on this.\n\nI believe Gerrit normally copes with changes where only the Reviewed and Approved comments were changed, but in this case, I also needed to rebase my changes on top of dae7b327d1c9e26dba254b68d5f53a8753cd5f69, which probably explains why Gerrit dropped CR and IA."},{"timestamp":1530272937,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Tim Foster"}],"currentPatchSet":{"number":"4","revision":"4970a5b910c78b3290b31e877627340099643751","parents":["dae7b327d1c9e26dba254b68d5f53a8753cd5f69"],"ref":"refs/changes/33/4433/4","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1530271667,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530271702,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530272195,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530272195,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"SUBM","value":"1","grantedOn":1530272937,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/logging.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"tools/mk-shar","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-3},"patchSets":[{"number":"1","revision":"ced6396357f295e369708f01d714bf0d0e8304ed","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/33/4433/1","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1530018632,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530018666,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/logging.js","line":199,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"This looks fine."},{"file":"tools/mk-shar","line":76,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"The changes in this file are for a separate ticket?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/logging.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"tools/mk-shar","type":"MODIFIED","insertions":3,"deletions":-3}],"sizeInsertions":4,"sizeDeletions":-5},{"number":"2","revision":"ed65a563f8873aea35f64b1b08ef689a7b8d6c50","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/33/4433/2","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1530101436,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530102107,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530131542,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/logging.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"tools/mk-shar","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-3},{"number":"3","revision":"cd98eb5dbfbac18226bb7e5cc07465bc484d7552","parents":["ea39aeca8a39b78bfecea2864c9e2a4cd8502249"],"ref":"refs/changes/33/4433/3","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1530170633,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530102107,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530131542,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530208933,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/logging.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"tools/mk-shar","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-3},{"number":"4","revision":"4970a5b910c78b3290b31e877627340099643751","parents":["dae7b327d1c9e26dba254b68d5f53a8753cd5f69"],"ref":"refs/changes/33/4433/4","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1530271667,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530271702,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530272195,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530272195,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"SUBM","value":"1","grantedOn":1530272937,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/logging.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"tools/mk-shar","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":2,"sizeDeletions":-3}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}]}