{"project":"joyent/smartos-live","branch":"master","id":"Iec94837e77314d5f8aaaf53a0ae3a42f71ceb35a","number":"5355","subject":"OS-7497 bhyve disks need uuids Reviewed by: Jorge Schrauwen \u003csjorge@blackdot.be\u003e Reviewed by: Dylan Yep \u003cdylan.yep@joyent.com\u003e Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Approved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"url":"https://cr.joyent.us/5355","commitMessage":"OS-7497 bhyve disks need uuids\nReviewed by: Jorge Schrauwen \u003csjorge@blackdot.be\u003e\nReviewed by: Dylan Yep \u003cdylan.yep@joyent.com\u003e\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nApproved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1547225989,"lastUpdated":1548689418,"open":false,"status":"MERGED","comments":[{"timestamp":1547225989,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 1."},{"timestamp":1547226042,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1547230742,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1: Code-Review+1\n\n(2 comments)\n\nI not as well versed in the test framework, what is the wanted behavior/test for when a uuid gets updated to \"\"?"},{"timestamp":1547248346,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 2."},{"timestamp":1547248401,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1547248428,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(2 comments)\n\nI wasn\u0027t really ready for others to review before - so quite a bit of change since then.  Some of that change includes adding tests for invalid uuids.  This turned up a long-standing bug in our common uuid validation code.  :)"},{"timestamp":1547249266,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1547493144,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 2:\n\n(1 comment)\n\nLooks good. Assuming all tests pass and that\u0027s mentioned in the ticket, you\u0027ve got my +1.\n\nWhat are the benefits to putting all the tests in a single test block?"},{"timestamp":1547590257,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\n(1 comment)\n\nI had initially done one test() to save the time of provisioning so many instances.  On further consideration, breaking this up into several test()s only costs about 10 seconds of run time.  This comes with greater clarity in the test output."},{"timestamp":1547590269,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 3."},{"timestamp":1547590324,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1547590339,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3:\n\nNow test output looks like:\n\n# Running tests/test-disk-uuid.js\nAlready have \"imgapi\" image source \"https://images.joyent.com\", no change\nAlready have \"docker\" image source \"https://docker.io\", no change\nTAP version 13\n# uuid is optional in the add_disk payload and uuids are assigned\nok 1 VM created with uuid 727316f7-a9b2-ef51-f201-91975d89e2ce\nok 2 VM loaded uuid 727316f7-a9b2-ef51-f201-91975d89e2ce state stopped zone_state installed\nok 3 VM is stopped\nok 4 disk has valid uuid: 03be4541-dd93-c3c2-bdc9-8e2cfc00d090\nok 5 disk has valid uuid: 50c967cd-61c5-4696-e6fe-f51a47f8e477\nok 6 should have two disks\nok 7 added one disk without uuid\nok 8 disk has valid uuid: 03be4541-dd93-c3c2-bdc9-8e2cfc00d090\nok 9 disk has valid uuid: 50c967cd-61c5-4696-e6fe-f51a47f8e477\nok 10 disk has valid uuid: 952bbb5d-417e-689d-8704-85ae41126072\n# add one disk with a uuid\nok 11 VM created with uuid 756f4dec-d235-e55d-98aa-ced1d1a54b8f\nok 12 VM loaded uuid 756f4dec-d235-e55d-98aa-ced1d1a54b8f state stopped zone_state installed\nok 13 VM is stopped\nok 14 disk has valid uuid: 78a9ffea-b6d7-e069-a125-b321e52a4b8c\nok 15 disk has valid uuid: db7a8b52-ad07-ef90-b4ff-b1a40d13ff3c\nok 16 should have two disks\nok 17 new disk with uuid c7c6e8b8-7686-e1af-ecc6-8f2ef47a08b5 found in config\nok 18 added one disk with uuid\nok 19 disk has valid uuid: 78a9ffea-b6d7-e069-a125-b321e52a4b8c\nok 20 disk has valid uuid: db7a8b52-ad07-ef90-b4ff-b1a40d13ff3c\nok 21 disk has valid uuid: c7c6e8b8-7686-e1af-ecc6-8f2ef47a08b5\n# add multiple diskss with uuids\nok 22 VM created with uuid 52ffaf57-9f76-c1df-8558-ba2dcd31aa64\nok 23 VM loaded uuid 52ffaf57-9f76-c1df-8558-ba2dcd31aa64 state stopped zone_state installed\nok 24 VM is stopped\nok 25 disk has valid uuid: c0ecf544-62b8-c768-879d-fa4218929a59\nok 26 disk has valid uuid: 7d914b86-ebf6-612a-b35b-e2dbf6cc8569\nok 27 should have two disks\nok 28 new disk with uuid 526df469-0b7e-ecc0-a3f1-b397a5997ea0 found in config\nok 29 new disk with uuid be53f0ea-681c-e5b7-9415-e800a8f49356 found in config\nok 30 add two disks with unique uuids\nok 31 disk has valid uuid: c0ecf544-62b8-c768-879d-fa4218929a59\nok 32 disk has valid uuid: 7d914b86-ebf6-612a-b35b-e2dbf6cc8569\nok 33 disk has valid uuid: 526df469-0b7e-ecc0-a3f1-b397a5997ea0\nok 34 disk has valid uuid: be53f0ea-681c-e5b7-9415-e800a8f49356\n# duplicate disks.*.uuids in payload are detected\nok 35 VM created with uuid de4f019b-29f1-cdc6-d389-e12402502e6f\nok 36 VM loaded uuid de4f019b-29f1-cdc6-d389-e12402502e6f state stopped zone_state installed\nok 37 VM is stopped\nok 38 disk has valid uuid: c255db01-4865-cc64-fa4b-898c31bf9c33\nok 39 disk has valid uuid: 40592819-4c94-e8e0-ed19-d5205ab1f66d\nok 40 should have two disks\nok 41 error expected when adding multiple disks with same uuid\nok 42 VM loaded uuid de4f019b-29f1-cdc6-d389-e12402502e6f state stopped zone_state installed\nok 43 should have two disks\nok 44 disk has valid uuid: c255db01-4865-cc64-fa4b-898c31bf9c33\nok 45 disk has valid uuid: 40592819-4c94-e8e0-ed19-d5205ab1f66d\n# collision with existing disks are detected\nok 46 VM created with uuid 2e074f4f-3e1c-6b75-a162-867289747a23\nok 47 VM loaded uuid 2e074f4f-3e1c-6b75-a162-867289747a23 state stopped zone_state installed\nok 48 VM is stopped\nok 49 disk has valid uuid: 4702ec05-0a50-453f-b9ec-8de391266def\nok 50 disk has valid uuid: e95213f9-a57d-69c0-87f1-a892dbcbf658\nok 51 should have two disks\nok 52 error expected when adding disks with in-use uuid\nok 53 VM loaded uuid 2e074f4f-3e1c-6b75-a162-867289747a23 state stopped zone_state installed\nok 54 should have two disks\nok 55 disk has valid uuid: 4702ec05-0a50-453f-b9ec-8de391266def\nok 56 disk has valid uuid: e95213f9-a57d-69c0-87f1-a892dbcbf658\n# bogus uuids are not allowed\nok 57 VM created with uuid 43cbd9db-fe27-e9a3-d4eb-ccaf09b24d73\nok 58 VM loaded uuid 43cbd9db-fe27-e9a3-d4eb-ccaf09b24d73 state stopped zone_state installed\nok 59 VM is stopped\nok 60 disk has valid uuid: 2bf29e46-791b-6007-c2c0-b48a8231d931\nok 61 disk has valid uuid: e2842f1f-dadc-ca2e-f7e7-9868282a5ca4\nok 62 should have two disks\nok 63 bogus uuid \"\" not allowed\nok 64 bogus uuid \"not-a-uuid\" not allowed\nok 65 bogus uuid 0 not allowed\nok 66 bogus uuid [\"also\",\"not\",\"a\",\"uuid\"] not allowed\nok 67 VM loaded uuid 43cbd9db-fe27-e9a3-d4eb-ccaf09b24d73 state stopped zone_state installed\nok 68 should have two disks\nok 69 disk has valid uuid: 2bf29e46-791b-6007-c2c0-b48a8231d931\nok 70 disk has valid uuid: e2842f1f-dadc-ca2e-f7e7-9868282a5ca4\n# starting and stopping the VM does not lose uuids\nok 71 VM created with uuid 07d3e379-d209-e093-d603-911eaf93e07b\nok 72 VM loaded uuid 07d3e379-d209-e093-d603-911eaf93e07b state stopped zone_state installed\nok 73 VM is stopped\nok 74 disk has valid uuid: ffbc8ad6-11f2-4e9f-dc92-beafbb6f8a35\nok 75 disk has valid uuid: 8f39bd02-c8e1-e394-8848-8a9e26824009\nok 76 should have two disks\nok 77 zone start: success\nok 78 VM loaded uuid 07d3e379-d209-e093-d603-911eaf93e07b state running zone_state running\nok 79 VM is running\nok 80 disk has valid uuid: ffbc8ad6-11f2-4e9f-dc92-beafbb6f8a35\nok 81 disk has valid uuid: 8f39bd02-c8e1-e394-8848-8a9e26824009\nok 82 should have two disks\nok 83 zone stop: success\nok 84 VM loaded uuid 07d3e379-d209-e093-d603-911eaf93e07b state stopped zone_state installed\nok 85 VM is stopped\nok 86 disk has valid uuid: ffbc8ad6-11f2-4e9f-dc92-beafbb6f8a35\nok 87 disk has valid uuid: 8f39bd02-c8e1-e394-8848-8a9e26824009\nok 88 should have two disks\n# disks without uuids have uuids assigned at next boot\nok 89 VM created with uuid 79def0b3-b34c-c40c-f74e-9e9a1ef4d52a\nok 90 VM loaded uuid 79def0b3-b34c-c40c-f74e-9e9a1ef4d52a state stopped zone_state installed\nok 91 VM is stopped\nok 92 disk has valid uuid: 8213183e-bd04-ef8b-c9b8-db3332fcc90e\nok 93 disk has valid uuid: 5f3f769f-784c-6ff8-afba-a89971ee4b07\nok 94 should have two disks\nok 95 remmove disk uuids: success\nok 96 VM loaded uuid 79def0b3-b34c-c40c-f74e-9e9a1ef4d52a state stopped zone_state installed\nok 97 disk /dev/zvol/rdsk/zones/79def0b3-b34c-c40c-f74e-9e9a1ef4d52a/disk0 should not have uuid\nok 98 disk /dev/zvol/rdsk/zones/79def0b3-b34c-c40c-f74e-9e9a1ef4d52a/disk1 should not have uuid\nok 99 should have two disks\nok 100 zone start: success\nok 101 VM loaded uuid 79def0b3-b34c-c40c-f74e-9e9a1ef4d52a state running zone_state running\nok 102 disk has valid uuid: d196458a-24ec-cca2-b787-b874f79c9e65\nok 103 disk has valid uuid: f5997ad2-ecb1-ebfd-e962-ae064775c49e\nok 104 should have two disks\n\n1..104\n# tests 104\n# pass  104\n\n# ok\n#\n# tests/test-disk-uuid.js TEST COMPLETE IN 21 SECONDS, SUMMARY:\n#\n# PASS: 104 / 104\n#"},{"timestamp":1547675546,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1548176511,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 4."},{"timestamp":1548176564,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548264122,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1548272225,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1\n\n(3 comments)"},{"timestamp":1548343230,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4:\n\n(3 comments)"},{"timestamp":1548343240,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1548343301,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1548450470,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 6."},{"timestamp":1548450527,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548458778,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1548575697,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1548602604,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 7: Patch Set 6 was rebased"},{"timestamp":1548602661,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"},{"timestamp":1548689367,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1548689418,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Mike Gerdts"}],"currentPatchSet":{"number":"8","revision":"838dbdd02b49a522d7eaef68e7c543c67753cd8b","parents":["9b40988b4563e1aaabf24ad48bf30821e2bf0e6d"],"ref":"refs/changes/55/5355/8","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548689367,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548450527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548458778,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548575697,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1548689418,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":2,"deletions":-6},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-35},"patchSets":[{"number":"1","revision":"18f73900ffea1a8e72a62ee8069e6815eeb65941","parents":["8f1e83bbc31331e3df3195a73ce4aff4797d60fe"],"ref":"refs/changes/55/5355/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1547225989,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1547226042,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1547230742,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"comments":[{"file":"src/vm/man/vmadm.1m.md","line":1031,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"I though there was some upgrade hooks available, maybe use those to add the uuid to existing VMs and skip the fill on on next vmadm start? (I might be miss remembering though)"},{"file":"src/vm/man/vmadm.1m.md","line":1031,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"I\u0027m not aware of anything in the platform that allows such upgrades - maybe you are thinking of a mechanism for triton services?\n\nThe implementation is consistent with what we did for pci_slot."},{"file":"src/vm/man/vmadm.1m.md","line":1031,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Might be yeah"},{"file":"src/vm/node_modules/VM.js","line":9548,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"This is unique per vm or also cross-vm?"},{"file":"src/vm/node_modules/VM.js","line":9548,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It only needs to be unique within a VM.  Trying to go the extra mile to be unique across VMs is not helpful, is much messier, and does not play well with migration."},{"file":"src/vm/node_modules/VM.js","line":9548,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Maybe add an extra line to the man page make sure this is clear for the user that I needs to be unique within a single vm?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":11,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":116,"deletions":-26},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":279,"deletions":0}],"sizeInsertions":416,"sizeDeletions":-26},{"number":"2","revision":"a3c6c3799911fb3c5b5fb9a020e61c49f96cf375","parents":["9d98018c7deaa96ac7eb9f6a26095c4c7bc08bc4"],"ref":"refs/changes/55/5355/2","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1547248346,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1547248401,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/VM.js","line":9539,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"This could be done with a single reduce.\n\nuuids \u003d vmobj.disks.reduce(function diskUuid(_uuids, _disk) {\n  if(_disk.hasOwnProperty(\u0027uuid\u0027)) {\n    _uuids.push(_disk.uuid);\n  }\n\n  return _uuids;\n}, [])"},{"file":"src/vm/node_modules/VM.js","line":9539,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":11,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":119,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":554,"deletions":0}],"sizeInsertions":698,"sizeDeletions":-31},{"number":"3","revision":"a317cefac4e15c9a3a27cfbda7d18dd6dd693d8a","parents":["9d98018c7deaa96ac7eb9f6a26095c4c7bc08bc4"],"ref":"refs/changes/55/5355/3","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1547590269,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1547590324,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/tests/test-disk-uuid.js","line":514,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"s/diskss/disk"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":708,"sizeDeletions":-31},{"number":"4","revision":"0a09566b56c9203406124d9d89111ad6a9ebd7b1","parents":["9d98018c7deaa96ac7eb9f6a26095c4c7bc08bc4"],"ref":"refs/changes/55/5355/4","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548176511,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548176564,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548272225,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548272225,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548264122,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"comments":[{"file":"src/vm/node_modules/proptable.js","line":703,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"What does this do?"},{"file":"src/vm/node_modules/proptable.js","line":703,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"oops, I meant to ask about that.  It\u0027s not at all clear to me when this is needed.  I can\u0027t find a pattern in the properties that have it set."},{"file":"src/vm/node_modules/utils.js","line":211,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This can all be replaced with a single \"re.test(str)\""},{"file":"src/vm/node_modules/utils.js","line":211,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"I think the type comparison is relevant.\n\n    \u003e a \u003d [uuid]\n    [ \u00278bb7aba2-e736-61f4-eb0b-abde17bfeb92\u0027 ]\n    \u003e re.test(a)\n    true\n    \u003e typeof (uuid) \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026 re.test(uuid)\n    true\n    \u003e typeof (a) \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026 re.test(a)\n    false\n\nThe other stuff that I carried forward is probably not needed."},{"file":"src/vm/tests/test-disk-uuid.js","line":299,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"a uuid"},{"file":"src/vm/tests/test-disk-uuid.js","line":299,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":708,"sizeDeletions":-31},{"number":"5","revision":"9c37600314f5493c2ecf83995fbaa8f967b50a16","parents":["a8b1126292d49455fe6aeed0ae2895af2dd7b88a"],"ref":"refs/changes/55/5355/5","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548343240,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548176564,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548272225,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548272225,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548264122,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":708,"sizeDeletions":-31},{"number":"6","revision":"ec94837e77314d5f8aaaf53a0ae3a42f71ceb35a","parents":["a8b1126292d49455fe6aeed0ae2895af2dd7b88a"],"ref":"refs/changes/55/5355/6","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548450470,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548450527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548575697,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548458778,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":2,"deletions":-6},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-35},{"number":"7","revision":"9d7a6567c51beb9a1b8ba5521cc48253bce1448f","parents":["9b40988b4563e1aaabf24ad48bf30821e2bf0e6d"],"ref":"refs/changes/55/5355/7","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548602604,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548450527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548575697,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548458778,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":2,"deletions":-6},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-35},{"number":"8","revision":"838dbdd02b49a522d7eaef68e7c543c67753cd8b","parents":["9b40988b4563e1aaabf24ad48bf30821e2bf0e6d"],"ref":"refs/changes/55/5355/8","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1548689367,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548450527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1548575697,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1548689418,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548458778,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"src/Makefile","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":12,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":120,"deletions":-29},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/utils.js","type":"MODIFIED","insertions":2,"deletions":-6},{"file":"src/vm/tests/test-disk-uuid.js","type":"ADDED","insertions":562,"deletions":0}],"sizeInsertions":706,"sizeDeletions":-35}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}]}