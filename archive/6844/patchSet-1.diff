commit 8334d6431952c5bb11a5517c88e2abc79f4a8c80
Author: Brian Bennett <brian.bennett@joyent.com>
Date:   2019-08-28T09:38:59-07:00 (6 weeks ago)
    
    joyent/manta-thoth#95 thoth should work inside a job

diff --git a/bin/thoth b/bin/thoth
index 8dea1a6..68314ee 100755
--- a/bin/thoth
+++ b/bin/thoth
@@ -3549,10 +3549,12 @@ var connect = function ()
 	var i, opts = {};
 	var mvars = [ 'MANTA_URL', 'MANTA_USER', 'MANTA_KEY_ID' ];
 
-	for (i = 0; i < mvars.length; i++) {
-		if (!process.env[mvars[i]]) {
-			fatal('expected ' + mvars[i] +
-			    ' environment variable to be set');
+	if (process.env.MANTA_NO_AUTH !== 'true') {
+		for (i = 0; i < mvars.length; i++) {
+			if (!process.env[mvars[i]]) {
+				fatal('expected ' + mvars[i] +
+				    ' environment variable to be set');
+			}
 		}
 	}
 
