{"project":"joyent/sdc-headnode","branch":"master","topic":"HEAD-2315","id":"Iaafcdfe22999e87578265cefe20ce7ba00b3e832","number":"159","subject":"HEAD-2315 boot media should use current grub Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Cody Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"url":"https://cr.joyent.us/159","commitMessage":"HEAD-2315 boot media should use current grub\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Cody Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1469663887,"lastUpdated":1469908880,"open":false,"status":"MERGED","comments":[{"timestamp":1469663887,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 1."},{"timestamp":1469663896,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Topic set to HEAD-2315"},{"timestamp":1469663945,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n buildtools/bashstyle tools/bin/sdc-vm\n buildtools/bashstyle tools/bin/sdc-amonrelay\n buildtools/bashstyle tools/bin/sdc-vmname\n buildtools/bashstyle tools/lib/wrap.sh\n buildtools/bashstyle buildtools/lib/trace_logger.sh\n buildtools/bashstyle buildtools/lib/common.sh\n buildtools/bashstyle buildtools/lib/error_handler.sh\n buildtools/bashstyle bin/include-tar-generic\n buildtools/bashstyle bin/build-image\n buildtools/bashstyle bin/build-coal-image\n buildtools/bashstyle bin/reflash\n buildtools/bashstyle bin/build-usb-image\n buildtools/bashstyle bin/mk-sdc-clients-light.sh\n buildtools/bashstyle bin/build-dataset\n buildtools/bashstyle bin/build-tar-image\n npm install\n npm WARN addRemoteGit Error: Command failed: \n npm WARN addRemoteGit     at ChildProcess.exithandler (child_process.js:658:15)\n npm WARN addRemoteGit     at ChildProcess.emit (events.js:98:17)\n npm WARN addRemoteGit     at maybeClose (child_process.js:766:16)\n npm WARN addRemoteGit     at Process.ChildProcess._handle.onexit (child_process.js:833:5)\n npm WARN addRemoteGit  git+ssh://git@github.com/joyent/node-manta.git#12f4c84 resetting remote /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4 because of error: { [Error: Command failed: ] killed: false, code: 1, signal: null }\n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: Cloning into bare repository \u0027/home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4\u0027...\n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: Host key verification failed.\n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: fatal: Could not read from remote repository.\n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: \n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: Please make sure you have the correct access rights\n npm ERR! git clone --template\u003d/home/build/.npm/_git-remotes/_templates --mirror ssh://git@github.com/joyent/node-manta.git /home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4: and the repository exists.\n npm ERR! SunOS 5.11\n npm ERR! argv \"/opt/local/bin/node\" \"/opt/local/bin/npm\" \"install\"\n npm ERR! node v0.10.46\n npm ERR! npm  v2.15.1\n npm ERR! code 128\n \n npm ERR! Command failed: Cloning into bare repository \u0027/home/build/.npm/_git-remotes/ssh-git-github-com-joyent-node-manta-git-5ee153d4\u0027...\n npm ERR! Host key verification failed.\n npm ERR! fatal: Could not read from remote repository.\n npm ERR! \n npm ERR! Please make sure you have the correct access rights\n npm ERR! and the repository exists.\n npm ERR! \n npm ERR! \n npm ERR! If you need help, you may report this error at:\n npm ERR!     \u003chttps://github.com/npm/npm/issues\u003e\n \n npm ERR! Please include the following file with any support request:\n npm ERR!     /tmp/repo/npm-debug.log\n Makefile:213: recipe for target \u00270-npm-stamp\u0027 failed\n gmake: *** [0-npm-stamp] Error 1"},{"timestamp":1469665029,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1469665106,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: -CI-Testing"},{"timestamp":1469665545,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1469726697,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)\n\nCan you describe a bit more about how the changes to build-usb-image and build-coal-image work? I\u0027m not sure I follow how the correct files now end up in the cache to untar."},{"timestamp":1469728401,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\nI was able to clarify how the image part gets put together, so I\u0027m relatively happy, though still think the README might need some improvement."},{"timestamp":1469745977,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 3."},{"timestamp":1469746085,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1469832395,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1469836867,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1469908870,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 4: Commit message was updated."},{"timestamp":1469908880,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Joshua M. Clulow"}],"currentPatchSet":{"number":"4","revision":"4057d5b2bfd8bc4a49a99edd858db01e9197c909","parents":["d85c547840d8debd155c821a388bcfa21e674114"],"ref":"refs/changes/59/159/4","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1469908870,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469746085,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469832395,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469836867,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1469908880,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/build-coal-image","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"bin/build-usb-image","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"build.spec","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usb/1gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/1gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/2gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/2gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/4gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/4gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/README.md","type":"DELETED","insertions":0,"deletions":-136},{"file":"usb/grub-LICENSE","type":"DELETED","insertions":0,"deletions":-339},{"file":"vmware/README.md","type":"ADDED","insertions":18,"deletions":0},{"file":"vmware/make_vmdk","type":"ADDED","insertions":101,"deletions":0}],"sizeInsertions":145,"sizeDeletions":-573},"patchSets":[{"number":"1","revision":"9892a07d9462e512c466464413d34c5c20c2b9eb","parents":["1ee00927dcfdb48d63eca36b119cebf804b4003a"],"ref":"refs/changes/59/159/1","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1469663887,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1469663945,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/build-coal-image","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"bin/build-usb-image","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"build.spec","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usb/1gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/2gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/4gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/README.md","type":"MODIFIED","insertions":0,"deletions":-103},{"file":"usb/grub-LICENSE","type":"DELETED","insertions":0,"deletions":-339}],"sizeInsertions":15,"sizeDeletions":-449},{"number":"2","revision":"f76fda560fe0fc83585d334d3e2be604d15af7b9","parents":["d85c547840d8debd155c821a388bcfa21e674114"],"ref":"refs/changes/59/159/2","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1469665029,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469665545,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"usb/README.md","line":14,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Probably worth talking about how this is only used for VMware and that others are automatically generated by the build."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/build-coal-image","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"bin/build-usb-image","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"build.spec","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usb/1gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/2gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/4gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/README.md","type":"MODIFIED","insertions":0,"deletions":-103},{"file":"usb/grub-LICENSE","type":"DELETED","insertions":0,"deletions":-339}],"sizeInsertions":15,"sizeDeletions":-449},{"number":"3","revision":"aafcdfe22999e87578265cefe20ce7ba00b3e832","parents":["d85c547840d8debd155c821a388bcfa21e674114"],"ref":"refs/changes/59/159/3","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1469745977,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469832395,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469836867,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469746085,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/build-coal-image","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"bin/build-usb-image","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"build.spec","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usb/1gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/1gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/2gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/2gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/4gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/4gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/README.md","type":"DELETED","insertions":0,"deletions":-136},{"file":"usb/grub-LICENSE","type":"DELETED","insertions":0,"deletions":-339},{"file":"vmware/README.md","type":"ADDED","insertions":18,"deletions":0},{"file":"vmware/make_vmdk","type":"ADDED","insertions":101,"deletions":0}],"sizeInsertions":145,"sizeDeletions":-573},{"number":"4","revision":"4057d5b2bfd8bc4a49a99edd858db01e9197c909","parents":["d85c547840d8debd155c821a388bcfa21e674114"],"ref":"refs/changes/59/159/4","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1469908870,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1469832395,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1469836867,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1469908880,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1469746085,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/build-coal-image","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"bin/build-usb-image","type":"MODIFIED","insertions":5,"deletions":-6},{"file":"build.spec","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usb/1gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/1gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/2gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/2gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/4gb.coal.vmdk","type":"DELETED","insertions":0,"deletions":-28},{"file":"usb/4gb.img.tgz","type":"DELETED","insertions":0,"deletions":0},{"file":"usb/README.md","type":"DELETED","insertions":0,"deletions":-136},{"file":"usb/grub-LICENSE","type":"DELETED","insertions":0,"deletions":-339},{"file":"vmware/README.md","type":"ADDED","insertions":18,"deletions":0},{"file":"vmware/make_vmdk","type":"ADDED","insertions":101,"deletions":0}],"sizeInsertions":145,"sizeDeletions":-573}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}]}