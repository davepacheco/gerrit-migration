{"project":"joyent/illumos-joyent","branch":"master","id":"I333fe34442fe190403667c9c5fa3433d62152a11","number":"202","subject":"OS-5571 incorrect task count in cgroup 0 Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"url":"https://cr.joyent.us/202","commitMessage":"OS-5571 incorrect task count in cgroup 0\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1470260952,"lastUpdated":1470339294,"open":false,"status":"ABANDONED","comments":[{"timestamp":1470260952,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Uploaded patch set 1."},{"timestamp":1470265378,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1470267882,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1470322613,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1470339294,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Abandoned\n\nThis change is incorrect, a different approach is needed."}],"currentPatchSet":{"number":"1","revision":"333fe34442fe190403667c9c5fa3433d62152a11","parents":["5216f207fca0ab66e4f96f2fdaea9154b1317359"],"ref":"refs/changes/02/202/1","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1470260952,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"In most other places where zone_nlwps_lock is acquired, p_lock is also held. I\u0027m not sure if we would run into ordering issues with it held here."},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"p_lock is already held by one call point but I don\u0027t see it at the other call point. I am not clear that it matters here since taking the lock is mostly an attempt to be consistent with current usage, but I think the outer lock will be the control point."},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Even though it\u0027s unlikely (or impossible) that it will change, isn\u0027t p_zone considered as under the protection of p_lock?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":16,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"333fe34442fe190403667c9c5fa3433d62152a11","parents":["5216f207fca0ab66e4f96f2fdaea9154b1317359"],"ref":"refs/changes/02/202/1","uploader":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"createdOn":1470260952,"author":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"In most other places where zone_nlwps_lock is acquired, p_lock is also held. I\u0027m not sure if we would run into ordering issues with it held here."},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"p_lock is already held by one call point but I don\u0027t see it at the other call point. I am not clear that it matters here since taking the lock is mostly an attempt to be consistent with current usage, but I think the outer lock will be the control point."},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","line":502,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Even though it\u0027s unlikely (or impossible) that it will change, isn\u0027t p_zone considered as under the protection of p_lock?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/brand/lx/cgroups/cgrps_vfsops.c","type":"MODIFIED","insertions":16,"deletions":0}],"sizeInsertions":16,"sizeDeletions":0}],"allReviewers":[{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}