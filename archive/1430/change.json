{"project":"joyent/sdc-cn-agent","branch":"master","id":"I0fc62998a46c6387075ceb278de57936b442b6af","number":"1430","subject":"AGENT-1059 cn-agent should not log docker_build payloads Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"url":"https://cr.joyent.us/1430","commitMessage":"AGENT-1059 cn-agent should not log docker_build payloads\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1486157739,"lastUpdated":1486166934,"open":false,"status":"MERGED","comments":[{"timestamp":1486157739,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 1."},{"timestamp":1486157741,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 47888c81e31fc73fbe69225ba8b03c11140faf05\n    \n    do not log task parameters for docker_build"},{"timestamp":1486157771,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486160196,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1486165058,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 2."},{"timestamp":1486165059,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 66b341e838b05866d760896cc33dbd0d1bd77287\n    \n    bump copyright dates"},{"timestamp":1486165090,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486165125,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1486165347,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1486166914,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1486166934,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Orlando Vazquez"}],"currentPatchSet":{"number":"3","revision":"0fc62998a46c6387075ceb278de57936b442b6af","parents":["b42d166a9c1a68a6edb18c7baa0019ea7cd652cc"],"ref":"refs/changes/30/1430/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1486166914,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486165090,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486165125,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486165347,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1486166934,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":13,"deletions":-2}],"sizeInsertions":28,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"a97120fb6aee8b2c0a49aa236a037eff84f6e062","parents":["b42d166a9c1a68a6edb18c7baa0019ea7cd652cc"],"ref":"refs/changes/30/1430/1","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1486157739,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486157771,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/task_agent/task_agent.js","line":109,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"perhaps something like:\n\nvar logFields \u003d {taskName: req.params.task};\n...\nif (logParams) {\n    logFields.params \u003d req.params;\n}\nreq.log.info(logFields, \u0027start task\u0027);\n\n\nI don\u0027t know if \"start task\" is appropriate here.\nThen at least we get a structured log message for this handler with (a) the same msg (useful for keying/grepping) and (b) a \u0027taskName\u0027 field to search on."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":12,"deletions":-1}],"sizeInsertions":26,"sizeDeletions":-2},{"number":"2","revision":"e28382d9696db5cf9c6e182e1722f005578acedf","parents":["b42d166a9c1a68a6edb18c7baa0019ea7cd652cc"],"ref":"refs/changes/30/1430/2","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1486165058,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486165090,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486165125,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486165347,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":13,"deletions":-2}],"sizeInsertions":28,"sizeDeletions":-4},{"number":"3","revision":"0fc62998a46c6387075ceb278de57936b442b6af","parents":["b42d166a9c1a68a6edb18c7baa0019ea7cd652cc"],"ref":"refs/changes/30/1430/3","uploader":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"createdOn":1486166914,"author":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486165090,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486165125,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486165347,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1486166934,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/app.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"lib/task_agent/task_agent.js","type":"MODIFIED","insertions":13,"deletions":-2}],"sizeInsertions":28,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}]}