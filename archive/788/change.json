{"project":"joyent/sdc-napi","branch":"master","id":"I5efaf42a3d3384db58631bcdcfdc4a798df708ba","number":"788","subject":"NAPI-376 Fix regressions from NAPI-361 Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Alex Wilson \u003calex.wilson@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/788","commitMessage":"NAPI-376 Fix regressions from NAPI-361\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Alex Wilson \u003calex.wilson@joyent.com\u003e\n","createdOn":1477522554,"lastUpdated":1477593094,"open":false,"status":"MERGED","comments":[{"timestamp":1477522554,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1477522784,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477523734,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1477527681,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1477527957,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1477527978,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477528033,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1477530719,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1477531319,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1477531555,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477591936,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1477592880,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1477593005,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Integration-Approval+1"},{"timestamp":1477593078,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1477593094,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"6","revision":"5efaf42a3d3384db58631bcdcfdc4a798df708ba","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477593078,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477531555,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477591936,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477593005,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"SUBM","value":"1","grantedOn":1477593094,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":51,"deletions":-5}],"sizeInsertions":56,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"146644b5b6cea32ba4a844324ab253893d8f815d","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477522554,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477522784,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/models/network.js","line":1062,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Can you provide a bit more to the reader about why this is needed and what\u0027s going on?"},{"file":"lib/models/network.js","line":1062,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve placed more information about this over at fixupIPAddr()."},{"file":"lib/util/ip.js","line":25,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is long here supposed to refer to the type or something else?"},{"file":"lib/util/ip.js","line":25,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Yes, it refers to the type. I\u0027ve changed the wording to \"numeric\"."},{"file":"lib/util/ip.js","line":46,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"How do other callers potentially handle a null being returned now? For example, in the network and nic models.\n\nShould we also be checking that the octets are in a valid range?"},{"file":"lib/util/ip.js","line":46,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"The callers check if it returns null when doing input validation for user input. It expects the input to be valid if it\u0027s coming from Moray, since it should have been validated before being placed in there.\n\nI\u0027ve moved this to octetsToNumber(), and added range checks there."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":31,"deletions":-4}],"sizeInsertions":34,"sizeDeletions":-5},{"number":"2","revision":"1900f60014c4736e861626dfc971f1eeaa0d9c6b","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477527681,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477527978,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/models/network.js","line":997,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"What does this have to do with the route objects?"},{"file":"lib/util/ip.js","line":45,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think the same question I had previously still holds. How do callers handle getting null here now? It seems many things pass the results of this to formatting libraries."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":49,"deletions":-5}],"sizeInsertions":54,"sizeDeletions":-7},{"number":"3","revision":"8eaf003c15a542811a23ea0c0d0cccaceda1b9fd","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477530719,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477527978,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":49,"deletions":-5}],"sizeInsertions":54,"sizeDeletions":-7},{"number":"4","revision":"4c802a7b2daa5d1dee530e75a39ccff040c3c7b3","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477531319,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477591936,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477531555,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":51,"deletions":-5}],"sizeInsertions":56,"sizeDeletions":-7},{"number":"5","revision":"d918d3e89657768eef9a58514c3c51ecc8442608","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477592880,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477591936,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477593005,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477531555,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":51,"deletions":-5}],"sizeInsertions":56,"sizeDeletions":-7},{"number":"6","revision":"5efaf42a3d3384db58631bcdcfdc4a798df708ba","parents":["4b413d4712055019af1a9c2e160bb7246f5c0b48"],"ref":"refs/changes/88/788/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477593078,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477591936,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1477593094,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477593005,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477531555,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/models/network.js","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"lib/util/ip.js","type":"MODIFIED","insertions":51,"deletions":-5}],"sizeInsertions":56,"sizeDeletions":-7}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}