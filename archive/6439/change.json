{"project":"joyent/illumos-joyent","branch":"master","id":"Ic6ce7a25abbb33fa38edd55230b7992c5a36ce91","number":"6439","subject":"OS-7719 PCIe speeds and feeds should be exposed to userland OS-7718 pcieb should enable link bandwidth notifications OS-7742 Clean up pcieb CERRWARN and smatch OS-7743 Clean up pcie module -Wno-uninitialized and -Wno-parentheses Reviewed by: Hans Rosenfel","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/6439","commitMessage":"OS-7719 PCIe speeds and feeds should be exposed to userland\nOS-7718 pcieb should enable link bandwidth notifications\nOS-7742 Clean up pcieb CERRWARN and smatch\nOS-7743 Clean up pcie module -Wno-uninitialized and -Wno-parentheses\nReviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Rob Johnston \u003crob.johnston@joyent.com\u003e\n","createdOn":1560447964,"lastUpdated":1561139621,"open":false,"status":"MERGED","comments":[{"timestamp":1560447964,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1560448008,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2."},{"timestamp":1560448058,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\nThis now has the fixes for issues that caused me to back it out originally. The original version was uploaded as patch set one where as the fixes are in patch set two to make it easier to see what\u0027s changed from the original review."},{"timestamp":1560448329,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1560522976,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1561139354,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 2: Integration-Approval+1"},{"timestamp":1561139529,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1561139587,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1561139621,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"4","revision":"c6ce7a25abbb33fa38edd55230b7992c5a36ce91","parents":["f866eafe56a327754d101195d6d63f024fb095a5"],"ref":"refs/changes/39/6439/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1561139587,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560448329,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560522976,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561139354,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}},{"type":"SUBM","value":"1","grantedOn":1561139621,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/pcieb/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/cmd/pcieb/pcieb.c","type":"ADDED","insertions":169,"deletions":0},{"file":"usr/src/lib/fm/topo/libtopo/common/topo_hc.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.c","type":"MODIFIED","insertions":112,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.h","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pcie_hp.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pciehpc.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/hotplug/pcishpc.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcie.c","type":"MODIFIED","insertions":539,"deletions":-18},{"file":"usr/src/uts/common/io/pciex/pcie_pwr.c","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcieb.c","type":"MODIFIED","insertions":296,"deletions":-24},{"file":"usr/src/uts/common/io/pciex/pcieb.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/pcieb_ioctl.h","type":"ADDED","insertions":64,"deletions":0},{"file":"usr/src/uts/common/sys/pcie.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/uts/common/sys/pcie_impl.h","type":"MODIFIED","insertions":39,"deletions":-9},{"file":"usr/src/uts/common/sys/sysevent/eventdefs.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/sysevent/pcie.h","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/uts/i86pc/pcie/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/io/pciex/pcieb_x86.c","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"usr/src/uts/intel/pcieb/Makefile","type":"MODIFIED","insertions":1,"deletions":-17}],"sizeInsertions":1385,"sizeDeletions":-96},"patchSets":[{"number":"1","revision":"d3a2c6678881672f9e59a627bb8581f176c4eea1","parents":["2cbcfc285b5e437a620b2eff0f206603f3f3b29a"],"ref":"refs/changes/39/6439/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1560447964,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/pcieb/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/cmd/pcieb/pcieb.c","type":"ADDED","insertions":169,"deletions":0},{"file":"usr/src/lib/fm/topo/libtopo/common/topo_hc.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.c","type":"MODIFIED","insertions":112,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.h","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pcie_hp.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pciehpc.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/hotplug/pcishpc.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcie.c","type":"MODIFIED","insertions":530,"deletions":-18},{"file":"usr/src/uts/common/io/pciex/pcie_pwr.c","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcieb.c","type":"MODIFIED","insertions":296,"deletions":-24},{"file":"usr/src/uts/common/io/pciex/pcieb.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/pcieb_ioctl.h","type":"ADDED","insertions":64,"deletions":0},{"file":"usr/src/uts/common/sys/pcie.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/uts/common/sys/pcie_impl.h","type":"MODIFIED","insertions":39,"deletions":-9},{"file":"usr/src/uts/common/sys/sysevent/eventdefs.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/sysevent/pcie.h","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/uts/i86pc/pcie/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/io/pciex/pcieb_x86.c","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"usr/src/uts/intel/pcieb/Makefile","type":"MODIFIED","insertions":1,"deletions":-17}],"sizeInsertions":1376,"sizeDeletions":-96},{"number":"2","revision":"c2c290b08bb2618274707051d1f3c4a63cc7383a","parents":["2cbcfc285b5e437a620b2eff0f206603f3f3b29a"],"ref":"refs/changes/39/6439/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1560448008,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560448329,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560522976,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561139354,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/pcieb/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/cmd/pcieb/pcieb.c","type":"ADDED","insertions":169,"deletions":0},{"file":"usr/src/lib/fm/topo/libtopo/common/topo_hc.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.c","type":"MODIFIED","insertions":112,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.h","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pcie_hp.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pciehpc.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/hotplug/pcishpc.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcie.c","type":"MODIFIED","insertions":539,"deletions":-18},{"file":"usr/src/uts/common/io/pciex/pcie_pwr.c","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcieb.c","type":"MODIFIED","insertions":296,"deletions":-24},{"file":"usr/src/uts/common/io/pciex/pcieb.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/pcieb_ioctl.h","type":"ADDED","insertions":64,"deletions":0},{"file":"usr/src/uts/common/sys/pcie.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/uts/common/sys/pcie_impl.h","type":"MODIFIED","insertions":39,"deletions":-9},{"file":"usr/src/uts/common/sys/sysevent/eventdefs.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/sysevent/pcie.h","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/uts/i86pc/pcie/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/io/pciex/pcieb_x86.c","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"usr/src/uts/intel/pcieb/Makefile","type":"MODIFIED","insertions":1,"deletions":-17}],"sizeInsertions":1385,"sizeDeletions":-96},{"number":"3","revision":"609da953602a4ce55710c83b42f4ee5ed2357f4c","parents":["f866eafe56a327754d101195d6d63f024fb095a5"],"ref":"refs/changes/39/6439/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1561139529,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560448329,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560522976,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561139354,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/pcieb/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/cmd/pcieb/pcieb.c","type":"ADDED","insertions":169,"deletions":0},{"file":"usr/src/lib/fm/topo/libtopo/common/topo_hc.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.c","type":"MODIFIED","insertions":112,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.h","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pcie_hp.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pciehpc.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/hotplug/pcishpc.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcie.c","type":"MODIFIED","insertions":539,"deletions":-18},{"file":"usr/src/uts/common/io/pciex/pcie_pwr.c","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcieb.c","type":"MODIFIED","insertions":296,"deletions":-24},{"file":"usr/src/uts/common/io/pciex/pcieb.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/pcieb_ioctl.h","type":"ADDED","insertions":64,"deletions":0},{"file":"usr/src/uts/common/sys/pcie.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/uts/common/sys/pcie_impl.h","type":"MODIFIED","insertions":39,"deletions":-9},{"file":"usr/src/uts/common/sys/sysevent/eventdefs.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/sysevent/pcie.h","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/uts/i86pc/pcie/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/io/pciex/pcieb_x86.c","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"usr/src/uts/intel/pcieb/Makefile","type":"MODIFIED","insertions":1,"deletions":-17}],"sizeInsertions":1385,"sizeDeletions":-96},{"number":"4","revision":"c6ce7a25abbb33fa38edd55230b7992c5a36ce91","parents":["f866eafe56a327754d101195d6d63f024fb095a5"],"ref":"refs/changes/39/6439/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1561139587,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1561139621,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560448329,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1560522976,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1561139354,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/cmd/pcieb/Makefile","type":"ADDED","insertions":36,"deletions":0},{"file":"usr/src/cmd/pcieb/pcieb.c","type":"ADDED","insertions":169,"deletions":0},{"file":"usr/src/lib/fm/topo/libtopo/common/topo_hc.h","type":"MODIFIED","insertions":7,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.c","type":"MODIFIED","insertions":112,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/common/pcibus/did_props.h","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pcie_hp.c","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/hotplug/pciehpc.c","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/hotplug/pcishpc.c","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcie.c","type":"MODIFIED","insertions":539,"deletions":-18},{"file":"usr/src/uts/common/io/pciex/pcie_pwr.c","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"usr/src/uts/common/io/pciex/pcieb.c","type":"MODIFIED","insertions":296,"deletions":-24},{"file":"usr/src/uts/common/io/pciex/pcieb.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/io/pciex/pcieb_ioctl.h","type":"ADDED","insertions":64,"deletions":0},{"file":"usr/src/uts/common/sys/pcie.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/uts/common/sys/pcie_impl.h","type":"MODIFIED","insertions":39,"deletions":-9},{"file":"usr/src/uts/common/sys/sysevent/eventdefs.h","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"usr/src/uts/common/sys/sysevent/pcie.h","type":"ADDED","insertions":57,"deletions":0},{"file":"usr/src/uts/i86pc/pcie/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/uts/intel/io/pciex/pcieb_x86.c","type":"MODIFIED","insertions":11,"deletions":-8},{"file":"usr/src/uts/intel/pcieb/Makefile","type":"MODIFIED","insertions":1,"deletions":-17}],"sizeInsertions":1385,"sizeDeletions":-96}],"allReviewers":[{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}]}