{"project":"joyent/illumos-joyent","branch":"master","id":"I63be22a60afc7de097f038691b9cab2a1dd22854","number":"731","subject":"OS-5719 lx_proc fails lookup of /proc/\u003cthread\u003e OS-5720 lxbrand consolidate process locking logic Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Approved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/731","commitMessage":"OS-5719 lx_proc fails lookup of /proc/\u003cthread\u003e\nOS-5720 lxbrand consolidate process locking logic\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nApproved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\n","createdOn":1476820047,"lastUpdated":1477323168,"open":false,"status":"MERGED","comments":[{"timestamp":1476820047,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1476986616,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(3 comments)\n\nThis all looks really good. I just had a few small nits I noticed but nothing else."},{"timestamp":1476994315,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1476994325,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1476995292,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1477321668,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1477322483,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1477323168,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"4","revision":"63be22a60afc7de097f038691b9cab2a1dd22854","parents":["395f529c3ca301ad3ace214e341ade672c68db68"],"ref":"refs/changes/31/731/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1477322483,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1477323168,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/brand/lx/os/lx_misc.c","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","type":"MODIFIED","insertions":160,"deletions":-56},{"file":"usr/src/uts/common/brand/lx/os/lx_ptrace.c","type":"MODIFIED","insertions":4,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/procfs/lx_proc.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","type":"MODIFIED","insertions":139,"deletions":-80},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prvnops.c","type":"MODIFIED","insertions":104,"deletions":-309},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"usr/src/uts/common/brand/lx/syscall/lx_futex.c","type":"MODIFIED","insertions":5,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/syscall/lx_ioctl.c","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":96,"deletions":-91},{"file":"usr/src/uts/common/brand/lx/syscall/lx_sched.c","type":"MODIFIED","insertions":2,"deletions":-29}],"sizeInsertions":534,"sizeDeletions":-604},"patchSets":[{"number":"1","revision":"4a510c933c7ba7815658ab92ef980f1ba1534b39","parents":["60aeaad16a6efd44513cfc0be1edaf7b1e920964"],"ref":"refs/changes/31/731/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1476820047,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","line":146,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I know you didn\u0027t touch these lines but can you fix \u0027solaris\u0027 while you\u0027re in here?"},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","line":146,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Can do."},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","line":209,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"change \"not\" to \"no\""},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","line":209,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","line":446,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Is this comment \"parent process\" correct? It looks like in lx_pid_assign its the process, not its parent process."},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","line":446,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It\u0027s the parent in the sense that contains the LWP.  I agree that the terminology isn\u0027t great.  I\u0027ll think up something less confusing."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/brand/lx/os/lx_misc.c","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","type":"MODIFIED","insertions":158,"deletions":-54},{"file":"usr/src/uts/common/brand/lx/os/lx_ptrace.c","type":"MODIFIED","insertions":4,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/procfs/lx_proc.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","type":"MODIFIED","insertions":139,"deletions":-80},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prvnops.c","type":"MODIFIED","insertions":104,"deletions":-309},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","type":"MODIFIED","insertions":14,"deletions":-7},{"file":"usr/src/uts/common/brand/lx/syscall/lx_futex.c","type":"MODIFIED","insertions":5,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/syscall/lx_ioctl.c","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":96,"deletions":-91},{"file":"usr/src/uts/common/brand/lx/syscall/lx_sched.c","type":"MODIFIED","insertions":2,"deletions":-29}],"sizeInsertions":531,"sizeDeletions":-602},{"number":"2","revision":"1527517b3967039fd3ad9776fb3efef6443b2eca","parents":["5373bfca1478d6f817b11a8735b557503f35e7a8"],"ref":"refs/changes/31/731/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1476994325,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/brand/lx/os/lx_misc.c","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","type":"MODIFIED","insertions":160,"deletions":-56},{"file":"usr/src/uts/common/brand/lx/os/lx_ptrace.c","type":"MODIFIED","insertions":4,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/procfs/lx_proc.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","type":"MODIFIED","insertions":139,"deletions":-80},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prvnops.c","type":"MODIFIED","insertions":104,"deletions":-309},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"usr/src/uts/common/brand/lx/syscall/lx_futex.c","type":"MODIFIED","insertions":5,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/syscall/lx_ioctl.c","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":96,"deletions":-91},{"file":"usr/src/uts/common/brand/lx/syscall/lx_sched.c","type":"MODIFIED","insertions":2,"deletions":-29}],"sizeInsertions":534,"sizeDeletions":-604},{"number":"3","revision":"b945b4309bc5999b68b479fccf5f450142dac0e4","parents":["395f529c3ca301ad3ace214e341ade672c68db68"],"ref":"refs/changes/31/731/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1477321668,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/common/brand/lx/os/lx_misc.c","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","type":"MODIFIED","insertions":160,"deletions":-56},{"file":"usr/src/uts/common/brand/lx/os/lx_ptrace.c","type":"MODIFIED","insertions":4,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/procfs/lx_proc.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","type":"MODIFIED","insertions":139,"deletions":-80},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prvnops.c","type":"MODIFIED","insertions":104,"deletions":-309},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"usr/src/uts/common/brand/lx/syscall/lx_futex.c","type":"MODIFIED","insertions":5,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/syscall/lx_ioctl.c","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":96,"deletions":-91},{"file":"usr/src/uts/common/brand/lx/syscall/lx_sched.c","type":"MODIFIED","insertions":2,"deletions":-29}],"sizeInsertions":534,"sizeDeletions":-604},{"number":"4","revision":"63be22a60afc7de097f038691b9cab2a1dd22854","parents":["395f529c3ca301ad3ace214e341ade672c68db68"],"ref":"refs/changes/31/731/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1477322483,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1476995292,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1477323168,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/brand/lx/os/lx_misc.c","type":"MODIFIED","insertions":5,"deletions":-5},{"file":"usr/src/uts/common/brand/lx/os/lx_pid.c","type":"MODIFIED","insertions":160,"deletions":-56},{"file":"usr/src/uts/common/brand/lx/os/lx_ptrace.c","type":"MODIFIED","insertions":4,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/procfs/lx_proc.h","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prsubr.c","type":"MODIFIED","insertions":139,"deletions":-80},{"file":"usr/src/uts/common/brand/lx/procfs/lx_prvnops.c","type":"MODIFIED","insertions":104,"deletions":-309},{"file":"usr/src/uts/common/brand/lx/sys/lx_brand.h","type":"MODIFIED","insertions":15,"deletions":-7},{"file":"usr/src/uts/common/brand/lx/syscall/lx_futex.c","type":"MODIFIED","insertions":5,"deletions":-12},{"file":"usr/src/uts/common/brand/lx/syscall/lx_ioctl.c","type":"MODIFIED","insertions":0,"deletions":-1},{"file":"usr/src/uts/common/brand/lx/syscall/lx_kill.c","type":"MODIFIED","insertions":96,"deletions":-91},{"file":"usr/src/uts/common/brand/lx/syscall/lx_sched.c","type":"MODIFIED","insertions":2,"deletions":-29}],"sizeInsertions":534,"sizeDeletions":-604}],"allReviewers":[{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}