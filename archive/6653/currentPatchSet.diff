From d0ad717eaff81f39ecd9e8dc56a915f7694f0b6e Mon Sep 17 00:00:00 2001
From: Isaac Davis <isaac.davis@joyent.com>
Date: Thu, 25 Jul 2019 21:26:51 +0000
Subject: [PATCH] TRITON-1834 Set triton-prometheus scrape interval to 10s
 Reviewed by: Chris Burroughs <chris.burroughs@joyent.com> Approved by: Chris
 Burroughs <chris.burroughs@joyent.com>

---
 CHANGES.md               | 4 ++++
 README.md                | 4 ++--
 bin/prometheus-configure | 4 ++--
 etc/prometheus.yml.in    | 4 ++--
 package.json             | 2 +-
 5 files changed, 11 insertions(+), 7 deletions(-)

diff --git a/CHANGES.md b/CHANGES.md
index 3655edc..0c7eeb4 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -1,5 +1,9 @@
 # triton-prometheus changes
 
+## 1.0.1
+
+TRITON-1834 Set triton-prometheus scrape interval to 10s
+
 ## 1.0.0
 
 First version.
diff --git a/README.md b/README.md
index e85b98c..1b760cd 100644
--- a/README.md
+++ b/README.md
@@ -70,9 +70,9 @@ deployed using `sdcadm` or `manta-adm`.
 | ------------------------------ | ------- | ----------- |
 | **cmon\_domain**               | String  | Optional. The domain at which Prometheus should talk to this DC's CMON, e.g. "cmon.us-east-1.triton.zone". The actual endpoint is assumed to be https and port 9163. See notes below. |
 | **cmon\_enforce\_certificate** | Bool    | Optional. This can be set to `true` to have Prometheus fail on TLS cert errors from a self-signed cert. This is false by default. |
-| **scrape\_interval**           | Integer | Optional. The interval, in seconds, at which Prometheus should scrape its targets. Defaults to 60. |
+| **scrape\_interval**           | Integer | Optional. The interval, in seconds, at which Prometheus should scrape its targets. Defaults to 10. |
 | **scrape\_timeout**            | Integer | Optional. The amount of time, in seconds, that is allotted for each scrape to complete. Defaults to 10. |
-| **evaluation\_interval**       | Integer | Optional. The interval, in seconds, at which Prometheus should evaluate its alerting rules. Defaults to 60. |
+| **evaluation\_interval**       | Integer | Optional. The interval, in seconds, at which Prometheus should evaluate its alerting rules. Defaults to 10. |
 
 Prometheus gets its metrics from the DC's local CMON, typically over the
 external network. To auth with CMON properly in a production environment,
diff --git a/bin/prometheus-configure b/bin/prometheus-configure
index efaf297..7acd11b 100755
--- a/bin/prometheus-configure
+++ b/bin/prometheus-configure
@@ -69,9 +69,9 @@ CMON_CERT_FILE=${CMON_AUTH_DIR}/prometheus.cert.pem
 #
 # Default intervals, in seconds
 #
-DEFAULT_SCRAPE_INTERVAL=60
+DEFAULT_SCRAPE_INTERVAL=10
 DEFAULT_SCRAPE_TIMEOUT=10
-DEFAULT_EVALUATION_INTERVAL=60
+DEFAULT_EVALUATION_INTERVAL=10
 
 #
 # A space-separated list of names of things updated. This is used to determine
diff --git a/etc/prometheus.yml.in b/etc/prometheus.yml.in
index 719aa47..82f270f 100644
--- a/etc/prometheus.yml.in
+++ b/etc/prometheus.yml.in
@@ -3,9 +3,9 @@ global:
   # These three numeric values can be set as SAPI config variables. If these
   # variables are not set, the defaults used by the instance's setup scripts
   # are:
-  # - scrape_interval: 60s
+  # - scrape_interval: 10s
   # - scrape_timeout: 10s
-  # - evaluation_interval: 60s
+  # - evaluation_interval: 10s
   #
   # These variables may be set manually or by `sdcadm` or `manta-adm`, which may
   # specify their own application- and size-specific defaults.
diff --git a/package.json b/package.json
index 855921d..c7f09f1 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
     "name": "triton-prometheus",
     "description": "Prometheus for TritonDC",
-    "version": "1.0.0",
+    "version": "1.0.1",
     "author": "Joyent (joyent.com)",
     "private": true,
     "repository": {
-- 
2.21.0

