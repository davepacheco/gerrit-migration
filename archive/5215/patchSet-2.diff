From 52403dea11f4316cca1a167aa7b74048b0dbd3b0 Mon Sep 17 00:00:00 2001
From: "carol.cobine" <carol.cobine@joyent.com>
Date: Thu, 3 Jan 2019 11:24:24 -0500
Subject: [PATCH] DOC-777 Setting up Coal in my Machine

---
 docs/developer-guide/coal-setup.md | 172 +++++++++++++++--------------
 1 file changed, 88 insertions(+), 84 deletions(-)

diff --git a/docs/developer-guide/coal-setup.md b/docs/developer-guide/coal-setup.md
index 2355b15..b57b5ff 100644
--- a/docs/developer-guide/coal-setup.md
+++ b/docs/developer-guide/coal-setup.md
@@ -8,125 +8,129 @@
     Copyright (c) 2015, Joyent, Inc.
 -->
 
-# Set Up CoaL
+# Cloud on a Laptop (CoaL)
+CoaL is a VMware virtual appliance that provides a full Triton head node for development and testing. Because most Joyent developers work on a Mac, this document walks you through the process of setting up CoaL on a Mac. 
 
-CoaL stands for "Cloud on a Laptop". It is a VMware virtual appliance
-for a SmartDataCenter headnode. It's useful for developing and testing
-SmartDataCenter (SDC). This document walks through setting up CoaL.
+**Note**: Some developers in the community have successfully set up CoaL in Windows and Linux using these instructions only as general guidelines and modifying them as needed.  
 
-**WARNING: these steps and command options are not appropriate for
-production deployments.**
+**WARNING**: these steps and command options are not appropriate for
+production deployments.
 
-The minimum requirements, practically speaking, for a good CoaL
-experience is a **Mac with at least 16 GB RAM and an SSD with at least
-45 GB disk available**. Currently, almost all team members using CoaL
-are on Macs with VMware Fusion. Vmware Workstation for Linux is used by
-a few in the community. VMware Workstation for Windows should work, but
-has not recently been tested.
+## Minimum Requirements
+The minimum requirements for a good CoaL experience are a Mac with at least 16 GB RAM and an SSD with at least 45 GB disk available.
 
-At a high level, setting up CoaL involves:
+## Overview 
+The high-level steps for setting up CoaL includes:
 
-1. Downloading the latest build.
-1. Booting the VMware appliance (virtual machine).
-2. Configuring SmartDataCenter.
-3. Waiting for the SDC services to automatically install and setup in
-   the SDC headnode virtual machine. This can take from 10 to 20 minutes
-   on a Mac laptop.
-4. Test and develop.
+1. Downloading the latest CoaL build.
+2. Downloading, installing, and configuring VMware.
+3. Extracting, loading, and configuring CoaL
+4. Booting the VMware appliance (virtual machine).
+5. Configuring SmartDataCenter.
+6. Waiting for the SDC services to automatically install and setup in the SDC headnode virtual machine. This can take from 10 to 20 minutes.
+7. Testing and developing.
 
+## Downloading CoaL
 
-## Run CoaL on VMware
+The CoaL tarball is approximately 2 GB and will take some time to complete.
 
-### Download CoaL and Configure VMware
-
-1. Start the download of the latest CoaL build. The tarball is
-   approximately 2 GB.
+Start the download of the latest CoaL build by running:
 
     curl -C - -O https://us-east.manta.joyent.com/Joyent_Dev/public/SmartDataCenter/coal-latest.tgz
+	
+While you wait for the tarball download to complete, you can configure and install VMWare.
 
-2. Install VMware, if you haven't already.
-    - Mac: [VMware Fusion](http://www.vmware.com/products/fusion) 5, 7, or 8.
-    - Windows or Linux: [VMware Workstation](http://www.vmware.com/products/workstation).
+## Downloading installing, and configuring VMware
 
-3. Configure VMware virtual networks for CoaL's "external" and "admin"
-   networks. This is a one time configuration for a VMware installation.
+Most Joyent team members run CoaL from VMware Fusion. You can download it from the [VMware Fusion](http://www.vmware.com/products/fusion) product site.
 
-    1. Launch VMware at least once after installing VMware.
+1. Download [VMware Fusion](http://www.vmware.com/products/fusion). We recommend VMware version 8.5.3., but users have had success with v5 and v8.
 
-    2. Run the OS specific CoaL set up script for VMware:
+**Note**: You can download VMware Workstation for Windows or Linux from [VMware Workstation](http://www.vmware.com/products/workstation.
+	
+2. Install VMWare.
 
-         - Mac:
+Once you have installed VMware, launch the application to confirm that the application is correctly installed, and then close it.  
 
-            ```bash
-            curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-mac-vmware-setup | sudo bash
-            ```
+3. Launch VMWare, and then close the application. 
 
-         - Linux:
+Now, you are ready to run the CoaL set up script to configure the VMware virtual networks for CoaL's external and admin networks. 
 
-            ```bash
-            curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-linux-vmware-setup | sudo bash
-            ```
+3. To configure the CoaL virtual networks on a Mac, run:
 
-         - Windows:
+   ```bash
+   curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-mac-vmware-setup | sudo bash
+   ```
+**Note**: The set up scripts for Linux and Windows are as follows:
+	- Linux:
+		```bash
+		curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-linux-vmware-setup | sudo bash
+		```
 
-            ```
-            Download https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-windows-vmware-setup.bat
-            Run coal-windows-vmware-setup.bat
-            ```
+	- Windows:
+		```
+		Download https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-windows-vmware-setup.bat
+		Run coal-windows-vmware-setup.bat
+		```
+## Extracting, loading, and configuring CoaL
 
-1. Extract the CoaL virtual machine:
+1. To unroll the tarball and extract the CoaL virtual machine, run:
 
-    - Mac example:
+    ```bash
+       $ tar -zxvf coal-latest.tgz -C ~/Documents/Virtual\ Machines.localized
+       x root.password.20140911t161518z
+       x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/
+       x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmx
+       x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/zpool.vmdk
+       x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmdk
+       x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/4gb.img
+       ...
+    ```
 
-        ```bash
-        $ tar -zxvf coal-latest.tgz -C ~/Documents/Virtual\ Machines.localized
-        x root.password.20140911t161518z
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmx
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/zpool.vmdk
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmdk
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/4gb.img
-        ...
-        ```
+2. To load the CoaL appliance:
+ - Launch VMware Fusion.
+ - Select File and then click Open. 
+ - Navigate to and select the `.vmwarevm` file that contains the CoaL build. 
+ 
+ If you are working from the commandline instead of the VMWare GUI, run:
+```
+ open coal-<branch>-<build_date_time>-<git_sha1_hash>-4gb.vmwarevm
+``
+3. To configure memory and run:
+ - Select **Virtual Machine** and then click **Settings**. The **USB-headnode Settings** dialog displays.
+ - Click **Processes & Memory**.
+ - In the **Memory** section, note that the default memory is set to 8192 MB. You can change this setting, but *be sure to leave Mac OS X with at least 8 GB*.
 
-1. Set memory and run.
+**WARNING**: Allocating less than 6 GB may cause problems. If you allocate as low as 4 GB, you will certainly encounter problems. If the CoaL VM hits a memory limit, it will page rapidly and operations will contend for resources. In this situation, the VM will attempt to perform massive amounts of disk I/O to keep up with the system's demands and will slow down, eventually failing to meet them. 
 
-    - Mac example:
+**Note**: If you are not using the VMWare GUI, you can change the default memory in the CoaL `USB-headnode.vmx` file.  You can set memsize = "6144" according to your preference. 
 
-        1. Launch VMware Fusion
-        2. File > Open... `coal-<branch>-<build_date_time>-<git_sha1_hash>-4gb.vmwarevm`
-        3. Virtual Machine > Settings
-        4. Processes & Memory > Default memory is set to 8192 MB, but be sure
-	   to leave Mac OS X with at least 8 GB.  If you prefer not to use the
-	   VMWare GUI, the place to change this default is in the CoaL
-	   `USB-headnode.vmx` file, where you can set `memsize = "6144"`, for
-	   example.
-	   WARNING: If you choose to allocate less than 6 GB this may cause
-	   problems, and if you go as low as 4 GB it certainly will. As the
-	   CoaL VM hits its memory limit, it will page rapidly and operations
-	   will contend for resources.  In this situation, the VM will attempt
-	   to perform massive amounts of disk I/O to keep up with the system's
-	   demands, and will slow down and eventually fail to meet them.
+### Booting the head node.
 
-1. When you are prompted with the GRUB menu press the down arrow.
+When the GRUB menu loads, we need the command line to specify the console device first, and then we boot the head node when we select Live 64-bit. Is this correct?
 
-  1. Press the down arrow key to highlight "Live 64-bit".
+1. Boot the head node. The GRUB boot loader menu displays. 
 
-  2. Press 'c' to go to the command line for GRUB.
+GRUB intervenes in the boot process, enabling you to choose what environment to load.  When the GRUB menu appears, use the arrow keys to select the menu options. The last step directs you to press **c** to load the GRUB command line. Be prepared to press **c** quickly and immediately.
 
      ![CoaL Grub Boot Menu](../img/coal-grub-menu.png)
 
-     By default, the OS will redirect the console to ttyb which is fine
-     for production but needs to be changed for CoaL. At the command line enter
-     "variable os_console vga":
+2. When you are prompted with the GRUB menu:
+ - Press the down arrow key to highlight **Live 64-bit**.
+ - Press **c** quickly to load the GRUB command line. If you are too slow, the **Live 64-bit** option loads instead of the command line. We need the command line first to specify the console type. 
+ - If needed, press **Esc** to redirect the console back to the GRUB menu and try again.
 
-        ```
-        grub> variable os_console vga
-        ```
+By default, the OS directs the console to use ttyb. This value is fine for production, but we will use **vga**.
 
-  1. Press enter.
+3. At the command prompt, type `variable os_console vga`, and press **Enter**.
+```
+<grub> variable os_console vga
+```
+4. Press **Esc** to return to the GRUB menu.
+5. Press **Enter** to boot **Live 64-bit**. 
 
-  1. Press esc to get back to the GRUB menu.
+If you see a blank screen with a cursor at the top left while booting, you may have forgotten to redirect the console. If so, press Esc to return to the GRUB menu.
+5. Press Enter to boot Live 64-bit.
 
   1. Boot "Live 64-bit" by pressing enter.
 
-- 
2.21.0

