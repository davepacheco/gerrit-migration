commit 07a571ae43f4cb75ac3f08169414d12a6a56c2e6 (refs/changes/15/5215/4)
Author: carol.cobine <carol.cobine@joyent.com>
Date:   2019-01-03T17:47:55-05:00 (9 months ago)
    
    DOC-777 Setting up Coal in my Machine

diff --git a/docs/developer-guide/coal-setup.md b/docs/developer-guide/coal-setup.md
index 2355b15..65766a1 100644
--- a/docs/developer-guide/coal-setup.md
+++ b/docs/developer-guide/coal-setup.md
@@ -8,222 +8,204 @@
     Copyright (c) 2015, Joyent, Inc.
 -->
 
-# Set Up CoaL
+# Cloud on a Laptop (CoaL)
 
-CoaL stands for "Cloud on a Laptop". It is a VMware virtual appliance
-for a SmartDataCenter headnode. It's useful for developing and testing
-SmartDataCenter (SDC). This document walks through setting up CoaL.
+CoaL is a VMware virtual appliance that provides a full Triton head node for development and testing. Because most Joyent developers work on a Mac, this document walks you through the process of setting up CoaL on a Mac. We recommend that you read this document carefully before you install CoaL.
 
-**WARNING: these steps and command options are not appropriate for
-production deployments.**
+**Note**: Some developers in the community have successfully set up CoaL in Windows and Linux using these instructions only as general guidelines and modifying them as needed.
 
-The minimum requirements, practically speaking, for a good CoaL
-experience is a **Mac with at least 16 GB RAM and an SSD with at least
-45 GB disk available**. Currently, almost all team members using CoaL
-are on Macs with VMware Fusion. Vmware Workstation for Linux is used by
-a few in the community. VMware Workstation for Windows should work, but
-has not recently been tested.
+**WARNING**: these steps and command options are not appropriate for
+production deployments.
 
-At a high level, setting up CoaL involves:
+## Minimum Requirements
 
-1. Downloading the latest build.
-1. Booting the VMware appliance (virtual machine).
-2. Configuring SmartDataCenter.
-3. Waiting for the SDC services to automatically install and setup in
-   the SDC headnode virtual machine. This can take from 10 to 20 minutes
-   on a Mac laptop.
-4. Test and develop.
+The minimum requirements for a good CoaL experience are a Mac with at least 16 GB RAM and an SSD with at least 45 GB disk available.
 
+## Overview
 
-## Run CoaL on VMware
+The high-level steps for setting up CoaL includes:
 
-### Download CoaL and Configure VMware
+1. Downloading the latest CoaL build.
+2. Downloading, installing, and configuring VMware.
+3. Extracting, loading, and configuring CoaL.
+4. Booting the VMware appliance (virtual machine).
+5. Configuring SmartDataCenter.
+6. Waiting for the SDC services to automatically install and setup in the SDC headnode virtual machine. This can take from 10 to 20 minutes.
+7. Testing and developing.
 
-1. Start the download of the latest CoaL build. The tarball is
-   approximately 2 GB.
+## Downloading CoaL
 
-    curl -C - -O https://us-east.manta.joyent.com/Joyent_Dev/public/SmartDataCenter/coal-latest.tgz
+The CoaL tarball is approximately 2 GB and will take some time to complete.
 
-2. Install VMware, if you haven't already.
-    - Mac: [VMware Fusion](http://www.vmware.com/products/fusion) 5, 7, or 8.
-    - Windows or Linux: [VMware Workstation](http://www.vmware.com/products/workstation).
+Start the download of the latest CoaL build by running:
 
-3. Configure VMware virtual networks for CoaL's "external" and "admin"
-   networks. This is a one time configuration for a VMware installation.
+	```
+	curl -C - -O https://us-east.manta.joyent.com/Joyent_Dev/public/SmartDataCenter/release-20180927-20180927T130527Z/headnode/coal-release-20180927-20180927T130527Z-g34dbd8a-4gb.tgz
+	```
 
-    1. Launch VMware at least once after installing VMware.
+While you wait for the tarball download to complete, you can configure and install VMWare.
 
-    2. Run the OS specific CoaL set up script for VMware:
+## Downloading installing, and configuring VMware
 
-         - Mac:
+Most Joyent team members run CoaL from VMware Fusion. You can download it from the [VMware Fusion](http://www.vmware.com/products/fusion) product site.
 
-            ```bash
-            curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-mac-vmware-setup | sudo bash
-            ```
+1. Download [VMware Fusion](http://www.vmware.com/products/fusion). We recommend VMware version 8.5.3., but users have had success with v5 and v8.
 
-         - Linux:
+**Note**: You can download VMware Workstation for Windows or Linux from [VMware Workstation](http://www.vmware.com/products/workstation.
 
-            ```bash
-            curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-linux-vmware-setup | sudo bash
-            ```
+2. Install VMWare. When complete, launch the application to confirm that the application is correctly installed, and then close it.
 
-         - Windows:
+Now, you are ready to configure the VMware virtual networks. To do this, you run a one-time script to configure CoaL's external and admin networks.
 
-            ```
-            Download https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-windows-vmware-setup.bat
-            Run coal-windows-vmware-setup.bat
-            ```
+3. To configure the CoaL virtual networks, on a Mac, run:
 
-1. Extract the CoaL virtual machine:
+	```bash
+	curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-mac-vmware-setup | sudo bash
+	```
+	
+	**Note**: To download set up scripts for Linux and Windows:
+	
+    - On Linux, run:
+	```bash
+	curl -s https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-linux-vmware-setup | sudo bash
+	```
+    - For Windows, download https://raw.githubusercontent.com/joyent/sdc/master/tools/coal-windows-vmware-setup.bat, then run `coal-windows-vmware-setup.bat`.
+	
+## Extracting, loading, and configuring CoaL
 
-    - Mac example:
+1. To unroll the tarball and extract the CoaL virtual machine, run:
 
-        ```bash
-        $ tar -zxvf coal-latest.tgz -C ~/Documents/Virtual\ Machines.localized
-        x root.password.20140911t161518z
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmx
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/zpool.vmdk
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmdk
-        x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/4gb.img
-        ...
-        ```
+	```bash
+	$ tar -zxvf coal-latest.tgz -C ~/Documents/Virtual\ Machines.localized
+	x root.password.20140911t161518z
+	x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/
+	x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmx
+	x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/zpool.vmdk
+	x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/USB-headnode.vmdk
+	x coal-master-20140911T194415Z-g1a445f5-4gb.vmwarevm/4gb.img
+	...
+	```
 
-1. Set memory and run.
+2. To load the CoaL appliance:
+    1. Launch VMware Fusion.
+    2. Select **File** and then click **Open**.
+    3. Navigate to and select the `.vmwarevm` file that contains the CoaL build.
 
-    - Mac example:
+**Note**: If you are working from the command line instead of the VMWare GUI, run:
+	```
+	open coal-<branch>-<build_date_time>-<git_sha1_hash>-4gb.vmwarevm
+	```
+	
+3. To configure memory and run:
+    1. Select **Virtual Machine** and then click **Settings**. The **USB-headnode Settings** dialog displays.
+    2. Click **Processes & Memory**.
+    3. In the **Memory** section, note that the default memory is set to 8192 MB. You can change this setting, but *be sure to leave Mac OS X with at least 8 GB to avoid resource allocation problems*.
 
-        1. Launch VMware Fusion
-        2. File > Open... `coal-<branch>-<build_date_time>-<git_sha1_hash>-4gb.vmwarevm`
-        3. Virtual Machine > Settings
-        4. Processes & Memory > Default memory is set to 8192 MB, but be sure
-	   to leave Mac OS X with at least 8 GB.  If you prefer not to use the
-	   VMWare GUI, the place to change this default is in the CoaL
-	   `USB-headnode.vmx` file, where you can set `memsize = "6144"`, for
-	   example.
-	   WARNING: If you choose to allocate less than 6 GB this may cause
-	   problems, and if you go as low as 4 GB it certainly will. As the
-	   CoaL VM hits its memory limit, it will page rapidly and operations
-	   will contend for resources.  In this situation, the VM will attempt
-	   to perform massive amounts of disk I/O to keep up with the system's
-	   demands, and will slow down and eventually fail to meet them.
+**Note**: If you are not using the VMWare GUI, you can change the default memory in the CoaL `USB-headnode.vmx` file.  You can set memsize = "6144" according to your preference.
 
-1. When you are prompted with the GRUB menu press the down arrow.
+The GRUB boot loader menu displays.
 
-  1. Press the down arrow key to highlight "Live 64-bit".
+### Booting the head node
 
-  2. Press 'c' to go to the command line for GRUB.
+GRUB intervenes in the boot process, enabling you to specify the environment to load. By default, the OS directs the console device to use ttyb. This value is fine for production but not for our use. 
 
-     ![CoaL Grub Boot Menu](../img/coal-grub-menu.png)
+In this section, we first bring up the command line to specify the **vga** console, and then we select **Live 64-bit** to boot the head node.
 
-     By default, the OS will redirect the console to ttyb which is fine
-     for production but needs to be changed for CoaL. At the command line enter
-     "variable os_console vga":
+**GRUB menu navigation tips**
 
-        ```
-        grub> variable os_console vga
-        ```
+When the GRUB menu displays, use the arrow keys to select the menu options. The last step directs you to press **c** to load the GRUB command line. Be prepared to press **c** quickly and immediately. If you are too slow, the **Live 64-bit** option loads instead of the command line. If needed, press **Esc** to redirect the console back to the GRUB menu and try again.
 
-  1. Press enter.
+	![CoaL Grub Boot Menu](../img/coal-grub-menu.png)
 
-  1. Press esc to get back to the GRUB menu.
+#### Specifying the console device
 
-  1. Boot "Live 64-bit" by pressing enter.
+When you are prompted with the GRUB menu:
 
-     If while booting it stays just showing a cursor then you might have
-     forgotten to redirect the console, see instructions above.
+1. Press the down arrow key to highlight **Live 64-bit**.
+2. Quickly press **c** to load the GRUB command line. If you miss this step, press **Esc** to redirect the console back to the GRUB menu and try again.
+3. At the **GRUB command prompt**, type `variable os_console vga`, and press **Enter**.
+4. Press **Esc** to return to the GRUB menu.
+5. Press **Enter** to boot **Live 64-bit**.
+
+**Note**: If you see a blank screen with a cursor at the top left while the head node is booting, you may have forgotten to redirect the console. If so, press Esc to return to the GRUB menu.
 
      ![kvm warning on boot](../img/coal-only-cursor.png)
 
-     On boot, being in a virtual environment without Intel VT-x support
-     enabled, you'll receive cpu and kvm warnings:
+Also note that because you are in a virtual environment without Intel VT-x support enabled, you'll receive cpu and kvm warnings. You can safely ignore them:
 
      ![kvm warning on boot](../img/coal-boot-warnings.png)
 
+### Configuring the head node
 
-### Configure the Headnode
-
-Use the following table to configure your CoaL with settings that are
-fine for development. The table is followed by screenshots.
+Use the following table to configure the development settings for CoaL. In many cases, you will choose the default values. In others, you must type the literal value provided. Variables are in *italics*. You can set any value for variables.
 
-If you make a mistake while entering the configuration you can restart
-the VMware virtual machine. Also, as the onscreen instructions describe,
-the last step in configuration allows editing the resulting
-configuration file.
+The final prompt asks that you verify the configuration settings. If you have made a mistake, you can reject the settings and restart the configuration process.
 
 |Setting|Value|Notes|
 |---|---|---|
 |*Instructions*|↵||
-|Company Name|Clavius||
-|Region of Datacenter|orbit||
-|Name of Datacenter|coal-1|(Availability zone.) |
-|Location of DataCenter|Moon, Earth||
-|*Instructions*|↵||
-|'admin' interface|2|The second NIC is set up as the admin network by the CoaL networking script|
-|(admin) headnode IP address|10.99.99.7|Must use this value.|
-|(admin) headnode netmask:|↵|Use the default.|
-|(admin) Zone's starting IP address:|↵|Use the default.|
-|Add external network now? (Y/n)|↵|Must use this value.|
-|'external' interface|1|The first NIC is set up as the external network by the CoaL networking script|
-|(external) headnode IP address|10.88.88.200|Must use this value.|
-|(external) headnode netmask:|↵|Use the default.|
-|(external) gateway IP address:|10.88.88.2|Must use this value.|
-|(external) network VLAN ID|↵|Use default. The external network is not on a VLAN in CoaL|
-|Starting Provisionable IP address for external Network|↵|Use the default.|
-|Ending Provisionable IP address for external Network|↵|Use the default.|
-|Default gateway IP address:|↵|Use the default.|
-|Primary DNS Server|↵|Use the default.|
-|Secondary DNS Server|↵|Use the default.|
-|Head node domain name|example.com||
-|DNS Search Domain|example.com||
-|NTP Server IP Address|↵|Use the default.|
-|"root" password|rootpass||
-|Confirm "root" password|||
-|"admin" password|adminpass1||
+|Company Name|*Clavius*|You can give the company name any value.|
+|Data center region|*orbit*||
+|Data center name|*coal-1*|Also known as the availability zone (AZ).|
+|Data center location|*Moon*, *Earth*||
+|admin interface|**2**|Type **2**. The second NIC is set up as the admin network by the CoaL networking script|
+|(admin) headnode IP address|**10.99.99.7**|Type **10.99.99.7** to specify the IP address.|
+|(admin) headnode netmask:|↵|Press **Enter** to select the default.|
+|(admin) Zone's starting IP address:|↵|Press **Enter** to select the default.|
+|Add external network now? (Y/n)|↵|Type **Y** to add the external network, or press **Enter** to select the default.|
+|'external' interface|1|Type **1**. The first NIC is set up as the external network by the CoaL networking script|
+|(external) headnode IP address|10.88.88.200|Type **10.88.88.200** to specify the IP address.|
+|(external) headnode netmask:|↵|Press **Enter** to select the default.|
+|(external) gateway IP address:|10.88.88.2|Type **10.88.88.2** to specify the gateway IP address.|
+|(external) network VLAN ID|↵|Press **Enter** to select the default. The external network is not on a VLAN in CoaL|
+|Starting Provisionable IP address for external Network|↵|Press **Enter** to select the default.|
+|Ending Provisionable IP address for external Network|↵|Press **Enter** to select the default.|
+|Default gateway IP address:|↵|Press **Enter** to select the default.|
+|Primary DNS Server|↵|Press **Enter** to select the default.|
+|Secondary DNS Server|↵|Press **Enter** to select the default.|
+|Head node domain name|*example.com*|The domain name should be unique. You can ping the domain to verify if its a valid website. If it already exists, select a different domain name.|
+|DNS Search Domain|*example.com*|The search domain should be a unique,  non-reachable web domain name that doesn’t exist.You can ping the domain to verify if its a valid website. If it already exists, select a different domain name|
+|NTP Server IP Address|↵|Press **Enter** to select the default.|
+|Set root password|rootpass|Type **rootpass** to set the root password.|
+|Confirm root password|||
+|Set admin password|adminpass1|Type **adminpass1** to set the admin password.|
 |Confirm "admin" password|||
-|Administrator's email|↵|Use the default.|
-|Support email|↵|Use the default.|
-|Enable telemetry|↵|Defaults to false.|
-|Verify Configuration||Review the configuration before proceeding.|
-|Verify Configuration Again|||
+|Administrator email|↵|Press **Enter** to select the default.|
+|Support email|↵|Press **Enter** to select the default.|
+|Enable telemetry|↵|Press **Enter** to select the default, false.|
+|Verify configuration settings||Review the configuration before proceeding. If the configuration is not correct, type **n** to reject the settings and restart the process.|
+|Confirm configuration||If you verified the configuration settings, you are prompted to confirm them.|
 
-Verify configuration:
+The Verify Configuration prompt looks something like:
 
 ![Configuration displayed on console for verification.](../img/coal-verify-configuration.png)
 
-
 ## Installation
 
-CoaL will now install based on the configuration parameters entered
-above. Installation has been observed to take up to 20 minutes,
-particularly if installing on a laptop hard disk drive. It is not
-complete **until you see "Setup complete"**.
-
-On a Mac, you will be prompted to enter your admin password, so that the
-VM can monitor all network traffic. You may receive this popup a few
-times:
+CoaL will now install the Triton head node based on your configuration parameters. The installation can take up to 20 minutes, particularly on a laptop hard disk drive. Installation isn’t complete until the Setup complete message displays.
+On a Mac, you will be prompted to enter your admin password several times to enable the VM to monitor all network traffic:
 
 ![Mac system dialog confirming VM can monitor all network traffic.](../img/coal-mac-vm-monitor-all-network-traffic.png)
 
-The next phase of installation completes with notification of a reboot:
+A reboot notification displays when the next phase of installation completes:
 
 ![Reboot message shown on console.](../img/coal-will-reboot.png)
 
-The final phase of installation, setup, is the longest and does not show
-the progress at the beginning of it. You may see either just a cursor on
-the login page or a login prompt:
+The final phase of installation, setup, is the longest but does not display the progress. You may see either just a cursor on the login page or a login prompt.
+
+Note that message on the console welcomes you to SD7. SD7 is an older name for Triton:
 
 !["Welcome to SDC7!" message on console.](../img/coal-welcome-sdc7.png)
 
-or
+You might also see:
 
 ![Login prompt on console.](../img/coal-headnode-login-prompt.png)
 
-After sometime you will see "preparing for setup":
+After some time, a **preparing for setup** message displays:
 
 !["preparing for setup..." on console.](../img/coal-preparing-for-setup.png)
 
-Finally, you'll see "Setup complete":
+When the installation completes, **completing setup** displays.
 
 !["Setup complete on console."](../img/coal-setup-complete.png)
 
