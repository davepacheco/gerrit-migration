{"project":"joyent/sdc-vmapi","branch":"master","id":"I01b2db0fc9ae6119455a322745e062bc7ae3f08e","number":"6228","subject":"TRITON-1641 VMAPI should properly support \"remaining\" disk size for bhyve VMs Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/6228","commitMessage":"TRITON-1641 VMAPI should properly support \"remaining\" disk size for bhyve VMs\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1557514045,"lastUpdated":1557935809,"open":false,"status":"MERGED","comments":[{"timestamp":1557514045,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1557514049,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit ec8f50a5fd7b11b988f02893308fea5304589957\n    \n    TRITON-1641 VMAPI should properly support remaining disk size for bhyve VMs"},{"timestamp":1557514080,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(2 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1557514175,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1557514180,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit b629de0a7bfea58e14177efdc788fa483167d62b\n    \n    Fix make check"},{"timestamp":1557514209,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1557514293,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nApart of properly supporting \"remaining\" as a disk.size value, I\u0027ve also fixed the fact that we were allowing zero or negative values for disk size. These things should work both for new machine creation and new disk addition to an existing VM. Tests results added to the JIRA issue."},{"timestamp":1557518216,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\n(14 comments)"},{"timestamp":1557761561,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1557761566,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 9a29178a2b68e01a63db5c4616c734e5ed1d787d\n    \n    Applied Mike\u0027s suggestions"},{"timestamp":1557761596,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1557761626,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1557761631,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit befe571b0aded31bd80ad1c17d870ef34e868557\n    \n    Applied Mike\u0027s suggestions\n    \n    commit 62004e4b598e12634f4cbf640a963ecf00a801ba\n    \n    Fix make check\n    \n    commit 6720fe800c9908fed796338fe81db7850678f140\n    \n    TRITON-1641 VMAPI should properly support remaining disk size for bhyve VMs"},{"timestamp":1557761646,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\n(12 comments)\n\nDone with suggested changes, Mike"},{"timestamp":1557761664,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1557763598,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1557933913,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1557935667,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1557935702,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"},{"timestamp":1557935799,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1557935809,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"6","revision":"b507968cbbe5fb87cb2d305b77e6d9ea5ba8d48c","parents":["ba16cd5582003c3d1ad962957b808038fa3e41da"],"ref":"refs/changes/28/6228/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557935799,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557761596,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1557763598,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1557933913,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1557935809,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":103,"deletions":-72},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":248,"sizeDeletions":-83},"patchSets":[{"number":"1","revision":"bca1bc28af6c3bd732be613a91ae5be022a22a5d","parents":["1adcbdc137e0ad0f8b0e6a7c4d35fdcae83e5778"],"ref":"refs/changes/28/6228/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557514045,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1557514080,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/common/validation.js","line":44,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"missing blank before close comment"},{"file":"lib/common/validation.js","line":2354,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"missing blank before close comment"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":25,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":104,"deletions":-59},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":250,"sizeDeletions":-70},{"number":"2","revision":"c9c46b341281fcd307e51da8d445f4f1949f0bea","parents":["1adcbdc137e0ad0f8b0e6a7c4d35fdcae83e5778"],"ref":"refs/changes/28/6228/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557514175,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557514209,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/common/validation.js","line":2235,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete empty line"},{"file":"lib/common/validation.js","line":2235,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":186,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":186,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":524,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":524,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":554,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":554,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":600,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":600,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":613,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":613,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":643,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on line line"},{"file":"lib/endpoints/vms.js","line":643,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":676,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":676,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":683,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":683,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":893,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"indented too far"},{"file":"lib/endpoints/vms.js","line":893,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":1187,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on one line"},{"file":"lib/endpoints/vms.js","line":1187,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":2156,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"No need to split this string across lines"},{"file":"lib/endpoints/vms.js","line":2156,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/endpoints/vms.js","line":2479,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"\"error));\" will fit on previous line."},{"file":"lib/endpoints/vms.js","line":2512,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fit on previous line"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":25,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":104,"deletions":-59},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":250,"sizeDeletions":-70},{"number":"3","revision":"164389e8ff5c241d35dce1d098a3f4d731b13729","parents":["1adcbdc137e0ad0f8b0e6a7c4d35fdcae83e5778"],"ref":"refs/changes/28/6228/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557761561,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557761596,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":103,"deletions":-72},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":248,"sizeDeletions":-83},{"number":"4","revision":"01b2db0fc9ae6119455a322745e062bc7ae3f08e","parents":["64192456fa44660a92661766410d3ff4ed0d5480"],"ref":"refs/changes/28/6228/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557761626,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557761596,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1557933913,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1557763598,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":103,"deletions":-72},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":248,"sizeDeletions":-83},{"number":"5","revision":"e5192ada98c39711dca4706c538911fee35b2c90","parents":["ba16cd5582003c3d1ad962957b808038fa3e41da"],"ref":"refs/changes/28/6228/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557935667,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557761596,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1557933913,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1557763598,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":103,"deletions":-72},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":248,"sizeDeletions":-83},{"number":"6","revision":"b507968cbbe5fb87cb2d305b77e6d9ea5ba8d48c","parents":["ba16cd5582003c3d1ad962957b808038fa3e41da"],"ref":"refs/changes/28/6228/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1557935799,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1557761596,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1557935809,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1557933913,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1557763598,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":24,"deletions":-5},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":103,"deletions":-72},{"file":"test/vms.disks.test.js","type":"MODIFIED","insertions":121,"deletions":-6}],"sizeInsertions":248,"sizeDeletions":-83}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}