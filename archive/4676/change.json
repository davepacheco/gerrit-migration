{"project":"joyent/sdc-cnapi","branch":"master","id":"I432d9da525c292ecb3e2a3954ab3e9bdc8ad177a","number":"4676","subject":"TRITON-557 improve CNAPI handling for heartbeats and server status Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/4676","commitMessage":"TRITON-557 improve CNAPI handling for heartbeats and server status\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1534223538,"lastUpdated":1534287237,"open":false,"status":"MERGED","comments":[{"timestamp":1534223538,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1534223540,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 7de7ecc4445c049b2cab8065baf0d2ce1cc76f75\n    \n    fix bug where sysinfo updater ruins status\n    \n    commit 347a1b1e24dc8a449a94fecbd849d2993aff0dea\n    \n    matches https://cr.joyent.us/#/c/4449/"},{"timestamp":1534223569,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1534223659,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2."},{"timestamp":1534223661,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit cfb94e6b51df145e1afae33575e2efa42203b131\n    \n    undo the parts that changed them, for Gerrit"},{"timestamp":1534223689,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1534223785,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 3."},{"timestamp":1534223786,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 0667b705b6566f5349894723a25ef71963fffacb\n    \n    separate out the fix"},{"timestamp":1534223814,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1534286326,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1534287208,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1534287237,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"4","revision":"432d9da525c292ecb3e2a3954ab3e9bdc8ad177a","parents":["34717f5ad774df02af06db103230ec5cbaccc019"],"ref":"refs/changes/76/4676/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1534287208,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534223569,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1534287237,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/cnapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-18},{"file":"docs/static.md","type":"MODIFIED","insertions":91,"deletions":-17},{"file":"lib/app.js","type":"MODIFIED","insertions":56,"deletions":-54},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/endpoints/allocations.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":27,"deletions":-3},{"file":"lib/heartbeat_reconciler.js","type":"ADDED","insertions":416,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":81,"deletions":-385},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":776,"sizeDeletions":-484},"patchSets":[{"number":"1","revision":"cefb15cb9e3f797d266e588d6c1bfc62bf0902ba","parents":["34717f5ad774df02af06db103230ec5cbaccc019"],"ref":"refs/changes/76/4676/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1534223538,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534223569,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/cnapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-18},{"file":"docs/static.md","type":"MODIFIED","insertions":91,"deletions":-17},{"file":"lib/app.js","type":"MODIFIED","insertions":56,"deletions":-54},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/endpoints/allocations.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":27,"deletions":-3},{"file":"lib/heartbeat_reconciler.js","type":"ADDED","insertions":416,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":81,"deletions":-385},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":776,"sizeDeletions":-484},{"number":"2","revision":"b24c76402463136dfe7267826c192e5df5a9ac4c","parents":["34717f5ad774df02af06db103230ec5cbaccc019"],"ref":"refs/changes/76/4676/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1534223659,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534223689,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/cnapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-18},{"file":"docs/static.md","type":"MODIFIED","insertions":91,"deletions":-17},{"file":"lib/app.js","type":"MODIFIED","insertions":51,"deletions":-54},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/endpoints/allocations.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":27,"deletions":-3},{"file":"lib/heartbeat_reconciler.js","type":"ADDED","insertions":416,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":81,"deletions":-385},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":771,"sizeDeletions":-484},{"number":"3","revision":"95e661d974edf58470626f786f3132b9e426def2","parents":["34717f5ad774df02af06db103230ec5cbaccc019"],"ref":"refs/changes/76/4676/3","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1534223785,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534223569,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/cnapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-18},{"file":"docs/static.md","type":"MODIFIED","insertions":91,"deletions":-17},{"file":"lib/app.js","type":"MODIFIED","insertions":56,"deletions":-54},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/endpoints/allocations.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":27,"deletions":-3},{"file":"lib/heartbeat_reconciler.js","type":"ADDED","insertions":416,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":81,"deletions":-385},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":776,"sizeDeletions":-484},{"number":"4","revision":"432d9da525c292ecb3e2a3954ab3e9bdc8ad177a","parents":["34717f5ad774df02af06db103230ec5cbaccc019"],"ref":"refs/changes/76/4676/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1534287208,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1534223569,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1534286326,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1534287237,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"bin/cnapi.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-18},{"file":"docs/static.md","type":"MODIFIED","insertions":91,"deletions":-17},{"file":"lib/app.js","type":"MODIFIED","insertions":56,"deletions":-54},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/endpoints/allocations.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":27,"deletions":-3},{"file":"lib/heartbeat_reconciler.js","type":"ADDED","insertions":416,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":81,"deletions":-385},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-2}],"sizeInsertions":776,"sizeDeletions":-484}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}