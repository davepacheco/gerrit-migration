From daa535caac0e98e5f2ae1c1f22438105f78df7a9 Mon Sep 17 00:00:00 2001
From: Orlando Vazquez <ovazquez@gmail.com>
Date: Tue, 6 Mar 2018 16:51:44 -0800
Subject: [PATCH] TRITON-215 CNAPI waitlist code incorrectly using splice
 method of array objects

---
 lib/models/waitlist.js | 8 ++++----
 package.json           | 2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/lib/models/waitlist.js b/lib/models/waitlist.js
index 0f4132a..70ad6df 100644
--- a/lib/models/waitlist.js
+++ b/lib/models/waitlist.js
@@ -5,7 +5,7 @@
  */
 
 /*
- * Copyright (c) 2016, Joyent, Inc.
+ * Copyright (c) 2018, Joyent, Inc.
  */
 
 /*
@@ -708,7 +708,7 @@ function (ticket, serverqueue, etag, callback) {
         });
     }
 
-    queue.splice(ticketIdx, ticketIdx+1);
+    queue.splice(ticketIdx, 1);
     serverqueue.tickets[key] = queue;
 
     Object.keys(serverqueue.tickets).forEach(function (k) {
@@ -822,7 +822,7 @@ function (ticket, serverqueue, etag, callback) {
         });
     }
 
-    queue.splice(ticketIdx, ticketIdx+1);
+    queue.splice(ticketIdx, 1);
     serverqueue.tickets[key] = queue;
 
     Object.keys(serverqueue.tickets).forEach(function (k) {
@@ -948,7 +948,7 @@ function (ticket, serverqueue, etag, callback) {
         });
     }
 
-    queue.splice(ticketIdx, ticketIdx+1);
+    queue.splice(ticketIdx, 1);
     serverqueue.tickets[key] = queue;
 
     Object.keys(serverqueue.tickets).forEach(function (k) {
diff --git a/package.json b/package.json
index 39ffe24..298451b 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "cnapi",
   "description": "SmartDataCenter Compute Node API",
-  "version": "1.8.0",
+  "version": "1.8.1",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
-- 
2.21.0

