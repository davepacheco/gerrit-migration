From ec921550863d7a8d469f8c702d3163c72e576d9d Mon Sep 17 00:00:00 2001
From: Jerry Jelinek <jerry.jelinek@joyent.com>
Date: Mon, 6 Mar 2017 17:59:24 +0000
Subject: [PATCH] OS-5993 illumos test files need work

---
 usr/src/cmd/dtrace/test/README             | 9 +++------
 usr/src/test/Readme.smartos                | 8 ++++----
 usr/src/test/os-tests/runfiles/default.run | 4 ++--
 usr/src/test/os-tests/tests/poll/Makefile  | 4 ++--
 4 files changed, 11 insertions(+), 14 deletions(-)

diff --git a/usr/src/cmd/dtrace/test/README b/usr/src/cmd/dtrace/test/README
index 51ab650fd7..094f70e7da 100644
--- a/usr/src/cmd/dtrace/test/README
+++ b/usr/src/cmd/dtrace/test/README
@@ -20,13 +20,10 @@ CDDL HEADER END
 
 Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
 Use is subject to license terms.
-
-ident	"%Z%%M%	%I%	%E% SMI"
+Copyright 2017 Joyent, Inc.
 
 DTrace Testing Suite
 
 The SUNWdtrt package delivers a set of test programs and D source
-files into the directory /opt/SUNWdtrt.  For more information see
-the following web site:
-
-	http://www.opensolaris.org/os/community/dtrace/dtest
+files into the directory /opt/SUNWdtrt. To run the tests:
+	/opt/SUNWdtrt/bin/dtest
diff --git a/usr/src/test/Readme.smartos b/usr/src/test/Readme.smartos
index 12a430c4d5..9c413aba2f 100644
--- a/usr/src/test/Readme.smartos
+++ b/usr/src/test/Readme.smartos
@@ -10,7 +10,7 @@
 #
 
 #
-# Copyright 2016, Joyent, Inc.
+# Copyright 2017, Joyent, Inc.
 #
 
 I) Introduction
@@ -32,7 +32,7 @@ SmartOS global zone, where any user created is lost on reboot.
 
 II) Setup to Run the Tests
 
-1) The tests currently require python26 to run, so you need to install this in
+1) The tests currently require python27 to run, so you need to install this in
    the global zone. The easiest way to do this is with pkgsrc using the
    following procedure:
 
@@ -42,8 +42,8 @@ II) Setup to Run the Tests
    b) Install the bootstrap tarball:
       # gzcat bootstrap-2014Q4-multiarch.tar.gz | (cd /; tar -xpf -)
 
-   c) Install python26:
-      pkgin in python26
+   c) Install python27:
+      pkgin in python27
 
 2) You need to get the tests from your build machine onto the test machine's
    global zone. This can be done in whatever way is easiest for you. Here is
diff --git a/usr/src/test/os-tests/runfiles/default.run b/usr/src/test/os-tests/runfiles/default.run
index 216f189519..eca82268c0 100644
--- a/usr/src/test/os-tests/runfiles/default.run
+++ b/usr/src/test/os-tests/runfiles/default.run
@@ -11,7 +11,7 @@
 
 #
 # Copyright (c) 2012 by Delphix. All rights reserved.
-# Copyright 2016 Joyent, Inc.
+# Copyright 2017 Joyent, Inc.
 #
 
 [DEFAULT]
@@ -22,7 +22,7 @@ timeout = 60
 post =
 outputdir = /var/tmp/test_results
 
-[/opt/os-tests/tests/poll_test]
+[/opt/os-tests/tests/poll]
 user = root
 tests = ['poll_test', 'epoll_test']
 
diff --git a/usr/src/test/os-tests/tests/poll/Makefile b/usr/src/test/os-tests/tests/poll/Makefile
index 14cc28b056..378b7e7490 100644
--- a/usr/src/test/os-tests/tests/poll/Makefile
+++ b/usr/src/test/os-tests/tests/poll/Makefile
@@ -11,7 +11,7 @@
 
 #
 # Copyright (c) 2012 by Delphix. All rights reserved.
-# Copyright 2016 Joyent, Inc.
+# Copyright 2017 Joyent, Inc.
 #
 
 include $(SRC)/cmd/Makefile.cmd
@@ -26,7 +26,7 @@ poll_test.ln := LDLIBS += -lsocket
 C99MODE = -xc99=%all
 
 ROOTOPTPKG = $(ROOT)/opt/os-tests
-TESTDIR = $(ROOTOPTPKG)/tests
+TESTDIR = $(ROOTOPTPKG)/tests/poll
 
 CMDS = $(PROG:%=$(TESTDIR)/%)
 $(CMDS) := FILEMODE = 0555
-- 
2.21.0

