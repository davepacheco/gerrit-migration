From aabbc8bbf3ed90878c29186c31f76156c3797629 Mon Sep 17 00:00:00 2001
From: Jan Wyszynski <jan.wyszynski@joyent.com>
Date: Wed, 13 Jun 2018 22:12:00 +0000
Subject: [PATCH] MANTA-3761 MorayCleanerStream asserts option that isn't
 passed in moray_gc.js

---
 bin/moray_gc.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/bin/moray_gc.js b/bin/moray_gc.js
index 98487f6..87094f3 100755
--- a/bin/moray_gc.js
+++ b/bin/moray_gc.js
@@ -46,6 +46,7 @@ var MORAY_CLEANUP_PATH = '/' + MANTA_USER + '/stor/manta_gc/moray';
 var PID_FILE = '/var/tmp/moray_gc.pid';
 var CRON_START = new Date();
 var MORAY_CLEANER = lib.createMorayCleaner({ log: LOG, batchSize: 1000 });
+var MANTA_DELETE_BUCKET = 'manta_delete_log';
 MORAY_CLEANER.on('error', function (err) {
         LOG.fatal(err);
         var returnCode = auditCron(err);
@@ -80,7 +81,8 @@ function cleanShardOneObject(log, shard, input, cb) {
                  */
                 var mcs = MORAY_CLEANER.cleanStream({
                         shard: shard,
-                        object: input
+                        object: input,
+                        bucket: MANTA_DELETE_BUCKET
                 });
 
                 mcs.once('error', function (mcsErr) {
-- 
2.21.0

