{"project":"joyent/sdcadm","branch":"master","id":"I947ee7ecd8d9d57053ea0d6ffa612179dad9eac8","number":"5144","subject":"TRITON-929 mockcloud should support \"sdcadm experimental update-agents\"","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/5144","commitMessage":"TRITON-929 mockcloud should support \"sdcadm experimental update-agents\"\n","createdOn":1543342768,"lastUpdated":1544650958,"open":false,"status":"ABANDONED","comments":[{"timestamp":1543342768,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1543342771,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 0f7c2afd3aacb6c63409de795944005092a25878\n    \n    useragent is already handled when creating the cnapi client\n    \n    commit 4eda454c0de8385c2b75921ac16f1e52e5f0a6cf\n    \n    update using CNAPI for servers that support it, only fallback to Ur for those where that didn\u0027t work"},{"timestamp":1543342810,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n version is: 1.22.0\n Version check ok.\n /tmp/repo/./build/node/bin/node node_modules/.bin/eslint  lib/channel.js lib/platform.js lib/ur.js lib/vmadm.js lib/post-setup/ha-binder.js lib/post-setup/dev-sample-data.js lib/post-setup/fabrics.js lib/post-setup/docker.js lib/post-setup/common-external-nics.js lib/post-setup/ha-manatee.js lib/post-setup/cloudapi.js lib/post-setup/index.js lib/post-setup/cns.js lib/post-setup/underlay-nics.js lib/post-setup/dev-headnode-prov.js lib/post-setup/cmon.js lib/post-setup/volapi.js lib/locker.js lib/common.js lib/svcadm.js lib/cli/do_info.js lib/cli/do_avail.js lib/cli/do_update_gz_tools.js lib/cli/do_completion.js lib/cli/do_services.js lib/cli/do_update_other.js lib/cli/do_nfs_volumes.js lib/cli/do_instances.js lib/cli/do_self_update.js lib/cli/do_update_docker.js lib/cli/do_update.js lib/cli/do_create.js lib/cli/do_check_config.js lib/cli/do_rollback.js lib/cli/do_add_new_agent_svcs.js lib/cli/experimental.js lib/cli/do_fix_core_vm_resolvers.js lib/cli/index.js lib/cli/do_install_docker_cert.js lib/cli/do_check_health.js lib/cli/do_update_agents.js lib/logging.js lib/default-fabric.js lib/errors.js lib/procedures/update-moray-v2.js lib/procedures/download-images.js lib/procedures/update-binder-v2.js lib/procedures/update-single-headnode-imgapi.js lib/procedures/update-manatee-v2.js lib/procedures/update-single-hn-sapi-v1.js lib/procedures/index.js lib/procedures/update-stateless-services-v1.js lib/procedures/procedure.js lib/procedures/update-dockerlogger.js lib/procedures/update-agent-v1.js lib/procedures/shared.js lib/procedures/update-sapi-v2.js lib/procedures/create-service-instance-v1.js lib/sdcadm.js lib/steps/usbkey.js lib/steps/dnsdomain.js lib/steps/index.js lib/steps/servers.js lib/steps/updateVmSize.js lib/steps/sapi.js lib/steps/zookeeper.js lib/steps/noRabbit.js lib/steps/binder.js lib/dc-maint.js test/dc-maint.test.js test/common.js test/rollback.test.js test/check-config.test.js test/available.test.js test/post-setup-ha-binder.test.js test/shared.js test/check-health.test.js test/services.test.js test/instances.test.js test/channel.test.js test/unit/testutil.js test/unit/cli/do_update_agents.test.js test/unit/steps/usbkey.test.js test/sdcadm.test.js test/create.test.js test/common.test.js test/self-update.test.js test/update.test.js test/update-gz-tools.test.js test/platform.test.js test/post-setup.test.js test/experimental.test.js test/manatee.test.js test/help.test.js\n \n /tmp/repo/lib/cli/do_update_agents.js\n   735:17  error  \u0027failures\u0027 is assigned a value but never used. Allowed unused vars must match /^_/            no-unused-vars\n   782:1   error  Line 782 exceeds the maximum line length of 80                                                max-len\n   789:50  error  \u0027err\u0027 is defined but never used. Allowed unused args must match /^(_|res|req|stdout|stderr)/  no-unused-vars\n \n ✖ 3 problems (3 errors, 0 warnings)\n \n tools/mk/Makefile.targ:201: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1544648615,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Abandoned\n\nAbandoned for now"},{"timestamp":1544649157,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Restored"},{"timestamp":1544649163,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1544649164,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit c19229e8378c3e13487cbd4fc70174430cdd2465\n    \n    useragent is already handled when creating the cnapi client\n    \n    commit 09336db1f78f09fab51c199643293789bcdf32e9\n    \n    update using CNAPI for servers that support it, only fallback to Ur for those where that didn\u0027t work"},{"timestamp":1544649177,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Abandoned\n\nagain"},{"timestamp":1544650958,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n fatal: No tags can describe \u0027947ee7ecd8d9d57053ea0d6ffa612179dad9eac8\u0027.\n Try --always, or create some tags.\n version is: 1.23.0\n Version check ok.\n /tmp/repo/./build/node/bin/node node_modules/.bin/eslint  lib/sdcadm.js lib/default-fabric.js lib/steps/updateVmSize.js lib/steps/usbkey.js lib/steps/sapi.js lib/steps/zookeeper.js lib/steps/dnsdomain.js lib/steps/index.js lib/steps/binder.js lib/steps/noRabbit.js lib/steps/servers.js lib/channel.js lib/dc-maint.js lib/errors.js lib/post-setup/cloudapi.js lib/post-setup/ha-manatee.js lib/post-setup/dev-sample-data.js lib/post-setup/cmon.js lib/post-setup/volapi.js lib/post-setup/fabrics.js lib/post-setup/ha-binder.js lib/post-setup/common-external-nics.js lib/post-setup/underlay-nics.js lib/post-setup/dev-headnode-prov.js lib/post-setup/docker.js lib/post-setup/cns.js lib/post-setup/index.js lib/common.js lib/svcadm.js lib/locker.js lib/logging.js lib/cli/do_nfs_volumes.js lib/cli/do_check_health.js lib/cli/do_create.js lib/cli/do_services.js lib/cli/do_instances.js lib/cli/do_info.js lib/cli/index.js lib/cli/do_update_agents.js lib/cli/do_self_update.js lib/cli/do_check_config.js lib/cli/do_fix_core_vm_resolvers.js lib/cli/experimental.js lib/cli/do_add_new_agent_svcs.js lib/cli/do_avail.js lib/cli/do_update_docker.js lib/cli/do_completion.js lib/cli/do_rollback.js lib/cli/do_update_other.js lib/cli/do_install_docker_cert.js lib/cli/do_update.js lib/cli/do_update_gz_tools.js lib/platform.js lib/vmadm.js lib/ur.js lib/procedures/update-single-hn-sapi-v1.js lib/procedures/procedure.js lib/procedures/download-images.js lib/procedures/update-moray-v2.js lib/procedures/update-dockerlogger.js lib/procedures/update-stateless-services-v1.js lib/procedures/shared.js lib/procedures/update-sapi-v2.js lib/procedures/update-single-headnode-imgapi.js lib/procedures/create-service-instance-v1.js lib/procedures/index.js lib/procedures/update-manatee-v2.js lib/procedures/update-binder-v2.js lib/procedures/update-agent-v1.js test/channel.test.js test/available.test.js test/sdcadm.test.js test/rollback.test.js test/dc-maint.test.js test/experimental.test.js test/common.js test/instances.test.js test/help.test.js test/services.test.js test/post-setup-ha-binder.test.js test/self-update.test.js test/shared.js test/unit/cli/do_update_agents.test.js test/unit/steps/usbkey.test.js test/unit/testutil.js test/check-health.test.js test/manatee.test.js test/create.test.js test/common.test.js test/post-setup.test.js test/update-gz-tools.test.js test/update.test.js test/check-config.test.js test/platform.test.js\n \n /tmp/repo/lib/cli/do_update_agents.js\n   735:17  error  \u0027failures\u0027 is assigned a value but never used. Allowed unused vars must match /^_/            no-unused-vars\n   782:1   error  Line 782 exceeds the maximum line length of 80                                                max-len\n   789:50  error  \u0027err\u0027 is defined but never used. Allowed unused args must match /^(_|res|req|stdout|stderr)/  no-unused-vars\n \n ✖ 3 problems (3 errors, 0 warnings)\n \n tools/mk/Makefile.targ:201: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"}],"currentPatchSet":{"number":"2","revision":"947ee7ecd8d9d57053ea0d6ffa612179dad9eac8","parents":["7f46252ff5317a97b4f6a3073c95ea7b5a87f1f5"],"ref":"refs/changes/44/5144/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1544649163,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1543342810,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":331,"deletions":-52}],"sizeInsertions":331,"sizeDeletions":-52},"patchSets":[{"number":"1","revision":"307a2252afe47fad8e6af0ed6549115e2c3c15e5","parents":["f5be82edf7f9222374b218d1ecdb86bcead3de8f"],"ref":"refs/changes/44/5144/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1543342768,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1543342810,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":331,"deletions":-52}],"sizeInsertions":331,"sizeDeletions":-52},{"number":"2","revision":"947ee7ecd8d9d57053ea0d6ffa612179dad9eac8","parents":["7f46252ff5317a97b4f6a3073c95ea7b5a87f1f5"],"ref":"refs/changes/44/5144/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1544649163,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1543342810,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_update_agents.js","type":"MODIFIED","insertions":331,"deletions":-52}],"sizeInsertions":331,"sizeDeletions":-52}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}