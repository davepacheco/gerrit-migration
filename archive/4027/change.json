{"project":"joyent/moray","branch":"master","id":"I7f84926eda471676c5af9de42fff63d6f5eda397","number":"4027","subject":"MORAY-473 Validate Moray configuration at startup Reviewed by: Jan Wyszynski \u003cjan.wyszynski@joyent.com\u003e Approved by: Jan Wyszynski \u003cjan.wyszynski@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/4027","commitMessage":"MORAY-473 Validate Moray configuration at startup\nReviewed by: Jan Wyszynski \u003cjan.wyszynski@joyent.com\u003e\nApproved by: Jan Wyszynski \u003cjan.wyszynski@joyent.com\u003e\n","createdOn":1527718387,"lastUpdated":1527901056,"open":false,"status":"MERGED","comments":[{"timestamp":1527718387,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1527718436,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1527718446,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527718496,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527721311,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1527721363,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527727637,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1527790313,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1527790349,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1527790360,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527879417,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1527879440,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1527879470,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527879492,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527879826,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 7."},{"timestamp":1527879877,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527901000,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1527901028,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1527901056,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"8","revision":"867ada0db0255a2c607269e158aa7f3075f8332c","parents":["0f91e20340899f19791984029e47a7d832d35731"],"ref":"refs/changes/27/4027/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527901028,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527879877,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}},{"type":"SUBM","value":"1","grantedOn":1527901056,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":85,"sizeDeletions":-8},"patchSets":[{"number":"1","revision":"8da36a36a9e8ba4ae95744a6d6e87ba6bb360217","parents":["d219f4515c83f8e6d9504937df958d036bc70425"],"ref":"refs/changes/27/4027/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527718387,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527718446,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":56,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":66,"sizeDeletions":-8},{"number":"2","revision":"a8642f07dd02808f844c6761faa2c6830b68b187","parents":["e1d5ea269ab971578159073ce64f491f19c9cd8f"],"ref":"refs/changes/27/4027/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527718436,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527718496,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":56,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":66,"sizeDeletions":-8},{"number":"3","revision":"e42cd551b9c404e6c42a064d93d3d0ab13b637ef","parents":["e1d5ea269ab971578159073ce64f491f19c9cd8f"],"ref":"refs/changes/27/4027/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527721311,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527721363,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/schema.js","line":373,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Will the \u0027required\u0027 on L351 apply recursively to these properties? Does it need to? (Same for \u0027standalone\u0027 properties on L380 and L381."},{"file":"lib/schema.js","line":373,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"No, but we should make sure that these are there. I\u0027ve added a \"required\" to these objects, too."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":72,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":82,"sizeDeletions":-8},{"number":"4","revision":"69fba44f07d715d1f8ee35d8a8e7b464f14f24a6","parents":["e1d5ea269ab971578159073ce64f491f19c9cd8f"],"ref":"refs/changes/27/4027/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527790313,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527790360,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":74,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":84,"sizeDeletions":-8},{"number":"5","revision":"a1cc751abe0babec60a117eb93034b4454aa5cc9","parents":["e1d5ea269ab971578159073ce64f491f19c9cd8f"],"ref":"refs/changes/27/4027/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527879417,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527879470,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":76,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":86,"sizeDeletions":-8},{"number":"6","revision":"78e7556759f725a5c53f3e78ca05383cfdbf4f2d","parents":["0f91e20340899f19791984029e47a7d832d35731"],"ref":"refs/changes/27/4027/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527879440,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527879492,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":76,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":86,"sizeDeletions":-8},{"number":"7","revision":"7f84926eda471676c5af9de42fff63d6f5eda397","parents":["0f91e20340899f19791984029e47a7d832d35731"],"ref":"refs/changes/27/4027/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527879826,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527879877,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":85,"sizeDeletions":-8},{"number":"8","revision":"867ada0db0255a2c607269e158aa7f3075f8332c","parents":["0f91e20340899f19791984029e47a7d832d35731"],"ref":"refs/changes/27/4027/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527901028,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1527901056,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527879877,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1527901000,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/errors.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/schema.js","type":"MODIFIED","insertions":75,"deletions":0},{"file":"lib/server.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4},{"file":"sdc/sapi_manifests/moray/template","type":"MODIFIED","insertions":0,"deletions":-4}],"sizeInsertions":85,"sizeDeletions":-8}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}