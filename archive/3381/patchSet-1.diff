From c49719ba9cf135d000b2fe1935a280b01acf918f Mon Sep 17 00:00:00 2001
From: Josh Wilsdon <josh@wilsdon.ca>
Date: Fri, 16 Feb 2018 10:46:15 -0800
Subject: [PATCH] TRITON-128 add cnapi support for bhyve

---
 lib/endpoints/vms.js | 2 +-
 package.json         | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/endpoints/vms.js b/lib/endpoints/vms.js
index 414e651..f56651f 100644
--- a/lib/endpoints/vms.js
+++ b/lib/endpoints/vms.js
@@ -548,7 +548,7 @@ VM.create = function handlerVmCreate(req, res, next) {
     var imgapi_url = req.stash.app.config.imgapi.url;
     var image_uuid;
 
-    if (req.params.brand === 'kvm') {
+    if (['bhyve', 'kvm'].indexOf(req.params.brand) !== -1) {
         if (req.params.hasOwnProperty('disks') && req.params.disks[0]) {
             image_uuid = req.params.disks[0].image_uuid;
         }
diff --git a/package.json b/package.json
index 5e33dca..adc3dba 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "cnapi",
   "description": "SmartDataCenter Compute Node API",
-  "version": "1.6.1",
+  "version": "1.7.1",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
-- 
2.21.0

