{"project":"joyent/sdc-vmapi","branch":"master","id":"I157591d1208a1b2e8e8c39386a21d771de063699","number":"6958","subject":"TRITON-1903 allow bhyve resize Reviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e","owner":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"url":"https://cr.joyent.us/6958","commitMessage":"TRITON-1903 allow bhyve resize\nReviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\n","createdOn":1570477103,"lastUpdated":1570560106,"open":true,"status":"NEW","comments":[{"timestamp":1570477103,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 1."},{"timestamp":1570477105,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 5ce3f9a0fc5300dd1df5ad61b5b93c86c4c2c844\n    \n    TRITON-1903 allow bhyve resize"},{"timestamp":1570477154,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1570544269,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1: Code-Review+1\n\n(5 comments)\n\nLooks good to me but for some minor nits and a typo left around in docs"},{"timestamp":1570553462,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Uploaded patch set 2."},{"timestamp":1570553463,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1570553514,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1570553631,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Patch Set 2:\n\nConfirming all vmapi bhyve tests still pass:\n\nvms.resize.bhyve.test.js\n✔ fetch_napi_networks\n✔ find_sample_1g_package\n✔ find_small_flexible_disk_package\n✔ find_flexible_disk_package\n✔ find_image_by_name\n✔ create_bhyve_vm\n✔ create_ginormous_package\n✔ resize_vm_to_ginormous_package_gets_error\n✔ delete_ginormous_package\n✔ error_for_resize_when_disk_usage_exceeds_flex_size\n✔ resize_vm_to_flexible_disk\n✔ resize_vm_non_flexible_disk_gets_error\n✔ resize_vm_down_too_small_gets_error\n✔ destroy_vm\n\nOK: 58 assertions (45142ms)"},{"timestamp":1570560080,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\nI assume tests are passing too so ..."},{"timestamp":1570560106,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nActually, just saw your other comment with the test output :-)"}],"currentPatchSet":{"number":"2","revision":"157591d1208a1b2e8e8c39386a21d771de063699","parents":["a53646ebc1f4b79fc138b1ad5a9d364a4c6cfd4f"],"ref":"refs/changes/58/6958/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1570553462,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1570553514,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570560080,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1570560080,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/apis/wfapi.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":164,"deletions":-21},{"file":"lib/errors.js","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"lib/vm-migration/migrate.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/vms.full.test.js","type":"MODIFIED","insertions":0,"deletions":-257},{"file":"test/vms.resize.bhyve.test.js","type":"ADDED","insertions":501,"deletions":0},{"file":"test/vms.resize.test.js","type":"ADDED","insertions":378,"deletions":0},{"file":"test/vms.validate.test.js","type":"MODIFIED","insertions":562,"deletions":-7}],"sizeInsertions":1627,"sizeDeletions":-300},"patchSets":[{"number":"1","revision":"b541858e4012bab3ddf176993d153f4b87f016cd","parents":["a53646ebc1f4b79fc138b1ad5a9d364a4c6cfd4f"],"ref":"refs/changes/58/6958/1","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1570477103,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1570477154,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570544269,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"comments":[{"file":"docs/index.md","line":2418,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"?"},{"file":"docs/index.md","line":2418,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Weird - fixed."},{"file":"lib/common/validation.js","line":1662,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"nit: the \"else\" is not needed here."},{"file":"lib/common/validation.js","line":1662,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"lib/common/validation.js","line":1719,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"On these cases I personally prefer to assign the value of \"some\" to a variable and use just the variable for the conditional. It does nothing but helping readability. (Just a personal preference, though)"},{"file":"lib/common/validation.js","line":1719,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Done"},{"file":"package.json","line":30,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Definitely a good idea."},{"file":"test/vms.resize.bhyve.test.js","line":32,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Shouldn\u0027t we try to perform a search by name for these kind of images? The tests using this one will fail as soon as we deprecate the image. Not that it needs to be part of this issue, though."},{"file":"test/vms.resize.bhyve.test.js","line":32,"reviewer":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"message":"Yes, that would be better. Fixed.\n\nI had just copied the original resize code here (which still looks up it\u0027s image by uuid)."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":10,"deletions":-5},{"file":"lib/apis/wfapi.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":162,"deletions":-21},{"file":"lib/errors.js","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"lib/vm-migration/migrate.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/vms.full.test.js","type":"MODIFIED","insertions":0,"deletions":-257},{"file":"test/vms.resize.bhyve.test.js","type":"ADDED","insertions":470,"deletions":0},{"file":"test/vms.resize.test.js","type":"ADDED","insertions":378,"deletions":0},{"file":"test/vms.validate.test.js","type":"MODIFIED","insertions":562,"deletions":-7}],"sizeInsertions":1595,"sizeDeletions":-300},{"number":"2","revision":"157591d1208a1b2e8e8c39386a21d771de063699","parents":["a53646ebc1f4b79fc138b1ad5a9d364a4c6cfd4f"],"ref":"refs/changes/58/6958/2","uploader":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"createdOn":1570553462,"author":{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1570553514,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1570560080,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1570560080,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/apis/wfapi.js","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":164,"deletions":-21},{"file":"lib/errors.js","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"lib/vm-migration/migrate.js","type":"MODIFIED","insertions":4,"deletions":-4},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/vms.full.test.js","type":"MODIFIED","insertions":0,"deletions":-257},{"file":"test/vms.resize.bhyve.test.js","type":"ADDED","insertions":501,"deletions":0},{"file":"test/vms.resize.test.js","type":"ADDED","insertions":378,"deletions":0},{"file":"test/vms.validate.test.js","type":"MODIFIED","insertions":562,"deletions":-7}],"sizeInsertions":1627,"sizeDeletions":-300}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Todd Whiteman","email":"todd.whiteman@joyent.com","username":"twhiteman"}]}