{"project":"joyent/node-artedi","branch":"master","id":"I1acdf3fcbf7f836b993430d32604b9d988f1f035","number":"3146","subject":"joyent/node-artedi#9 Create an accessor function for collector values Reviewed by: Richard Kiene \u003crichard.kiene@joyent.com\u003e Approved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e","owner":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"url":"https://cr.joyent.us/3146","commitMessage":"joyent/node-artedi#9 Create an accessor function for collector values\nReviewed by: Richard Kiene \u003crichard.kiene@joyent.com\u003e\nApproved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e\n","createdOn":1514912691,"lastUpdated":1515190481,"open":false,"status":"MERGED","comments":[{"timestamp":1514912691,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 1."},{"timestamp":1514912710,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1514912723,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1514913130,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 3."},{"timestamp":1514913159,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515029910,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\n(2 comments)"},{"timestamp":1515086207,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1515088882,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1515188624,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 4."},{"timestamp":1515188646,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515189113,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 5."},{"timestamp":1515189131,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515189696,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1515189945,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 6."},{"timestamp":1515189963,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1515190107,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1"},{"timestamp":1515190376,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 7: Commit message was updated."},{"timestamp":1515190481,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kody A Kantor"}],"currentPatchSet":{"number":"7","revision":"1acdf3fcbf7f836b993430d32604b9d988f1f035","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/7","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1515190376,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515189963,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"SUBM","value":"1","grantedOn":1515190481,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":14,"deletions":-2},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":21,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":66,"deletions":-19}],"sizeInsertions":181,"sizeDeletions":-42},"patchSets":[{"number":"1","revision":"73332e9a261f246e86b7b173b697b654a49b9153","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/1","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1514912691,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1514912710,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":20,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":63,"deletions":-19}],"sizeInsertions":179,"sizeDeletions":-40},{"number":"2","revision":"868a2a672ea63843f8a0fb1cb6f9fa91e70a2c4e","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/2","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1514912723,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1514912710,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":20,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":63,"deletions":-19}],"sizeInsertions":179,"sizeDeletions":-40},{"number":"3","revision":"c7e7ed31fa35a495c0619111dfe87841dd7df0cd","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/3","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1514913130,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1514913159,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515029910,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515029910,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"comments":[{"file":"lib/counter.js","line":60,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Is it worth logging that this happened?"},{"file":"lib/counter.js","line":60,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"The thing is that this could be an expected result if the consumer is trying to see if a metric with the given metadata labels exists.\n\nIt was a tough decision to make this return \u0027null\u0027. Any numeric value might have meaning (zero, -1, etc.), and I don\u0027t know that it makes to return an Error object if the user might be testing for the existence of a metric, but maybe we could have a \u0027NoExist\u0027 error that the caller could check for. What do you think?\n\nnode-artedi doesn\u0027t log anything right now and doesn\u0027t take a Bunyan logger as an argument anywhere. We could definitely add logging if it would be useful."},{"file":"lib/counter.js","line":60,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"I like the NoExist option if it doesn\u0027t introduce a big mess for existing clients. Otherwise, I\u0027m fine :)"},{"file":"lib/gauge.js","line":55,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Worth a log statement that getWithLabels failed to return a value?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":20,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":62,"deletions":-19}],"sizeInsertions":173,"sizeDeletions":-40},{"number":"4","revision":"8a837f6494a04ea939e239843a5c4ed03057c352","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/4","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1515188624,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515188646,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":14,"deletions":-2},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":21,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":66,"deletions":-19}],"sizeInsertions":181,"sizeDeletions":-42},{"number":"5","revision":"f3bd9e044c0e52c48b3d62ef5f432138d4df58eb","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/5","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1515189113,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515189131,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515189696,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515189696,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":14,"deletions":-2},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":21,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":66,"deletions":-19}],"sizeInsertions":181,"sizeDeletions":-42},{"number":"6","revision":"e81da32ed0cd04b6fa809bb3174ab453f3b2c540","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/6","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1515189945,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515189963,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":14,"deletions":-2},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":21,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":66,"deletions":-19}],"sizeInsertions":181,"sizeDeletions":-42},{"number":"7","revision":"1acdf3fcbf7f836b993430d32604b9d988f1f035","parents":["0b28a55934e3df049537ad173bace5d8c63d4429"],"ref":"refs/changes/46/3146/7","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1515190376,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1515189963,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1515190107,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"SUBM","value":"1","grantedOn":1515190481,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":3,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":8,"deletions":-8},{"file":"docs/API.md","type":"MODIFIED","insertions":18,"deletions":0},{"file":"docs/private_api.md","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"lib/common.js","type":"MODIFIED","insertions":14,"deletions":-2},{"file":"lib/counter.js","type":"MODIFIED","insertions":22,"deletions":-1},{"file":"lib/gauge.js","type":"MODIFIED","insertions":21,"deletions":-1},{"file":"lib/metric.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"lib/metric_vector.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":66,"deletions":-19}],"sizeInsertions":181,"sizeDeletions":-42}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}]}