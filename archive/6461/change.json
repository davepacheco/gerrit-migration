{"project":"joyent/triton-kbmapi","branch":"master","id":"Ia45e51bc18ebe0a2b75c851a4b4bb7b3e62fb80c","number":"6461","subject":"TRITON-1756 kbmapi: Key Backup and Management API Portions contributed by: Chris Burroughs \u003cchris.burroughs@joyent.com\u003e","owner":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"url":"https://cr.joyent.us/6461","commitMessage":"TRITON-1756 kbmapi: Key Backup and Management API\nPortions contributed by: Chris Burroughs \u003cchris.burroughs@joyent.com\u003e\n","createdOn":1560877041,"lastUpdated":1562013644,"open":true,"status":"NEW","comments":[{"timestamp":1560877041,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 1."},{"timestamp":1560877136,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n curl: (28) Operation timed out after 30000 milliseconds with 0 out of 0 bytes received\n xmllint --noout --path deps/eng/tools/ --dtdvalid deps/eng/tools/service_bundle.dtd.1 smf/manifests/kbmapi.xml\n deps/eng/tools/mk/Makefile.node_prebuilt.targ:41: *** NODE_PREBUILT_TARBALL is empty: no \u0027https://download.joyent.com/pub/build/sdcnode/c2c31b00-1d60-11e9-9a77-ff9f06554b0f/master-latest/sdcnode//sdcnode-v6.17.0-zone64-c2c31b00-1d60-11e9-9a77-ff9f06554b0f-master-.*\\.tgz\u0027 found.  Stop."},{"timestamp":1561411683,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(34 comments)\n\nI\u0027m somewhat confused as to why a lot of the things in the tools directory are there.  Why don\u0027t they just come from deps/eng?\n\n$ for file in tools/*; do test -f deps/eng/$file \u0026\u0026 echo could use $file from eng; done\ncould use tools/bashstyle from eng\ncould use tools/download_ctftools from eng\ncould use tools/download_go from eng\ncould use tools/jsl.node.conf from eng\ncould use tools/jsl.web.conf from eng\ncould use tools/jsstyle.conf from eng\ncould use tools/mkrepo from eng\ncould use tools/runtests.in from eng\ncould use tools/service_bundle.dtd.1 from eng"},{"timestamp":1562013644,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\nPosting my comments so far.  I\u0027ve not taken a close look at test code."}],"currentPatchSet":{"number":"1","revision":"a45e51bc18ebe0a2b75c851a4b4bb7b3e62fb80c","parents":["339d173955d79dde21406fb4fdc765fcef9c3b35"],"ref":"refs/changes/61/6461/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1560877041,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1560877136,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":8,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Copyright 2019 Joyent, Inc."},{"file":"Makefile","line":34,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"But all the js code seems to be indent\u003d4"},{"file":"README.md","line":21,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"maybe not once the code review is complete?"},{"file":"README.md","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":":)"},{"file":"boot/configure.sh","line":15,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"set -o errexit"},{"file":"boot/setup.sh","line":15,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"set -o errexit"},{"file":"boot/setup.sh","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete?"},{"file":"boot/setup.sh","line":42,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete?"},{"file":"docs/index.md","line":1,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This file needs to be updated to reflect what is actually in RFD 77, fill in more API details"},{"file":"lib/apis/moray.js","line":63,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"What purpose does this serve?  It seems as though it violates the \"only allowing by indexes in bucket.schema.index\" part of the comment above."},{"file":"lib/apis/moray.js","line":74,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems a missing bucket should be an error as well"},{"file":"lib/apis/moray.js","line":82,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"this will fit on the previous line"},{"file":"lib/apis/moray.js","line":86,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Do we need to sanitize the input to prevent injection attacks?  I\u0027m thinking that we may want to have an expression that ensures that all keys and values are made up of only allowed characters."},{"file":"lib/apis/moray.js","line":288,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"assertions for opts.*"},{"file":"lib/apis/moray.js","line":371,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"asserts for bucket, key, remove, val"},{"file":"lib/apis/moray.js","line":383,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"could use a function name"},{"file":"lib/apis/moray.js","line":438,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Seem to be unused.  Delete?"},{"file":"lib/app.js","line":8,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Copyright 2019 Joyent, Inc."},{"file":"lib/app.js","line":124,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Do we need some subset of these?  Cribbed from sdc-cloudapi/lib/app.js.\n\nserver.use(authorizationParser());\n// Run authentication and authorization before everything else\nserver.use(auth.signatureAuth);\nserver.use(auth.tokenAuth);\nserver.use(auth.assertAuthenticated);\nserver.use(auth.loadAccount);"},{"file":"lib/config.js","line":41,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"never called externally, why export?"},{"file":"lib/endpoints.js","line":68,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says:\n\n\u003e Like GetToken, except it also includes the pin. The recovery_token field is not returned.\n\n1. Does GetToken also not return recovery_token?\n2. I don\u0027t see where recovery_token is stripped from the token returned from Moray."},{"file":"lib/models/token.js","line":16,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete"},{"file":"lib/models/token.js","line":28,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Should this set of fields match those that are required by CREATE_SCHEMA?"},{"file":"lib/models/token.js","line":51,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems that for all of these schemas, we should be validating the optional parameters as well."},{"file":"lib/models/token.js","line":53,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says the following additional fields are required:\n\npin\npubkeys\npubkeys.9a\npubkeys.9d\npubkeys.9e"},{"file":"lib/models/token.js","line":56,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says these are optional"},{"file":"lib/models/token.js","line":169,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"rfd 77 says \"recovery_tokens\" and the value is an array of recovery tokens."},{"file":"lib/models/token.js","line":266,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"tokens.forEach(stripSensitiveFields);"},{"file":"lib/models/token.js","line":317,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Maybe for updating the pin?  Perhaps that would be better with SetTokenPin, but we would need to figure out a way to handle failure in the middle of a PIN change."},{"file":"lib/models/token.js","line":350,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Why not just:\n\nbucket: BUCKET,"},{"file":"lib/util/constants.js","line":20,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"The names seem pretty generic for shared constants.  DEFAULT_LIST_LIMIT instead?  Maybe this is just the way we do this elsewhere and now is not the time to try to fix it."},{"file":"lib/util/validate.js","line":16,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Need ^ and $, right?"},{"file":"lib/util/validate.js","line":38,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"is this because it is more efficient than val.match(), compatibility, or some other reason?"},{"file":"tools/download_go","line":1,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"why is this file needed?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":27,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":12,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":15,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":154,"deletions":0},{"file":"README.md","type":"ADDED","insertions":82,"deletions":0},{"file":"README.txt","type":"DELETED","insertions":0,"deletions":-1},{"file":"boot/configure.sh","type":"ADDED","insertions":22,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":47,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/restdown","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/apis/moray.js","type":"ADDED","insertions":453,"deletions":0},{"file":"lib/app.js","type":"ADDED","insertions":324,"deletions":0},{"file":"lib/config.js","type":"ADDED","insertions":42,"deletions":0},{"file":"lib/endpoints.js","type":"ADDED","insertions":136,"deletions":0},{"file":"lib/models/index.js","type":"ADDED","insertions":44,"deletions":0},{"file":"lib/models/token.js","type":"ADDED","insertions":358,"deletions":0},{"file":"lib/util/constants.js","type":"ADDED","insertions":20,"deletions":0},{"file":"lib/util/errors.js","type":"ADDED","insertions":262,"deletions":0},{"file":"lib/util/validate.js","type":"ADDED","insertions":58,"deletions":0},{"file":"package.json","type":"ADDED","insertions":31,"deletions":0},{"file":"sapi_manifests/kbmapi/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/kbmapi/template","type":"ADDED","insertions":12,"deletions":0},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"sbin/kbmapid","type":"ADDED","insertions":28,"deletions":0},{"file":"server.js","type":"ADDED","insertions":57,"deletions":0},{"file":"smf/manifests/kbmapi.xml.in","type":"ADDED","insertions":39,"deletions":0},{"file":"test/lib/client.js","type":"ADDED","insertions":52,"deletions":0},{"file":"test/lib/common.js","type":"ADDED","insertions":445,"deletions":0},{"file":"test/lib/config.js","type":"ADDED","insertions":29,"deletions":0},{"file":"test/lib/log.js","type":"ADDED","insertions":28,"deletions":0},{"file":"test/lib/server.js","type":"ADDED","insertions":178,"deletions":0},{"file":"test/lib/token.js","type":"ADDED","insertions":130,"deletions":0},{"file":"test/runtest","type":"ADDED","insertions":32,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":176,"deletions":0},{"file":"test/unit/helpers.js","type":"ADDED","insertions":48,"deletions":0},{"file":"test/unit/run.js","type":"ADDED","insertions":31,"deletions":0},{"file":"test/unit/token.test.js","type":"ADDED","insertions":135,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":176,"deletions":0},{"file":"tools/download_ctftools","type":"ADDED","insertions":90,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/jsl.node.conf","type":"ADDED","insertions":139,"deletions":0},{"file":"tools/jsl.web.conf","type":"ADDED","insertions":137,"deletions":0},{"file":"tools/jsstyle.conf","type":"ADDED","insertions":14,"deletions":0},{"file":"tools/mkrepo","type":"ADDED","insertions":121,"deletions":0},{"file":"tools/obliterate-kbmapi-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/rsync-to","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/runtests.in","type":"ADDED","insertions":136,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":6128,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"a45e51bc18ebe0a2b75c851a4b4bb7b3e62fb80c","parents":["339d173955d79dde21406fb4fdc765fcef9c3b35"],"ref":"refs/changes/61/6461/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1560877041,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1560877136,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":8,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Copyright 2019 Joyent, Inc."},{"file":"Makefile","line":34,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"But all the js code seems to be indent\u003d4"},{"file":"README.md","line":21,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"maybe not once the code review is complete?"},{"file":"README.md","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":":)"},{"file":"boot/configure.sh","line":15,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"set -o errexit"},{"file":"boot/setup.sh","line":15,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"set -o errexit"},{"file":"boot/setup.sh","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete?"},{"file":"boot/setup.sh","line":42,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete?"},{"file":"docs/index.md","line":1,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This file needs to be updated to reflect what is actually in RFD 77, fill in more API details"},{"file":"lib/apis/moray.js","line":63,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"What purpose does this serve?  It seems as though it violates the \"only allowing by indexes in bucket.schema.index\" part of the comment above."},{"file":"lib/apis/moray.js","line":74,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems a missing bucket should be an error as well"},{"file":"lib/apis/moray.js","line":82,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"this will fit on the previous line"},{"file":"lib/apis/moray.js","line":86,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Do we need to sanitize the input to prevent injection attacks?  I\u0027m thinking that we may want to have an expression that ensures that all keys and values are made up of only allowed characters."},{"file":"lib/apis/moray.js","line":288,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"assertions for opts.*"},{"file":"lib/apis/moray.js","line":371,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"asserts for bucket, key, remove, val"},{"file":"lib/apis/moray.js","line":383,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"could use a function name"},{"file":"lib/apis/moray.js","line":438,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Seem to be unused.  Delete?"},{"file":"lib/app.js","line":8,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Copyright 2019 Joyent, Inc."},{"file":"lib/app.js","line":124,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Do we need some subset of these?  Cribbed from sdc-cloudapi/lib/app.js.\n\nserver.use(authorizationParser());\n// Run authentication and authorization before everything else\nserver.use(auth.signatureAuth);\nserver.use(auth.tokenAuth);\nserver.use(auth.assertAuthenticated);\nserver.use(auth.loadAccount);"},{"file":"lib/config.js","line":41,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"never called externally, why export?"},{"file":"lib/endpoints.js","line":68,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says:\n\n\u003e Like GetToken, except it also includes the pin. The recovery_token field is not returned.\n\n1. Does GetToken also not return recovery_token?\n2. I don\u0027t see where recovery_token is stripped from the token returned from Moray."},{"file":"lib/models/token.js","line":16,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"delete"},{"file":"lib/models/token.js","line":28,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Should this set of fields match those that are required by CREATE_SCHEMA?"},{"file":"lib/models/token.js","line":51,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems that for all of these schemas, we should be validating the optional parameters as well."},{"file":"lib/models/token.js","line":53,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says the following additional fields are required:\n\npin\npubkeys\npubkeys.9a\npubkeys.9d\npubkeys.9e"},{"file":"lib/models/token.js","line":56,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"RFD 77 says these are optional"},{"file":"lib/models/token.js","line":169,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"rfd 77 says \"recovery_tokens\" and the value is an array of recovery tokens."},{"file":"lib/models/token.js","line":266,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"tokens.forEach(stripSensitiveFields);"},{"file":"lib/models/token.js","line":317,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Maybe for updating the pin?  Perhaps that would be better with SetTokenPin, but we would need to figure out a way to handle failure in the middle of a PIN change."},{"file":"lib/models/token.js","line":350,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Why not just:\n\nbucket: BUCKET,"},{"file":"lib/util/constants.js","line":20,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"The names seem pretty generic for shared constants.  DEFAULT_LIST_LIMIT instead?  Maybe this is just the way we do this elsewhere and now is not the time to try to fix it."},{"file":"lib/util/validate.js","line":16,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Need ^ and $, right?"},{"file":"lib/util/validate.js","line":38,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"is this because it is more efficient than val.match(), compatibility, or some other reason?"},{"file":"tools/download_go","line":1,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"why is this file needed?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":27,"deletions":0},{"file":".gitignore","type":"ADDED","insertions":12,"deletions":0},{"file":".gitmodules","type":"ADDED","insertions":15,"deletions":0},{"file":"LICENSE","type":"ADDED","insertions":373,"deletions":0},{"file":"Makefile","type":"ADDED","insertions":154,"deletions":0},{"file":"README.md","type":"ADDED","insertions":82,"deletions":0},{"file":"README.txt","type":"DELETED","insertions":0,"deletions":-1},{"file":"boot/configure.sh","type":"ADDED","insertions":22,"deletions":0},{"file":"boot/setup.sh","type":"ADDED","insertions":47,"deletions":0},{"file":"deps/eng","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/restdown","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/sdc-scripts","type":"ADDED","insertions":1,"deletions":0},{"file":"docs/index.md","type":"ADDED","insertions":51,"deletions":0},{"file":"lib/apis/moray.js","type":"ADDED","insertions":453,"deletions":0},{"file":"lib/app.js","type":"ADDED","insertions":324,"deletions":0},{"file":"lib/config.js","type":"ADDED","insertions":42,"deletions":0},{"file":"lib/endpoints.js","type":"ADDED","insertions":136,"deletions":0},{"file":"lib/models/index.js","type":"ADDED","insertions":44,"deletions":0},{"file":"lib/models/token.js","type":"ADDED","insertions":358,"deletions":0},{"file":"lib/util/constants.js","type":"ADDED","insertions":20,"deletions":0},{"file":"lib/util/errors.js","type":"ADDED","insertions":262,"deletions":0},{"file":"lib/util/validate.js","type":"ADDED","insertions":58,"deletions":0},{"file":"package.json","type":"ADDED","insertions":31,"deletions":0},{"file":"sapi_manifests/kbmapi/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/kbmapi/template","type":"ADDED","insertions":12,"deletions":0},{"file":"sapi_manifests/registrar/manifest.json","type":"ADDED","insertions":5,"deletions":0},{"file":"sapi_manifests/registrar/template","type":"ADDED","insertions":30,"deletions":0},{"file":"sbin/kbmapid","type":"ADDED","insertions":28,"deletions":0},{"file":"server.js","type":"ADDED","insertions":57,"deletions":0},{"file":"smf/manifests/kbmapi.xml.in","type":"ADDED","insertions":39,"deletions":0},{"file":"test/lib/client.js","type":"ADDED","insertions":52,"deletions":0},{"file":"test/lib/common.js","type":"ADDED","insertions":445,"deletions":0},{"file":"test/lib/config.js","type":"ADDED","insertions":29,"deletions":0},{"file":"test/lib/log.js","type":"ADDED","insertions":28,"deletions":0},{"file":"test/lib/server.js","type":"ADDED","insertions":178,"deletions":0},{"file":"test/lib/token.js","type":"ADDED","insertions":130,"deletions":0},{"file":"test/runtest","type":"ADDED","insertions":32,"deletions":0},{"file":"test/runtests","type":"ADDED","insertions":176,"deletions":0},{"file":"test/unit/helpers.js","type":"ADDED","insertions":48,"deletions":0},{"file":"test/unit/run.js","type":"ADDED","insertions":31,"deletions":0},{"file":"test/unit/token.test.js","type":"ADDED","insertions":135,"deletions":0},{"file":"tools/bashstyle","type":"ADDED","insertions":176,"deletions":0},{"file":"tools/download_ctftools","type":"ADDED","insertions":90,"deletions":0},{"file":"tools/download_go","type":"ADDED","insertions":126,"deletions":0},{"file":"tools/jsl.node.conf","type":"ADDED","insertions":139,"deletions":0},{"file":"tools/jsl.web.conf","type":"ADDED","insertions":137,"deletions":0},{"file":"tools/jsstyle.conf","type":"ADDED","insertions":14,"deletions":0},{"file":"tools/mkrepo","type":"ADDED","insertions":121,"deletions":0},{"file":"tools/obliterate-kbmapi-service.sh","type":"ADDED","insertions":68,"deletions":0},{"file":"tools/rsync-to","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/runtests.in","type":"ADDED","insertions":136,"deletions":0},{"file":"tools/service_bundle.dtd.1","type":"ADDED","insertions":1091,"deletions":0}],"sizeInsertions":6128,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}]}