{"project":"joyent/illumos-joyent","branch":"master","id":"Idc1e9292e2ad9f799f0f53b3612eb1495588f369","number":"6845","subject":"OS-7964 CTR mode tries to be both a stream and block cipher and fails at both Reviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/6845","commitMessage":"OS-7964 CTR mode tries to be both a stream and block cipher and fails at both\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\n","createdOn":1567012313,"lastUpdated":1568249743,"open":true,"status":"NEW","comments":[{"timestamp":1567012313,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1567013012,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1567182356,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3."},{"timestamp":1568041553,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1568140131,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1568216530,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1568216736,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1568245955,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 6:\n\nAre there any other implementations of AES-CTR you can interop-challenge?  Say OpenSSL?  I\u0027m willing to IA this if you have interoperability covered."},{"timestamp":1568246007,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 6:\n\n\u003e Are there any other implementations of AES-CTR you can\n \u003e interop-challenge?  Say OpenSSL?  I\u0027m willing to IA this if you\n \u003e have interoperability covered.\n\nPublic test vectors and results would work too.  (AES-CTR being a stream cipher may make test-vector-tests annoying, though.)"},{"timestamp":1568249743,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 6:\n\nThe crypto tests themselves use the test vectors from RFC3686 section 6.\nThe changes in OS-7954 (the other CR under \u0027Submitted together\u0027), the tests fail the current in-gate code, and the below code passes with it."}],"currentPatchSet":{"number":"6","revision":"dc1e9292e2ad9f799f0f53b3612eb1495588f369","parents":["11f4fdcac29785d4e5040e44215f3b1a7c152844"],"ref":"refs/changes/45/6845/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1568216736,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568140131,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},"patchSets":[{"number":"1","revision":"ca1d36b676bf673bf02520579551ba66a5999df2","parents":["eb21f809585790e04be73cf7e1d63475310c7364"],"ref":"refs/changes/45/6845/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1567012313,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},{"number":"2","revision":"99aae41ba85f2ba992659395560f6deaf66a30b7","parents":["eb21f809585790e04be73cf7e1d63475310c7364"],"ref":"refs/changes/45/6845/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1567013012,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},{"number":"3","revision":"7924753211eaf73f1cfdda9a8daa6ef1ed3eea10","parents":["ff3ba27549cce1409234e7439cd15a9aa2f9eb36"],"ref":"refs/changes/45/6845/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1567182356,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},{"number":"4","revision":"74bdfb51be523d64a9922e7342c870d1bc0ed110","parents":["ac2f8ce1f702c155ff73d11fd383686b2dd75f33"],"ref":"refs/changes/45/6845/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1568041553,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568140131,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},{"number":"5","revision":"41b4e76be42a6cf83914cfac1302479fd736a716","parents":["cbbbd94c1b6c420661e63f90da43ca3e2ad69a56"],"ref":"refs/changes/45/6845/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1568216530,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568140131,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277},{"number":"6","revision":"dc1e9292e2ad9f799f0f53b3612eb1495588f369","parents":["11f4fdcac29785d4e5040e44215f3b1a7c152844"],"ref":"refs/changes/45/6845/6","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1568216736,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1568140131,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/common/crypto/aes/aes_modes.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/common/crypto/modes/ctr.c","type":"MODIFIED","insertions":164,"deletions":-136},{"file":"usr/src/common/crypto/modes/modes.h","type":"MODIFIED","insertions":4,"deletions":-6},{"file":"usr/src/lib/pkcs11/libsoftcrypto/common/mapfile-vers","type":"MODIFIED","insertions":1,"deletions":-2},{"file":"usr/src/lib/pkcs11/pkcs11_softtoken/common/softAESCrypt.c","type":"MODIFIED","insertions":47,"deletions":-41},{"file":"usr/src/test/crypto-tests/tests/modes/aes/ctr/aes_ctr.c","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"usr/src/uts/common/crypto/io/aes.c","type":"MODIFIED","insertions":67,"deletions":-89}],"sizeInsertions":286,"sizeDeletions":-277}],"allReviewers":[{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}