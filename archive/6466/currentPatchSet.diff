commit e6609fd70d1b8fa90aa4d22a05ec30abf6b28add
Author: Ante Vojvodic <ante@atcorner.hr>
Date:   2019-06-19T12:30:07+00:00 (4 months ago)
    
    OS-7848 configure should import configure-build if it exists
    Reviewed by: John Levon <john.levon@joyent.com>
    Reviewed by: Tim Foster <tim.foster@joyent.com>
    Approved by: Tim Foster <tim.foster@joyent.com>

diff --git a/configure b/configure
index cb46dc5e..02ac4dcd 100755
--- a/configure
+++ b/configure
@@ -31,8 +31,9 @@ conf_pkgsrcurl="https://download.joyent.com/pub/build/pkgsrc"
 # Build defaults which are unlikely to change, but may be overridden by
 # configure-build.
 #
-if [[ ! -f configure-build ]]; then
-	source default.configure-build
+source default.configure-build
+if [[ -f configure-build ]]; then
+	source configure-build || fatal "failed to source configure-build"
 fi
 
 #
@@ -58,13 +59,6 @@ function fatal
 	exit 1
 }
 
-function source_vars
-{
-	if [[ -f "configure-build" ]]; then
-		source "$file" || fatal "failed to source configure-build"
-	fi
-}
-
 function check_loc
 {
 	[[ "$(readlink -f "$PWD")" != "$(readlink -f "$conf_arg0_dir")" ]] && \
@@ -478,8 +472,6 @@ read -r -d '' usage <<EOF
 		shadow compilers, comma delimited (gcc7,gcc#) [default: none]
 EOF
 
-source_vars
-
 while getopts "cdhp:rs:" arg; do
 	case $arg in
 	c)
