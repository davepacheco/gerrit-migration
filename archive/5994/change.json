{"project":"joyent/illumos-joyent","branch":"master","id":"I66c8cdb14b0af20202102312be2839cccfcbe528","number":"5994","subject":"OS-7669 Want CPU Temperature Sensors OS-7677 i86pc chip module should be smatch clean Reviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e Reviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.co","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/5994","commitMessage":"OS-7669 Want CPU Temperature Sensors\nOS-7677 i86pc chip module should be smatch clean\nReviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\nReviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1553123415,"lastUpdated":1557253899,"open":false,"status":"MERGED","comments":[{"timestamp":1553123415,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1553123485,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1553123536,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1555452356,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 2:\n\n(25 comments)\n\nThanks for letting me take my time on this one! I learned a lot, and these changes are really interesting."},{"timestamp":1555520085,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3."},{"timestamp":1555520119,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(19 comments)"},{"timestamp":1556212390,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 4."},{"timestamp":1556212449,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\nThere were some changes here because of conflicting merges. Also, I refactored the sensor bits in the FM topo area to make it so that they\u0027re a little more generic as I was otherwise going to duplicate it in some follow up work."},{"timestamp":1556218089,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 4: Code-Review+1\n\n(7 comments)"},{"timestamp":1556278890,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 4: Code-Review+1\n\n(1 comment)"},{"timestamp":1556285157,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 5."},{"timestamp":1556286802,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(3 comments)"},{"timestamp":1556287120,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1556295559,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(20 comments)"},{"timestamp":1556313664,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 6."},{"timestamp":1556313666,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(20 comments)"},{"timestamp":1556314719,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 6:\n\n(6 comments)"},{"timestamp":1556320201,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 7."},{"timestamp":1556320206,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6:\n\n(3 comments)"},{"timestamp":1556378865,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1556379215,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1556379937,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1556644878,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1556804368,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1556916944,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1556923006,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1557253446,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 8: Patch Set 7 was rebased."},{"timestamp":1557253661,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 9: Commit message was updated."},{"timestamp":1557253899,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"9","revision":"66c8cdb14b0af20202102312be2839cccfcbe528","parents":["cc59441dae061aa8d400c05f9b740d4126017e99"],"ref":"refs/changes/94/5994/9","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1557253661,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556644878,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556804368,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556916944,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556923006,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1557253899,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1015,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2826,"sizeDeletions":-53},"patchSets":[{"number":"1","revision":"81febe12549f0a71b80be1c722190ce4dcce1d50","parents":["c33a1acb9de8b5fce4525488909de95b5ab558bf"],"ref":"refs/changes/94/5994/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1553123415,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":123,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s not clear yet whether or not we\u0027ll end up sorting out the issue with the CMI interface and MSRs. If we can sort it out, then all of this will disappear in favor of cmi_hdl_rdmsr()."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":318,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":9,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":977,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":789,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2711,"sizeDeletions":-51},{"number":"2","revision":"cfd181ffb8af98454f7687718af440cdb7578acb","parents":["c33a1acb9de8b5fce4525488909de95b5ab558bf"],"ref":"refs/changes/94/5994/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1553123536,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","comments":[{"file":"usr/src/cmd/devfsadm/devfsadm.c","line":2078,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"nit: drop this word? i.e., \"operate on multiple classes of devices\""},{"file":"usr/src/cmd/devfsadm/devfsadm.c","line":2078,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/cmd/devfsadm/devfsadm.c","line":2079,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Is this a minor node?"},{"file":"usr/src/cmd/devfsadm/devfsadm.c","line":2079,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, I tried to clarify this a bit. Is that clearer?"},{"file":"usr/src/cmd/devfsadm/devfsadm.c","line":2079,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Yes, thanks."},{"file":"usr/src/man/man7d/Makefile","line":15,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Do we need to update the copyright here?"},{"file":"usr/src/man/man7d/Makefile","line":15,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/sensors.h","line":24,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I\u0027ve never seen this type of request in a code comment before. Is the expectation that people will look at the git history and contact you?"},{"file":"usr/src/uts/common/sys/sensors.h","line":24,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I was trying to put it there to suggest they reach out to the broader illumos community. I\u0027ve removed the sentence for the time being."},{"file":"usr/src/uts/common/sys/sensors.h","line":42,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"FAHRENHEIT\"? :)"},{"file":"usr/src/uts/common/sys/sensors.h","line":42,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/sensors.h","line":45,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"What is the reasoning for this? It seems like it is intentionally arbitrary to me, but I just want to make sure that\u0027s right."},{"file":"usr/src/uts/common/sys/sensors.h","line":45,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"ioctls exist in a global namespace effectively. There\u0027s a single integer that\u0027s given which can be used to indicate what the command is supposed to do. A given device may need to handle multiple different types of commands from different sets. As such, the defacto way to pick a command is to use three letters to try and create a unique space so you\u0027re unlikely to overlap at all. Different drivers will use different letters as a code so that way we can try and avoid overlapping.\n\nAll in all, it\u0027s kind of a wart, but there\u0027s no great way to do otherwise with the current design of ioctl. Does that help clarify where that\u0027s coming from and why it exists?"},{"file":"usr/src/uts/common/sys/sensors.h","line":59,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"granularity\""},{"file":"usr/src/uts/common/sys/sensors.h","line":59,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/sensors.h","line":60,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Suggestion to make it a bit clearer:\n\n\"The sit_temp member indicates the granularity: the number of increments per degree in the temperature measurement.\""},{"file":"usr/src/uts/common/sys/sensors.h","line":60,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think that\u0027s clearer, though it is sit_gran that indicates this."},{"file":"usr/src/uts/common/sys/sensors.h","line":62,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"perhaps: \"actual value in degrees\" to reiterate what the final unit is?"},{"file":"usr/src/uts/common/sys/sensors.h","line":62,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/common/sys/sensors.h","line":65,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"It took me awhile to understand this part. If I understand correctly, there are two broad cases of sit_gran, which have pretty different behaviors:\n1. positive value: temperature \u003d 1/sit_gran * sit_temp\n2. negative value: temperature \u003d (-1) * sit_gran * sit_temp\n\nIs that correct?\n\nTo make it a bit clearer, I would suggest mentioning the fact that sit_gran is signed first, then elucidate with examples of a positive and negative value."},{"file":"usr/src/uts/common/sys/sensors.h","line":65,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"That\u0027s correct. I\u0027ve rearranged things a bit at your suggestion."},{"file":"usr/src/uts/common/sys/sunddi.h","line":265,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Should this be added to the man page for ddi_create_minor_node(9F)?"},{"file":"usr/src/uts/common/sys/sunddi.h","line":265,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, I don\u0027t think it needs to be at this point. Right now the whole sensor framework is pretty vague and under a lot of flux. It\u0027s not clear that we\u0027ll want to have that be a committed interface, which I feel like documenting it there would suggest. The node type being public makes sense when we can then do other things based on that and have certain expectations."},{"file":"usr/src/uts/common/sys/sunddi.h","line":265,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Thanks for the explanation."},{"file":"usr/src/uts/intel/Makefile.rules","line":313,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Just making sure: Was this an intentional change?"},{"file":"usr/src/uts/intel/Makefile.rules","line":313,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Are you looking at an inter-revision change? I suspect this\u0027ll show up because I rebased the change."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":19,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Should we add a brief explanation of what these are?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":19,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve tried to add something here, how is it?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":19,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"That\u0027s good. Thanks."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":20,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"nit: put this in quotation marks? i.e., \u0027\"processor node\" in cpuid.c parlance\u0027"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":20,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":35,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"perhaps: \"is mapping northbridges and data fabric devices to their corresponding CPUs\"?\nIs the mapping not the same for both directions?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":39,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"This sentence confused me a bit, I think because it\u0027s a little long.\n\nSuggested revision:\n\"This is not as straightforward as we would like it to be, as there is no direct means of mapping a CPU to its corresponding northbridge. This mapping is crucial for temperature sensors: We need to know which northbridge maps to the die we want.\""},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":41,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"nit: s/this/the mapping"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":44,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"also on PCI Bus 0?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":44,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":50,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"map what together?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":52,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"by the AMD platform\"?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":52,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"not a guarantee\"?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":57,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I had a lot of trouble following the description of how to map CPUs to northbridges and data fabrics. I added a few clarifying questions that may help. I think most of my confusion came from not knowing what different pronouns referred to."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":57,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve rewritten all of this. I hope it\u0027ll be a little bit clearer."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":57,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Thanks; this rewrite is much clearer."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":759,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"\"northbridges\"?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":759,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":760,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"same here"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":760,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":124,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Should we name the routine here specifically to be unambiguous? I am also wondering if a warning comment should be added to the source of that routine (if there isn\u0027t already)."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":124,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027ve added that here. I\u0027m not sure the best place to note it in the surrounding code, because its safety depends a bit on the platform and whether or not you\u0027re on the CPU you\u0027re calling this from."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":650,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I\u0027m not sure I follow this part. Is it guaranteed that nothing else could call into the driver, or programs should not do that?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":650,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This isn\u0027t as clear in the manuals as it should be. During attach(9E) you can\u0027t have your other cb ops and entry points called. This is in detach(9E):\n\nThe system guarantees that the function will only be called for a particular dev_info node after (and not concurrently with) a successful attach(9E) of that device. The system also guarantees that detach() will only be called when there are no outstanding open(9E) calls on the device.\n\nI\u0027ve actually decided we should just remove the comment as it\u0027s not worth the additional confusion here. There\u0027s no harm in taking locks in this context."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":6,"deletions":0},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":318,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":9,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":977,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":789,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2711,"sizeDeletions":-51},{"number":"3","revision":"538ac85e66dc94263b327565e4026ff625125e26","parents":["6dec4a05385ed1b5f25175e319c87f8e96dd992f"],"ref":"refs/changes/94/5994/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1555520085,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":65,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Looks like this shouldn\u0027t be there."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":65,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":2,"deletions":-5},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":318,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":44,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1014,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":106,"deletions":-12}],"sizeInsertions":2751,"sizeDeletions":-56},{"number":"4","revision":"cd0f59543f7d2516ec0218ba8c0e2debb624e8d5","parents":["ce79a84f945c46383786999babb4bcf38fd56a43"],"ref":"refs/changes/94/5994/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1556212390,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556218089,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556278890,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":46,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I like this description!"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":65,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"remove asterisk"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":65,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1014,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2825,"sizeDeletions":-53},{"number":"5","revision":"500e828089fa7120f0fe352e7035d6f8e7e43b06","parents":["c0fe56ca3adfe07b5bb3969d7e73386e349eb357"],"ref":"refs/changes/94/5994/5","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1556285157,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556287120,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","line":65,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Any reason to prefer this over bzero? (here and below)"},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","line":65,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t think there\u0027s a big reason one way or the other. In userland at least, bzero is implemented in terms of memset."},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","line":122,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Could make this const"},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","line":122,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":357,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why bother with a non-void return type if this can\u0027t fail?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":357,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Good question. I wonder if I should go back and add FM support in a future rev. As I suspect other things will ultimately end up consuming the smn interfaces (memory controller drivers), I\u0027d like to keep it this way for now, if that\u0027s OK?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":357,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"That\u0027s fine"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":435,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"style nit: This might be a little cleaner by declaring a local pointer to the map with a shorter name?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":435,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is the new version clearer?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":435,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yeah, modulo the noted continuation"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":693,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why not sizeof (temp)?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":693,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Historically I\u0027ve tried to use the type, but I guess it\u0027s probably clearer here to do otherwise."},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":897,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Should we be destroying the idspace prior to cleaning up the resources below which possess IDs in it?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":897,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Ugh no, we shouldn\u0027t. I\u0027m not sure why that didn\u0027t blow up in my testing."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":125,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: a little redundant"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":125,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: Not sure if this break is appropriate, grammar-wise"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":125,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":125,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"How\u0027s the new version?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":125,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Much better, thanks."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"point of reference: In my recent HMA work, I simply skipped the kpreempt check, since the xcall logic will short circuit to the basic function call if the target is the current CPU.\n\nMaybe it\u0027s good to be simple? (or not?)"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I believe we need this right now and it would be erroneous to remove it. We don\u0027t want to do a crosscall to ourselves to read this when we can avoid it. As such, if we want to have the shortcut to operate on ourselves, then we must disable pre-emption, otherwise we can be pre-empted and run on another CPU. This is logically equivalent to what cmi_hdl_rdmsr() would have done."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yeah, the preemption protection is needed if you don\u0027t want to xcall yourself.  For HMA, the behavior is so infrequent that a single self-xcall seemed cheap when compared to the extra logic.  This is fine if you want to keep it as-is."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, I\u0027d prefer not to x-call myself and interrupt if we can avoid it."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"AFAICT, xc_common will skip the interrupt for xcalls directed at the current CPU.  It will go through the effort of allocating the slot for the xcall data, but after that, it\u0027ll just fall through to processing it in xc_serv.\n\nRegardless, it\u0027s not a big deal."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"You\u0027re right there; however, it appears while xc_common is changing the spl, it\u0027s not touching pre-emption, so I think it\u0027s still required."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":135,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Raising the spl that high effectively masks all interrupts (in apix, it literally does cli()), I think."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":213,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Does it make sense to compare against CORETEMP_MINOR_MIN here, rather than the 0 sentinel?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":213,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":226,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: capitalize?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":226,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/In the/The/"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":226,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":226,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":229,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/was/is"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":229,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I rephrased this a bit."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":388,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"why not sizeof (kind) (here and below)?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":388,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"It\u0027s just how I\u0027ve always written things. I think it\u0027s a habit from when I have pointers."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":392,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Is there sense in constraining the mode like this before passing it to ddi_copyout?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":392,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, I believe we should only pass in the bits that we know of and have meaning to us. We could easily imagine a future bit that has meaning, but requires us to do something different in the driver."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":449,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why not sizeof (temp)?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":449,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":585,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If we believe the buffer is appropriately sized for whatever is stored in \u0027ctc\u0027, would it make sense to just VERIFY these?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":585,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I\u0027d rather it just be a runtime failure rather than panicking, so someone can boot, if something gets messed up."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":585,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I mean, since the contents and sizing of the string are completely controlled by us, it seems to me like failure would be a programmer error, not runtime.\n\nJust my 2c.  Up to you."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":585,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, I understand."},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":634,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"the module interface will serialize attach/detach to keep this kind of check safe, right?"},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","line":634,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yes, it\u0027s supposed to do so."},{"file":"usr/src/uts/intel/sys/x86_archext.h","line":249,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/CUPID/CPUID"},{"file":"usr/src/uts/intel/sys/x86_archext.h","line":249,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"usr/src/uts/intel/sys/x86_archext.h","line":252,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"s/CUPID/CPUID"},{"file":"usr/src/uts/intel/sys/x86_archext.h","line":252,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1014,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2825,"sizeDeletions":-53},{"number":"6","revision":"a25b3059c50db9ec54ea9f4d64fd13f1b064ee8e","parents":["c0fe56ca3adfe07b5bb3969d7e73386e349eb357"],"ref":"refs/changes/94/5994/6","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1556313664,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":433,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This continuation shouldn\u0027t be necessary now, right?"},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","line":433,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Haha, yeah, it doesn\u0027t need to be there."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1016,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2827,"sizeDeletions":-53},{"number":"7","revision":"b9cdddea91687223977256d99b33b438db4650bd","parents":["c0fe56ca3adfe07b5bb3969d7e73386e349eb357"],"ref":"refs/changes/94/5994/7","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1556320201,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556923006,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556644878,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556916944,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556804368,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1015,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2826,"sizeDeletions":-53},{"number":"8","revision":"cd5e62350794d1f9a1b99fc7c1fde184e84a80c8","parents":["cc59441dae061aa8d400c05f9b740d4126017e99"],"ref":"refs/changes/94/5994/8","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1557253446,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556923006,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556644878,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556916944,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556804368,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1015,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2826,"sizeDeletions":-53},{"number":"9","revision":"66c8cdb14b0af20202102312be2839cccfcbe528","parents":["cc59441dae061aa8d400c05f9b740d4126017e99"],"ref":"refs/changes/94/5994/9","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1557253661,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1557253899,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556923006,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556644878,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556916944,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556804368,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":7,"deletions":-1},{"file":"usr/src/cmd/devfsadm/Makefile.com","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/cmd/devfsadm/devfsadm.c","type":"MODIFIED","insertions":16,"deletions":-5},{"file":"usr/src/cmd/devfsadm/sensor_link.c","type":"ADDED","insertions":79,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.c","type":"ADDED","insertions":261,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/common/shared/topo_sensor.h","type":"ADDED","insertions":34,"deletions":0},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/Makefile","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.c","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip.h","type":"MODIFIED","insertions":6,"deletions":-1},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_label.c","type":"MODIFIED","insertions":5,"deletions":-3},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_subr.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/fm/topo/modules/i86pc/chip/chip_temp.c","type":"ADDED","insertions":91,"deletions":0},{"file":"usr/src/man/man7d/Makefile","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"usr/src/man/man7d/amdf17nbdf.7d","type":"ADDED","insertions":53,"deletions":0},{"file":"usr/src/man/man7d/coretemp.7d","type":"ADDED","insertions":49,"deletions":0},{"file":"usr/src/uts/common/sys/Makefile","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/uts/common/sys/sensors.h","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/common/sys/sunddi.h","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"usr/src/uts/i86pc/os/cpuid.c","type":"MODIFIED","insertions":43,"deletions":-5},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"usr/src/uts/intel/Makefile.intel","type":"MODIFIED","insertions":12,"deletions":-6},{"file":"usr/src/uts/intel/Makefile.rules","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"usr/src/uts/intel/amdf17nbdf/Makefile","type":"ADDED","insertions":47,"deletions":0},{"file":"usr/src/uts/intel/coretemp/Makefile","type":"ADDED","insertions":54,"deletions":0},{"file":"usr/src/uts/intel/io/amdf17nbdf/amdf17nbdf.c","type":"ADDED","insertions":1015,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.c","type":"ADDED","insertions":784,"deletions":0},{"file":"usr/src/uts/intel/io/coretemp/coretemp.conf","type":"ADDED","insertions":16,"deletions":0},{"file":"usr/src/uts/intel/sys/x86_archext.h","type":"MODIFIED","insertions":105,"deletions":-11}],"sizeInsertions":2826,"sizeDeletions":-53}],"allReviewers":[{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}]}