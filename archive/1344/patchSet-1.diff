From 8a9b37a46d79c1aedda1213f168b0e3cf307b3a4 Mon Sep 17 00:00:00 2001
From: Josh Wilsdon <jwilsdon@joyent.com>
Date: Wed, 25 Jan 2017 19:45:32 -0800
Subject: [PATCH] TOOLS-1662 sdcadm add-new-agent-svcs fails with: TypeError:
 Cannot read property 'params' of undefined

---
 lib/cli/do_add_new_agent_svcs.js | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/lib/cli/do_add_new_agent_svcs.js b/lib/cli/do_add_new_agent_svcs.js
index 62e782c..dadffc2 100644
--- a/lib/cli/do_add_new_agent_svcs.js
+++ b/lib/cli/do_add_new_agent_svcs.js
@@ -146,8 +146,7 @@ function do_add_new_agent_svcs(subcmd, opts, args, cb) {
                         }
                         if (!svcs.length) {
                             newAgentServices.push(agent);
-                        }
-                        if (!svcs[0].params.image_uuid) {
+                        } else if (!svcs[0].params.image_uuid) {
                             agentServices[agent] = svcs[0];
                             updateAgentServices.push(agent);
                         }
-- 
2.21.0

