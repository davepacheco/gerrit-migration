commit 61e5828b10f124c1daf5b37d6b29129c7e687359 (refs/changes/44/1344/2)
Author: Josh Wilsdon <jwilsdon@joyent.com>
Date:   2017-01-25T19:46:37-08:00 (2 years, 8 months ago)
    
    TOOLS-1662 sdcadm add-new-agent-svcs fails with: TypeError: Cannot read property 'params' of undefined

diff --git a/lib/cli/do_add_new_agent_svcs.js b/lib/cli/do_add_new_agent_svcs.js
index 62e782c..dadffc2 100644
--- a/lib/cli/do_add_new_agent_svcs.js
+++ b/lib/cli/do_add_new_agent_svcs.js
@@ -146,8 +146,7 @@ function do_add_new_agent_svcs(subcmd, opts, args, cb) {
                         }
                         if (!svcs.length) {
                             newAgentServices.push(agent);
-                        }
-                        if (!svcs[0].params.image_uuid) {
+                        } else if (!svcs[0].params.image_uuid) {
                             agentServices[agent] = svcs[0];
                             updateAgentServices.push(agent);
                         }
diff --git a/package.json b/package.json
index fe744b9..4f49452 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "sdcadm",
   "description": "Administer a SmartDataCenter (SDC) standup",
-  "version": "1.15.1",
+  "version": "1.15.2",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
