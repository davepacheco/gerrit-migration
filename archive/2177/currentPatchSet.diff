commit 0eab4f0a6d55802dc60181aad17591416b8ca86a (refs/changes/77/2177/1)
Author: Sean Chittenden <sean@chittenden.org>
Date:   2017-07-01T09:29:47-07:00 (2 years, 3 months ago)
    
    Increase the performance of the backup dataset.

diff --git a/pg_dump/pg_backup_common.sh b/pg_dump/pg_backup_common.sh
index 6bfd0c9..e471947 100644
--- a/pg_dump/pg_backup_common.sh
+++ b/pg_dump/pg_backup_common.sh
@@ -97,8 +97,9 @@ function mount_data_set
 {
     # destroy the dump dataset if it already exists
     zfs destroy -R $DUMP_DATASET
-    # clone the current snapshot. Disable sync for faster performance.
-    zfs clone -o sync=disabled $ZFS_SNAPSHOT $DUMP_DATASET
+    # clone the current snapshot. Tune logbias and disable sync for faster
+    # performance.
+    zfs clone -o sync=disabled -o logbias=throughput $ZFS_SNAPSHOT $DUMP_DATASET
     [[ $? -eq 0 ]] || fatal "unable to clone snapshot"
     echo "successfully mounted dataset"
     # remove recovery.conf so this pg instance does not become a slave
