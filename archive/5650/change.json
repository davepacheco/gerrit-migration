{"project":"joyent/boray","branch":"master","id":"I285fdbf37544e164cee853a58453d5d61fe1dcaf","number":"5650","subject":"joyent/boray#4 add support for \"listobjects\" Reviewed by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e Approved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e","owner":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"url":"https://cr.joyent.us/5650","commitMessage":"joyent/boray#4 add support for \"listobjects\"\nReviewed by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e\nApproved by: Kelly McLaughlin \u003ckelly.mclaughlin@joyent.com\u003e\n","createdOn":1551296972,"lastUpdated":1551735439,"open":false,"status":"MERGED","comments":[{"timestamp":1551296972,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 1."},{"timestamp":1551296976,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 4cd3662b94aa7a6c97887a0252faeab3250a1ce8\n    \n    initial commit"},{"timestamp":1551297023,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1551297027,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 93c809cfabb845270300363916acfec9ccbbf13f\n    \n    initial commit"},{"timestamp":1551484611,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2:\n\nI\u0027m seeing this error testing out the different changes:\n\n```\n{\"msg\":\"failed to process connection\",\"v\":0,\"name\":\"slog-rs\",\"level\":50,\"time\":\"2019-03-01T23:53:03.225474520+00:00\",\"hostname\":\"539ac6ae-787f-493d-ff9d-c3faefa79183\",\"pid\":91799,\"build-id\":\"0.1.0\",\"err\":\"Failed to parse JSON data as payload for listobjects function\"}\n```\n\nLooking at the electric-boray log output I can see the problem is that the bucket name is being used for the bucket id rather than the UUID of the bucket:\n\n```\n[2019-03-01T23:53:03.224Z] DEBUG: electric-moray/FastClientRequest/899428 on be5401a5-37f3-cd3c-c54f-c5d219a7f453 (/root/electric-boray/node_modules/boray/node_modules/fast/lib/fast_client.js:254 in FastClient.rpc): rpc listobjects: entered (req_id\u003df97cd948-21e9-66ac-f4ea-81fa3edf1a5e, domain\u003d10.12.26.19, msgid\u003d2, rpcmethod\u003dlistobjects, timeoutms\u003dnull)\n    rpcargs: [\n      {\n        \"owner\": \"14aafd84-a57f-11e8-8706-4fc23c74c5e7\",\n        \"bucket_id\": \"mybucket1\",\n        \"vnode\": 0\n      }\n    ]\n```\n\nI think I updated all the components to the right branch, but maybe I missed something. Are the requests using the bucket UUID for you?"},{"timestamp":1551735109,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1551735432,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1551735439,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dave Eddy"}],"currentPatchSet":{"number":"3","revision":"285fdbf37544e164cee853a58453d5d61fe1dcaf","parents":["138d13e5261957e0248a9dbf496ad9d48a533367"],"ref":"refs/changes/50/5650/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1551735432,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"SUBM","value":"1","grantedOn":1551735439,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/main.rs","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/object.rs","type":"MODIFIED","insertions":70,"deletions":0}],"sizeInsertions":71,"sizeDeletions":0},"patchSets":[{"number":"1","revision":"0ae203860ff5af8613d6b2b667b9ee2a73cf5898","parents":["3f78167fc4525341c7aa600da910c81b190d6653"],"ref":"refs/changes/50/5650/1","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1551296972,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/main.rs","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/object.rs","type":"MODIFIED","insertions":70,"deletions":0}],"sizeInsertions":71,"sizeDeletions":0},{"number":"2","revision":"d9d8582493eb25272739094891b5f59274726bee","parents":["138d13e5261957e0248a9dbf496ad9d48a533367"],"ref":"refs/changes/50/5650/2","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1551297023,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/main.rs","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/object.rs","type":"MODIFIED","insertions":70,"deletions":0}],"sizeInsertions":71,"sizeDeletions":0},{"number":"3","revision":"285fdbf37544e164cee853a58453d5d61fe1dcaf","parents":["138d13e5261957e0248a9dbf496ad9d48a533367"],"ref":"refs/changes/50/5650/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1551735432,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1551735439,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1551735109,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/main.rs","type":"MODIFIED","insertions":1,"deletions":0},{"file":"src/object.rs","type":"MODIFIED","insertions":70,"deletions":0}],"sizeInsertions":71,"sizeDeletions":0}],"allReviewers":[{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}