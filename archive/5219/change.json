{"project":"joyent/sdc-vmapi","branch":"master","id":"Ia63cb5721db34e917034bf80b0b13df28eb9e1ab","number":"5219","subject":"TRITON-962 Add `CreateDisk`, `ResizeDisk` and `DeleteDisk` end-points to VMAPI Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Reviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e Approved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/5219","commitMessage":"TRITON-962 Add `CreateDisk`, `ResizeDisk` and `DeleteDisk` end-points to VMAPI\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nReviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\nApproved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\n","createdOn":1544510803,"lastUpdated":1550767671,"open":false,"status":"MERGED","comments":[{"timestamp":1544510803,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1544510837,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544510837,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\nsdcadm up vmapi@893a2542-fd0b-11e8-b097-23efc7c553fb --channel\u003dexperimental"},{"timestamp":1545319661,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\n(2 comments)\n\nPersonal preference comment about when to use return and next added once. Adding it three times sounds redundant. I assume tests depend on the pending Bhyve ones, correct?"},{"timestamp":1545903415,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1545903450,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545928889,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\n(1 comment)\n\nI\u0027m not sure that \"slot\" is the right key.  I\u0027ve sent email to start a discussion on this."},{"timestamp":1546596989,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 3."},{"timestamp":1546597022,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1546597124,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 2:\n\nsdcadm up vmapi@6b777770-1008-11e9-a100-db2ed9258a61 --channel\u003dexperimental"},{"timestamp":1546605852,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1546839901,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1546903148,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1547354450,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 4."},{"timestamp":1547354485,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1547658752,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1547664934,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4:\n\ntests?"},{"timestamp":1548259738,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1550595756,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 5."},{"timestamp":1550595787,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550617137,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1550764282,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1550767502,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1550767533,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1550767662,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1550767671,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Marsell Kukuljevic"}],"currentPatchSet":{"number":"7","revision":"369b1655cf64acadceafa1b9063905ca0725a410","parents":["797aaa00701c833ad383adf22eb8dd18cb312f42"],"ref":"refs/changes/19/5219/7","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550767662,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550595787,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550617137,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1550767671,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":234,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"test/vms.disks.test.js","type":"ADDED","insertions":405,"deletions":0}],"sizeInsertions":840,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"db7adbf1c8e7a8fc5f8d5cb0870ccb6c6dfd1449","parents":["dd962afdd4ac74b8580cec072d1abc1a888d6771"],"ref":"refs/changes/19/5219/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1544510803,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544510837,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/vms.js","line":858,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Personal preference, but I\u0027d like next call, then return, since we\u0027re actually returning nothing but moving forward."},{"file":"lib/endpoints/vms.js","line":874,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Ditto"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":74,"deletions":-2},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":182,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":334,"sizeDeletions":-6},{"number":"2","revision":"99bd766a6b9f7b3a7eab6830b8cabf844ac3f2c4","parents":["bff75369888f566015f361d3a7775d3a50274662"],"ref":"refs/changes/19/5219/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1545903415,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545903450,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/vms.js","line":975,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"d"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":74,"deletions":-2},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":198,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":350,"sizeDeletions":-6},{"number":"3","revision":"485f658f83446c5e6a74e3b3f6c4a41fbc071bc3","parents":["bff75369888f566015f361d3a7775d3a50274662"],"ref":"refs/changes/19/5219/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1546596989,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1546597022,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":1443,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This range (0:4:*) is typically used for cdroms, which seems to be poorly supported or unsupported through triton.  Probably best to not suggest this range."},{"file":"docs/index.md","line":1443,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Mention that it is optional and that if not specified it will be automatically assigned.\n\nSomewhere (near \"## Delegate Dataset\"?) we may also want to caution that function (bus:device:function) must be 0 unless the bus:device already has something in function 0.  Removal of the function 0 device is not allowed while another function is present on that bus:device.  This is all spelled out in vmadm(1M) at disks.*.pci_slot."},{"file":"docs/index.md","line":1443,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Not 0:3:*? bhyve is assigning disks to 0:4:* by default...\n\nI\u0027ve changed all the docs to use 0:5:* instead of 0:4:* here and in cloudapi, but I\u0027d like confirmation of the above before I commit anything."},{"file":"docs/index.md","line":1443,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"yeah, sorry.  0:3:* is used for cdroms.  We should be encouraging the use of 0:4:* for disks (that\u0027s the automatic assignment range).  0:5:* is fine too - those slots have been used in the past for disks."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":76,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":231,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":421,"sizeDeletions":-6},{"number":"4","revision":"d6cf8b847b5245b09847d874294798ca27949650","parents":["bff75369888f566015f361d3a7775d3a50274662"],"ref":"refs/changes/19/5219/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1547354450,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1547354485,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1547658752,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548259738,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":235,"deletions":-2},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":437,"sizeDeletions":-7},{"number":"5","revision":"a63cb5721db34e917034bf80b0b13df28eb9e1ab","parents":["47b969ad57ba142a91368953b3a59d526023d722"],"ref":"refs/changes/19/5219/5","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550595756,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550595787,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550617137,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":234,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"test/vms.disks.test.js","type":"ADDED","insertions":405,"deletions":0}],"sizeInsertions":840,"sizeDeletions":-5},{"number":"6","revision":"e2588b1eb9687a03f0c7deef8525b5e59c985a50","parents":["797aaa00701c833ad383adf22eb8dd18cb312f42"],"ref":"refs/changes/19/5219/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550767502,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550595787,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550617137,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":234,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"test/vms.disks.test.js","type":"ADDED","insertions":405,"deletions":0}],"sizeInsertions":840,"sizeDeletions":-5},{"number":"7","revision":"369b1655cf64acadceafa1b9063905ca0725a410","parents":["797aaa00701c833ad383adf22eb8dd18cb312f42"],"ref":"refs/changes/19/5219/7","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550767662,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550595787,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1550764282,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1550767671,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1550617137,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":88,"deletions":-2},{"file":"lib/common/validation.js","type":"MODIFIED","insertions":36,"deletions":0},{"file":"lib/endpoints/vms.js","type":"MODIFIED","insertions":234,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":77,"deletions":-2},{"file":"test/vms.disks.test.js","type":"ADDED","insertions":405,"deletions":0}],"sizeInsertions":840,"sizeDeletions":-5}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}]}