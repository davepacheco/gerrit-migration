{"project":"joyent/node-cueball","branch":"master","id":"I1a24c7a9775185c4b8995c52b7bdc809fe016a0e","number":"2833","subject":"joyent/node-cueball#128 Allow configuring pool-wide queue drop policies Reviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e Approved by: Alex Wilson \u003calex.wilson@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/2833","commitMessage":"joyent/node-cueball#128 Allow configuring pool-wide queue drop policies\nReviewed by: Tim Kordas \u003ctim.kordas@joyent.com\u003e\nApproved by: Alex Wilson \u003calex.wilson@joyent.com\u003e\n","createdOn":1508540271,"lastUpdated":1512078326,"open":false,"status":"MERGED","comments":[{"timestamp":1508540271,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1508540338,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508540774,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1508540906,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508547041,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1508778235,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1508778747,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1508778842,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1508779010,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1508779037,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 4:\n\nI\u0027ve updated the tests to check the \"claim-timeouts\" counter I added."},{"timestamp":1508779116,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508781238,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1508781346,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1508781403,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1508877819,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1509041814,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 5:\n\nWe probably also want to add something to CHANGES.adoc ?\n2.5.0 hasn\u0027t been published to npm yet, so this could go into that along with my stats change ? (or is that not how versioning works?)."},{"timestamp":1509599232,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Code-Review+1\n\nYeah, update CHANGES.adoc and I reckon we can get this one out as part of 2.5.0 (which hasn\u0027t been tagged yet, was waiting to collect a few things like this with it)"},{"timestamp":1510073511,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6."},{"timestamp":1510073558,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1510080742,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1510178341,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 7."},{"timestamp":1510178395,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1510178398,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\n(1 comment)"},{"timestamp":1511218985,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"Patch Set 7: Code-Review+1\n\n(1 comment)"},{"timestamp":1512077226,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1512077781,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1512078326,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"8","revision":"8574f7bd18bc27548cda625829dc5fe35c9f4acb","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1512077781,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1510178395,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511218985,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512077226,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"SUBM","value":"1","grantedOn":1512078326,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":3,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"docs/internals.adoc","type":"MODIFIED","insertions":28,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":530,"sizeDeletions":-12},"patchSets":[{"number":"1","revision":"a5239be13a3f37154be7ac381aacda3f9f589b42","parents":["8be0307c79347f99cef63c26d6b93e423856b88b"],"ref":"refs/changes/33/2833/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1508540271,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508540338,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":299,"deletions":0}],"sizeInsertions":496,"sizeDeletions":-12},{"number":"2","revision":"074fdf225fd8562e6bf9378c91b961e3257b55f1","parents":["8be0307c79347f99cef63c26d6b93e423856b88b"],"ref":"refs/changes/33/2833/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1508540774,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1508547041,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508540906,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/api.adoc","line":170,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"a change of this magnitude seems like it ought to get a little more documentation than this. Maybe add a separate section somewhere, and include the link that you put in the source-code comment ?"},{"file":"docs/api.adoc","line":170,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I was hesitant to go into too much description here, so that the exact details aren\u0027t part of the API, but I realized that that\u0027s what the Cueball Internals document is for. I\u0027ve added a new section there."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":299,"deletions":0}],"sizeInsertions":496,"sizeDeletions":-12},{"number":"3","revision":"48a8d7e1074828e66501d24ef9ea8c6fc8f0a412","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1508778747,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1508547041,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508540906,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":299,"deletions":0}],"sizeInsertions":496,"sizeDeletions":-12},{"number":"4","revision":"b010bd2651f56a449567bc440cd617e505ea0997","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1508779010,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508779116,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":499,"sizeDeletions":-12},{"number":"5","revision":"5e98d90ae93a3bb015cd781ac51b9d2ed51c9828","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1508781238,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509599232,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1508781346,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1508877819,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"docs/internals.adoc","type":"MODIFIED","insertions":27,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":526,"sizeDeletions":-12},{"number":"6","revision":"c754fb46a50d1a587857f66df0e58bab6e2bc775","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1510073511,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1510073558,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/internals.adoc","line":216,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"it might be nice to clarify what it means to a request that it has been \"dropped\" via CoDel."},{"file":"docs/internals.adoc","line":216,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve added a description of the error that gets returned when it gets dropped. Is that what you were looking for?"},{"file":"docs/internals.adoc","line":216,"reviewer":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},"message":"yep! sounds good."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":3,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"docs/internals.adoc","type":"MODIFIED","insertions":27,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":529,"sizeDeletions":-12},{"number":"7","revision":"1a24c7a9775185c4b8995c52b7bdc809fe016a0e","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1510178341,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512077226,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1510178395,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511218985,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":3,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"docs/internals.adoc","type":"MODIFIED","insertions":28,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":530,"sizeDeletions":-12},{"number":"8","revision":"8574f7bd18bc27548cda625829dc5fe35c9f4acb","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/33/2833/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1512077781,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1512078326,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512077226,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1510178395,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1511218985,"by":{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":3,"deletions":0},{"file":"docs/api.adoc","type":"MODIFIED","insertions":2,"deletions":0},{"file":"docs/internals.adoc","type":"MODIFIED","insertions":28,"deletions":0},{"file":"lib/codel.js","type":"ADDED","insertions":118,"deletions":0},{"file":"lib/connection-fsm.js","type":"MODIFIED","insertions":17,"deletions":-6},{"file":"lib/pool.js","type":"MODIFIED","insertions":40,"deletions":-6},{"file":"lib/utils.js","type":"MODIFIED","insertions":20,"deletions":0},{"file":"test/codel.test.js","type":"ADDED","insertions":302,"deletions":0}],"sizeInsertions":530,"sizeDeletions":-12}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Tim Kordas","email":"tim.kordas@joyent.com","username":"timkordas"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}