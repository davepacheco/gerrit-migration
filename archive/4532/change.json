{"project":"joyent/sdc-dockerlogger","branch":"master","id":"I0b220f6e5e8fadd3e3203dc92cf15c80380a0770","number":"4532","subject":"TRITON-554 sdc-dockerlogger build fails when cloned to anything other than \u0027dockerlogger\u0027 Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"url":"https://cr.joyent.us/4532","commitMessage":"TRITON-554 sdc-dockerlogger build fails when cloned to anything other than \u0027dockerlogger\u0027\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1531904331,"lastUpdated":1532952920,"open":false,"status":"MERGED","comments":[{"timestamp":1531904331,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 1."},{"timestamp":1531904334,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1531904336,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 419687547963a181257dd8f8e492a7d04f032d7e\n    \n    TRITON-554 dockerlogger build fails when dirname !\u003d \u0027dockerlogger\u0027"},{"timestamp":1532020689,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1532097738,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 2."},{"timestamp":1532097740,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1532097744,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit c078964129681b23a32447804d4edb35f3ad306d\n    \n    TRITON-554 dockerlogger build fails when dirname !\u003d \u0027dockerlogger\u0027"},{"timestamp":1532097935,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 2:\n\nI made the change to the branch name computation and added quotes around \"$(BRANCH)\" as suggested.\n\nThe change to add | $(DESTDIR) didn\u0027t make a difference though - since this is a phony target, invoking it always runs the target, regardless as to whether anything has changed. mk-shar itself computes a new timestamp each time it\u0027s run, so we always produce a package with a new name."},{"timestamp":1532121383,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1532952894,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1532952920,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Tim Foster"}],"currentPatchSet":{"number":"3","revision":"0b220f6e5e8fadd3e3203dc92cf15c80380a0770","parents":["2926f3c7dc52d74948dd7c8551f931640780fbd2"],"ref":"refs/changes/32/4532/3","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1532952894,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1532097740,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1532952920,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":17,"deletions":-6}],"sizeInsertions":17,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"43b9312960f93777e93b73d5ce69e0f1d5e79e2c","parents":["2926f3c7dc52d74948dd7c8551f931640780fbd2"],"ref":"refs/changes/32/4532/1","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1531904331,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1531904334,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":15,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"FWIW, the eng.git makefiles get BRANCH via:\n```\n_AWK :\u003d $(shell (which gawk \u003e/dev/null \u0026\u0026 echo gawk) \\\n\t|| (which nawk \u003e/dev/null \u0026\u0026 echo nawk) \\\n\t|| echo awk)\nBRANCH :\u003d $(shell git symbolic-ref HEAD | $(_AWK) -F/ \u0027{print $$3}\u0027)\n```\n\nbut I\u0027m not fussed either way."},{"file":"Makefile","line":38,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"should that be a presence-only dep on the DESTDIR?\n\n```\npkg: dockerlogger.smartos | $(DESTDIR)\n...\n```\n\nI\u0027m not sure if adding a file under the destdir will change its timestamp such that it would be considered out of date again."},{"file":"Makefile","line":39,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps quote that \"$(BRANCH)\" in case an empty value or value with spaces is accidentally given."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":12,"deletions":-5}],"sizeInsertions":12,"sizeDeletions":-5},{"number":"2","revision":"a98d48f5ba50366abe48f7d1994a62282762b4b0","parents":["2926f3c7dc52d74948dd7c8551f931640780fbd2"],"ref":"refs/changes/32/4532/2","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1532097738,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1532097740,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":17,"deletions":-6}],"sizeInsertions":17,"sizeDeletions":-6},{"number":"3","revision":"0b220f6e5e8fadd3e3203dc92cf15c80380a0770","parents":["2926f3c7dc52d74948dd7c8551f931640780fbd2"],"ref":"refs/changes/32/4532/3","uploader":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"createdOn":1532952894,"author":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1532097740,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1532121383,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1532952920,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":17,"deletions":-6}],"sizeInsertions":17,"sizeDeletions":-6}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}]}