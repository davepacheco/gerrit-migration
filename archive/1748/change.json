{"project":"joyent/node-sshpk-agent","branch":"master","id":"I0a60379f19841c3203db50186d54aa18f9fffbb7","number":"1748","subject":"joyent/node-sshpk-agent#9 want to sign certificates using agent keys Reviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/1748","commitMessage":"joyent/node-sshpk-agent#9 want to sign certificates using agent keys\nReviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e\n","createdOn":1491343656,"lastUpdated":1492725116,"open":false,"status":"MERGED","comments":[{"timestamp":1491343656,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1491343684,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1491871171,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 1:\n\n(5 comments)"},{"timestamp":1491946948,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1491946951,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1491946969,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492016020,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 2: Code-Review+1\n\nThanks for answering those questions!"},{"timestamp":1492476906,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1492476928,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1492476946,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3:\n\nI\u0027ve documented the new functions and bumped the minor version again (because 1.5.0 was already released with the sha2 bits)"},{"timestamp":1492724708,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\nStill lgtm!"},{"timestamp":1492725035,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1492725071,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n\"make check\" passed ok"},{"timestamp":1492725098,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1492725116,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"5","revision":"c552f92730f63780e2a7d48512ff310e45ec6423","parents":["f6d36e7b9ddbaa92fe214712b6215c8c083d335e"],"ref":"refs/changes/48/1748/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1492725098,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492476928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"SUBM","value":"1","grantedOn":1492725116,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":46,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":171,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":330,"sizeDeletions":-30},"patchSets":[{"number":"1","revision":"621bfa6c7dc621b708ec8dac4027609d37b2b1bf","parents":["e47fb47ea19bb42971eb60a3da6ec6ca3bf17615"],"ref":"refs/changes/48/1748/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1491343656,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1491343684,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/client.js","line":195,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"I\u0027m not sure why these values get passed in to the buffer -- maybe a comment would be helpful here?"},{"file":"lib/client.js","line":195,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Added."},{"file":"lib/client.js","line":245,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Could 245-249 and 232-236 be pulled out into a common decorator?"},{"file":"lib/client.js","line":245,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Ok."},{"file":"lib/client.js","line":266,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Do you think it would be an unnecessary check to ensure that validFrom is before validUntil?"},{"file":"lib/client.js","line":266,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"It\u0027s... not unnecessary, as I think such certs would be in violation of X.509 (though by my reading it\u0027s kind of ambiguous). But we\u0027re trying to just do what sshpk already does, here. Maybe we should patch both of them to add that check later..."},{"file":"lib/client.js","line":333,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Why does `issuerKey` have to be its own parameter if it\u0027s also passed in as `cert.issuerKey`?"},{"file":"lib/client.js","line":333,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"cert.issuerKey is just a cache of the issuer key that\u0027s used if the cert came in from the openssh format (and thus contained a designated issuer key). When we\u0027re creating a cert, we also put it in so that we can include it in the openssh format we produce.\n\nThis is different to the key that\u0027s signing the certificate (particularly in x509, where the two can be different keys)."},{"file":"test/key-mgmt.test.js","line":111,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"It might be a good idea to also test a scenario with multiple ids."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":161,"deletions":-2},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":273,"sizeDeletions":-29},{"number":"2","revision":"15636a25c6ebd076ffa51086e9a5d251b93d6d3b","parents":["e47fb47ea19bb42971eb60a3da6ec6ca3bf17615"],"ref":"refs/changes/48/1748/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1491946948,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1491946969,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492016020,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":171,"deletions":-2},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":283,"sizeDeletions":-29},{"number":"3","revision":"0a60379f19841c3203db50186d54aa18f9fffbb7","parents":["e47fb47ea19bb42971eb60a3da6ec6ca3bf17615"],"ref":"refs/changes/48/1748/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1492476906,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492476928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":46,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":171,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":330,"sizeDeletions":-30},{"number":"4","revision":"ad9bd4edbe2c170bad80642eadd02a8831a229e4","parents":["f6d36e7b9ddbaa92fe214712b6215c8c083d335e"],"ref":"refs/changes/48/1748/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1492725035,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492476928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":46,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":171,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":330,"sizeDeletions":-30},{"number":"5","revision":"c552f92730f63780e2a7d48512ff310e45ec6423","parents":["f6d36e7b9ddbaa92fe214712b6215c8c083d335e"],"ref":"refs/changes/48/1748/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1492725098,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1492725116,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1492476928,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1492724708,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":46,"deletions":0},{"file":"lib/client.js","type":"MODIFIED","insertions":171,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/basic.test.js","type":"MODIFIED","insertions":71,"deletions":0},{"file":"test/key-mgmt.test.js","type":"MODIFIED","insertions":41,"deletions":-27}],"sizeInsertions":330,"sizeDeletions":-30}],"allReviewers":[{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}