{"project":"joyent/nginx","branch":"joyent/1.10.2","topic":"mako-mpu","id":"I747b5c0807f3cd5cd3967adccb09d722a039e515","number":"1336","subject":"MANTA-3115 want nginx mpu commit module Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Approved by: Dave Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/1336","commitMessage":"MANTA-3115 want nginx mpu commit module\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nApproved by: Dave Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1485373862,"lastUpdated":1486063652,"open":false,"status":"MERGED","comments":[{"timestamp":1485373862,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1485373920,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Topic set to mako-mpu"},{"timestamp":1485374143,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\nNote to reviewers: the files that begin with mpu_* were pulled in from some of our other projects to facilitate the JSON parsing and emission. They are not new for this project.\n\nThe main things which are new that matter are the build changes and the file src/http/modules/mpu/ngx_http_mpu_commit_module.c.\n\nTo see how this is consumed, I suggest you check the other review in this topic."},{"timestamp":1485474097,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(13 comments)\n\nI don\u0027t know anything about nginx, so I can\u0027t really review that aspect of this code, but I did have a few nitty comments."},{"timestamp":1485547914,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2."},{"timestamp":1485547929,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(13 comments)"},{"timestamp":1485562495,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2:\n\n(1 comment)\n\nJust one more small nit for me."},{"timestamp":1485563712,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1485810405,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(7 comments)"},{"timestamp":1485811765,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1485813268,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3."},{"timestamp":1485813273,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(7 comments)"},{"timestamp":1485889708,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1485908241,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1485971315,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\nTo test these changes (both the nginx specific changes and our own), I\u0027ve down the following:\n\n* Augmented the mako test suite to cover MPU success cases and errors\n* Specifically tested large offset streaming PUTs both via tests and via curl in different ways, which sends us down different nginx test paths\n* Left the tests running in a loop overnight and verified that once they were killed, there we did not leak any temporary files, file descriptors, have the nginx process grow beyond a reasonable amount of fragmentation, and verified that umem didn\u0027t find any leaks (though a large amount of the allocations are found on a per-request structures, so umem may not find things)\n* Went through the error / access logs and verified that there were no errors beyond our own logging of bad requests\n* Built images and verified that the SAPI manifests correctly were translated and successfully started nginx\n* Worked with Jordan to verify that this worked against muskie and worked against the actual nginx code paths that manta uses"},{"timestamp":1485977461,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1485981426,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3:\n\nIt looks like there are 2-3 dependencies here that came from elsewhere (at least jsonemitter and custr, and maybe json-nvlist?).  Based on our past experience, I\u0027m worried we\u0027ll end up creating forks of these when people don\u0027t realize they came from elsewhere, or realize it but create a fork out of laziness.  This has happened quite a bit with other components.  A few options for improving this:\n\n- add a note to the README (which could also explain where the canonical source is and how to keep them in sync)\n- remove the \"mpu_\" prefix so people can tell it\u0027s not part of the mpu functionality\n- put the sources into a \"deps\" subdirectory so it\u0027s clear they came from elsewhere\n- put these modules into top-level repositories (like we did for illumos-libavl) and incorporate them by submodule"},{"timestamp":1485993221,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 4."},{"timestamp":1486058934,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4:\n\nTo test these changes (both the nginx specific changes and our own), I\u0027ve down the following:\n\n* Augmented the mako test suite to cover MPU validation, large MPUs, correct removal of files after MPU commit, simultaneous racing commits, and subsequent commits worked\n* Specifically tested large offset streaming PUTs both via tests and via curl in different ways, which sends us down different nginx test paths\n* Verified that we were properly using the large file aware symbols in the built version of nginx\n* Left the tests running in a loop overnight and verified that once they were killed, there we did not leak any temporary files, file descriptors, have the nginx process grow beyond a reasonable amount of fragmentation, and verified that umem didn\u0027t find any leaks (though a large amount of the allocations are found on a per-request structures, so umem may not find things)\n* Went through the error / access logs and verified that there were no errors beyond our own logging of bad requests\n* Built images and verified that the SAPI manifests correctly were translated and successfully started nginx\n* Worked with Jordan to verify that this worked against muskie and worked against the actual nginx code paths that manta uses\n* Executed the alternate port and host aspects (via environment variables) of the test suite"},{"timestamp":1486059550,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1486061430,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4: Code-Review+1\n\nNice catch on the fsync race.  Additionally, the mpu_* -\u003e deps/* change is great."},{"timestamp":1486061518,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1486063354,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1486063652,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"5","revision":"747b5c0807f3cd5cd3967adccb09d722a039e515","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/5","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1486063354,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486059550,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486061430,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486061518,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1486063652,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1418,"deletions":0}],"sizeInsertions":3587,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"62eec6a8a6283f059d17810b5bc61a644c912f52","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1485373862,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"README.md","line":13,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Could we perhaps changes these to imperative phrasing?"},{"file":"README.md","line":13,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":31,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":31,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":36,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"append comma"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":36,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":58,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"can this portion be removed?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":58,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"change to \"happens\"?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":58,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":58,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":75,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"this sentence seems incomplete. should you change \"place\" to \"start\"?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":75,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":81,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"will the maintainers of this code know what an mblk_t is?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":81,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Haha, probably not, I guess."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":82,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"This sentence seems confusing. What \"things\" are you talking about? Are you saying that chaining is unsupported? Is having the buffer in memory unsupported?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":82,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":82,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"perhaps expand on this slightly?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":89,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"How do you know it has been done? Also, if there is not enough information then its not clear what you do next. Does it fail or how do you recover?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":89,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":94,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This will read easier if you specify what \"it\" is."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":94,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":107,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"of pointers, I assume?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":107,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":135,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"what is relinking?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":135,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I meant for renaming, but got caught up in thinking in terms of link(2)."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":195,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"change to \"is\"?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":195,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":439,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I assume this works like normal and will core dump the process? Is there is a reason we want to core dump on only this error (both here and elsewhere), but log all of the rest?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":439,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Mostly because this definitely represents a programmer error that we\u0027ve caused. There\u0027s no way that the request thta we got could have lead to this, only a bug in this module would result in an EFAULT.\n\nEffectively, I\u0027m declaring that EFAULT is always a programmer error in this module, hence the abort."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":456,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"since you get the stat out side of the loop, what happens if the file size grows? Do you want to read that too?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":456,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"The file shouldn\u0027t be growing at this point. We\u0027re only called back once nginx has finished streaming the file to disk from the user. It will no longer read anything at this point."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":691,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"It seems like this function deletes the input file on a bunch of error cases. Is that the correct behavior or should infile be left alone if the rename fails for some other reason?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":691,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"We should always delete the input file on failure, as this is a temporary file that we need to make sure we clean up ourselves. Nothing else will clean it up and we\u0027ll waste disk space otherwise.\n\nThe reason that this function does it as opposed to the places where we clean up in the calling function is that once we do the rename, we have to assume that nginx has another file with that name."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":711,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"why do you delete here when the buffer overflowed?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":711,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Because we\u0027ll fail the request and we don\u0027t want the temporary file to stick around on disk forever. If we don\u0027t clean it up, nothing else will."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":762,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"it"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":762,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Done"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":778,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Is this const cast necessary?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":778,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"No, it must have been left around from something else."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":1243,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Why split this across lines?"},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":1243,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I think got refactored and I missed it at some point during that."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1356,"deletions":0}],"sizeInsertions":3512,"sizeDeletions":-5},{"number":"2","revision":"45d626c961cef57fea48287ac602222f9070d9f2","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1485547914,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","comments":[{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":688,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I am happy with your responses to my CR comments. Can you add a comment to this function explaining the rationale you described in your CR comments."},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","line":688,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Yeah, I\u0027ll add something here to clarify that and get that respun. Thanks Jerry."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-5},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1353,"deletions":0}],"sizeInsertions":3509,"sizeDeletions":-5},{"number":"3","revision":"cdef893b0bea30ae909b954dfc55b8cca2469104","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1485813268,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1485889708,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1485908241,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1485977461,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":3,"deletions":-7},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/mpu_custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/mpu_json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/mpu_jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1383,"deletions":0}],"sizeInsertions":3541,"sizeDeletions":-7},{"number":"4","revision":"7664c3da3915423c7e382c8f3648ec13a0525ac4","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/4","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1485993221,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486061518,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486059550,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486061430,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1418,"deletions":0}],"sizeInsertions":3587,"sizeDeletions":-5},{"number":"5","revision":"747b5c0807f3cd5cd3967adccb09d722a039e515","parents":["281e0cbe9819786778738d9bb61772f1a57f5fbc"],"ref":"refs/changes/36/1336/5","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1486063354,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1486061518,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1486063652,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486059550,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1486061430,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"auto/make","type":"MODIFIED","insertions":1,"deletions":0},{"file":"auto/modules","type":"MODIFIED","insertions":9,"deletions":0},{"file":"auto/options","type":"MODIFIED","insertions":2,"deletions":0},{"file":"auto/sources","type":"MODIFIED","insertions":6,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.c","type":"ADDED","insertions":212,"deletions":0},{"file":"src/http/modules/mpu/deps/custr.h","type":"ADDED","insertions":80,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.c","type":"ADDED","insertions":941,"deletions":0},{"file":"src/http/modules/mpu/deps/json-nvlist.h","type":"ADDED","insertions":52,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.c","type":"ADDED","insertions":690,"deletions":0},{"file":"src/http/modules/mpu/deps/jsonemitter.h","type":"ADDED","insertions":162,"deletions":0},{"file":"src/http/modules/mpu/ngx_http_mpu_commit_module.c","type":"ADDED","insertions":1418,"deletions":0}],"sizeInsertions":3587,"sizeDeletions":-5}],"allReviewers":[{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}]}