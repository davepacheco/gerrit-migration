{"project":"joyent/sdc-ufds","branch":"master","id":"I983755eb0a9666e5c1d4dae3fbc8c0fc028c02dd","number":"2601","subject":"CAPI-534 ufds-master incorrectly checking moray for existence of pwdPolicy with empty string as key Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/2601","commitMessage":"CAPI-534 ufds-master incorrectly checking moray for existence of pwdPolicy with empty string as key\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\n","createdOn":1505834383,"lastUpdated":1505918622,"open":false,"status":"MERGED","comments":[{"timestamp":1505834383,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1505834389,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 5da776f2a526ce2f0a6ccb7eb3e678865190fb26\n    \n    CAPI-534 ufds-master incorrectly checking moray for existence of pwdPolicy with empty string as key"},{"timestamp":1505834417,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505837176,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(4 comments)"},{"timestamp":1505839063,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1505839068,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 181f7ccbefb2ff5c577f36111439861b81cb235e\n    \n    CAPI-534 ufds-master incorrectly checking moray for existence of pwdPolicy with empty string as key"},{"timestamp":1505839091,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505839099,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(4 comments)\n\nDone with the suggested changes Patrick"},{"timestamp":1505839155,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1505879792,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1505918447,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1505918597,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1505918603,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit b2faf7ac80abb7233b2b822ab4e6d298697caf7c\n    \n    CAPI-534 ufds-master incorrectly checking moray for existence of pwdPolicy with empty string as key"},{"timestamp":1505918622,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"983755eb0a9666e5c1d4dae3fbc8c0fc028c02dd","parents":["3ff5a93f43de6c2222545cbcbf971d49a8c372ac"],"ref":"refs/changes/01/2601/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1505918597,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505839091,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505879792,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505918447,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1505918622,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/salt.js","type":"MODIFIED","insertions":92,"deletions":-50}],"sizeInsertions":92,"sizeDeletions":-50},"patchSets":[{"number":"1","revision":"7dede075c2943b34ca720a5b788dda8bfaa50cf5","parents":["3ff5a93f43de6c2222545cbcbf971d49a8c372ac"],"ref":"refs/changes/01/2601/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1505834383,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505834417,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/salt.js","line":109,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Being short and entirely synchronous, couldn\u0027t this be merged with the subsequent function?"},{"file":"lib/salt.js","line":109,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/salt.js","line":134,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Another stretch of logic that could be merged with the function below."},{"file":"lib/salt.js","line":134,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/salt.js","line":137,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"If the req.exists() call yielded a negative result and the pwdpolicysubentry wasn\u0027t set, should we attempt this \u0027req.get()\u0027 on an empty key, or fail explicitly?"},{"file":"lib/salt.js","line":137,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"This can just be \u0027err\u0027, now that vasync is on the scene, right?"},{"file":"lib/salt.js","line":137,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I\u0027d say we\u0027re fine with the customer specific keys not existing. We\u0027ll just get the default pwdPolicy if there isn\u0027t anything specifically set. There will be no req.get() to empty key, since we\u0027ll always have the initialization value, though."},{"file":"lib/salt.js","line":137,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/salt.js","type":"MODIFIED","insertions":98,"deletions":-52}],"sizeInsertions":98,"sizeDeletions":-52},{"number":"2","revision":"18f9854da0f842dd3b2aa25b5025ecd5073f50b2","parents":["3ff5a93f43de6c2222545cbcbf971d49a8c372ac"],"ref":"refs/changes/01/2601/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1505839063,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505839091,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/salt.js","type":"MODIFIED","insertions":92,"deletions":-50}],"sizeInsertions":92,"sizeDeletions":-50},{"number":"3","revision":"974a07bfd9b3dcacdb8bfb7cceb144d6c143805e","parents":["3ff5a93f43de6c2222545cbcbf971d49a8c372ac"],"ref":"refs/changes/01/2601/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1505839155,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505839091,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505879792,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505918447,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/salt.js","type":"MODIFIED","insertions":92,"deletions":-50}],"sizeInsertions":92,"sizeDeletions":-50},{"number":"4","revision":"983755eb0a9666e5c1d4dae3fbc8c0fc028c02dd","parents":["3ff5a93f43de6c2222545cbcbf971d49a8c372ac"],"ref":"refs/changes/01/2601/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1505918597,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505839091,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505879792,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1505918447,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"SUBM","value":"1","grantedOn":1505918622,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/salt.js","type":"MODIFIED","insertions":92,"deletions":-50}],"sizeInsertions":92,"sizeDeletions":-50}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}