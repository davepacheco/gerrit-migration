commit 12b8a5907e920cd0dc8953b901c1ad32af794e1f (refs/changes/11/5211/1)
Author: Alex Wilson <alex.wilson@joyent.com>
Date:   2018-12-07T13:13:52-08:00 (10 months ago)
    
    MANTA-4042 confusing message when accessing unauthorized paths

diff --git a/lib/client.js b/lib/client.js
index 552fb8c..94aebe4 100644
--- a/lib/client.js
+++ b/lib/client.js
@@ -464,14 +464,17 @@ MahiClient.prototype.authorize = function authorize(opts) {
     }
 
     /*
-     * Deny if the caller or owner is not approved for provisioning.
-     * Operators will have been allowed access above regardless of approved
-     * for provisioning status on their account or the owner of the resource.
+     * Deny if the caller or owner is not approved for provisioning (unless
+     * either caller is an operator or the owner is an operator and it's only
+     * the owner that isn't approved).
      */
-    if (!principal.account.approved_for_provisioning) {
+    if (!principal.account.approved_for_provisioning &&
+        !principal.account.isOperator) {
         throw new errors.AccountBlockedError(principal.account.login);
     }
-    if (!resource.owner.account.approved_for_provisioning) {
+    if (!resource.owner.account.approved_for_provisioning &&
+        !resource.owner.account.isOperator &&
+        !principal.account.isOperator) {
         throw new errors.AccountBlockedError(resource.owner.account.login);
     }
 
