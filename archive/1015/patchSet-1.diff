From e04d04ab1e3d56bedab82c5340d060daae091568 Mon Sep 17 00:00:00 2001
From: Chris Burroughs <chris.burroughs@joyent.com>
Date: Mon, 28 Nov 2016 16:58:41 -0500
Subject: [PATCH] ./bin/triton key add -f ~/.ssh/id_rsa_atest.pub

---
 lib/do_key/do_add.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/lib/do_key/do_add.js b/lib/do_key/do_add.js
index 15b5d5a..b868b53 100644
--- a/lib/do_key/do_add.js
+++ b/lib/do_key/do_add.js
@@ -40,7 +40,8 @@ function do_add(subcmd, opts, args, cb) {
     var filePath = args[0];
     var cli = this.top;
 
-    vasync.pipeline({arg: {}, funcs: [
+    vasync.pipeline({arg: {cli: this.top}, funcs: [
+        common.cliSetupTritonApi,
         function gatherDataStdin(ctx, next) {
             if (filePath !== '-') {
                 return next();
-- 
2.21.0

