{"project":"joyent/node-fast","branch":"master","id":"I803b222cd38f6ad5aaad707dd0f8173451f49411","number":"5562","subject":"joyent/node-fast#23 Add support for updated crc package to improve interoperability","owner":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"url":"https://cr.joyent.us/5562","commitMessage":"joyent/node-fast#23 Add support for updated crc package to improve interoperability\n","createdOn":1549910188,"lastUpdated":1556310445,"open":false,"status":"MERGED","comments":[{"timestamp":1549910188,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 1."},{"timestamp":1549910190,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 4dc0f16e0a480a7f4a5621745041013364c8f6c4\n    \n    joyent/node-fast#23 Add support for updated crc package to improve interoperability"},{"timestamp":1549917184,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n(13 comments)"},{"timestamp":1550090470,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550092117,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1550093262,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 2."},{"timestamp":1550093263,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit f8cee2658f13d2661c73e454482c996ad26b6f55\n    \n    joyent/node-fast#23 Add support for updated crc package to improve interoperability"},{"timestamp":1550093429,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(12 comments)"},{"timestamp":1550096962,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1550685291,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n(1 comment)\n\nMy only remaining concern is the naming... but even that is between a nit and a legitimate concern, so I could be OK with the naming as-is."},{"timestamp":1550700576,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1551737166,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 3."},{"timestamp":1551737168,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 5ee0c7b96185e5c894b6123349af74c428d22878\n    \n    Rename CRC mode constants and add CRC kang stat for servers"},{"timestamp":1551737170,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing-1\n\n(10 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1551737367,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 4."},{"timestamp":1551737370,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit a1868043acd0bbd0a136d4aeeabb89b9c8c5e587\n    \n    Replace constant renaming missed in last commit"},{"timestamp":1551737371,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1551737472,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 4:\n\n\u003e (1 comment)\n \u003e \n \u003e My only remaining concern is the naming... but even that is between\n \u003e a nit and a legitimate concern, so I could be OK with the naming\n \u003e as-is.\n\nI updated the naming based on the Manta ML discussion. I like these names much better. I also added a kang stat for servers that will show the CRC mode. For clients I\u0027m thinking it\u0027s better left to incorporate that in each component that works as a fast client."},{"timestamp":1551806786,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4: Code-Review+1\n\nThese new names look good to me! Have you run the test suite included with this?"},{"timestamp":1551807437,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 4:\n\n\u003e These new names look good to me! Have you run the test suite\n \u003e included with this?\n\nI did. I\u0027ll some testing info for IA on the Github issue as my next step. Thanks!"},{"timestamp":1553545511,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 5."},{"timestamp":1553545513,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 2ce3fe4fcd0527dcede657020b853c903140d33d\n    \n    Export FAST_CHECKSUM constants"},{"timestamp":1553545516,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1553797627,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 6."},{"timestamp":1553797629,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 5b7ea659118fab768a72109e49801bb6fea39d0e\n    \n    One more update for the OLD/NEW to V1/V2 crc mode rename changes"},{"timestamp":1553797632,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1554225582,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1\n\n(2 comments)\n\nThis with the testing notes all look good to me.  I have 2 very small nits, but the code looks good to me."},{"timestamp":1554245271,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 7."},{"timestamp":1554245272,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit 2c39d83f2bf948499b72dabeeb32ef4f0389fad2\n    \n    Replace use of \u003d\u003d/!\u003d with \u003d\u003d\u003d/!\u003d\u003d for CRC checks"},{"timestamp":1554245275,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1554245455,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 6:\n\n(2 comments)"},{"timestamp":1554392975,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1"},{"timestamp":1554995999,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 7:\n\n(15 comments)\n\nIn general, this looks pretty good. A couple of things I noticed, but wasn\u0027t sure where to comment on them:\n\n1) We\u0027ve modified bin/fastcall and bin/fastserve to include the version information, but not bin/fastbench. Any particular reason that\u0027s the case?\n\n2) We don\u0027t have any tests that simulate a client passing an invalid checksum version in their constructor. It may be worth adding some to catch bad client behavior."},{"timestamp":1555351220,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 7:\n\n(12 comments)"},{"timestamp":1555429613,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 8."},{"timestamp":1555429615,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit 6db45be5c250ee1ccbc966093f5abaa8f552538f\n    \n    Updates to example programs based on review feedback\n    Update fastcall, fastbench, and fastserve to make the CRC compatibility mode a\n    command line option. Also add javascriptlint and jsstyle as submodules so that a\n    make check works within the repo."},{"timestamp":1555429977,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 8:\n\nI\u0027m going to try to group the changes for Robert\u0027s review feedback into several patchsets to make it easier to verify the changes. \n\nPS8 is the first one and it contains the changes to the example programs. It makes the CRC mode a command-line option with the fastcall and fastbench programs defaulting to FAST_CHECKSUM_V2 and the fastserve program defaulting to FAST_CHECKSUM_V1_V2. It also changes those programs to use the external exports from the fast module rather than directly accessing internal library modules. \n\nFinally, I added javascriptlint and jsstyle as submodules so that `make check` works properly within the repo."},{"timestamp":1555527085,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 9."},{"timestamp":1555527087,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 9:\n\nNew commits:\n    \n    commit fe41f6908c3c6a71ce9e84c404e3b081816c8de1\n    \n    Update fast_protocol documentation about CRC mode\n    \n    commit eff20566a82ffdfec52b3e85ef9fc31b24150ed2\n    \n    Validate CRC mode inputs\n    Validate CRC mode inputs when creating a FastClient or a FastServer. Also\n    validate the CRC mode in the fastMessageEncode function in the fast_protocol\n    module.\n    \n    commit 45fa65130393924f3c1c601612d1cfda884a1305\n    \n    Refactor CRC calculation and validation code\n    Extract the CRC calculation and validation into a separate function. Also factor\n    out the CRC validation error generation into its own function.\n    \n    commit b9e1b76ce83afc0981c79b2c6b0009c8631bf6cd\n    \n    Add new Makefile helpers"},{"timestamp":1555527110,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555527833,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 9:\n\nI think I\u0027ve addressed all the review feedback now in the commits between PS8 and PS9. Due to my misunderstanding about how gerrit determines patch sets the changes are in separate commits rather than separate patch sets. The following is a summary of each successive commit:\n\n6db45be5c250ee1ccbc966093f5abaa8f552538f\n\n* Update example programs so that CRC mode can be specified as a command-line option. Also use the external fast module exports rather than using internal node-fast  references. Add javascriptlint and jsstyle as submodules.\n\nb9e1b76ce83afc0981c79b2c6b0009c8631bf6cd\n\n* Add some Makefile helper files I forgot to stage before the previous commit\n    \n45fa65130393924f3c1c601612d1cfda884a1305\n    \n* Extract the CRC calculation and validation into a separate function. Also factor out the CRC validation error generation into its own function.\n\neff20566a82ffdfec52b3e85ef9fc31b24150ed2\n    \n* Validate CRC mode inputs when creating a FastClient or a FastServer. Also validate the CRC mode in the fastMessageEncode function in the fast_protocol module.\n\nfe41f6908c3c6a71ce9e84c404e3b081816c8de1\n    \n* Update fast_protocol documentation about CRC mode"},{"timestamp":1555531784,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 10."},{"timestamp":1555531786,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 10:\n\nNew commits:\n    \n    commit 86d63f298b6d5548c56bc0b8a7d349e8f3f63b39\n    \n    Fix header docs in tst.crc_mode test module"},{"timestamp":1555531809,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555947281,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 10:\n\n(5 comments)"},{"timestamp":1555963479,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 10:\n\n(4 comments)"},{"timestamp":1555966291,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 10:\n\n(3 comments)"},{"timestamp":1555966849,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 11."},{"timestamp":1555966851,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 11:\n\nNew commits:\n    \n    commit 09e9f530024357f81986d29a00d0628e2d804212\n    \n    More updates based on review feedback\n    * Shorten the CRC mode strings used by the example programs for easier use.\n    * Fix an issue with argument checking in fastMessageEncode.\n    * Update CRC tests based on the fastMessageEncode change."},{"timestamp":1555966874,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1555967981,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 11: Code-Review+1"},{"timestamp":1556137395,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 12."},{"timestamp":1556137397,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 12:\n\nNew commits:\n    \n    commit 001c60304ee764abb4b5de225b4ed816d1cf1b95\n    \n    Correct some minor typos"},{"timestamp":1556137420,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1556137954,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 13."},{"timestamp":1556137956,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 13:\n\nNew commits:\n    \n    commit b98d46da812e421e398bc218ff3fd6dae442d1d7\n    \n    Remove invalid encoder test cases using FAST_CHECKSUM_V1_V2 mode"},{"timestamp":1556137977,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1556138198,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 14."},{"timestamp":1556138200,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 14:\n\nNew commits:\n    \n    commit e23dd4f3b80ea0a7c723cbc8cfffa268fee96b49\n    \n    Remove invalid encoder test cases using FAST_CHECKSUM_V1_V2 mode, part 2"},{"timestamp":1556138228,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 14: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1556144104,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 14:\n\n(5 comments)\n\nthe nits are completely optional.  besides the nit, there is one missed copyright year, and one question about the usage message for `fastcall`.  Besides that, the code looks good to me! :)"},{"timestamp":1556205020,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Uploaded patch set 15."},{"timestamp":1556205022,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 15:\n\nNew commits:\n    \n    commit 5cadb65a4d268e1b4271c72f4051b01396c2c5c3\n    \n    Address Dave\u0027s review feedback"},{"timestamp":1556205044,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 15: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1556205079,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Patch Set 14:\n\n(5 comments)"},{"timestamp":1556206205,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 15: Code-Review+1"},{"timestamp":1556207046,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 15: Code-Review+1"},{"timestamp":1556223484,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 15: Integration-Approval+1\n\ntested and working on node 6\n\n[root@buckets-electric-moray ~/node-fast]# make test\ngit submodule update --init deps/catest\nSubmodule \u0027deps/catest\u0027 (https://github.com/joyent/catest) registered for path \u0027deps/catest\u0027\nCloning into \u0027/root/node-fast/deps/catest\u0027...\nSubmodule path \u0027deps/catest\u0027: checked out \u0027ca138645cc9647d6976063c61fa9f28dd16c5023\u0027\ndeps/catest/catest test/tst.crc_mode.js test/tst.protocol_encoder.js test/tst.client_request.js test/tst.socket_summarize.js test/tst.client_generic.js test/tst.allocator.js test/tst.server.js test/tst.protocol_decoder.js\nConfiguration:\n    SRC:                         /root/node-fast\n    Output directory:            /var/tmp/catest.30662\n    Temp directory:              /var/tmp/catest.30662_tmpfiles\n    Keep successful test output: false\n    Found 8 test(s) to run\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nExecuting test test/tst.crc_mode.js ... success.\nExecuting test test/tst.protocol_encoder.js ... success.\nExecuting test test/tst.client_request.js ... success.\nExecuting test test/tst.socket_summarize.js ... success.\nExecuting test test/tst.client_generic.js ... success.\nExecuting test test/tst.allocator.js ... success.\nExecuting test test/tst.server.js ... success.\nExecuting test test/tst.protocol_decoder.js ... success.\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\n\nResults:\n        Tests passed:    8/ 8\n        Tests failed:    0/ 8\n\n\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\u003d\nCleaning up output from successful tests ... done.\nNote: Compatibility tests need to be run manually with \"make test-compat\".\n[root@buckets-electric-moray ~/node-fast]# node -v\nv6.14.4"},{"timestamp":1556310445,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kelly McLaughlin"}],"currentPatchSet":{"number":"15","revision":"803b222cd38f6ad5aaad707dd0f8173451f49411","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/15","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556205020,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1556205044,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556206205,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556207046,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556223484,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1556310445,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":34,"deletions":-9},{"file":"bin/fastserve","type":"MODIFIED","insertions":30,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":19,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1171,"sizeDeletions":-117},"patchSets":[{"number":"1","revision":"a402bce46126d628d90b3e6e5ad3c45cbd3ee94b","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/1","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1549910188,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550090470,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastcall","line":10,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"bin/fastcall","line":10,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"bin/fastserve","line":10,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"bin/fastserve","line":10,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"lib/fast_client.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"lib/fast_client.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"lib/fast_protocol.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"lib/fast_protocol.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"lib/fast_protocol.js","line":124,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I like the concept of support old, new, and old-new.... but i\u0027m wondering about the name.  Putting \"new\" in software always makes me wary.  I don\u0027t have any good alternatives but perhaps something like LEGACY, and maybe something to indicate ACTUALLY_WORKS_ISNT_BROKEN.\n\nAgain, I don\u0027t know any good names personally, but NEW makes me question it."},{"file":"lib/fast_protocol.js","line":124,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"How about CRC_MODE_BUGGY (alternatively CRC_MODE_LEGACY), CRC_MODE_BRIDGE (or CRC_MODE_DUAL perhaps?), and CRC_MODE_CORRECT?\n\nI didn\u0027t particularly like NEW AND OLD, but I  couldn\u0027t really think of any other great descriptors either."},{"file":"lib/fast_protocol.js","line":124,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Truthfully I don\u0027t even know.  I\u0027d like to get others opinions here (dap perhaps)?"},{"file":"lib/fast_protocol.js","line":124,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Maybe I\u0027ll just send an email to the manta list about it and try to solicit some input that way."},{"file":"lib/fast_protocol.js","line":208,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: use a switch statement here and assert.fail on the default case."},{"file":"lib/fast_protocol.js","line":208,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"lib/fast_server.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"lib/fast_server.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/common.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/common.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/common/client.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/common/client.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/tst.client_generic.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/tst.client_generic.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/tst.client_request.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/tst.client_request.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/tst.protocol_decoder.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/tst.protocol_decoder.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/tst.protocol_encoder.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"test/tst.protocol_encoder.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"bin/fastserve","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":89,"deletions":-22},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":21,"deletions":-6},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"test/common/client.js","type":"MODIFIED","insertions":24,"deletions":-8},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":8,"deletions":-4},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":189,"deletions":-15},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":114,"deletions":-9},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":24,"deletions":-2}],"sizeInsertions":497,"sizeDeletions":-75},{"number":"2","revision":"c823c00255b7dfd415c854c608d0c1ea5d37ccb8","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/2","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1550093262,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1550096962,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":97,"deletions":-23},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":22,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":190,"deletions":-16},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":515,"sizeDeletions":-86},{"number":"3","revision":"c298af5cc57187dd13374d574dae44278c0be207","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/3","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1551737166,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1551737170,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/fast_protocol.js","line":186,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":187,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":219,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":221,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":234,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":236,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1_V2"},{"file":"lib/fast_protocol.js","line":252,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V2"},{"file":"lib/fast_protocol.js","line":254,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V1"},{"file":"lib/fast_protocol.js","line":257,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V2"},{"file":"lib/fast_protocol.js","line":270,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: FAST_CHECKSUM_V2"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":531,"sizeDeletions":-89},{"number":"4","revision":"d8cb5a47702af82d746ea0a49b7e10595fae5045","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/4","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1551737367,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1551737371,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1551806786,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":531,"sizeDeletions":-89},{"number":"5","revision":"0aaa4a06da24c19c859b9b7d5e2e33d66d755813","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/5","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1553545511,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553545516,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":535,"sizeDeletions":-89},{"number":"6","revision":"a8ca5c75bb4dc883e2b37f3a3cc6f058ed3b4e09","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/6","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1553797627,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553797632,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554225582,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554225582,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"lib/fast_protocol.js","line":141,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: spacing (although this could be just gerrit being weird)"},{"file":"lib/fast_protocol.js","line":141,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"I lined up the `\u003d` with the other statements in that group to match the way other groups in that file looked."},{"file":"lib/fast_protocol.js","line":223,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I realize this is how it was done, but is there reason to prefer \"!\u003d\" over \"!\u003d\u003d\" ?"},{"file":"lib/fast_protocol.js","line":223,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":535,"sizeDeletions":-89},{"number":"7","revision":"a85ac2883a8dd644d34d9fb087e1d0d882ead0b9","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/7","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1554245271,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554245275,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554392975,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554392975,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"bin/fastcall","line":158,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t want to force more work, but it seems like it\u0027d be rather useful for this to be an optional CLI argument to specify the checksum version which will make it simpler for folks to test some of this."},{"file":"bin/fastcall","line":158,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Yep, will make this change."},{"file":"bin/fastserve","line":141,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I don\u0027t want to force more work, but it seems like it\u0027d be rather useful for this to be an optional CLI argument to specify the checksum version which will make it simpler for folks to test some of this."},{"file":"bin/fastserve","line":141,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Good idea, will do."},{"file":"lib/fast.js","line":23,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there a reason these are exposed but none of the clients actually use this exposure? It seems like bin/fastcall and bin/fastserve are just using the protocol ones. Shouldn\u0027t we have the clients there look like the way we\u0027d expect consumers to use this (as folks will probably just end up looking at those for a sample of how to do it)."},{"file":"lib/fast.js","line":23,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Yeah good idea. These example programs were not written in terms of the external exports and I just followed suit, but it\u0027s a good point that they should serve as a reference for how we want people to interface with the library. I\u0027ll update them to use the fast module exports instead."},{"file":"lib/fast_protocol.js","line":74,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I would probably indicate here that this is the CRC issue. For example:\n\nThe changes to address joyent/node-fast#23 (this CRC issue) were done ..."},{"file":"lib/fast_protocol.js","line":85,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Maybe it\u0027s worth adding a bit suggesting that this mechanism can be used for other CRC changes in the future. Alternatively we should suggest that that might only come with a version change."},{"file":"lib/fast_protocol.js","line":85,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Maybe I\u0027ll make the distinction here between normal library version changes where CRC calculations are not affected and ones that might represent incompatibilities just so it\u0027s very clear the intention of the mechanism."},{"file":"lib/fast_protocol.js","line":139,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Seeing these, I wonder if they should actually be a bitfield. Probably doesn\u0027t matter as even if we were to have a V3 or V4, it\u0027s not clear that we\u0027d keep a V1 around and need to have a V1,V2,V3,V4 or all the inbetween variants."},{"file":"lib/fast_protocol.js","line":139,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"I\u0027m really hoping this is the only time this mechanism is ever used. I\u0027m happy to look into using a bitfield if you think it\u0027s worthwhile though."},{"file":"lib/fast_protocol.js","line":139,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, that seems reasonable."},{"file":"lib/fast_protocol.js","line":191,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is it legal for someone to pass FAST_CHECKSUM_V1_V2 here? If so should it generate a V2 or a V1 checksum? Maybe it\u0027s clearer to make it illegal to pass FAST_CHECKSUM_V1_V2 for message encoding. Presumably we should blow an assertion if we have a non-matching checksum like in the decode case below. Though we should probably make sure the client/server can\u0027t put us in that place."},{"file":"lib/fast_protocol.js","line":191,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"It\u0027s a good point. FAST_CHECKSUM_V1_V2 is really only about the functioning of the message decoder. The behavior on encoding is implicit unless you come here and examine the code. For the server side it\u0027s the case that we\u0027ll only every use FAST_CHECKSUM_V1 or FAST_CHECKSUM_V2 based on the the mode detected when the incoming client message is decoded. The client side behavior is not as clear. I had been thinking about this with the assumption that we would update our server components to use the bridge mode first and due to that assumption these changes do not support a way to have a client accept and decode messages using FAST_CHECKSUM_V1_V2 from a server that is only using FAST_CHECKSUM_V1. The client will always encode the messages with FAST_CHECKSUM_V2. It would be great to support this scenario, but the only way I can see that working is by having a means for servers to advertise to clients their capabilities or by having clients attempt sending messages encoded with both CRC options and determine what the server might accept. I think both of these options are substantial changes and probably not worth the effort in this case. Instead, I think the client should only accept FAST_CHECKSUM_V1 or FAST_CHECKSUM_V2. That makes the client behavior for both encoding and decoding clear. The trade-off is that server components have to update to FAST_CHECKSUM_V1_V2 mode before the  clients that communicate with it, but to me that seems acceptable. \n\nFor this particular bit of code then, we could then validate that `crc_mode` is only one of `FAST_CHECKSUM_V1` or `FAST_CHECKSUM_V2`."},{"file":"lib/fast_protocol.js","line":233,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"This is duplicated three times here. Is it worth a function that\u0027ll construct this with the crc parameters as arguments so if we have to change it in the future, there\u0027s only one place?"},{"file":"lib/fast_protocol.js","line":233,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Sure, I\u0027ll do that."},{"file":"lib/fast_protocol.js","line":249,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"None of the tests cases cover this form of error message in the decoder in the error case. Should we add one, since it has a different from than the others as it lists both CRCs?"},{"file":"lib/fast_protocol.js","line":249,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"I\u0027ll look into adding that."},{"file":"lib/fast_protocol.js","line":344,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"We should probably check the validity of this from the client, especially as the current implementation will behave as though any value that\u0027s not FAST_CHECKSUM_V1 is FAST_CHECKSUM_V2."},{"file":"lib/fast_protocol.js","line":388,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is there a reason that we\u0027re not checking the validity of the crc_mode here? It seems like we should verify this in the constructor (or possibly in the callers) and blow up rather than just blow up when we first send a message."},{"file":"lib/fast_protocol.js","line":388,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"No reason, just an oversight. I\u0027ll make that adjustment."},{"file":"lib/fast_server.js","line":178,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Rather than joyent/node-fast#23, maybe we should initially refer folks to the bit in fast_protocol.js? I only mention that because it seems to have a useful set of background information and I always have a slight paranoia that bug trackers will disappear (which isn\u0027t that reasonable). This is true for both the client and server mentions of this."},{"file":"lib/fast_server.js","line":178,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Yep, will do."},{"file":"test/common/client.js","line":164,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Are the tabs between sentences intentional? Also true at +220."},{"file":"test/tst.protocol_decoder.js","line":92,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"When you say FP_OFF_TYPE has been deleted do you mean that the line buf.writeUInt8 of FP_OFF_TYPE has been deleted?"},{"file":"test/tst.protocol_decoder.js","line":92,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Hmm, I\u0027m not sure why this is showing up in the diff. This is just a preexisting comment rather than something I\u0027ve added. https://github.com/joyent/node-fast/blob/master/test/tst.protocol_decoder.js#L86-L91"},{"file":"test/tst.protocol_decoder.js","line":106,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Based on my reading, the decoder today doesn\u0027t include anything about in the output data object about the version, status, or crc in its output which is why these aren\u0027t explicitly checked in these check blocks. They\u0027re mostly getting exercised by the decoder choosing whether it\u0027s emitting data or error, right?"},{"file":"test/tst.protocol_decoder.js","line":106,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Exactly right"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"bin/fastcall","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"bin/fastserve","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":535,"sizeDeletions":-89},{"number":"8","revision":"f88549b1118649879322c7245f96e3f51298a812","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/8","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1555429613,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"Makefile.targ","type":"DELETED","insertions":0,"deletions":-317},{"file":"bin/fastbench","type":"MODIFIED","insertions":31,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":36,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":32,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":110,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":23,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3}],"sizeInsertions":636,"sizeDeletions":-425},{"number":"9","revision":"3c683a178441c2083f4a42f8a1545783b8184f3f","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/9","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1555527085,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555527110,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":31,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":36,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":32,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":182,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":366,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1173,"sizeDeletions":-117},{"number":"10","revision":"08adfb653b5cd3e7164773a10a5842a2d1cee6de","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/10","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1555531784,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555531809,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastbench","line":216,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Optional thing, but it may be nice to be able to specify just the string \u0027v1\u0027 or \u0027v2\u0027."},{"file":"bin/fastbench","line":216,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Ok, I can definitely shorten the input strings down."},{"file":"bin/fastbench","line":216,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Either way, it\u0027s up to you."},{"file":"bin/fastcall","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should some version of this function be in the library since it seems similar to the one in bin/fastbench? It doesn\u0027t really matter too much here."},{"file":"bin/fastcall","line":130,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"I wondered that too, but since it differs depending on if you\u0027re writing a FastClient or FastServer I didn\u0027t think it was worth it. Also, I thought if someone was coming to cut and paste some code to get a program started they wouldn\u0027t have to hunt anywhere else to find this code."},{"file":"bin/fastcall","line":130,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, the trade off there makes sense."},{"file":"test/tst.crc_mode.js","line":245,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Shouldn\u0027t these two fastMessageEncode calls throw an exception in fastMessageEncode (lib/fast_protocol.js+203), which will cause us to hit the mod_assertplus.fail below and therefore fail the test?"},{"file":"test/tst.crc_mode.js","line":245,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Ah, nice catch! I failed to check the value of the `default_crc_mode` passed to this function independent of the CRC mode value that ultimately gets used by the  function. I\u0027ll make that change and update the tests accordingly."},{"file":"tools/mk/Makefile.deps","line":2,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Should we instead be adding eng.git as a submodule here? I think that was what a lot of the luallaby work was doing, but I\u0027m not sure if that was meant to cover the individual bits here."},{"file":"tools/mk/Makefile.deps","line":2,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"It\u0027s a good question. I actually started with adding eng.git, but the problem I ran into was that it seems a bit too focused on the image building aspect. When using the helper files from eng.git I wasn\u0027t able to run `make` in the repo without complaints about my image version and missing dependencies for building images. We won\u0027t ever need to build an image for this repo most likely so it seemed like more annoyance than benefit. I do want to talk with Tim about how we might use those files more outside of the image building context, but for now I copied this file from muskie right before it moved to using the eng.git files and I didn\u0027t want to create a dependency on changes to eng.git."},{"file":"tools/mk/Makefile.deps","line":2,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK. I guess starting that way is reasonable. We (not necessarily you) should consider circling back on this later then."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":31,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":36,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":32,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":182,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":360,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1167,"sizeDeletions":-117},{"number":"11","revision":"119672a75d6da9b3714276faa34bb9d18c141484","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/11","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1555966849,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555967981,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1555966874,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":35,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":31,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1178,"sizeDeletions":-117},{"number":"12","revision":"ba64103e5bb85bd9ab8462c5663b5fd5d971d0f3","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/12","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556137395,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1556137420,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":35,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":31,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":25,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1178,"sizeDeletions":-117},{"number":"13","revision":"de61d1c23f92deb37fa626ea2e78901e071a4589","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/13","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556137954,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1556137977,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"test/tst.protocol_encoder.js","line":40,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: undeclared identifier: useOldNewCrc"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":35,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":31,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1173,"sizeDeletions":-117},{"number":"14","revision":"e7ea83e13bcb822c21c262ec99d405c23ddd9118","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/14","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556138198,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1556138228,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastcall","line":42,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"isn\u0027t CRC_MODE a part of OPTIONS already since it is passed via `-m`?"},{"file":"bin/fastcall","line":42,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Nice catch. This was from an earlier revision to this. I ended up putting it in OPTIONS and never cleaned this part up. Thanks!"},{"file":"bin/fastcall","line":128,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: you could make this a switch statement\n\n switch (option.optarg) {\n case \u0027v1\u0027:\n    return ...;\n case \u0027v2\u0027:\n     return ...;\n default:\n     mode_cmdutil.usage(\u0027...\u0027);\n }\n\nthis way, if we end up with v3, v4, etc. in the future it\u0027ll be simple to add."},{"file":"bin/fastcall","line":128,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Good idea. Will make this change."},{"file":"bin/fastserve","line":119,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: if multiple bin tools use this logic (or similar, perhaps adding them to some common lib may be good)."},{"file":"bin/fastserve","line":119,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Robert mentioned something similar as well. I thought about doing so, but I also see value in these programs as self-contained examples and not having to go hunting all over for the code they use. I think there are opportunities in these programs to consolidate some code and make them more uniform in their approach, but I\u0027d prefer to leave that to another CR."},{"file":"lib/fast.js","line":8,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"2019"},{"file":"lib/fast.js","line":8,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"},{"file":"test/tst.client_request.js","line":621,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit:\n\n mod_assertplus.equal(errors.socket, null);"},{"file":"test/tst.client_request.js","line":621,"reviewer":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":35,"deletions":-10},{"file":"bin/fastserve","type":"MODIFIED","insertions":31,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":19,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1172,"sizeDeletions":-117},{"number":"15","revision":"803b222cd38f6ad5aaad707dd0f8173451f49411","parents":["8a02bcddd9efc2f4b37b88345d712fb0bacc3acc"],"ref":"refs/changes/62/5562/15","uploader":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"createdOn":1556205020,"author":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556206205,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1556205044,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1556207046,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1556223484,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1556310445,"by":{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/fastbench","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"bin/fastcall","type":"MODIFIED","insertions":34,"deletions":-9},{"file":"bin/fastserve","type":"MODIFIED","insertions":30,"deletions":-7},{"file":"deps/javascriptlint","type":"ADDED","insertions":1,"deletions":0},{"file":"deps/jsstyle","type":"ADDED","insertions":1,"deletions":0},{"file":"lib/fast.js","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/fast_client.js","type":"MODIFIED","insertions":20,"deletions":-3},{"file":"lib/fast_protocol.js","type":"MODIFIED","insertions":188,"deletions":-24},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":33,"deletions":-7},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/common.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"test/common/client.js","type":"MODIFIED","insertions":25,"deletions":-9},{"file":"test/tst.client_generic.js","type":"MODIFIED","insertions":9,"deletions":-5},{"file":"test/tst.client_request.js","type":"MODIFIED","insertions":192,"deletions":-18},{"file":"test/tst.crc_mode.js","type":"ADDED","insertions":370,"deletions":0},{"file":"test/tst.protocol_decoder.js","type":"MODIFIED","insertions":115,"deletions":-10},{"file":"test/tst.protocol_encoder.js","type":"MODIFIED","insertions":19,"deletions":-3},{"file":"tools/mk/Makefile.deps","type":"ADDED","insertions":54,"deletions":0},{"file":"tools/mk/Makefile.targ","fileOld":"Makefile.targ","type":"RENAMED","insertions":26,"deletions":-9}],"sizeInsertions":1171,"sizeDeletions":-117}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Kelly McLaughlin","email":"kelly.mclaughlin@joyent.com","username":"kellymclaughlin"}]}