{"project":"joyent/moray","branch":"master","id":"I260153a80cc3b9b6e3a8c58d1e5c49be6de5f25f","number":"2565","subject":"MORAY-351 moray missing DTrace probes for many RPC operations Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e","owner":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"url":"https://cr.joyent.us/2565","commitMessage":"MORAY-351 moray missing DTrace probes for many RPC operations\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1505343527,"lastUpdated":1506013490,"open":false,"status":"MERGED","comments":[{"timestamp":1505343527,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 1."},{"timestamp":1505343553,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505400464,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\nI haven\u0027t looked at this too deeply yet, but we should also update the \"dtrace-provider\" dependency to \"~0.8\"."},{"timestamp":1505404157,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1505418695,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 2."},{"timestamp":1505418726,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505419012,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 3."},{"timestamp":1505419038,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505426150,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 4."},{"timestamp":1505426187,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505426642,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 5."},{"timestamp":1505426683,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505430023,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 6."},{"timestamp":1505430051,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505431941,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1505431945,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1505512167,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 7."},{"timestamp":1505512199,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505513638,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\n(1 comment)"},{"timestamp":1505517894,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 8."},{"timestamp":1505517931,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505855189,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 9."},{"timestamp":1505855216,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 9: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505860047,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 9:\n\n(1 comment)\n\nCan you also update the \"dtrace-provider\" dependency in package.json to \"~0.8\"?"},{"timestamp":1505860119,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 9:\n\n(1 comment)"},{"timestamp":1505952750,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 10."},{"timestamp":1505952758,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 10:\n\n(1 comment)"},{"timestamp":1505952777,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1505953024,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 11."},{"timestamp":1505953065,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506010083,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 11: Code-Review+1 Integration-Approval+1"},{"timestamp":1506013452,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 12: Commit message was updated."},{"timestamp":1506013458,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 13: Patch Set 12 was rebased"},{"timestamp":1506013469,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jan Wyszynski"},{"timestamp":1506013490,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 13:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"13","revision":"cb5bc6393b9cbdb9e1b896501b1b46a329210da8","parents":["008773346a9f9ce4ada0ad2d78f038d20f432437"],"ref":"refs/changes/65/2565/13","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1506013458,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505953065,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1506013469,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":111,"sizeDeletions":-20},"patchSets":[{"number":"1","revision":"46b388d7faf8cebf33cfddeaba53517d7af2ddfa","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/1","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505343527,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505343553,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/buckets/creat.js","line":70,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I don\u0027t think we need DTrace probes for each the operations inside this and other pipelines, since we have the handler-start/handler-done probes. What would you think about adding a handler-error probe, which would fire with err.toString() when there\u0027s an error? I think that should then cover most needs for tracking these functions."},{"file":"lib/buckets/get.js","line":69,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"All of the *-done probes for a route will be fired at the end of the handlerPipeline() function, here:\n\nhttps://github.com/joyent/moray/blob/6d70a28bacfbe14f108420644dc4e04f7d9059a3/lib/control.js#L94-L98\n\nIt fires using the cbProbe() function, which by default is just the msgid, but can be overridden in the options object to have further arguments. This is why you\u0027re seeing getbucket-done fire twice, and with an undefined bucket the second time."},{"file":"lib/buckets/list.js","line":87,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"We should fire a listbuckets-start probe here, and define a listbuckets-done probe for handlerPipeline() to fire."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":43,"deletions":0},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":73,"deletions":-4},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":14,"deletions":-1},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":59,"deletions":0},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":170,"deletions":-1}],"sizeInsertions":370,"sizeDeletions":-6},{"number":"2","revision":"81433bc4a6e16f1efac689c86322767635b9ec05","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/2","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505418695,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505418726,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":33,"deletions":-2},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":44,"deletions":-5},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":48,"deletions":-6},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":46,"deletions":-1}],"sizeInsertions":194,"sizeDeletions":-17},{"number":"3","revision":"38cbd4dcc8f9d737491d9f8d3365c1b14525c3ea","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/3","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505419012,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505419038,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":33,"deletions":-2},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":44,"deletions":-5},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":48,"deletions":-6},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":46,"deletions":-1}],"sizeInsertions":193,"sizeDeletions":-17},{"number":"4","revision":"1bc2546cf64f4c941ef30b7c690440458155abce","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/4","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505426150,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505426187,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":15,"deletions":-2},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":28,"deletions":-5},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":14,"deletions":-8},{"file":"lib/control.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":34,"deletions":-1}],"sizeInsertions":113,"sizeDeletions":-19},{"number":"5","revision":"ddcf65cc9b71f8289d897883d2f4a05638ab1452","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/5","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505426642,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505426683,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":12,"deletions":-19},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":8,"deletions":-2},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":13,"deletions":-21},{"file":"lib/control.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":34,"deletions":-1}],"sizeInsertions":89,"sizeDeletions":-45},{"number":"6","revision":"56bc6da1ffaf1e0ecfe3061f0230654a5581e2af","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/6","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505430023,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1505431945,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505430051,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/buckets/list.js","line":84,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I think that including the req_id is a good idea, especially since the msgid isn\u0027t great for distinguishing requests without the connId. Could we change the default cbProbe in handlerPipeline() to look like this function, and update the following probes to take an additional \"char *\" argument?\n\n- putobject-done\n- update-done\n- delmany-done\n- batch-done\n- delobject-done\n- reindexobjects-done\n\nWe could also add it to batch-op-done, and update where that fires.\n\nUnfortunately, updating getobject-done and findobjects-done would be a breaking change to any DTrace scripts. That might be fine though, since I think people tend to just use the D scripts that live in the bin/ directory. If so, and we decide to break the API, we should also make connId an argument. It might be best to save any breaking changes for a separate bug though."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":34,"deletions":-1}],"sizeInsertions":80,"sizeDeletions":-6},{"number":"7","revision":"e835ce3dd585a397f2f10910a78da66e8c5c7193","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/7","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505512167,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505512199,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/dtrace.js","line":42,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"You\u0027ll also want to add a \u0027char *\u0027 here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":44,"deletions":-11},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":90,"sizeDeletions":-17},{"number":"8","revision":"7411eb1488dcc5c19b666ff2df166e5eba67a25e","parents":["6d70a28bacfbe14f108420644dc4e04f7d9059a3"],"ref":"refs/changes/65/2565/8","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505517894,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505517931,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":45,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":91,"sizeDeletions":-18},{"number":"9","revision":"130ab7bff4c09e9733cd1f4d4d72917dc9ed6e0a","parents":["26b5659c9b1f887ba12e5c1108218d068fd0b07c"],"ref":"refs/changes/65/2565/9","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505855189,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505855216,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/ping.js","line":53,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Can we also pass rpc.requestId() (the \"msgid\" value) as the first argument to ping-start and ping-done, for symmetry with the other probes?"},{"file":"lib/ping.js","line":53,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Also: does this work if opts.deep is undefined? If not, you may need to make this \"!!opts.deep\"."},{"file":"lib/ping.js","line":53,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"I verified in the most recent testing notes that opts.deep \u003d\u003d\u003d undefined is fine and dtrace just prints 0 if that is the case. Tested this by adding a temporary assignment to deep before we return here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1}],"sizeInsertions":110,"sizeDeletions":-19},{"number":"10","revision":"ffabfa22dbc8b67ed37848be9416b26949922b07","parents":["26b5659c9b1f887ba12e5c1108218d068fd0b07c"],"ref":"refs/changes/65/2565/10","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505952750,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505952777,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1}],"sizeInsertions":110,"sizeDeletions":-19},{"number":"11","revision":"260153a80cc3b9b6e3a8c58d1e5c49be6de5f25f","parents":["26b5659c9b1f887ba12e5c1108218d068fd0b07c"],"ref":"refs/changes/65/2565/11","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1505953024,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505953065,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":111,"sizeDeletions":-20},{"number":"12","revision":"4146296b89d604ddf8442840d6e43c92cc5d8c75","parents":["26b5659c9b1f887ba12e5c1108218d068fd0b07c"],"ref":"refs/changes/65/2565/12","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1506013452,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505953065,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":111,"sizeDeletions":-20},{"number":"13","revision":"cb5bc6393b9cbdb9e1b896501b1b46a329210da8","parents":["008773346a9f9ce4ada0ad2d78f038d20f432437"],"ref":"refs/changes/65/2565/13","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1506013458,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1506010083,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1505953065,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1506013469,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/buckets/creat.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/del.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/get.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/buckets/list.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/buckets/update.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/control.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/dtrace.js","type":"MODIFIED","insertions":51,"deletions":-12},{"file":"lib/objects/batch.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/ping.js","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":111,"sizeDeletions":-20}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}]}