{"project":"joyent/manta-garbage-collector","branch":"master","id":"Ibecbef190c49962ad154e248c7e8e2dea3d37abc","number":"4832","subject":"MANTA-3945 garbage-collector loads index shard list incorrectly Reviewed by: Jared Morrow \u003cjm@joyent.com\u003e Approved by: Jared Morrow \u003cjm@joyent.com\u003e","owner":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"url":"https://cr.joyent.us/4832","commitMessage":"MANTA-3945 garbage-collector loads index shard list incorrectly\nReviewed by: Jared Morrow \u003cjm@joyent.com\u003e\nApproved by: Jared Morrow \u003cjm@joyent.com\u003e\n","createdOn":1536796686,"lastUpdated":1536869482,"open":false,"status":"MERGED","comments":[{"timestamp":1536796686,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 1."},{"timestamp":1536796701,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1536796712,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1536803780,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 3."},{"timestamp":1536803803,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1536803806,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1536860810,"reviewer":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1536866042,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 5."},{"timestamp":1536866066,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1536866067,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 6: Patch Set 5 was rebased"},{"timestamp":1536866772,"reviewer":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"},"message":"Patch Set 6: Code-Review+1 Integration-Approval+1\n\nLooks great"},{"timestamp":1536869365,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1536869451,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 8: Commit message was updated."},{"timestamp":1536869482,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jan Wyszynski"}],"currentPatchSet":{"number":"8","revision":"3199d3977f7646c86b2f56f232a9bfb3ada06f31","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/8","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536869451,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536866066,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"SUBM","value":"1","grantedOn":1536869482,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":90,"deletions":-13}],"sizeInsertions":90,"sizeDeletions":-13},"patchSets":[{"number":"1","revision":"29a8f38032d82bce3aa87cd4fc5e5e2742a54d7e","parents":["5399d39d184aeff4ad10ef9fb66b90c0526ed708"],"ref":"refs/changes/32/4832/1","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536796686,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536796712,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":21,"deletions":-5}],"sizeInsertions":21,"sizeDeletions":-5},{"number":"2","revision":"a074212d3c12bcfc56a957417c07f6b6c615666b","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/2","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536796701,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CHANGE","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":21,"deletions":-5}],"sizeInsertions":21,"sizeDeletions":-5},{"number":"3","revision":"402ca396155be554032f9fae7e0817b115234093","parents":["5399d39d184aeff4ad10ef9fb66b90c0526ed708"],"ref":"refs/changes/32/4832/3","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536803780,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536803806,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":42,"deletions":-5}],"sizeInsertions":42,"sizeDeletions":-5},{"number":"4","revision":"c5b4a1491cede507931b202600c582f3bb11f667","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/4","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536803803,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CHANGE","comments":[{"file":"cmd/server.js","line":212,"reviewer":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"},"message":"I know we aren\u0027t planning on running this on anything that doesn\u0027t fit the pattern NUM.moray.DOMAIN, BUT it might be worth while covering the simple case of someone having a domain like foo.3.moray.joyent.us.  That right now would return NaN here.  It would then make all the compares below be false no matter what. (anything compared to NaN is false)  It might be worth checking for NaN and then logging that we are going to crash.  I\u0027m not suggesting trying to recover, just making it more clear what happened in a log."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":42,"deletions":-5}],"sizeInsertions":42,"sizeDeletions":-5},{"number":"5","revision":"becbef190c49962ad154e248c7e8e2dea3d37abc","parents":["5399d39d184aeff4ad10ef9fb66b90c0526ed708"],"ref":"refs/changes/32/4832/5","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536866042,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536866066,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":90,"deletions":-13}],"sizeInsertions":90,"sizeDeletions":-13},{"number":"6","revision":"59a22e4229a58120670ea4decfec03b6194be251","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/6","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536866067,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536866066,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":90,"deletions":-13}],"sizeInsertions":90,"sizeDeletions":-13},{"number":"7","revision":"a06f71c0e1f25b771a74f91767df3fdd73282e58","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/7","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536869365,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536866066,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":90,"deletions":-13}],"sizeInsertions":90,"sizeDeletions":-13},{"number":"8","revision":"3199d3977f7646c86b2f56f232a9bfb3ada06f31","parents":["5a369c3b3a835019e3bc82d9da6331c6fb50b40e"],"ref":"refs/changes/32/4832/8","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1536869451,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1536866066,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1536866772,"by":{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"}},{"type":"SUBM","value":"1","grantedOn":1536869482,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"cmd/server.js","type":"MODIFIED","insertions":90,"deletions":-13}],"sizeInsertions":90,"sizeDeletions":-13}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jared Morrow","email":"jm@joyent.com","username":"jaredmorrow"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}]}