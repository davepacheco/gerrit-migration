{"project":"joyent/manta-reshard","branch":"master","id":"I5bd3db7abadc02219cfed68064d72eae8bd9a746","number":"3614","subject":"MANTA-3602 reshard repository clean up Reviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e Approved by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e","owner":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"url":"https://cr.joyent.us/3614","commitMessage":"MANTA-3602 reshard repository clean up\nReviewed by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e\nApproved by: Brittany Wald \u003cbrittany.wald@joyent.com\u003e\n","createdOn":1520974026,"lastUpdated":1521579751,"open":false,"status":"MERGED","comments":[{"timestamp":1520974026,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 1."},{"timestamp":1520974028,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1520974158,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 2."},{"timestamp":1520974160,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521069613,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1\n\n(22 comments)\n\nGreat stuff!  I\u0027ve left some comments/questions but nothing I consider to be a blocker with respect to the JIRA ticket\u0027s mission."},{"timestamp":1521145179,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 2: -Integration-Approval"},{"timestamp":1521500932,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 3."},{"timestamp":1521500934,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1521500982,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3:\n\n(21 comments)\n\nI have filed some follow-up tickets, and addressed some of your feedback directly.  Anything I haven\u0027t addressed will be follow-up work in a subsequent clean-up pass at this stage, I think."},{"timestamp":1521503006,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1521577700,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1521578997,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1521579053,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Patch Set 3:\n\nThank you for that explanation, it\u0027s useful to understand how you make those distinctions!"},{"timestamp":1521579743,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1521579751,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Joshua M. Clulow"}],"currentPatchSet":{"number":"4","revision":"5bd3db7abadc02219cfed68064d72eae8bd9a746","parents":["699aa9828683320073d84acdceeeff5bcfc830ee"],"ref":"refs/changes/14/3614/4","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1521579743,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521500934,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1521503006,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1521578997,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"SUBM","value":"1","grantedOn":1521579751,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":15,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-14},{"file":"boot/everyboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"boot/firstboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"cmd/phases.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"cmd/plan_archive.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_get.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_list.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"cmd/plan_pause.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_resume.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_tune.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"cmd/plan_unhold.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/server.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"cmd/status.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/create_instance.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/data_access.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/electric_moray.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/executor.js","type":"MODIFIED","insertions":33,"deletions":-15},{"file":"lib/http_client.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/http_server.js","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/locks.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/manatee_adm.js","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":13,"deletions":-5},{"file":"lib/phase_create_sentinel_bucket.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/phase_critical_section_enter.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_critical_section_exit.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/phase_establish_cluster.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/phase_install_ring.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/phase_reconfigure_peers.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_sapi_cleanup.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":21,"deletions":-13},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":15,"deletions":-11},{"file":"lib/phase_update_sapi_mark_readonly.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/phase_update_sapi_mark_readwrite.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/postgres.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/serial.js","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"lib/status.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/template.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/wrap.sh","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"scripts/reshard.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"smf/manifests/reshard.xml","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"templates/electric-moray-get-vnodes.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/electric-moray-update-ring.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-cleanup.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-create-archive.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-prime-workspace.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"templates/hashring-remap-vnodes.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/generate_cluster_state.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"test/manatee_adm_parser.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"test/status.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/status_wide.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/template.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":683,"sizeDeletions":-207},"patchSets":[{"number":"1","revision":"5d5060d5bf3e3c64f260769a2f68c2b6ea05c315","parents":["699aa9828683320073d84acdceeeff5bcfc830ee"],"ref":"refs/changes/14/3614/1","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1520974026,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1520974028,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":15,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-14},{"file":"boot/everyboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"boot/firstboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"cmd/phases.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"cmd/plan_archive.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_get.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_list.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"cmd/plan_pause.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_resume.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_tune.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"cmd/plan_unhold.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/server.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"cmd/status.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"deps/manta-scripts","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/create_instance.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/data_access.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/electric_moray.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/executor.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/http_client.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/http_server.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/locks.js","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"lib/manatee_adm.js","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_sentinel_bucket.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/phase_critical_section_enter.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_critical_section_exit.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/phase_establish_cluster.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/phase_install_ring.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/phase_reconfigure_peers.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":10,"deletions":-11},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":10,"deletions":-11},{"file":"lib/phase_sapi_cleanup.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":12,"deletions":-8},{"file":"lib/phase_update_sapi_mark_readonly.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/phase_update_sapi_mark_readwrite.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/postgres.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/serial.js","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"lib/status.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/template.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/wrap.sh","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"scripts/reshard.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"smf/manifests/reshard.xml","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"templates/electric-moray-get-vnodes.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/electric-moray-update-ring.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-cleanup.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-create-archive.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-prime-workspace.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"templates/hashring-remap-vnodes.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/generate_cluster_state.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"test/manatee_adm_parser.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"test/status.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/status_wide.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/template.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":641,"sizeDeletions":-160},{"number":"2","revision":"1592ef69513d95a7514c86ca6b6ef01f94215b50","parents":["699aa9828683320073d84acdceeeff5bcfc830ee"],"ref":"refs/changes/14/3614/2","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1520974158,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1520974160,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1521069613,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"comments":[{"file":"CONTRIBUTING.md","line":1,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"This file doesn\u0027t have any copyright info on it."},{"file":"CONTRIBUTING.md","line":1,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I believe that is expected -- at least, I copied most of it from another contemporary CONTRIBUTING.md file in another Manta project which also did not assert Copyright."},{"file":"lib/data_access.js","line":355,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"I think adding \"by the same plan\" would make this clearer."},{"file":"lib/data_access.js","line":355,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/executor.js","line":454,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Delete or expand?"},{"file":"lib/executor.js","line":454,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/executor.js","line":622,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"The \"need\" makes me feel like this should be a prioritized JIRA ticket."},{"file":"lib/executor.js","line":622,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I\u0027d like to defer this for now."},{"file":"lib/executor.js","line":899,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Describe away!"},{"file":"lib/executor.js","line":899,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/executor.js","line":923,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Formatting error?"},{"file":"lib/executor.js","line":923,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/http_server.js","line":234,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Delete or elaborate?"},{"file":"lib/http_server.js","line":234,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/http_server.js","line":281,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Same."},{"file":"lib/http_server.js","line":281,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/locks.js","line":31,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"This seems slightly out of place without a preceding descriptive sentence for why the example is here."},{"file":"lib/locks.js","line":31,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/phase_check_postgres_version.js","line":107,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Given that testing is over, do we still need this?"},{"file":"lib/phase_check_postgres_version.js","line":107,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I have reworked this a little."},{"file":"lib/phase_create_manatee_peers.js","line":365,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"What is intended here?"},{"file":"lib/phase_create_manatee_peers.js","line":365,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I think I was worried that this was not an adequately nuanced retry policy, and indeed, in practice, it was not!  I\u0027ll get rid of this in the follow-up ticket MANTA-3606."},{"file":"lib/phase_create_morays.js","line":62,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Delete or expand?"},{"file":"lib/phase_create_morays.js","line":62,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/phase_delete_data.js","line":511,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Haha oh the silent \"because that\u0027s a thing that\u0027s happened.\""},{"file":"lib/phase_delete_data.js","line":511,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Indeed!"},{"file":"lib/phase_establish_cluster.js","line":97,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"In that case, isn\u0027t firing the warning probably the right thing to do?"},{"file":"lib/phase_establish_cluster.js","line":97,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"There are probably two things that could be improved here:\n\n1. Pausing the plan will not break out of this wait if we never connect to zookeeper.  Unfortunately there is currently no way in the design of the pause/resume mechanism to be told asynchronously that a pause has been requested, so this is a little tricky.\n\n2. We could definitely report through the status mechanism that there has been a retry, and even how many of them we have seen.\n\nI\u0027d like to defer both of these to future work, though, and as I\u0027m not correcting either, I\u0027ll leave the XXX for now."},{"file":"lib/phase_remap_ring.js","line":230,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Does \"this\" here refer to the \"log messages\"?"},{"file":"lib/phase_remap_ring.js","line":230,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"No, I think I was referring to the POST endpoint itself.  I\u0027ve reworded the comment."},{"file":"lib/phase_remap_ring.js","line":480,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Delete or expand?"},{"file":"lib/phase_remap_ring.js","line":480,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/phase_restart_electric_moray_readonly.js","line":60,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Same comment as the other \"XXX This should be tunable.\""},{"file":"lib/phase_restart_electric_moray_readonly.js","line":60,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I have filed MANTA-3607 for this."},{"file":"lib/phase_restart_electric_moray_readwrite.js","line":60,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"I\u0027m not sure whether or not we should move all todos into JIRA tickets or not."},{"file":"lib/phase_restart_electric_moray_readwrite.js","line":60,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I have filed MANTA-3607 for this."},{"file":"lib/phase_shutdown_new_peers.js","line":37,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Why the uncertainty?"},{"file":"lib/phase_shutdown_new_peers.js","line":37,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I have reworded (and moved) this comment."},{"file":"lib/phase_unfreeze_cluster.js","line":124,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Sounds freasonable :)  Should we make a ticket and maybe point it to this spot in the code?"},{"file":"lib/phase_unfreeze_cluster.js","line":124,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"I have filed MANATEE-399 for this feature."},{"file":"lib/phase_update_electric_moray_ring.js","line":236,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Missing period."},{"file":"lib/phase_update_electric_moray_ring.js","line":236,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Done"},{"file":"lib/phase_update_electric_moray_ring.js","line":356,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"Do you want to leave this, or elaborate/file a ticket?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":15,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-14},{"file":"boot/everyboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"boot/firstboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"cmd/phases.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"cmd/plan_archive.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_get.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_list.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"cmd/plan_pause.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_resume.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_tune.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"cmd/plan_unhold.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/server.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"cmd/status.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/create_instance.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/data_access.js","type":"MODIFIED","insertions":9,"deletions":-2},{"file":"lib/electric_moray.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/executor.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/http_client.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/http_server.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/locks.js","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"lib/manatee_adm.js","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_sentinel_bucket.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/phase_critical_section_enter.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_critical_section_exit.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/phase_establish_cluster.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/phase_install_ring.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/phase_reconfigure_peers.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":10,"deletions":-11},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":10,"deletions":-11},{"file":"lib/phase_sapi_cleanup.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":12,"deletions":-8},{"file":"lib/phase_update_sapi_mark_readonly.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/phase_update_sapi_mark_readwrite.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/postgres.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/serial.js","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"lib/status.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/template.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/wrap.sh","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"scripts/reshard.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"smf/manifests/reshard.xml","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"templates/electric-moray-get-vnodes.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/electric-moray-update-ring.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-cleanup.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-create-archive.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-prime-workspace.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"templates/hashring-remap-vnodes.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/generate_cluster_state.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"test/manatee_adm_parser.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"test/status.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/status_wide.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/template.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":640,"sizeDeletions":-159},{"number":"3","revision":"cc8b1467a5a1f3ce439666a3265440f9702a1664","parents":["699aa9828683320073d84acdceeeff5bcfc830ee"],"ref":"refs/changes/14/3614/3","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1521500932,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521500934,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1521503006,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1521578997,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"comments":[{"file":"lib/phase_check_postgres_version.js","line":29,"reviewer":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},"message":"If this errors out, won\u0027t it be harder to debug the function \u003canonymous\u003e than if it were named?  This is a question I have for all the phase waterfall functions, so it would be a big change, and maybe not for this update.  I am curious why you chose not to name them, though, and wanted to bring it up in case there was a reason!"},{"file":"lib/phase_check_postgres_version.js","line":29,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Naming the functions can definitely help with debugging in some cases.  The particular case that I\u0027m aware of, where it is extremely helpful, is when profiling an application with DTrace and the ustack helper.  The context in which those probes fire generally only gives us a summary of the stack frame which includes only the function name.  I don\u0027t anticipate we\u0027ll be doing any profiling on the phase functions, as there just isn\u0027t a requirement for high performance -- most of what\u0027s going on is asynchronous scheduled work, like zone creation, where we\u0027re just waiting for it to be done before moving on.\n\nIn mdb, you can generally identify the specific function with, e.g., \"::jsstack -v\".  In that case you don\u0027t need the name per se; the debugger points you to the right place in the source.\n\nIn status output (for the resharder) and in log messages, it\u0027s much more important that we assemble useful cascading error messages with VError, than to have function names here, I think.\n\nThat said, I mostly went without names because there were a _lot_ of functions to name and I didn\u0027t really have the energy at the time to invent appropriate names for what are often pretty arbitrary divisions, especially due to the nature of all the async functions we end up calling."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":15,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-14},{"file":"boot/everyboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"boot/firstboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"cmd/phases.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"cmd/plan_archive.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_get.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_list.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"cmd/plan_pause.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_resume.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_tune.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"cmd/plan_unhold.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/server.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"cmd/status.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/create_instance.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/data_access.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/electric_moray.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/executor.js","type":"MODIFIED","insertions":33,"deletions":-15},{"file":"lib/http_client.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/http_server.js","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/locks.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/manatee_adm.js","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":13,"deletions":-5},{"file":"lib/phase_create_sentinel_bucket.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/phase_critical_section_enter.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_critical_section_exit.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/phase_establish_cluster.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/phase_install_ring.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/phase_reconfigure_peers.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_sapi_cleanup.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":21,"deletions":-13},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":15,"deletions":-11},{"file":"lib/phase_update_sapi_mark_readonly.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/phase_update_sapi_mark_readwrite.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/postgres.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/serial.js","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"lib/status.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/template.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/wrap.sh","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"scripts/reshard.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"smf/manifests/reshard.xml","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"templates/electric-moray-get-vnodes.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/electric-moray-update-ring.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-cleanup.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-create-archive.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-prime-workspace.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"templates/hashring-remap-vnodes.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/generate_cluster_state.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"test/manatee_adm_parser.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"test/status.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/status_wide.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/template.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":683,"sizeDeletions":-207},{"number":"4","revision":"5bd3db7abadc02219cfed68064d72eae8bd9a746","parents":["699aa9828683320073d84acdceeeff5bcfc830ee"],"ref":"refs/changes/14/3614/4","uploader":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"createdOn":1521579743,"author":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1521579751,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1521500934,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1521503006,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1521578997,"by":{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CONTRIBUTING.md","type":"ADDED","insertions":15,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":1,"deletions":-14},{"file":"boot/everyboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"boot/firstboot.sh","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"cmd/phases.js","type":"MODIFIED","insertions":9,"deletions":-8},{"file":"cmd/plan_archive.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_get.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_list.js","type":"MODIFIED","insertions":9,"deletions":-6},{"file":"cmd/plan_pause.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_resume.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/plan_tune.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"cmd/plan_unhold.js","type":"MODIFIED","insertions":8,"deletions":-3},{"file":"cmd/server.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"cmd/status.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/create_instance.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/data_access.js","type":"MODIFIED","insertions":11,"deletions":-3},{"file":"lib/electric_moray.js","type":"MODIFIED","insertions":9,"deletions":-3},{"file":"lib/executor.js","type":"MODIFIED","insertions":33,"deletions":-15},{"file":"lib/http_client.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/http_server.js","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/locks.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/manatee_adm.js","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"lib/phase_check_postgres_version.js","type":"MODIFIED","insertions":19,"deletions":-9},{"file":"lib/phase_create_manatee_peers.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_create_morays.js","type":"MODIFIED","insertions":13,"deletions":-5},{"file":"lib/phase_create_sentinel_bucket.js","type":"MODIFIED","insertions":11,"deletions":-2},{"file":"lib/phase_critical_section_enter.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_critical_section_exit.js","type":"MODIFIED","insertions":12,"deletions":-5},{"file":"lib/phase_delete_data.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/phase_establish_cluster.js","type":"MODIFIED","insertions":17,"deletions":-1},{"file":"lib/phase_freeze_cluster.js","type":"MODIFIED","insertions":12,"deletions":-1},{"file":"lib/phase_install_ring.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/phase_reconfigure_peers.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_remap_ring.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/phase_restart_electric_moray_readonly.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_restart_electric_moray_readwrite.js","type":"MODIFIED","insertions":10,"deletions":-12},{"file":"lib/phase_sapi_cleanup.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/phase_shutdown_new_peers.js","type":"MODIFIED","insertions":21,"deletions":-13},{"file":"lib/phase_unfreeze_cluster.js","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"lib/phase_update_electric_moray_ring.js","type":"MODIFIED","insertions":15,"deletions":-11},{"file":"lib/phase_update_sapi_mark_readonly.js","type":"MODIFIED","insertions":11,"deletions":-4},{"file":"lib/phase_update_sapi_mark_readwrite.js","type":"MODIFIED","insertions":12,"deletions":-2},{"file":"lib/postgres.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/serial.js","type":"MODIFIED","insertions":9,"deletions":-7},{"file":"lib/status.js","type":"MODIFIED","insertions":11,"deletions":0},{"file":"lib/template.js","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"lib/triton_access.js","type":"MODIFIED","insertions":12,"deletions":0},{"file":"lib/wrap.sh","type":"MODIFIED","insertions":9,"deletions":-1},{"file":"scripts/reshard.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"smf/manifests/reshard.xml","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"templates/electric-moray-get-vnodes.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/electric-moray-update-ring.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-cleanup.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-create-archive.sh","type":"MODIFIED","insertions":9,"deletions":0},{"file":"templates/hashring-prime-workspace.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"templates/hashring-remap-vnodes.sh","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/generate_cluster_state.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"test/manatee_adm_parser.js","type":"MODIFIED","insertions":10,"deletions":-2},{"file":"test/status.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/status_wide.js","type":"MODIFIED","insertions":10,"deletions":0},{"file":"test/template.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":683,"sizeDeletions":-207}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Brittany Wald","email":"brittany.wald@joyent.com","username":"princesspretzel"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}]}