{"project":"joyent/sdc-cnapi","branch":"master","id":"I293ec7bc3c6482de266064953fb8eea308d4f03b","number":"6032","subject":"TRITON-1297 CNAPI ServerReboot endpoint relies on \"exit 113\" and executing arbitrary shell scripts Reviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e Approved by: Orlando Vazquez \u003corlando@joyent.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/6032","commitMessage":"TRITON-1297 CNAPI ServerReboot endpoint relies on \"exit 113\" and executing arbitrary shell scripts\nReviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e\nApproved by: Orlando Vazquez \u003corlando@joyent.com\u003e\n","createdOn":1553889445,"lastUpdated":1554221702,"open":false,"status":"MERGED","comments":[{"timestamp":1553889445,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1553889446,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 36a78aaa5f9f4ceec29bd93fac24d60af50296bc\n    \n    implement reboot using server_reboot task\n    \n    commit 7caa1661f1f1c5c10a823176d42f3eb4a9eb5e68\n    \n    wip"},{"timestamp":1553889482,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1553895321,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2."},{"timestamp":1553895322,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 8ed0488291fdecc08cc2a1afce4fddb90e9632b4\n    \n    regen docs"},{"timestamp":1553895354,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1553901778,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 3."},{"timestamp":1553901780,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 6e8af43f1d7dd7e583c1add97864ebc805dab447\n    \n    remove space\n    \n    commit 81f930f8b86848a3266bc388609b8943ac3fb3fc\n    \n    fix existing tests"},{"timestamp":1553901811,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1554153828,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\n(1 comment)"},{"timestamp":1554154786,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1554155097,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 4."},{"timestamp":1554155099,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 1d1d65d09ac27daf17e5f50fe94adca7476b2cb4\n    \n    üêç case"},{"timestamp":1554155129,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1554220274,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1554221702,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"4","revision":"293ec7bc3c6482de266064953fb8eea308d4f03b","parents":["ba9d19aec855d992217bb10e079671c915fbe342"],"ref":"refs/changes/32/6032/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1554155097,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554155129,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554220274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554220274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1554221702,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":78,"deletions":-6},{"file":"lib/models/server.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/workflows/server-reboot.js","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":-1}],"sizeInsertions":131,"sizeDeletions":-23},"patchSets":[{"number":"1","revision":"973c43722ddf9585cc27efa94b0eccf2a890c85e","parents":["ba9d19aec855d992217bb10e079671c915fbe342"],"ref":"refs/changes/32/6032/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1553889445,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1553889482,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/servers.js","line":627,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"extra space between function name and left paren"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":78,"deletions":-6},{"file":"lib/models/server.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/workflows/server-reboot.js","type":"MODIFIED","insertions":28,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":109,"sizeDeletions":-11},{"number":"2","revision":"f2732443f77133468066f3c0d0f068c587180325","parents":["ba9d19aec855d992217bb10e079671c915fbe342"],"ref":"refs/changes/32/6032/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1553895321,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1553895354,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/endpoints/servers.js","line":627,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"extra space between function name and left paren"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":78,"deletions":-6},{"file":"lib/models/server.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/workflows/server-reboot.js","type":"MODIFIED","insertions":28,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":123,"sizeDeletions":-20},{"number":"3","revision":"b6cf9768515a4995d79569f571c98f08aa95dffa","parents":["ba9d19aec855d992217bb10e079671c915fbe342"],"ref":"refs/changes/32/6032/3","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1553901778,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1553901811,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554153828,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554153828,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"comments":[{"file":"lib/endpoints/servers.js","line":378,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Minor nit but all the other params have names with \"snake_case\". For internal objects I think it\u0027s not as big a deal but for public stuff it\u0027d be nice to keep it consistent."},{"file":"lib/endpoints/servers.js","line":378,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Good point. I\u0027ll change this. Thanks."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":78,"deletions":-6},{"file":"lib/models/server.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/workflows/server-reboot.js","type":"MODIFIED","insertions":28,"deletions":-3},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":-1}],"sizeInsertions":129,"sizeDeletions":-21},{"number":"4","revision":"293ec7bc3c6482de266064953fb8eea308d4f03b","parents":["ba9d19aec855d992217bb10e079671c915fbe342"],"ref":"refs/changes/32/6032/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1554155097,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1554155129,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1554221702,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1554220274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1554220274,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":14,"deletions":-9},{"file":"lib/endpoints/servers.js","type":"MODIFIED","insertions":78,"deletions":-6},{"file":"lib/models/server.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/workflows/server-reboot.js","type":"MODIFIED","insertions":30,"deletions":-5},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":-1}],"sizeInsertions":131,"sizeDeletions":-23}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}