From 736808fa56ff221deb33af033ccce1f4b43900c2 Mon Sep 17 00:00:00 2001
From: John Levon <john.levon@joyent.com>
Date: Mon, 29 Jul 2019 15:59:35 +0000
Subject: [PATCH] OS-7906 buffer overflow in zoneadmd/zfd.c Reviewed by: Mike
 Gerdts <mike.gerdts@joyent.com> Approved by: Mike Gerdts
 <mike.gerdts@joyent.com>

---
 usr/src/cmd/zoneadmd/zfd.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/usr/src/cmd/zoneadmd/zfd.c b/usr/src/cmd/zoneadmd/zfd.c
index 8f4307a653..307d916154 100644
--- a/usr/src/cmd/zoneadmd/zfd.c
+++ b/usr/src/cmd/zoneadmd/zfd.c
@@ -561,7 +561,7 @@ ctlcmd_process(int sockfd, int stdoutfd, unsigned int *flags)
 	if (i == 0) {
 		goto fail;
 	}
-	buf[i+1] = '\0';
+	buf[i] = '\0';
 
 	if (strncmp(buf, "TIOCSWINSZ ", 11) == 0) {
 		char *next = buf + 11;
-- 
2.21.0

