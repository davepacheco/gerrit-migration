commit 1a0d9241664ff2f2a75c0d0c61d3c0c0d3086a70
Author: John Levon <john.levon@joyent.com>
Date:   2019-07-26T13:46:53+00:00 (2 months ago)
    
    OS-7906 buffer overflow in zoneadmd/zfd.c

diff --git a/usr/src/cmd/zoneadmd/zfd.c b/usr/src/cmd/zoneadmd/zfd.c
index 8f4307a653..307d916154 100644
--- a/usr/src/cmd/zoneadmd/zfd.c
+++ b/usr/src/cmd/zoneadmd/zfd.c
@@ -561,7 +561,7 @@ ctlcmd_process(int sockfd, int stdoutfd, unsigned int *flags)
 	if (i == 0) {
 		goto fail;
 	}
-	buf[i+1] = '\0';
+	buf[i] = '\0';
 
 	if (strncmp(buf, "TIOCSWINSZ ", 11) == 0) {
 		char *next = buf + 11;
