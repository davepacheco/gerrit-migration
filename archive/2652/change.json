{"project":"joyent/node-fast","branch":"master","id":"Ie752171073fc22613d99d83bd794b79ca61f2c24","number":"2652","subject":"joyent/node-fast#9 node-fast could track basic request metrics Reviewed by: David Pacheco \u003cdap@joyent.com\u003e Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved by: David Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"url":"https://cr.joyent.us/2652","commitMessage":"joyent/node-fast#9 node-fast could track basic request metrics\nReviewed by: David Pacheco \u003cdap@joyent.com\u003e\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: David Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1506375827,"lastUpdated":1507215156,"open":false,"status":"MERGED","comments":[{"timestamp":1506375827,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 1."},{"timestamp":1506375829,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n(2 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1506376067,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\nThat\u0027s weird. \u0027make check\u0027 shows no issues on my machine, but these issues are present in the code."},{"timestamp":1506376417,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 2."},{"timestamp":1506376421,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506376481,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 1:\n\nHm. The linting error was because I used \u0027npm install jsl\u0027, which installed some random guy\u0027s \u0027jsl\u0027 linting library. Unfortunately the library I installed didn\u0027t have a non-zero exit status, or log anything. At any rate, that is fixed now."},{"timestamp":1506383547,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1506436959,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 3."},{"timestamp":1506436964,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506436999,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1506448589,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(6 comments)"},{"timestamp":1506452336,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1506465668,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 4."},{"timestamp":1506465672,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506466509,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3:\n\n(7 comments)\n\nThanks for taking a look, guys. A few changes are in. I need to think about how we could reliably test the metric stuff (besides just hitting the server endpoint), and look into the restify memory/connection leak question."},{"timestamp":1506487080,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1506527454,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 5."},{"timestamp":1506527458,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506530720,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1506546822,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 5:\n\n(4 comments)\n\nThis is looking great!  I noticed a couple of places where we could document the new parameter.  It\u0027d be great to check on the potential leak issue and have some tests, but I wouldn\u0027t consider those blockers here.\n\nI wonder if it\u0027s worth running a basic memory leak check (running `fastbench` for a while and checking for whether memory usage stabilizes)."},{"timestamp":1506701899,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 6."},{"timestamp":1506701904,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1506702419,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3:\n\n(3 comments)\n\nThanks! I fixed the connection/memory leak issue. I\u0027ll have to do the same in the Moray CR."},{"timestamp":1507148813,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1507152489,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 7."},{"timestamp":1507152493,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507153632,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1507153943,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 7:\n\nI also wrote test notes in the GitHub ticket. Let me know if I should do more testing or if we need any more changes."},{"timestamp":1507160755,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 7: Integration-Approval+1"},{"timestamp":1507166141,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1507215116,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1507215156,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Kody A Kantor"}],"currentPatchSet":{"number":"8","revision":"e752171073fc22613d99d83bd794b79ca61f2c24","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/8","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507215116,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507152493,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507153632,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507160755,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507166141,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1507215156,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":20,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":45,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":29,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":107,"sizeDeletions":-21},"patchSets":[{"number":"1","revision":"a4ad1d659fbcd32d4beb25aa36b16f50db3806ad","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/1","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506375827,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1506375829,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastserve","line":64,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: variable is declared but never referenced: kangserver"},{"file":"bin/fastserve","line":87,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: trailing_comma"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":42,"deletions":-20},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":25,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":98,"sizeDeletions":-21},{"number":"2","revision":"f3e0818dfce5085301cdfe89c6cfbb9444de4be9","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/2","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506376417,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506376421,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"CHANGES.md","line":7,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"2.3.0"},{"file":"CHANGES.md","line":7,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"package.json","line":4,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"2.3.0"},{"file":"package.json","line":4,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":41,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":25,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":97,"sizeDeletions":-20},{"number":"3","revision":"fc0398f780cf63460c61437db79f255d1c95f90e","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/3","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506436959,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506436964,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastserve","line":115,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"We don\u0027t seem to read the body here.  If the client\u0027s request contains a non-empty body, does this cause us to leak either memory or the socket?"},{"file":"bin/fastserve","line":115,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I\u0027m guessing that since you brought it up, it\u0027s a problem. I don\u0027t understand how restify/nodejs works well enough to make a change right now. I\u0027ll keep looking for a better solution."},{"file":"bin/fastserve","line":115,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"If it turns out that this is a problem, then it\u0027s something I think we\u0027d need to fix either in node\u0027s HTTP server, or in Restify. While you can send a request body in GET requests, they are not supposed to have semantic impact on the request, so it seems like we should never be looking at it in our code. I verified that sending a body in a GET request does show up in req.body, and then hit NAPI with the following:\n\n    while true; do sdc-napi /network_pools -X GET -d@- \u003c\u003c\u003c \u0027{\"foo\":\"bar\"}\u0027; done\n\nThe memory usage started out at 57M. After 10 minutes it was 67M. After 70 minutes it was at 70M, and had been at 71-72M shortly before that. I gcore\u0027d the process, and took a look through its objects and closures. I didn\u0027t see anything that looked like a leak. I then ran:\n\n    for x in {1..2000}; do sdc-napi /network_pools -X GET -d@- \u003c\u003c\u003c \u0027{\"foo\":\"bar\"}\u0027 \u0026 done\n\nMemory usage went to 71M briefly, but dropped to 70M after everything finished."},{"file":"bin/fastserve","line":115,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"@Cody: If this is a problem, I suspect it would be limited to large request bodies, where Node actually stopped reading from the socket (because its own buffers were full) and data accumulated in the kernel.  That\u0027s the case where Node won\u0027t even see end-of-stream, even if the other side of the TCP socket has sent it.  It would be interesting to try that test again with, say, a 10MB request body.\n\nI do think that this is probably a problem in restify, though I guess that\u0027s debatable.  The question is: when you send a response, what component is responsible for making sure that the request was cleaned up?  I tend to think that if you get to the end of the restify request processing pipeline (for any reason) and the response has not emitted \u0027end\u0027 and is paused, restify should probably read (and dump) the rest of the request body, which would allow the socket to be cleaned up.\n\nThat said, it\u0027s pretty easy to implement this behavior outside of restify.\n\nI mentioned offline to Kody that I wasn\u0027t sure it was valid in HTTP to send a response without having read the whole request.  It appears that it probably is valid, but that not all clients (browsers in particular) deal with it well.  Moreover, the state of the connection is likely undefined after that."},{"file":"bin/fastserve","line":115,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"This did turn out to be a problem. I ran a few tests where I sent a large request body (400k) in a loop. I saw the RSS skyrocket (from 35M to 230M in less than a minute) and never level out. There is also a socket leak when we don\u0027t read the full request. I implemented what I think is Dave\u0027s suggested fix, and that seems to have resolved both the memory and connection leaks.\n\nLike Cody mentioned, this is probably a pattern that we would have to implement in a lot of places. I know this problem exists in the muskie metrics code today for one."},{"file":"bin/fastserve","line":123,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"What version does this represent? The version of the Prometheus protocol? If so, should we be getting this number (or the whole header) from a constant in artedi, in case someone updates the artedi dep to one that speaks a different version, like 0.0.5?"},{"file":"bin/fastserve","line":123,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Good point! I\u0027ll file an artedi ticket to do this. It seems like something it should provide."},{"file":"lib/fast_server.js","line":208,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"\"tcp\" here (and L209, L212, and L213) seems odd.  Shouldn\u0027t this be \"fast\"?"},{"file":"lib/fast_server.js","line":208,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I could switch this to \u0027fast\u0027 if you think it\u0027s more correct. I\u0027m not sure though. It doesn\u0027t seem like we should label restify-processed requests as \u0027restify_requests_completed,\u0027 so I thought that we wouldn\u0027t label fast-processed requests with \u0027fast_requests_completed.\u0027"},{"file":"lib/fast_server.js","line":208,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I think that \u0027fast\u0027 is more correct, since this doesn\u0027t get bumped each time a TCP connection closes, but every time a fast request finishes. (I think that the restify equivalent would be http_requests_completed, and it would get bumped per request, even though HTTP Keep-Alive might cause them to all be on the same TCP connection.)"},{"file":"lib/fast_server.js","line":208,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"lib/fast_server.js","line":860,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I think we want to used elapsed time rather than wall time here (e.g., process.hrtime())."},{"file":"lib/fast_server.js","line":860,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done. Let me know if how I\u0027ve implemented that isn\u0027t okay. It would be nice if we could start tracking the time a request takes _before_ it hits a request handler (maybe in the decode stage), but I\u0027m not sure if this is good enough. Let me know if what\u0027s here now could be better."},{"file":"lib/fast_server.js","line":862,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Is there any reason not to store this as a member field on the server and use it directly, instead of looking it up here?"},{"file":"lib/fast_server.js","line":862,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done"},{"file":"package.json","line":22,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Should this be a devDependency?  This feels like a lot to pull into every fast server, and I think you only need it for \"fastserve\"."},{"file":"package.json","line":22,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"\"artedi\" too. The programs under bin/ aren\u0027t exported with a \"directories\" entry in this package.json, so they\u0027re only exposed to developers (and don\u0027t end up in node_modules/.bin directories, and therefore possibly people\u0027s PATHs)."},{"file":"package.json","line":22,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Done. I wasn\u0027t sure, since the bin/ programs are shipped in Moray zones, but this makes sense! Thanks."},{"file":"test/tst.server.js","line":167,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"What do you think about having the test cases read out the metrics and verify them, too?"},{"file":"test/tst.server.js","line":167,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"I think this is a decent amount of work. I\u0027m not totally opposed to doing that, but it will be complicated and possibly messy because artedi doesn\u0027t have a public API for accessing counter values. We would be relegated to parsing strings, at least until we get the node-skinner stuff in artedi."},{"file":"test/tst.server.js","line":167,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Okay.  It would be neat if you could fetch the current values from the counter object (for example), but I realize that might not be trivial."},{"file":"test/tst.server.js","line":167,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Yes, we could do that, but I don\u0027t want to consider that a stable API, especially since that will likely be changing with the node-skinner integration. I opened an artedi issue to have a public API for getting counter values."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":41,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":25,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":97,"sizeDeletions":-20},{"number":"4","revision":"ede20b67ca258f1fdbd28d9623a349013de46ddc","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/4","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506465668,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506465672,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":41,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":100,"sizeDeletions":-21},{"number":"5","revision":"b55fb29a918db5be956e27e621e1ca5a2392b7f7","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/5","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506527454,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506527458,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"README.md","line":318,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Can we add the collector here as well?"},{"file":"lib/fast_server.js","line":172,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Can we document this in the constructor above?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":41,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":100,"sizeDeletions":-21},{"number":"6","revision":"6dddfc24d7f7a9e992731fd09195805a107f0da8","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/6","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1506701899,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1506701904,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/fastserve","line":119,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"The style in this repo is to indent the function like you had it before.  (Sorry for the confusion.)"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":20,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":45,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":29,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":107,"sizeDeletions":-21},{"number":"7","revision":"bff920c366fa7d274e1bd8411469065c6a550a53","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/7","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507152489,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507153632,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507160755,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507166141,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507152493,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":20,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":45,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":29,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":107,"sizeDeletions":-21},{"number":"8","revision":"e752171073fc22613d99d83bd794b79ca61f2c24","parents":["fb3b57fb2327f7da9fcc8ab5a5c6412c27a5776e"],"ref":"refs/changes/52/2652/8","uploader":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"createdOn":1507215116,"author":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507153632,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1507160755,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507166141,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507152493,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1507215156,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":20,"deletions":0},{"file":"bin/fastserve","type":"MODIFIED","insertions":45,"deletions":-19},{"file":"lib/fast_server.js","type":"MODIFIED","insertions":29,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":4,"deletions":-2},{"file":"test/tst.server.js","type":"MODIFIED","insertions":5,"deletions":0}],"sizeInsertions":107,"sizeDeletions":-21}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}]}