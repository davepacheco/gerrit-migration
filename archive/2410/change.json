{"project":"joyent/manta-muskie","branch":"master","id":"Ieebaea1f31159a224656a20dd92eba65a4d46616","number":"2410","subject":"MANTA-3319 mpu-create ought to record when an MPU is created in the upload record Reviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e Approved by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e","owner":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"url":"https://cr.joyent.us/2410","commitMessage":"MANTA-3319 mpu-create ought to record when an MPU is created in the upload record\nReviewed by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e\nApproved by: Jordan Hendricks \u003cjordan.hendricks@joyent.com\u003e\n","createdOn":1502835600,"lastUpdated":1503014028,"open":false,"status":"MERGED","comments":[{"timestamp":1502835600,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 1."},{"timestamp":1502835630,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1502838837,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 1:\n\n(3 comments)\n\nAwesome job! Thanks for taking this on. I have a couple comments for the code review.\n\nAs for integration approval, in general you will need:\n- testing notes in the ticket (see MANTA-2910 for an example)\n- `make prepush` run as a part of testing\n- a description of any relevant manual testing done in the ticket\n\nAfter the code review comments are addressed, I can do IA for this as well, since it\u0027s such a small change."},{"timestamp":1502907643,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 2."},{"timestamp":1502907700,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1502985101,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 2: Code-Review+1\n\n(1 comment)"},{"timestamp":1503005500,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Uploaded patch set 3."},{"timestamp":1503005527,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1503005771,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1503005922,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 3:\n\nHas `make prepush` been run against the latest patchset for this?\n\nAlso, it would be good to see what the mpu-get output looks like for an upload that was created *before* this change."},{"timestamp":1503005958,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 3:\n\nI think once we have a manual test for an mpu-get with an older MPU this will be good to go from an IA perspective as well."},{"timestamp":1503013219,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1503013879,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 4: Commit message was updated."},{"timestamp":1503013995,"reviewer":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1503014003,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jan Wyszynski"},{"timestamp":1503014028,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"5","revision":"97955761d53c0a49ace9be61c4716fc1ccae983e","parents":["0aca7a4f972564a594e24622a1299b902c09326e"],"ref":"refs/changes/10/2410/5","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1503013995,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503005527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503005771,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503013219,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"SUBM","value":"1","grantedOn":1503014003,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":41,"sizeDeletions":-4},"patchSets":[{"number":"1","revision":"12b5c376f0249da7eef3068b62d8c13ccb2e2a04","parents":["af4520cc26aaed16d4e4024f8088c4a2d6eed8b0"],"ref":"refs/changes/10/2410/1","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1502835600,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502835630,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/uploads/common.js","line":106,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"While this description is more precise, I might instead say \"time of MPU creation\" instead of \"upload record creation\" time to give some context as to what it means."},{"file":"lib/uploads/common.js","line":918,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Have you tested what happens if an mpu-get is called for an upload record before this change? I would expect it to be undefined, which shouldn\u0027t be a problem here, but would still be a good case to check (at least in manual testing)."},{"file":"test/mpu/create.test.js","line":62,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Should we also check for the existence of creationTimeMs in checkGetResponse() (mpu/helper.js)?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0}],"sizeInsertions":37,"sizeDeletions":-4},{"number":"2","revision":"6576b97e08532454e8eb74b937d6dc02756a231f","parents":["af4520cc26aaed16d4e4024f8088c4a2d6eed8b0"],"ref":"refs/changes/10/2410/2","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1502907643,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502907700,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1502985101,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"comments":[{"file":"test/mpu/create.test.js","line":78,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Looks like the indentation in this if block is off."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":41,"sizeDeletions":-4},{"number":"3","revision":"eebaea1f31159a224656a20dd92eba65a4d46616","parents":["af4520cc26aaed16d4e4024f8088c4a2d6eed8b0"],"ref":"refs/changes/10/2410/3","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1503005500,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503005527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503005771,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503013219,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":41,"sizeDeletions":-4},{"number":"4","revision":"cf94bdb856b60ebc0445dcac52ee1c30c70bcb6a","parents":["af4520cc26aaed16d4e4024f8088c4a2d6eed8b0"],"ref":"refs/changes/10/2410/4","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1503013879,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503005527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503005771,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503013219,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":41,"sizeDeletions":-4},{"number":"5","revision":"97955761d53c0a49ace9be61c4716fc1ccae983e","parents":["0aca7a4f972564a594e24622a1299b902c09326e"],"ref":"refs/changes/10/2410/5","uploader":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"createdOn":1503013995,"author":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1503005527,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1503005771,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1503013219,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}},{"type":"SUBM","value":"1","grantedOn":1503014003,"by":{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/uploads/common.js","type":"MODIFIED","insertions":10,"deletions":-4},{"file":"test/mpu/create.test.js","type":"MODIFIED","insertions":27,"deletions":0},{"file":"test/mpu/helper.js","type":"MODIFIED","insertions":4,"deletions":0}],"sizeInsertions":41,"sizeDeletions":-4}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},{"name":"Jan Wyszynski","email":"jan.wyszynski@joyent.com","username":"IanWyszynski"}]}