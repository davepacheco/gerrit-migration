From 5c662ad07ab4e937323f04b5e910a595c0eeca87 Mon Sep 17 00:00:00 2001
From: Pedro Palazon Candel <pedro@joyent.com>
Date: Wed, 18 Oct 2017 11:27:22 +0200
Subject: [PATCH] SAPI-293 moray storage layer's putObject implementation
 doesn't handle errors correctly

---
 lib/server/stor/moray.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/server/stor/moray.js b/lib/server/stor/moray.js
index aaded7d..cb26743 100644
--- a/lib/server/stor/moray.js
+++ b/lib/server/stor/moray.js
@@ -356,6 +356,7 @@ function putObject(bucket, uuid, obj, opts, cb) {
         if (err) {
             log.error(err, 'failed to put object %s', uuid);
             cb(err);
+            return;
         }
 
         var record = {};
-- 
2.21.0

