{"project":"joyent/smartos-live","branch":"master","id":"I749766ecf54fa4bf388e26a9de49ada8a5a133e4","number":"5170","subject":"OS-7352 VM.update should allow disk resize with update_disks Reviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e Reviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e Reviewed by: Dylan Yep \u003cdylan.yep@joyent.com\u003e Approved by: Pedro Palazón Candel \u003cpedro@joye","owner":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"url":"https://cr.joyent.us/5170","commitMessage":"OS-7352 VM.update should allow disk resize with update_disks\nReviewed by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\nReviewed by: Orlando Vazquez \u003corlando@joyent.com\u003e\nReviewed by: Dylan Yep \u003cdylan.yep@joyent.com\u003e\nApproved by: Pedro Palazón Candel \u003cpedro@joyent.com\u003e\n","createdOn":1543808593,"lastUpdated":1543927512,"open":false,"status":"MERGED","comments":[{"timestamp":1543808593,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 1."},{"timestamp":1543808648,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543809972,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 2."},{"timestamp":1543810028,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543810190,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 3."},{"timestamp":1543810242,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543850019,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3: Code-Review+1\n\n(5 comments)\n\nOther than some observations regarding array methods and minor stuff, looks good to me (Assuming tests are passing, though)"},{"timestamp":1543857825,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 4."},{"timestamp":1543857881,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543872743,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 4:\n\n(15 comments)"},{"timestamp":1543873425,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 4:\n\n(5 comments)"},{"timestamp":1543876780,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 5."},{"timestamp":1543876791,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4:\n\n(24 comments)"},{"timestamp":1543876863,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543877985,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1543882618,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 6."},{"timestamp":1543882687,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing-1\n\n\"make check\" exited with status 2\n\n /tmp/repo/src/vm/tests/test-vrrp-nics.js\n /tmp/repo/src/vm/tests/test-vminfod.js\n /tmp/repo/src/vm/tests/test-vminfod-zonewatcher.js\n /tmp/repo/src/vm/tests/test-vminfod-zonewatcher-overflow.js\n /tmp/repo/src/vm/tests/test-vminfod-zpoolwatcher.js\n /tmp/repo/src/vm/lib/metadata/agent.js\n /tmp/repo/src/vm/lib/metadata/common.js\n /tmp/repo/src/vm/lib/metadata/crc32.js\n /tmp/repo/src/disklayout.js\n /tmp/repo/src/mkzpool.js\n /tmp/repo/src/ntp_config.js\n /tmp/repo/src/node_modules/disklayout.js\n \n 0 error(s), 0 warnings(s)\n \n \u003d\u003d\u003e Running jsstyle...\n (for file in filewait.js node_modules/{system,onlyif,net-boot-config}.js net-boot-config vm/sbin/*.js vm/node_modules/diff.js vm/node_modules/dladm.js vm/node_modules/expander.js vm/node_modules/fswatcher.js vm/node_modules/hrtime.js vm/node_modules/ip.js vm/node_modules/nic.js vm/node_modules/proptable.js vm/node_modules/utils.js vm/node_modules/VM.js vm/node_modules/qmp.js vm/node_modules/queue.js vm/node_modules/openonerrlogger.js vm/node_modules/vmload/*.js vm/node_modules/vminfod/*.js vm/node_modules/sysevent-stream.js vm/node_modules/zonecfg.js vm/node_modules/zoneevent.js img/lib/*.js img/sbin/imgadm vm/common/nictag.js vm/tests/common.js vm/tests/test-alias.js vm/tests/test-bhyve-disk-resize.js vm/tests/test-bhyve-pci.js vm/tests/test-bhyve-pci_slot.js vm/tests/test-cleanup-on-failure.js vm/tests/test-create-filesystems.js vm/tests/test-create.js vm/tests/test-defaults.js vm/tests/test-docker.js vm/tests/test-firewall.js vm/tests/test-fswatcher.js vm/tests/test-hrtime.js vm/tests/test-indestructible.js vm/tests/test-internal_metadata_namespaces.js vm/tests/test-lastexited.js vm/tests/test-openonerrlogger.js vm/tests/test-queue.js vm/tests/test-quota.js vm/tests/test-reboot.js vm/tests/test-reprovision.js vm/tests/test-send-recv.js vm/tests/test-snapshots.js vm/tests/test-spoof-opts.js vm/tests/test-sysinfo.js vm/tests/test-tmpfs.js vm/tests/test-update.js vm/tests/test-vrrp-nics.js vm/tests/test-vminfod.js vm/tests/test-vminfod-zonewatcher.js vm/tests/test-vminfod-zonewatcher-overflow.js vm/tests/test-vminfod-zpoolwatcher.js vm/lib/metadata/*.js; do \\\n \techo /tmp/repo/src/$file; \\\n \t/tmp/repo/src/../tools/jsstyle/jsstyle -o indent\u003d4,strict-indent\u003d1,doxygen,unparenthesized-return\u003d0,continuation-at-front\u003d1,leading-right-paren-ok\u003d1 $file; \\\n \t[[ $? \u003d\u003d \"0\" ]] || exit 1; \\\n done)\n /tmp/repo/src/filewait.js\n /tmp/repo/src/node_modules/system.js\n /tmp/repo/src/node_modules/onlyif.js\n /tmp/repo/src/node_modules/net-boot-config.js\n /tmp/repo/src/net-boot-config\n /tmp/repo/src/vm/sbin/add-userscript.js\n /tmp/repo/src/vm/sbin/metadata.js\n /tmp/repo/src/vm/sbin/vmadm.js\n /tmp/repo/src/vm/sbin/vmadmd.js\n /tmp/repo/src/vm/sbin/vmdf.js\n /tmp/repo/src/vm/sbin/vminfo.js\n /tmp/repo/src/vm/sbin/vminfod.js\n /tmp/repo/src/vm/node_modules/diff.js\n /tmp/repo/src/vm/node_modules/dladm.js\n /tmp/repo/src/vm/node_modules/expander.js\n /tmp/repo/src/vm/node_modules/fswatcher.js\n /tmp/repo/src/vm/node_modules/hrtime.js\n /tmp/repo/src/vm/node_modules/ip.js\n /tmp/repo/src/vm/node_modules/nic.js\n /tmp/repo/src/vm/node_modules/proptable.js\n /tmp/repo/src/vm/node_modules/utils.js\n /tmp/repo/src/vm/node_modules/VM.js\n vm/node_modules/VM.js: 2305: missing space between keyword and paren\n Makefile:463: recipe for target \u0027check\u0027 failed\n make[1]: *** [check] Error 1\n make[1]: Leaving directory \u0027/tmp/repo/src\u0027\n Makefile:387: recipe for target \u0027check\u0027 failed\n gmake: *** [check] Error 2"},{"timestamp":1543882694,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 6:\n\n(1 comment)"},{"timestamp":1543882749,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 7."},{"timestamp":1543882803,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1543899736,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1543900110,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Patch Set 7: Code-Review+1"},{"timestamp":1543916427,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 7: Code-Review+1 Integration-Approval+1\n\nI assume all test passing"},{"timestamp":1543927418,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1543927472,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"},{"timestamp":1543927491,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 9: Commit message was updated."},{"timestamp":1543927512,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Mike Gerdts"}],"currentPatchSet":{"number":"9","revision":"5bbd31725fc1d57535b0b605a3ca657bde1333e1","parents":["e74ed0afff867eaf969b94618d8ed1fe47e169bc"],"ref":"refs/changes/70/5170/9","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543927491,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543882803,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543899736,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543900110,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"SUBM","value":"1","grantedOn":1543927512,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":548,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":899,"sizeDeletions":-203},"patchSets":[{"number":"1","revision":"2e85843cd3a7b1062fa03340552605db1394e872","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/1","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543808593,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543808648,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":523,"deletions":-121},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":332,"deletions":-65}],"sizeInsertions":863,"sizeDeletions":-187},{"number":"2","revision":"1353477670bca0e9c8d848c86e20abbb054ac7f1","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/2","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543809972,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543810028,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":519,"deletions":-121},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":332,"deletions":-65}],"sizeInsertions":859,"sizeDeletions":-187},{"number":"3","revision":"ec49609d511ab50a7a084b9e2d6b3880df30a552","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/3","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543810190,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543810242,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543850019,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"comments":[{"file":"src/vm/node_modules/VM.js","line":2405,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"It would be great to name these functions for debug purposes"},{"file":"src/vm/node_modules/VM.js","line":2405,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2426,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"name"},{"file":"src/vm/node_modules/VM.js","line":2426,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":3042,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Should this say \"KVM\"?"},{"file":"src/vm/node_modules/VM.js","line":3042,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":14592,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"assert callback function"},{"file":"src/vm/node_modules/VM.js","line":14592,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":14613,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Either `updates.forEach` or `for (var i \u003d 0; i \u003c updates.length ; i +\u003d 1)` would be better choices than the `for ... in` loop. Ditto for the `for (vmDisk in vmDisks)` below."},{"file":"src/vm/node_modules/VM.js","line":14613,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/tests/test-bhyve-disk-resize.js","line":159,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Nit: would be good to assert opts if asserting sub-properties of it."},{"file":"src/vm/tests/test-bhyve-disk-resize.js","line":159,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/tests/test-bhyve-disk-resize.js","line":214,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Nit: would be good to assert opts if asserting sub-properties of it."},{"file":"src/vm/tests/test-bhyve-disk-resize.js","line":260,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Same here. I\u0027d possibly just go with a `payload.update_disks.map` function here, since that\u0027s what you\u0027re doing, modifying that to something else."},{"file":"src/vm/tests/test-bhyve-disk-resize.js","line":260,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"I don\u0027t think array.map helps here.  This function returns a copy of the input payload with each payload.disks.*.path expanded.  I have simplified it a bit using forEach."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":519,"deletions":-121},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":327,"deletions":-65}],"sizeInsertions":854,"sizeDeletions":-187},{"number":"4","revision":"9ba39a55fe67788defcd92887abee93d31ebb5bd","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/4","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543857825,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543857881,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/VM.js","line":2298,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Would be good assert.func() `callback`, or use optionalFunc if it is indeed optional."},{"file":"src/vm/node_modules/VM.js","line":2298,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2308,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"assert optionalNumber volume.block_size?"},{"file":"src/vm/node_modules/VM.js","line":2308,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2352,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"asserts"},{"file":"src/vm/node_modules/VM.js","line":2352,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2360,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Nit: Looks like the rest of the file doesn\u0027t pad single element arrays with spaces"},{"file":"src/vm/node_modules/VM.js","line":2360,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Huh.  I coulda sworn that \u0027make check\u0027 grumbled about the lack of space.  Maybe that\u0027s just for [{}]."},{"file":"src/vm/node_modules/VM.js","line":2381,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"hasOwnProperty returns true even if the value of the property is null or undefined. Since we\u0027re not messing around with the the prototype chain of the `volume` object, it might be better to do this:\n\nvar vbs \u003d volume.block_size || DEFAULT_VOLBLOCKSIZE;"},{"file":"src/vm/node_modules/VM.js","line":2381,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2402,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"asserts"},{"file":"src/vm/node_modules/VM.js","line":2402,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2408,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"function name"},{"file":"src/vm/node_modules/VM.js","line":2408,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":2430,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Drop the (period, space)"},{"file":"src/vm/node_modules/VM.js","line":2430,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Fix capitalization instead."},{"file":"src/vm/node_modules/VM.js","line":2473,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"asserts"},{"file":"src/vm/node_modules/VM.js","line":2473,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":3043,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I know you didn\u0027t add this function, but while we\u0027re adding asserts here... :)"},{"file":"src/vm/node_modules/VM.js","line":3043,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":4193,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Couldn\u0027t parse this."},{"file":"src/vm/node_modules/VM.js","line":4193,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Easier if you say it with a slur.  ;)"},{"file":"src/vm/node_modules/VM.js","line":4198,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"assert"},{"file":"src/vm/node_modules/VM.js","line":4198,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":14742,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"I know this isn\u0027t your contribution but I would move this up to L14621. My reasoning being that this is part of the flow of the function, but it\u0027s buried (and easily lost) at the end of `resizeDisks`, after inner function declarations, and since JS function declarations don\u0027t need to be exist before their first usage, I think unless they are very short it reads better to push them to the bottom, after the main function logic."},{"file":"src/vm/node_modules/VM.js","line":14742,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done.  I can\u0027t tell you how many times I moved some of the nested functions around in an attempt to make code readable."},{"file":"src/vm/node_modules/VM.js","line":14789,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Duplicate assert?"},{"file":"src/vm/node_modules/VM.js","line":14789,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":14798,"reviewer":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},"message":"Duplicate assert?"},{"file":"src/vm/node_modules/VM.js","line":14798,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/VM.js","line":14811,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Nit: Looks like the rest of the file doesn\u0027t pad single element arrays with spaces"},{"file":"src/vm/node_modules/VM.js","line":14811,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"},{"file":"src/vm/node_modules/proptable.js","line":592,"reviewer":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},"message":"Add this to the vmadm docs?"},{"file":"src/vm/node_modules/proptable.js","line":592,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":518,"deletions":-124},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":324,"deletions":-65}],"sizeInsertions":850,"sizeDeletions":-190},{"number":"5","revision":"5093b3d0e82e82ca8d6e857b0b673cfd5e927606","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/5","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543876780,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543876863,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543877985,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":545,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":896,"sizeDeletions":-203},{"number":"6","revision":"a8376c40097826321f3699274e8d8c8c99857a1e","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/6","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543882618,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1543882687,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"src/vm/node_modules/VM.js","line":2303,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This fixes a regression in test-blocksizes.js introduced by the previous round."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":548,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":899,"sizeDeletions":-203},{"number":"7","revision":"749766ecf54fa4bf388e26a9de49ada8a5a133e4","parents":["2255127725b4cfc2ce39c52288456a0792eb4e90"],"ref":"refs/changes/70/5170/7","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543882749,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543882803,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543899736,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543900110,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":548,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":899,"sizeDeletions":-203},{"number":"8","revision":"5445b728ea168f66b50ae3b1acb53e48ccf6f8ed","parents":["e74ed0afff867eaf969b94618d8ed1fe47e169bc"],"ref":"refs/changes/70/5170/8","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543927418,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543882803,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543899736,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543900110,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":548,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":899,"sizeDeletions":-203},{"number":"9","revision":"5bbd31725fc1d57535b0b605a3ca657bde1333e1","parents":["e74ed0afff867eaf969b94618d8ed1fe47e169bc"],"ref":"refs/changes/70/5170/9","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1543927491,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1543882803,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1543916427,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543899736,"by":{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"}},{"type":"SUBM","value":"1","grantedOn":1543927512,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543900110,"by":{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"src/vm/man/vmadm.1m.md","type":"MODIFIED","insertions":17,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":548,"deletions":-137},{"file":"src/vm/node_modules/proptable.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"src/vm/tests/test-bhyve-disk-resize.js","type":"MODIFIED","insertions":326,"deletions":-65}],"sizeInsertions":899,"sizeDeletions":-203}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Dylan Yep","email":"dyep49@gmail.com","username":"dyep49"},{"name":"Orlando Vazquez","email":"orlando@joyent.com","username":"orlandov"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}]}