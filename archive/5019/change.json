{"project":"joyent/mdata-client","branch":"master","id":"I02427ff9b36e881defdd7f05d6489bfd1d3b0337","number":"5019","subject":"TOOLS-2077 port modern mdata tools to Windows","owner":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"url":"https://cr.joyent.us/5019","commitMessage":"TOOLS-2077 port modern mdata tools to Windows\n","createdOn":1541060421,"lastUpdated":1550079222,"open":true,"status":"NEW","comments":[{"timestamp":1541060421,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 1."},{"timestamp":1541760671,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 2."},{"timestamp":1541760763,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 3."},{"timestamp":1543946513,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1543949557,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nSadly it\u0027s not. I\u0027ll recheck, but towards the beginning I also tried an older byte-at-a-time version. :("},{"timestamp":1543952309,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1544073208,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3:\n\nConfirmed the 1-byte version has the same 3K issue."},{"timestamp":1544541446,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\n(3 comments)"},{"timestamp":1546853272,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 4."},{"timestamp":1546957274,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\n(2 comments)"},{"timestamp":1546986276,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1547352639,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 5."},{"timestamp":1547354883,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 4:\n\n(3 comments)\n\nSome cstyle nits, but also a question about the way the line splitting is working in the serial port read loop.\n\nAs an aside: does cygwin not provide epoll emulation?"},{"timestamp":1550079116,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 6."},{"timestamp":1550079222,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Uploaded patch set 7."}],"currentPatchSet":{"number":"7","revision":"02427ff9b36e881defdd7f05d6489bfd1d3b0337","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/7","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550079222,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"plat/cygwin.c","type":"ADDED","insertions":179,"deletions":0}],"sizeInsertions":204,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"99801c9accb7d17ac171d982b895cb9ea14c0a41","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/1","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1541060421,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":6,"deletions":-6},{"file":"plat/cygwin.c","type":"ADDED","insertions":158,"deletions":0}],"sizeInsertions":170,"sizeDeletions":-6},{"number":"2","revision":"dce34875108dc365fb68121ea5d25d3465845401","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/2","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1541760671,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":6,"deletions":-6},{"file":"plat/cygwin.c","type":"ADDED","insertions":161,"deletions":0}],"sizeInsertions":173,"sizeDeletions":-6},{"number":"3","revision":"fde88e53e745e8bb7c919dcd67bda914f58f5af5","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/3","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1541760763,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1543952309,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"comments":[{"file":"README.md","line":41,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Include instructions (and/or bits in the makefile) for the proper cygwin resources needed?"},{"file":"plat/cygwin.c","line":32,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Should be \u0027size_t\u0027, not \u0027int\u0027"},{"file":"plat/cygwin.c","line":65,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"All of the other platforms read 1 character at a time.  I understand the motivation for reading more, but perhaps this is involved in 3K bug."},{"file":"plat/cygwin.c","line":142,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"All of the other platform drivers seem to store the file descriptor in its own field, and later configure it in the event poller (epoll/kqueue/etc).  Perhaps follow their lead?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":6,"deletions":-6},{"file":"plat/cygwin.c","type":"ADDED","insertions":161,"deletions":0}],"sizeInsertions":173,"sizeDeletions":-6},{"number":"4","revision":"0106de048a27bf6c930cb5d61d80b3d2f89c0680","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/4","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1546853272,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","comments":[{"file":"README.md","line":44,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"style nit: This should probably be a sub header (with license bumped up to the top level)"},{"file":"README.md","line":49,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"In order to use the binaries on a windows machine, are there cygwin libraries that need to be copied with them?"},{"file":"plat/cygwin.c","line":2,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"2019"},{"file":"plat/cygwin.c","line":66,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"It looks like this code only deals with a newline character that comes at the very end of a read().  I don\u0027t think there\u0027s any structural guarantee that this will be true.  If you\u0027re going to read more than one character at a time, I think you\u0027ll need to inspect the entire string for newlines and you\u0027ll need to accumulate anything that comes after a newline in some kind of buffer for later.\n\nIf I recall correctly, that\u0027s why the other platforms read one character at a time -- a subsequent line can remain in the device buffer until we\u0027re ready for it."},{"file":"plat/cygwin.c","line":67,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Please put spaces around mathematical operators; i.e.,\n\n    buf[sz - 1]\n\nThere are a few other instances of this in this file."},{"file":"plat/cygwin.c","line":68,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"This is meant to be Sun C style, so please don\u0027t use C++ style comments.  I\u0027d move this up above the line and flesh it out as a full sentence; e.g.,\n\n    /*\n     * Remove the trailing newline:\n     */"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"plat/cygwin.c","type":"ADDED","insertions":163,"deletions":0}],"sizeInsertions":182,"sizeDeletions":-6},{"number":"5","revision":"a7694d459cc194ffdcef5af1516fb14d2737d1c0","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/5","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1547352639,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"plat/cygwin.c","type":"ADDED","insertions":163,"deletions":0}],"sizeInsertions":188,"sizeDeletions":-7},{"number":"6","revision":"eca2dce529e36a1f47e326ab0370d91d946868f0","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/6","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550079116,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"plat/cygwin.c","type":"ADDED","insertions":179,"deletions":0}],"sizeInsertions":204,"sizeDeletions":-7},{"number":"7","revision":"02427ff9b36e881defdd7f05d6489bfd1d3b0337","parents":["dbb3fdec26373f8e86c9ea0057ebba48581ff476"],"ref":"refs/changes/19/5019/7","uploader":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"createdOn":1550079222,"author":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":0},{"file":"README.md","type":"MODIFIED","insertions":19,"deletions":-7},{"file":"plat/cygwin.c","type":"ADDED","insertions":179,"deletions":0}],"sizeInsertions":204,"sizeDeletions":-7}],"allReviewers":[{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}]}