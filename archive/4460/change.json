{"project":"joyent/sdcadm","branch":"master","id":"I3cac21ad89c6d5874cfddc7a7fb50ae8db3acb96","number":"4460","subject":"TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/4460","commitMessage":"TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1530288836,"lastUpdated":1530639968,"open":false,"status":"MERGED","comments":[{"timestamp":1530288836,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1530288841,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit f2a0d04824fff208705e1daa1d0e74c6ad23d3c3\n    \n    TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs"},{"timestamp":1530288873,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530288890,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1530288894,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 2a9a42be1a2d4e836a84d3bd8373a9bf99b535a8\n    \n    TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs"},{"timestamp":1530289017,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(1 comment)\n\nJust in case you can take a look! Otherwise I\u0027ll get somebody else involved next week."},{"timestamp":1530299441,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1530299445,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit cb72b73cd3301ea4b6b09afb3a21a59655d308d2\n    \n    TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs"},{"timestamp":1530299481,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530631248,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3: Code-Review+1\n\n(2 comments)"},{"timestamp":1530637558,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1530637564,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 3ead906396e8f3d00ebc366e8e58a09b1cff42f0\n    \n    TRITON-92 set \u0027dns_domain\u0027 on all Triton core VMs"},{"timestamp":1530637579,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(2 comments)\n\nChanges made as suggested!"},{"timestamp":1530637598,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530638067,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Code-Review+1\n\nThis is a chunk of code I\u0027m unfamiliar with, but I\u0027m okay giving it +IA too if it works on both an existing and fresh COAL.\n\nOtherwise I defer to another reviewer."},{"timestamp":1530639892,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\n\u003e This is a chunk of code I\u0027m unfamiliar with, but I\u0027m okay giving it\n \u003e +IA too if it works on both an existing and fresh COAL.\n \u003e \n \u003e Otherwise I defer to another reviewer.\n\nIt works on existing COAL setups and on fresh ones :-)"},{"timestamp":1530639919,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1530639968,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"4","revision":"3cac21ad89c6d5874cfddc7a7fb50ae8db3acb96","parents":["64663d032b9a1878da93e53a6a1220e71b58c7e4"],"ref":"refs/changes/60/4460/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530637558,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530637598,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530638067,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530639919,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1530639968,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":41,"deletions":-47},{"file":"lib/procedures/update-single-hn-sapi-v1.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/steps/dnsdomain.js","type":"ADDED","insertions":55,"deletions":0},{"file":"lib/steps/index.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/update.test.js","type":"MODIFIED","insertions":2,"deletions":-3}],"sizeInsertions":101,"sizeDeletions":-51},"patchSets":[{"number":"1","revision":"edc5a0109cab0a98d69f4f32bb1d67236d2abd36","parents":["dae7b327d1c9e26dba254b68d5f53a8753cd5f69"],"ref":"refs/changes/60/4460/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530288836,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530288873,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/update-sapi-v2.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/procedures/update-single-hn-sapi-v1.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/steps/dnsdomain.js","type":"ADDED","insertions":55,"deletions":0},{"file":"lib/steps/index.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/update.test.js","type":"MODIFIED","insertions":2,"deletions":-3}],"sizeInsertions":74,"sizeDeletions":-4},{"number":"2","revision":"83f86b4ea6bd5a85f5b04553b38d60d0b0cac75d","parents":["4970a5b910c78b3290b31e877627340099643751"],"ref":"refs/changes/60/4460/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530288890,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530288873,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"test/update.test.js","line":220,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Note this is due to the fact I\u0027ve just found some tests not passing after merging the previous 3 commits ... and never it\u0027s too late to fix a broken test!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/procedures/update-sapi-v2.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/procedures/update-single-hn-sapi-v1.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/steps/dnsdomain.js","type":"ADDED","insertions":55,"deletions":0},{"file":"lib/steps/index.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/update.test.js","type":"MODIFIED","insertions":2,"deletions":-3}],"sizeInsertions":74,"sizeDeletions":-4},{"number":"3","revision":"0f25f92ad23ad5e41587cc80c86a031547ef34a1","parents":["4970a5b910c78b3290b31e877627340099643751"],"ref":"refs/changes/60/4460/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530299441,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530299481,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530631248,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"comments":[{"file":"lib/common.js","line":713,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"This is probably outside the scope of this change, but the only difference I can tell between the code in waitUntilZoneInDNS() and waitUntilZoneOutOfDNS() is a single character -- !\u003d vs \u003d\u003d.\n\nThey should be merged into a single function that takes a comparator HOF to handle the !\u003d/\u003d\u003d difference."},{"file":"lib/common.js","line":713,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"If we left this for any other time it may never happen!"},{"file":"lib/steps/dnsdomain.js","line":34,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Adding ... to\nor\nSetting ... on"},{"file":"lib/steps/dnsdomain.js","line":34,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":6,"deletions":-6},{"file":"lib/procedures/update-sapi-v2.js","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/procedures/update-single-hn-sapi-v1.js","type":"MODIFIED","insertions":8,"deletions":0},{"file":"lib/steps/dnsdomain.js","type":"ADDED","insertions":55,"deletions":0},{"file":"lib/steps/index.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/update.test.js","type":"MODIFIED","insertions":2,"deletions":-3}],"sizeInsertions":80,"sizeDeletions":-10},{"number":"4","revision":"3cac21ad89c6d5874cfddc7a7fb50ae8db3acb96","parents":["64663d032b9a1878da93e53a6a1220e71b58c7e4"],"ref":"refs/changes/60/4460/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1530637558,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530637598,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1530639968,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530638067,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530639919,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/common.js","type":"MODIFIED","insertions":41,"deletions":-47},{"file":"lib/procedures/update-single-hn-sapi-v1.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/steps/dnsdomain.js","type":"ADDED","insertions":55,"deletions":0},{"file":"lib/steps/index.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"test/update.test.js","type":"MODIFIED","insertions":2,"deletions":-3}],"sizeInsertions":101,"sizeDeletions":-51}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}