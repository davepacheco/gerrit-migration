{"project":"joyent/illumos-joyent","branch":"master","id":"I39324c3c3e700905593cf884cb6987cf0db01381","number":"6087","subject":"OS-7727 want mac rx barrier function Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Reviewed by: Ryan Zezeski \u003crpz@joyent.com\u003e Approved by: Ryan Zezeski \u003crpz@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/6087","commitMessage":"OS-7727 want mac rx barrier function\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nReviewed by: Ryan Zezeski \u003crpz@joyent.com\u003e\nApproved by: Ryan Zezeski \u003crpz@joyent.com\u003e\n","createdOn":1554931679,"lastUpdated":1555366953,"open":false,"status":"MERGED","comments":[{"timestamp":1554931679,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1555024458,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1: Code-Review+1\n\n(1 comment)\n\nIn general this looks pretty good. I only noticed one thing that you may want to consider changing, but it\u0027s up to you."},{"timestamp":1555033325,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1555087211,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1555087392,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1555106417,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1555106498,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1555298146,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1555345623,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 3: Code-Review+1\n\nI like that we now have functions for cb enter/exit; definitely cleaner code."},{"timestamp":1555361840,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3:\n\ntest notes are written up in the ticket"},{"timestamp":1555365358,"reviewer":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1555365462,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1555365547,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1555366953,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"5","revision":"39324c3c3e700905593cf884cb6987cf0db01381","parents":["3023586c46cb6a2dd392cf1f47178de7bcca1af8"],"ref":"refs/changes/87/6087/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555365547,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555298146,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555345623,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555365358,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"SUBM","value":"1","grantedOn":1555366953,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":121,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":183,"sizeDeletions":-95},"patchSets":[{"number":"1","revision":"580cfbab9cf72c6feea9b81e53327fccd8158aef","parents":["d8075b7816cce899d8e5b43d151dd0e44f758855"],"ref":"refs/changes/87/6087/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1554931679,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555024458,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"comments":[{"file":"usr/src/uts/common/io/mac/mac.c","line":838,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"At first glance the else if construct here is a bit odd as both may be in this state. Because we use the same cv, I think we\u0027ll end up with the right thing happening either way, but it can be a bit surprising at first glance."},{"file":"usr/src/uts/common/io/mac/mac.c","line":838,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I did consider using a boolean_t and checking at the end. (And wrote it that way initially)  If you think that would be clearer, I can switch it back."},{"file":"usr/src/uts/common/io/mac/mac.c","line":838,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Maybe it\u0027s worth a brief comment in the else if case or at the top explaining how it\u0027s all good."},{"file":"usr/src/uts/common/io/mac/mac.c","line":838,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Probably easier to use the boolean than to craft that comment.  I\u0027ll update the wad shortly"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":107,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":169,"sizeDeletions":-95},{"number":"2","revision":"de65cbbe33917449d8a808d30e4b75257fbd374e","parents":["d8075b7816cce899d8e5b43d151dd0e44f758855"],"ref":"refs/changes/87/6087/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555106417,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":121,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":183,"sizeDeletions":-95},{"number":"3","revision":"c30e390ec0bf198b89f735a938d3704b88137ea2","parents":["5d9c1f58e33b02b709b5e031eec7e3e63d646ef7"],"ref":"refs/changes/87/6087/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555106498,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555298146,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555345623,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555365358,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":121,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":183,"sizeDeletions":-95},{"number":"4","revision":"fd8c07fe8e531aac86ea71bda61020697f59d6ea","parents":["3023586c46cb6a2dd392cf1f47178de7bcca1af8"],"ref":"refs/changes/87/6087/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555365462,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555298146,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555345623,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555365358,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":121,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":183,"sizeDeletions":-95},{"number":"5","revision":"39324c3c3e700905593cf884cb6987cf0db01381","parents":["3023586c46cb6a2dd392cf1f47178de7bcca1af8"],"ref":"refs/changes/87/6087/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1555365547,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555298146,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1555366953,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1555345623,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1555365358,"by":{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/uts/common/io/mac/mac.c","type":"MODIFIED","insertions":121,"deletions":-39},{"file":"usr/src/uts/common/io/mac/mac_client.c","type":"MODIFIED","insertions":37,"deletions":-11},{"file":"usr/src/uts/common/sys/mac_client.h","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/common/sys/mac_impl.h","type":"MODIFIED","insertions":23,"deletions":-44}],"sizeInsertions":183,"sizeDeletions":-95}],"allReviewers":[{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Ryan Zezeski","email":"rpz@joyent.com","username":"rzezeski"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}