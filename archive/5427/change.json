{"project":"joyent/node-zkstream","branch":"master","id":"Idfd80b3ccdf5b0a9ee65eabe21f8708508905db5","number":"5427","subject":"joyent/node-zkstream#39 ZKWatcher onStateChanged looking for wrong state Reviewed by: Robert Mustacchi \u003crm@joyent.com\u003e Approved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/5427","commitMessage":"joyent/node-zkstream#39 ZKWatcher onStateChanged looking for wrong state\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nApproved by: Joshua M. Clulow \u003cjmc@joyent.com\u003e\n","createdOn":1548379291,"lastUpdated":1549414031,"open":false,"status":"MERGED","comments":[{"timestamp":1548379291,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1548379352,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548383147,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(11 comments)"},{"timestamp":1548468702,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1548468727,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing-1\n\n(3 comments)\n\n\"make check\" exited with status 2"},{"timestamp":1548469337,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 1:\n\n(8 comments)"},{"timestamp":1548469350,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1548469410,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548702775,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(7 comments)\n\nThanks for the more detailed comments here, they were quite helpful."},{"timestamp":1548712950,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3:\n\n(5 comments)"},{"timestamp":1548712985,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1548713042,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548713568,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1548714187,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 5."},{"timestamp":1548714246,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548714571,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1548714985,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 5: Code-Review+1"},{"timestamp":1548715605,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1548715637,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 6."},{"timestamp":1548715698,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1548715828,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1549413792,"reviewer":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},"message":"Patch Set 6: Integration-Approval+1\n\nI think it\u0027d be good to put the testing notes in the Github issue, as that\u0027s where the analysis appears and it\u0027s the ticket we\u0027re using in the commit message.  The notes look good, though, thanks!"},{"timestamp":1549413907,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 6:\n\nOk, copy-pasted into the github ticket. Thanks"},{"timestamp":1549413933,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1549413969,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1549413990,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"},{"timestamp":1549414031,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"8","revision":"44ec28c686528d8efb8d37aa7a77a1a448ac2950","parents":["90ff503e7e93d10508adbb029c6bf4858869d9ec"],"ref":"refs/changes/27/5427/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1549413969,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548715698,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548715828,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549413792,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"SUBM","value":"1","grantedOn":1549413990,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":412,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":650,"sizeDeletions":-60},"patchSets":[{"number":"1","revision":"fd1cedb89a1d91033781d85b30c725494ecfecc9","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548379291,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548379352,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/zk-session.js","line":472,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Consider a state diagram?"},{"file":"lib/zk-session.js","line":472,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Ok, added."},{"file":"lib/zk-session.js","line":540,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why does the session explicitly reach in and emit disconnected() and resume(), but we need to look at and watch the session\u0027s stateChanged?"},{"file":"lib/zk-session.js","line":540,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I\u0027ve tried to add more explanation about this in the comments. The ZKSession does not change state due to notifications, so we can\u0027t use that for notify(), and for disconnected() as well as teh state change in the ZKSession we also need to know for sure that we made it onto its list of WatchEvents to be auto-resumed after reconnect. Only the ZKSession knows that, so it tells us in this way."},{"file":"lib/zk-session.js","line":550,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why do we need to use s.immediate() here? It\u0027s not clear to me why this one is special and we need to do it in a different tick explicitly versus others."},{"file":"lib/zk-session.js","line":555,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Because this is an asynchronous transition, what happens if we end up getting disconnected while we\u0027re heading to arming?"},{"file":"lib/zk-session.js","line":555,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"It\u0027s not, it\u0027s sync."},{"file":"lib/zk-session.js","line":592,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why don\u0027t we need to emit a deleted event? Is it because of the fact that this is based on an existence watcher, so if it fires here, we actually shouldn\u0027t do anything and instead return to armed? I think it\u0027d be useful to have a comment here. At first I thought all the of the event types that we had in cases where actual things that ZK had as a first class notion."},{"file":"lib/zk-session.js","line":592,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I\u0027ve re-done how this works so there\u0027s a single type for existence watchers (both deletion and creation)"},{"file":"lib/zk-session.js","line":614,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, in the case where the IDs are equal, why don\u0027t we want to update zkwe_lastpkt to the most recent one that we\u0027ve seen? I get that we don\u0027t want to emit it because in theory we already have? Though I\u0027m not sure I quite understand when this situation would occur."},{"file":"lib/zk-session.js","line":614,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Changed this to keep the zxid rather than the whole packet to make things clearer."},{"file":"lib/zk-session.js","line":627,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I would suggest removing the mention of destruction watchers as they aren\u0027t actually handled here."},{"file":"lib/zk-session.js","line":644,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"If this is the case and deleted watchers are disarmed once they\u0027re fired, but they\u0027re still tied to the session, how do they ever get cleaned up?"},{"file":"lib/zk-session.js","line":776,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"There are a myriad number of events. It\u0027s not clear to me why these are the only two we can be in."},{"file":"lib/zk-session.js","line":776,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Rewritten."},{"file":"test/basic.test.js","line":976,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Why are we connecting on zkc1 here, when we do it up above in the parallel?"},{"file":"test/basic.test.js","line":976,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"We\u0027re not asking it to connect, we\u0027re putting an event handler on when it gets connected next (which will be after it disconnects and reconnects due to the code below)"},{"file":"test/basic.test.js","line":992,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I guess this just simulates the race condition, but doesn\u0027t guarantee that we actually hit it at all, is that right?"},{"file":"test/basic.test.js","line":992,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"This code is pretty good at hitting it -- when I run this test on the old code from before the fix, I haven\u0027t had it fail to hit it yet (I\u0027ve run it about 15 or so times to check). I make sure to set up a watcher both on the turn of the event loop when I destroyed the socket, and also the next turn (in the setImmediate), which covers the bases here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":320,"deletions":-103},{"file":"test/basic.test.js","type":"MODIFIED","insertions":111,"deletions":0}],"sizeInsertions":431,"sizeDeletions":-103},{"number":"2","revision":"95a74b8c62de5cde7729f4f2a0ac20ad4465036c","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548468702,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1548468727,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/zk-session.js","line":544,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: missing default case in switch statement"},{"file":"test/basic.test.js","line":859,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: comparisons against null, 0, true, false, or an empty string allowing implicit type conversion (use \u003d\u003d\u003d or !\u003d\u003d)"},{"file":"test/basic.test.js","line":915,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"warning: comparisons against null, 0, true, false, or an empty string allowing implicit type conversion (use \u003d\u003d\u003d or !\u003d\u003d)"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":373,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":611,"sizeDeletions":-60},{"number":"3","revision":"a7abea391b3d97b96bbbad75ec26a9df59ab35f2","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548469350,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548469410,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/zk-session.js","line":498,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is the \u0027?\u0027 because you\u0027re unsure if that\u0027s the exact version or?"},{"file":"lib/zk-session.js","line":498,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Zookeeper uses branch-based version development where it\u0027s actually surprisingly hard to figure out which things are in which releases. So I\u0027m not 100% sure, but it happened around then."},{"file":"lib/zk-session.js","line":648,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So, resume sends us to armed in the code right now, not wait_session, which is where the diagram points us as going. Is that right? I guess where we resumed, it\u0027d make sense to go to armed.\n\nI think you want to call out the resume() versus the notify()."},{"file":"lib/zk-session.js","line":648,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Yeah, sorry, re-doing this part of the diagram and adding more arrows to make direction clear."},{"file":"lib/zk-session.js","line":648,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"But now resuming is missing the fact that notify will transition it to wait_session."},{"file":"lib/zk-session.js","line":648,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Take 3!"},{"file":"lib/zk-session.js","line":699,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"One other thing that I missed initially was the fact that while this can be emitted at any time in the FSM, we only care about it if we\u0027re in the armed state and that\u0027s only enforced by the FSM logic. That threw me off for a bit."},{"file":"lib/zk-session.js","line":699,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Adding an if() and a comment here."},{"file":"lib/zk-session.js","line":727,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Is the reason why neither wait_session or wait_connected need to handle the notifyAsserted event because they themselves are basically in the set up path for retriggering the watch, so it\u0027s basically OK to drop it?"},{"file":"lib/zk-session.js","line":786,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"So it\u0027s on the subsequent replies that we need to rearm is that right? We don\u0027t on this one because it\u0027s in a request specifically for this watch? And that\u0027s done by the fact that we go into the wait_session state after a notification which causes us to handle things correctly."},{"file":"test/basic.test.js","line":873,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Do we need to issue a sync() just to make sure everything\u0027s happened?"},{"file":"test/basic.test.js","line":873,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Not if we\u0027re on the same ZK server, no. sync is mostly about cross-ZK-server visibility."},{"file":"test/basic.test.js","line":928,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"WHy don\u0027t the delete/create events represent a change in the data that we capture? Is that because strictly speaking, it coming and going, while representing a change in the value of the node isn\u0027t captured by this because it\u0027s an existence related check?"},{"file":"test/basic.test.js","line":928,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"The creation of the new node does cause the dataChanged event to fire (since it involves assigning the node new data). The destruction of the old one does not -- destruction is semantically different from the data changing (at least to ZK)."},{"file":"test/basic.test.js","line":928,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"OK, thanks for the clarification."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":394,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":632,"sizeDeletions":-60},{"number":"4","revision":"44fffe4fd9bddcd5232c676de209dd1aed8063b1","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548712985,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548713042,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":407,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":645,"sizeDeletions":-60},{"number":"5","revision":"6b0eddc4375be0903f2e3b58b18bd97a9ec8460b","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548714187,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548714985,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548714246,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/zk-session.js","line":706,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Oops.\n\n    s/isInstate/isInState/"},{"file":"lib/zk-session.js","line":716,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Forgot about catch-up notifications here."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":407,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":645,"sizeDeletions":-60},{"number":"6","revision":"dfd80b3ccdf5b0a9ee65eabe21f8708508905db5","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1548715637,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548715828,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549413792,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548715698,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":412,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":650,"sizeDeletions":-60},{"number":"7","revision":"b3cf17eac23262a8bdafc4e557bc658b4adf5803","parents":["60214ca36fd84f7445b4eeff13de436954237568"],"ref":"refs/changes/27/5427/7","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1549413933,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548715828,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549413792,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548715698,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":412,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":650,"sizeDeletions":-60},{"number":"8","revision":"44ec28c686528d8efb8d37aa7a77a1a448ac2950","parents":["90ff503e7e93d10508adbb029c6bf4858869d9ec"],"ref":"refs/changes/27/5427/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1549413969,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1548715828,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1549413990,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549413792,"by":{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1548715698,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/zk-session.js","type":"MODIFIED","insertions":412,"deletions":-57},{"file":"test/basic.test.js","type":"MODIFIED","insertions":238,"deletions":-3}],"sizeInsertions":650,"sizeDeletions":-60}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Joshua M. Clulow","email":"jmc@joyent.com","username":"jclulow"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}