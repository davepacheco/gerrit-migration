{"project":"joyent/node-verror","branch":"master","id":"I53b3b757acf0a59cad30ad6d2bf688160cab0369","number":"300","subject":"joyent/node-verror#41 fullStack() test for werror fails on Node 0.10 joyent/node-verror#39 captureStackTrace lost when inheriting from WError Reviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e","owner":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"url":"https://cr.joyent.us/300","commitMessage":"joyent/node-verror#41 fullStack() test for werror fails on Node 0.10\njoyent/node-verror#39 captureStackTrace lost when inheriting from WError\nReviewed by: Julien Gilli \u003cjulien.gilli@joyent.com\u003e\n","createdOn":1471382185,"lastUpdated":1471459089,"open":false,"status":"MERGED","comments":[{"timestamp":1471382185,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 1."},{"timestamp":1471382187,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1471383385,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 2."},{"timestamp":1471383388,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1471455907,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 2: Code-Review+1\n\n(3 comments)"},{"timestamp":1471458080,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1471458403,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Uploaded patch set 3."},{"timestamp":1471458405,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1471458860,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1471459089,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by David Pacheco"}],"currentPatchSet":{"number":"3","revision":"53b3b757acf0a59cad30ad6d2bf688160cab0369","parents":["8b782cb7514aa3a09503e848e4c9ac3662a37075"],"ref":"refs/changes/00/300/3","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1471458403,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471458405,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471458860,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471458860,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"SUBM","value":"1","grantedOn":1471459089,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/verror.js","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/tst.inherit.js","type":"MODIFIED","insertions":26,"deletions":-6},{"file":"test/tst.werror.js","type":"MODIFIED","insertions":13,"deletions":-6}],"sizeInsertions":47,"sizeDeletions":-25},"patchSets":[{"number":"1","revision":"04f201ee0088bb214e94294cd649f7db28255788","parents":["ad40050d71263adb0b58fa294a30dd06adbc9174"],"ref":"refs/changes/00/300/1","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1471382185,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471382187,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":1,"deletions":0},{"file":"lib/verror.js","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"test/tst.inherit.js","type":"MODIFIED","insertions":26,"deletions":-3},{"file":"test/tst.werror.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":39,"sizeDeletions":-17},{"number":"2","revision":"77fec9dd78e6ce93dbba07cd1c4ceb73de276af4","parents":["8b782cb7514aa3a09503e848e4c9ac3662a37075"],"ref":"refs/changes/00/300/2","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1471383385,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471383388,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471455907,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"comments":[{"file":"package.json","line":3,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Is the stack trace of error objects considered to be part of the official supported interface? If so should it be considered a breaking change and thus be a major version bump?"},{"file":"package.json","line":3,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I do not consider the stack trace itself to be a public, programmatically-dependable interface."},{"file":"test/tst.inherit.js","line":74,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Why are there two separate tests, one to check the first line of the string generated from the \"stack\" accessor and the other one to check for the whole stack once cleaned?"},{"file":"test/tst.inherit.js","line":74,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Thanks for catching that.  The existing checks are vestigial."},{"file":"test/tst.werror.js","line":23,"reviewer":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},"message":"Nit: I find variables declared with a number suffix a bit confusing. Would naming these two variables \"stackMessageMiddle\" and \"stackMessageTop\" make it easier to understand their purpose in this case?"},{"file":"test/tst.werror.js","line":23,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I tend to agree, though I think that\u0027s mitigated when the variable is only used within a very short number of lines, and there isn\u0027t a strong distinction between the different values.  stackmessage is also used in existing cases where there\u0027s only one stack trace, so \"top\" may be somewhat confusing as a description.  I could change \"2\" to \"mid\"."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/verror.js","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/tst.inherit.js","type":"MODIFIED","insertions":26,"deletions":-3},{"file":"test/tst.werror.js","type":"MODIFIED","insertions":10,"deletions":-3}],"sizeInsertions":44,"sizeDeletions":-19},{"number":"3","revision":"53b3b757acf0a59cad30ad6d2bf688160cab0369","parents":["8b782cb7514aa3a09503e848e4c9ac3662a37075"],"ref":"refs/changes/00/300/3","uploader":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"createdOn":1471458403,"author":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"SUBM","value":"1","grantedOn":1471459089,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1471458405,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471458860,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471458860,"by":{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":5,"deletions":-1},{"file":"lib/verror.js","type":"MODIFIED","insertions":2,"deletions":-11},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/tst.inherit.js","type":"MODIFIED","insertions":26,"deletions":-6},{"file":"test/tst.werror.js","type":"MODIFIED","insertions":13,"deletions":-6}],"sizeInsertions":47,"sizeDeletions":-25}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Julien Gilli","email":"jgilli@netflix.com","username":"misterdjules"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}]}