{"project":"joyent/sdc-firewaller-agent","branch":"master","topic":"FWAPI-239","id":"I998d9b99b54ae31cfa1746685a4a4d16858ed06a","number":"486","subject":"FWAPI-239 Firewall rules are not regenerated when machine tag changes are made FWAPI-249 firewaller doesn\u0027t fetch remote VMs with matching tags Reviewed by: Richard Kiene \u003crichard.kiene@joyent.com\u003e Approved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/486","commitMessage":"FWAPI-239 Firewall rules are not regenerated when machine tag changes are made\nFWAPI-249 firewaller doesn\u0027t fetch remote VMs with matching tags\nReviewed by: Richard Kiene \u003crichard.kiene@joyent.com\u003e\nApproved by: Richard Kiene \u003crichard.kiene@joyent.com\u003e\n","createdOn":1474059595,"lastUpdated":1477622287,"open":false,"status":"MERGED","comments":[{"timestamp":1474059595,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1474059635,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Topic set to FWAPI-239"},{"timestamp":1474059645,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1474334284,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1474334317,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1475633857,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1475633963,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477605227,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 3:\n\n(4 comments)\n\nLooks great other than a few nits"},{"timestamp":1477608436,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1477608461,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1477608493,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1477609268,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(4 comments)"},{"timestamp":1477618275,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1\n\nLGTM"},{"timestamp":1477622278,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Commit message was updated."},{"timestamp":1477622287,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"6","revision":"662843294c3e3c3af0470e1471f87196955cd7e1","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477622278,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477608461,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"SUBM","value":"1","grantedOn":1477622287,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/pred.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-66},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":78,"deletions":-24},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":3,"deletions":-6}],"sizeInsertions":350,"sizeDeletions":-182},"patchSets":[{"number":"1","revision":"d77785608799db6331e1dcf5c95819b867e03182","parents":["45c884002a799c15288a39d48a5384cb53d094fe"],"ref":"refs/changes/86/486/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1474059595,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474059645,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/pred.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-65},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":154,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":76,"deletions":-21},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":2,"deletions":-5}],"sizeInsertions":321,"sizeDeletions":-169},{"number":"2","revision":"9450f87e82a2c80106a62856d801d5fd85e45c84","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1474334284,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474334317,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":14,"deletions":-5},{"file":"lib/pred.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-65},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":76,"deletions":-21},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":2,"deletions":-5}],"sizeInsertions":345,"sizeDeletions":-175},{"number":"3","revision":"9a914b4c3f11c0f29b05a58f0211821c1851248a","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1475633857,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1475633963,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/tasks/vm-common.js","line":44,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"err2 is a big ambiguous, also there is no \u0027err\u0027 that this appears to be conflicting with. May I suggest rvmRulesErr or rulesErr?"},{"file":"lib/tasks/vm-common.js","line":44,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/tasks/vm-common.js","line":68,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Similar suggestion as above. Perhaps fwAddErr?"},{"file":"lib/tasks/vm-common.js","line":68,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/tasks/vm-update.js","line":106,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"Perhaps a better name than err(N) here and elsewhere."},{"file":"lib/tasks/vm-update.js","line":106,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/vmapi.js","line":30,"reviewer":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},"message":"I find that !!vm.firewall_enabled reads a bit better."},{"file":"lib/vmapi.js","line":30,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/pred.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-66},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":78,"deletions":-24},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":3,"deletions":-6}],"sizeInsertions":350,"sizeDeletions":-182},{"number":"4","revision":"439053c02366963c74b47ce438cc37dccf27c9b6","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477608436,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477608461,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/pred.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-66},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":78,"deletions":-24},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":3,"deletions":-6}],"sizeInsertions":350,"sizeDeletions":-182},{"number":"5","revision":"998d9b99b54ae31cfa1746685a4a4d16858ed06a","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477608493,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477608461,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/pred.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-66},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":78,"deletions":-24},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":3,"deletions":-6}],"sizeInsertions":350,"sizeDeletions":-182},{"number":"6","revision":"662843294c3e3c3af0470e1471f87196955cd7e1","parents":["9fb35106f01db0f1a0539d28095f2aed43b01477"],"ref":"refs/changes/86/486/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1477622278,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1477622287,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1477608461,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1477618275,"by":{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"lib/cache.js","type":"MODIFIED","insertions":15,"deletions":-6},{"file":"lib/pred.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"lib/tasks/vm-add.js","type":"MODIFIED","insertions":1,"deletions":-66},{"file":"lib/tasks/vm-common.js","type":"ADDED","insertions":84,"deletions":0},{"file":"lib/tasks/vm-update.js","type":"MODIFIED","insertions":163,"deletions":-75},{"file":"lib/vmapi.js","type":"MODIFIED","insertions":78,"deletions":-24},{"file":"package.json","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"test/lib/vm.js","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/unit/helpers.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/vm-update.test.js","type":"MODIFIED","insertions":3,"deletions":-6}],"sizeInsertions":350,"sizeDeletions":-182}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Richard Kiene","email":"richard.kiene@joyent.com","username":"richardkiene"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}