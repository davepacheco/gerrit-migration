From c829bb6cb0123efe851afa25ea2faef2bb5721a1 Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Fri, 16 Jun 2017 10:38:56 -0700
Subject: [PATCH] IMGAPI-633 bulletproof bsd-prepare-image somewhat from
 SeanC's crazy BSD whatever...

---
 tools/prepare-image/bsd-prepare-image | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/tools/prepare-image/bsd-prepare-image b/tools/prepare-image/bsd-prepare-image
index 7b7962f..ea8b65c 100755
--- a/tools/prepare-image/bsd-prepare-image
+++ b/tools/prepare-image/bsd-prepare-image
@@ -79,7 +79,7 @@ function cleanup_ssh() {
     FILELIST='authorized_keys known_hosts id_dsa id_dsa.pub id_rsa id_rsa.pub ssh_config'
     for FILE in $FILELIST; do
         if [[ -f "/root/.ssh/$FILE" ]]; then
-            rm -rf /root/.ssh/$FILE
+            rm -r -f /root/.ssh/$FILE
         fi
     done
 }
@@ -87,7 +87,7 @@ function cleanup_ssh() {
 # Deleting ssh host keys. In FreeBSD and OpenBSD they will be recreated at
 # boot via `ssh-keygen -A` in /etc/rc
 function cleanup_hostkeys() {
-    rm -rf /etc/ssh/ssh_host_*
+    rm -r -f /etc/ssh/ssh_host_*
 }
 
 # Remove DHCP leases
@@ -100,7 +100,7 @@ function cleanup_root() {
 
     # Delete mail if it exists
     if [[ -e /var/mail/root ]] ; then
-       rm -rf /var/mail/root
+       rm -r -f /var/mail/root
     fi
 
     # clear shell history
@@ -122,7 +122,7 @@ function prepare_freebsd() {
     find /var/db/entropy -type f -name "saved-entropy.*" | xargs rm -f
 
     # Remove hostid file
-    rm -rf /etc/hostid
+    rm -r -f /etc/hostid
 
     # Clean up local cache of all packages
     pkg clean -a -y
@@ -141,13 +141,13 @@ function prepare_freebsd() {
 
 function prepre_openbsd() {
     # Cleanup network interfaces
-    rm -rf /etc/hostname.*
+    rm -r -f /etc/hostname.*
 
     # Removing /dev/vtbd1 entries from fstab
     sed -i' ' '/\/data/d' /etc/fstab
 
     # Delete hostname
-    rm -rf /etc/myname
+    rm -r -f /etc/myname
 
     # Remove root password. The root passord is set at first boot via the
     # guest tools to the value of `mdata-get root_pw`.
-- 
2.21.0

