From 27314042b35265077d05c518d5ed831ec581e719 Mon Sep 17 00:00:00 2001
From: Dillon Amburgey <dillona@dillona.com>
Date: Mon, 16 Jan 2017 12:53:48 -0500
Subject: [PATCH] OS-5897 secflags merge introduced broken fallthroughs
 Reviewed by: Jerry Jelinek <jerry.jelinek@joyent.com> Reviewed by: Patrick
 Mooney <patrick.mooney@joyent.com> Approved by: Patrick Mooney
 <patrick.mooney@joyent.com>

---
 usr/src/cmd/zonecfg/zonecfg.c | 3 +++
 usr/src/uts/common/os/zone.c  | 1 +
 2 files changed, 4 insertions(+)

diff --git a/usr/src/cmd/zonecfg/zonecfg.c b/usr/src/cmd/zonecfg/zonecfg.c
index 1c81a7816b..512f27d1e6 100644
--- a/usr/src/cmd/zonecfg/zonecfg.c
+++ b/usr/src/cmd/zonecfg/zonecfg.c
@@ -4109,7 +4109,10 @@ clear_property(cmd_t *cmd)
 			return;
 		case PT_VLANID:
 			in_progress_nwiftab.zone_nwif_vlan_id[0] = '\0';
+			need_to_commit = B_TRUE;
+			return;
 		}
+		break;
 	case RT_SECFLAGS:
 		switch (prop_type) {
 		case PT_LOWER:
diff --git a/usr/src/uts/common/os/zone.c b/usr/src/uts/common/os/zone.c
index 59cb19162c..c800e6a285 100644
--- a/usr/src/uts/common/os/zone.c
+++ b/usr/src/uts/common/os/zone.c
@@ -6314,6 +6314,7 @@ zone_setattr(zoneid_t zoneid, int attr, void *buf, size_t bufsize)
 		break;
 	case ZONE_ATTR_RSS:
 		err = zone_set_rss(zone, (const uint64_t *)buf);
+		break;
 	case ZONE_ATTR_SECFLAGS:
 		err = zone_set_secflags(zone, (psecflags_t *)buf);
 		break;
-- 
2.21.0

