{"project":"joyent/sdc-napi","branch":"master","id":"I2c5b6af15305ed9682584650dbeab70c2456a09f","number":"1910","subject":"NAPI-384 Entries should have creation or update times if possible in the API","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/1910","commitMessage":"NAPI-384 Entries should have creation or update times if possible in the API\n","createdOn":1493999989,"lastUpdated":1494617072,"open":false,"status":"MERGED","comments":[{"timestamp":1493999989,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1494000063,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494009901,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(3 comments)\n\nI did an initial pass over this and think it looks good. I\u0027ll take a deeper look later."},{"timestamp":1494277019,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1494277110,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494353028,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2: Code-Review+1\n\n(8 comments)"},{"timestamp":1494429707,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3."},{"timestamp":1494429726,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(8 comments)"},{"timestamp":1494429786,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494610125,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4."},{"timestamp":1494610175,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1494610812,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5."},{"timestamp":1494610894,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1494613735,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1494617072,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"5","revision":"2c5b6af15305ed9682584650dbeab70c2456a09f","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1494610812,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494610894,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1494613735,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1494613735,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1494617072,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":18,"deletions":0},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":100,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":153,"deletions":-53}],"sizeInsertions":469,"sizeDeletions":-65},"patchSets":[{"number":"1","revision":"454878abcde70d5b454896e0d4094e567094096f","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1493999989,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494000063,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/models/nic/create.js","line":90,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Neither of these should be set at this point. \"migration\" is only set during calls to .batch(), and \"err\" is only set inside nicAndIP()."},{"file":"lib/models/nic/provision.js","line":440,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"opts.migration is only ever set on the call to .batch(), so it won\u0027t be set here."},{"file":"lib/models/nic/provision.js","line":441,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Can you change this so the assignments are on separate lines?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":12,"deletions":-3},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":116,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":149,"deletions":-51}],"sizeInsertions":464,"sizeDeletions":-60},{"number":"2","revision":"415eba1932df84b3ad7f3125f588cf124f824dc9","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1494277019,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1494353028,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494277110,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/models/nic/create.js","line":128,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"It looks like addTimestamps shouldn\u0027t be needed. It comes right after provision.addParams, which you updated in the other file to add the timestamps."},{"file":"lib/models/nic/create.js","line":128,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/integration/fabrics.test.js","line":1190,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I think we only want to ignore the modified_timestamp here and below, right? Once the NIC is created, updating the NIC shouldn\u0027t change the created_timestamp field."},{"file":"test/integration/fabrics.test.js","line":1190,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/integration/helpers.js","line":54,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"\"Save the timestamps\" ?"},{"file":"test/integration/helpers.js","line":54,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/integration/network-owner.test.js","line":66,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Can you make this:\n\n    if (h.ifErr(t, err, \u0027error returned\u0027)) {"},{"file":"test/integration/network-owner.test.js","line":66,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/integration/nics.test.js","line":108,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Since h.saveTimestamps() takes care of creating the fields inside of state.ts, I\u0027m not sure if having this line (and similar below) is necessary.\n\nAlso, \"state.ts.a\" is created here, but it seems that calling h.saveTimestamps() creates \"state.ts.{created,modified}_timestamp.a\". I think that making h.saveTimestamps() do \"state.ts.a.{create,modified}_timestamp\" instead would make more sense."},{"file":"test/integration/nics.test.js","line":108,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/integration/nics.test.js","line":600,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"You do these same two checks in several places. Perhaps create a helper like h.timestampsAdvance(t, old, new) and use that throughout this file?"},{"file":"test/integration/nics.test.js","line":600,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/unit/nics.test.js","line":529,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"You can write this in the object literal above."},{"file":"test/unit/nics.test.js","line":529,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"},{"file":"test/unit/nics.test.js","line":1095,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Ditto"},{"file":"test/unit/nics.test.js","line":1095,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":10,"deletions":-3},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":19,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":116,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":149,"deletions":-51}],"sizeInsertions":461,"sizeDeletions":-60},{"number":"3","revision":"ae24e20b3d25e1bf029d2b01d3eff3970da7e7f9","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1494429707,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494429786,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":100,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":153,"deletions":-53}],"sizeInsertions":454,"sizeDeletions":-65},{"number":"4","revision":"549c6e5bbc72a906ef01afbd3fe79a7ac6a2ac16","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1494610125,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1494610175,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/models/nic/obj.js","line":459,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Unexpected trailing comma"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":19,"deletions":-1},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":100,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":153,"deletions":-53}],"sizeInsertions":470,"sizeDeletions":-66},{"number":"5","revision":"2c5b6af15305ed9682584650dbeab70c2456a09f","parents":["22a010eb786101e93b0e9dcd646d06c7fb419782"],"ref":"refs/changes/10/1910/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1494610812,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1494613735,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1494613735,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1494610894,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1494617072,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/models/nic/create.js","type":"MODIFIED","insertions":3,"deletions":-4},{"file":"lib/models/nic/obj.js","type":"MODIFIED","insertions":18,"deletions":0},{"file":"lib/models/nic/provision.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/models/nic/update.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/integration/fabrics.test.js","type":"MODIFIED","insertions":6,"deletions":-3},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":30,"deletions":0},{"file":"test/integration/network-owner.test.js","type":"MODIFIED","insertions":3,"deletions":-2},{"file":"test/integration/nics.test.js","type":"MODIFIED","insertions":100,"deletions":-1},{"file":"test/lib/common.js","type":"MODIFIED","insertions":134,"deletions":-1},{"file":"test/lib/nic.js","type":"MODIFIED","insertions":1,"deletions":0},{"file":"test/unit/network-pools.test.js","type":"MODIFIED","insertions":4,"deletions":0},{"file":"test/unit/nics.test.js","type":"MODIFIED","insertions":153,"deletions":-53}],"sizeInsertions":469,"sizeDeletions":-65}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}