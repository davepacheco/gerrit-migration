From b1befe91a0ca0bdd5902b1a63edaa70e4f6cce6b Mon Sep 17 00:00:00 2001
From: Jerry Jelinek <jerry.jelinek@joyent.com>
Date: Fri, 17 May 2019 19:12:39 +0000
Subject: [PATCH] OS-7803 lp build broken by SMT changes

---
 usr/src/cmd/lp/cmd/lpadmin/do_printer.c | 4 ++++
 usr/src/cmd/lp/cmd/lpsched/exec.c       | 4 ++++
 2 files changed, 8 insertions(+)

diff --git a/usr/src/cmd/lp/cmd/lpadmin/do_printer.c b/usr/src/cmd/lp/cmd/lpadmin/do_printer.c
index c26c59e39a..544fd40f13 100644
--- a/usr/src/cmd/lp/cmd/lpadmin/do_printer.c
+++ b/usr/src/cmd/lp/cmd/lpadmin/do_printer.c
@@ -26,6 +26,7 @@
  * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
  * Use is subject to license terms.
  * Copyright (c) 2016 by Delphix. All rights reserved.
+ * Copyright 2019 Joyent, Inc.
  */
 
 #include <stdio.h>
@@ -43,6 +44,9 @@
 #if defined PS_FAULTED
 #undef	PS_FAULTED
 #endif
+#if defined PS_DISABLED
+#undef	PS_DISABLED
+#endif
 #include "printers.h"
 #include "msgs.h"
 
diff --git a/usr/src/cmd/lp/cmd/lpsched/exec.c b/usr/src/cmd/lp/cmd/lpsched/exec.c
index 4bd1da4a91..f68926536c 100644
--- a/usr/src/cmd/lp/cmd/lpsched/exec.c
+++ b/usr/src/cmd/lp/cmd/lpsched/exec.c
@@ -22,6 +22,7 @@
 /*
  * Copyright (c) 1989, 2010, Oracle and/or its affiliates. All rights reserved.
  * Copyright (c) 2016 by Delphix. All rights reserved.
+ * Copyright 2019 Joyent, Inc.
  */
 
 /*	Copyright (c) 1984, 1986, 1987, 1988, 1989 AT&T	*/
@@ -32,6 +33,9 @@
 #if defined PS_FAULTED
 #undef  PS_FAULTED
 #endif /* PS_FAULTED */
+#if defined PS_DISABLED
+#undef	PS_DISABLED
+#endif /* PS_DISABLED */
 #include <dial.h>
 
 #include <stdlib.h>
-- 
2.21.0

