{"project":"joyent/illumos-joyent","branch":"master","id":"I18ab788d153564dc0bc27d9b855fa3df844f6673","number":"3433","subject":"OS-6655 i40e should read SFP data when firmware supports it Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Reviewed by: Rob Johnston \u003crob.johnston@joyent.com\u003e Reviewed by: Dale Ghent \u003cdale.ghent@joyent.com\u003e Approved by: Jerry Jelinek \u003cjerry.jelinek","owner":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"url":"https://cr.joyent.us/3433","commitMessage":"OS-6655 i40e should read SFP data when firmware supports it\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nReviewed by: Rob Johnston \u003crob.johnston@joyent.com\u003e\nReviewed by: Dale Ghent \u003cdale.ghent@joyent.com\u003e\nApproved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\n","createdOn":1519232225,"lastUpdated":1519667585,"open":false,"status":"MERGED","comments":[{"timestamp":1519232225,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 1."},{"timestamp":1519232337,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\nNote to reviewers, the i40e/core changes came from INTC."},{"timestamp":1519233819,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1519234391,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1519234734,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1: Code-Review+1\n\nThanks for the responses."},{"timestamp":1519243302,"reviewer":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1519245999,"reviewer":{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1519666504,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1: Integration-Approval+1"},{"timestamp":1519666848,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1519667569,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1519667585,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Robert Mustacchi"}],"currentPatchSet":{"number":"3","revision":"18ab788d153564dc0bc27d9b855fa3df844f6673","parents":["80f861f88899c68a6348c71dbd7c77e62917853a"],"ref":"refs/changes/33/3433/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1519667569,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519234734,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519243302,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519245999,"by":{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519666504,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1519667585,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_adminq_cmd.h","type":"MODIFIED","insertions":20,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_common.c","type":"MODIFIED","insertions":70,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_prototype.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","type":"MODIFIED","insertions":74,"deletions":-2}],"sizeInsertions":173,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"269f3d8269e70aa0fe47e6a01a0d7a362f678d98","parents":["f49f984d73e73b99d7388dfffa647c0d2f406d31"],"ref":"refs/changes/33/3433/1","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1519232225,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519234734,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519666504,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519243302,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519245999,"by":{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"}}],"comments":[{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","line":627,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"it seems like you could drop these first two checks, since they\u0027re covered by the last one, but that is just a nit"},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","line":627,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Unfortunately, we actually need all three. If gave you SIZE_MAX and for nbytes and offset as 30, you\u0027d pass the remaining check, but it\u0027d still be invalid. Basically you could trick the driver into overflowing and being valid due to the addition."},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","line":646,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Do you want to account for the possibility the major version could go to 2 or higher in the future?"},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","line":646,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"I basically did it this way since if the major version is two, I wanted to assume that all the existing commands and the method for interfacing with them wouldn\u0027t work and that we\u0027d need to come back and understand that."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_adminq_cmd.h","type":"MODIFIED","insertions":20,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_common.c","type":"MODIFIED","insertions":70,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_prototype.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","type":"MODIFIED","insertions":74,"deletions":-2}],"sizeInsertions":173,"sizeDeletions":-2},{"number":"2","revision":"3966fca5d4e5c1c0dbc6071697458b834c479e7e","parents":["80f861f88899c68a6348c71dbd7c77e62917853a"],"ref":"refs/changes/33/3433/2","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1519666848,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519234734,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519666504,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519243302,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519245999,"by":{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_adminq_cmd.h","type":"MODIFIED","insertions":20,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_common.c","type":"MODIFIED","insertions":70,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_prototype.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","type":"MODIFIED","insertions":74,"deletions":-2}],"sizeInsertions":173,"sizeDeletions":-2},{"number":"3","revision":"18ab788d153564dc0bc27d9b855fa3df844f6673","parents":["80f861f88899c68a6348c71dbd7c77e62917853a"],"ref":"refs/changes/33/3433/3","uploader":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"createdOn":1519667569,"author":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1519667585,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519234734,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519666504,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519243302,"by":{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519245999,"by":{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_adminq_cmd.h","type":"MODIFIED","insertions":20,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_common.c","type":"MODIFIED","insertions":70,"deletions":0},{"file":"usr/src/uts/common/io/i40e/core/i40e_prototype.h","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/uts/common/io/i40e/i40e_gld.c","type":"MODIFIED","insertions":74,"deletions":-2}],"sizeInsertions":173,"sizeDeletions":-2}],"allReviewers":[{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Rob Johnston","email":"rob.johnston@joyent.com","username":"rejohnst"},{"name":"Dale Ghent","email":"daleg@joyent.com","username":"daleghent"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}]}