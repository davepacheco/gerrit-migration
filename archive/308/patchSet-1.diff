From ccba223746dbb32c5805cafb21d3b00b87ef798c Mon Sep 17 00:00:00 2001
From: Ryan Zezeski <rpz@joyent.com>
Date: Wed, 17 Aug 2016 14:28:15 -0700
Subject: [PATCH] OS-4601 clock_getres(2) always returns 0 when ts is NULL

---
 usr/src/uts/common/brand/lx/syscall/lx_timer.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/usr/src/uts/common/brand/lx/syscall/lx_timer.c b/usr/src/uts/common/brand/lx/syscall/lx_timer.c
index c102334156..cc2964decf 100644
--- a/usr/src/uts/common/brand/lx/syscall/lx_timer.c
+++ b/usr/src/uts/common/brand/lx/syscall/lx_timer.c
@@ -257,15 +257,15 @@ lx_clock_getres(int clock, timespec_t *tp)
 {
 	lx_clock_backend_t *backend;
 
-	if (tp == NULL) {
-		return (0);
-	}
-
 	if ((backend = LX_CLOCK_BACKEND(clock)) == NULL) {
 		lx_clock_unsupported(clock);
 		return (set_errno(EINVAL));
 	}
 
+	if (tp == NULL) {
+		return (0);
+	}
+
 	return (backend->lclk_clock_getres(backend->lclk_ntv_id, tp));
 }
 
-- 
2.21.0

