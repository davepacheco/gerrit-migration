{"project":"joyent/illumos-joyent","branch":"master","id":"Ic8b89b2e0ef5e796d5ea1ee45802f7ebc39545f4","number":"5216","subject":"OS-7438 refactor bhyve EPT to use generic page tables OS-7437 want generic indexed page table system Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e Reviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e Approved by: Hans Rosenfeld \u003chans.rosenfeld@joyent","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/5216","commitMessage":"OS-7438 refactor bhyve EPT to use generic page tables\nOS-7437 want generic indexed page table system\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nReviewed by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\nApproved by: Hans Rosenfeld \u003chans.rosenfeld@joyent.com\u003e\n","createdOn":1544475655,"lastUpdated":1550158095,"open":false,"status":"MERGED","comments":[{"timestamp":1544475655,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1544475801,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1544721590,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1544738038,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1544791352,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 1: Code-Review+1\n\n(2 comments)"},{"timestamp":1544820469,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2."},{"timestamp":1544820481,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Patch Set 2 was rebased."},{"timestamp":1545055511,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1546982542,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4: Patch Set 3 was rebased."},{"timestamp":1548273647,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5: Patch Set 4 was rebased."},{"timestamp":1548946882,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5:\n\n(22 comments)\n\nSorry this took me so long. This looks good. When we have RVI I wonder how much similar code we\u0027ll end up with but we can always refactor as needed then..."},{"timestamp":1548977602,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(12 comments)"},{"timestamp":1549026400,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 5:\n\n(5 comments)"},{"timestamp":1549038092,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1549061843,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 6."},{"timestamp":1549061878,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1549061900,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 7:\n\n(13 comments)"},{"timestamp":1549284231,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 7: Code-Review+1\n\n(3 comments)\n\nStill seems worth moving the root init into the gipt map initialization, but this can definitely wait until further refactoring..."},{"timestamp":1549327297,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 8."},{"timestamp":1549327441,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 8:\n\n(2 comments)\n\nI\u0027ve done some refactoring to include the PTE-callback approach: Where gipt is table to do accomplish more complex structural tasks by being made aware of PTE format thanks to some EPT_supplied callbacks.  The hope is that less code duplication will be required when RVI support is added."},{"timestamp":1549360281,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 8:\n\n(4 comments)\n\nLooks good!"},{"timestamp":1549381081,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 9."},{"timestamp":1549381127,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 8:\n\n(4 comments)"},{"timestamp":1549381770,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 9: Code-Review+1\n\n(1 comment)"},{"timestamp":1549381966,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 10."},{"timestamp":1549382004,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 9:\n\n(1 comment)"},{"timestamp":1549383097,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 10: Code-Review+1"},{"timestamp":1549395194,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 11."},{"timestamp":1549395396,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 11:\n\nFixed some DEBUG nits during testing"},{"timestamp":1549395441,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 12: Patch Set 11 was rebased."},{"timestamp":1549406402,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 12: Code-Review+1"},{"timestamp":1549414417,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 12:\n\nTest notes are being recorded in OS-7438."},{"timestamp":1549541635,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Patch Set 12: Code-Review+1 Integration-Approval+1"},{"timestamp":1549569890,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 13: Patch Set 12 was rebased."},{"timestamp":1549569993,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 14: Commit message was updated."},{"timestamp":1550091574,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 15: Patch Set 14 was rebased."},{"timestamp":1550158023,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 16: Patch Set 15 was rebased."},{"timestamp":1550158068,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 17: Patch Set 16 was rebased."},{"timestamp":1550158095,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"17","revision":"c8b89b2e0ef5e796d5ea1ee45802f7ebc39545f4","parents":["75994c2981d7df79f8f235e44058f1c127265cf4"],"ref":"refs/changes/16/5216/17","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550158068,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"SUBM","value":"1","grantedOn":1550158095,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},"patchSets":[{"number":"1","revision":"2a8c48834682b90701fb7e146fa1971f77454a71","parents":["b1cf180263bead3ec5a4bbdda602d5371c2405d6"],"ref":"refs/changes/16/5216/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1544475655,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1544791352,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/uts/i86pc/Makefile.files","line":276,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I debated making this bhyve-specific, since there won\u0027t be any other consumers for the time being.  I\u0027m open to making that change."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":320,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"I\u0027m probably missing something important here. What exactly does \"wired\" mean in this context? Looks like \"is wired\" just means it\u0027s mapped and usable, and em_wired is a count of pages that are mapped and usable.\n\nIf my understanding is correct, would it perhaps be possible to rename em_wired to make it clearer?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":320,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Perhaps em_wired_pages would make more sense?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":320,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Yes, that would make it clearer.\n\nHow is this \"wired\" related to the -S switch in bhyve?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":301,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Would it make sense to allocate pts in this function, to make sure it is always of the required size? Or perhaps make the size explicit in the type specification like gipt_t *pts[GIPT_MAX_LEVELS]?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":301,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"For a gipt_map-t which chose a max level less than GIPT_MAX_LEVELS, that constraint would be unnecessary.  As this isn\u0027t really a public API at this point, I\u0027m not worried about the sharp edge.  (It seems pretty minor)"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":301,"reviewer":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},"message":"Fair enough."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":451,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":34,"deletions":-565},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":340,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":914,"sizeDeletions":-566},{"number":"2","revision":"7aa123189f3b34d824bd53a53ae79fc547477680","parents":["b1cf180263bead3ec5a4bbdda602d5371c2405d6"],"ref":"refs/changes/16/5216/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1544820469,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":451,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":34,"deletions":-565},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":340,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":914,"sizeDeletions":-566},{"number":"3","revision":"3f1733dab1e4444c15b6671f6e98c6f8f617798f","parents":["ad624932236bc6528ef8d030ba2d46e3f732e9ee"],"ref":"refs/changes/16/5216/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1544820481,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545055511,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":451,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":34,"deletions":-565},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":340,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":914,"sizeDeletions":-566},{"number":"4","revision":"e64e51882f488de1843e603dac58b23211079675","parents":["79ecd7ba38ef632ce05115bf44172e6157e2f26a"],"ref":"refs/changes/16/5216/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1546982542,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545055511,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":451,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":34,"deletions":-565},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":340,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":914,"sizeDeletions":-566},{"number":"5","revision":"18317479abd565dbfa963b1afda2b048a4e79ea3","parents":["4014b5dddd3d82d5c801ad28807ad911d324ca51"],"ref":"refs/changes/16/5216/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1548273647,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545055511,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}}],"comments":[{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":40,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I know this is just moved code, so optional, but: spaces around | ?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":40,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Sure thing."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":57,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Curious why this was changed to also check for RWX? It doesn\u0027t seem to make much difference, just a tidy?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":57,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I based this off figure 28-1 from intel x86 vol3 which is rather explicit about the RWX \u003d\u003d 0 case being absent."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":120,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit, spaces around minus?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":120,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":130,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"comment that we never free the root?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":130,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":282,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Why isn\u0027t gipt.c doing this? Taking a step back is there a reason we don\u0027t pass the root as an argument to gipt_map_init() ? That way, instead of (partially) handling a null root there, we can assert it exists.\n\nIt can also handle gipt_valid_cnt below?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":282,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I do like the idea of passing the root as part of gipt_map_init() and forcing a \u0027giptm_root !\u003d NULL\u0027 invariant.\n\nAs for gipt_valid_cnt, since its manipulation is restricted to the ept logic, I\u0027m hesitant to move any of it into the gipt code itself.  (Perhaps until gipt is enhanced with more knowledge of PTE assignment like we chatted about for NPT/RVI)"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":300,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Often useful in the future to handle a NULL arg for free routines?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":300,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Sure"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":332,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Maybe I\u0027m confused but when is this going to be not absent *and* not map a page?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":332,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Belt-and-suspenders paranoia"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":332,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I\u0027m all for paranoia, but how about a VERIFY()? AFAICS something would be badly wrong if we hit this"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":332,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"After further thought, I just went back to a simple check here."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":376,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Could these panics include the gipt pointer? Can be a little tedious to dig out otherwise?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":376,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"That sounds good."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":208,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"It\u0027s a shame the freebsd code exposes this to the generic code, ideally it\u0027d be hidden behind pm_impl and only called from the vminit() routines..."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":225,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Why not just directly return the value?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":225,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"So that I don\u0027t need to expose the structs at all to this part of the shim"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":225,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"I mean:\n\n  return (pmap-\u003e...wired_cnt(pmap-\u003epm_impl));\n\ni.e. just a style nit"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":225,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I remember now: it was to make the uint64_t (implicit) cast a little more clear. I\u0027ll put a guard in for that."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":656,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"While you\u0027re here, fix up ? s/will vCPUs/vCPUs will/"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","line":656,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":22,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Any chance this could be expanded now, with a brief description of the moving pieces and what they represent? And the pmap-\u003e{ept,rvi}-\u003egipt layers?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":22,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Yeah, I was waiting to expand this until I\u0027d received some buy-in on the rough design.  I\u0027ll be light on specifics of upstack consumers (ept, pmap)"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":71,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Not for now but I wonder if it\u0027s worth having a kmem cache for the gipts -"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":71,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027m not sure the frequency of these allocations would necessitate distinct per-cpu caches."},{"file":"usr/src/uts/i86pc/os/gipt.c","line":71,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Well initially I thought it might be useful in the absence of a dcmd, but then a gipt isn\u0027t that much use without a back pointer to the map, so meh."},{"file":"usr/src/uts/i86pc/os/gipt.c","line":90,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Is this just for a light form of deadbeef detection?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":90,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"yeah, paranoia"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":132,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"you verify max_levels elsewhere, here too?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":132,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":134,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Nit: ISP2() - can remove comment then"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":134,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":138,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Do we want an MDB walker?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":138,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Cross that bridge later, maybe?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":138,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Makes sense"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":144,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"lingering\""},{"file":"usr/src/uts/i86pc/os/gipt.c","line":144,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":222,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"s/root entry/table root/ ??"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":222,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":254,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Why is this being set rather than asserted?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":254,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"We\u0027re not asserting that pt-\u003egipt_next is NULL.  If we\u0027re unconditionally setting the one, I\u0027m fine zeroing the other."},{"file":"usr/src/uts/i86pc/os/gipt.c","line":254,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Not a big deal, but maybe we should assert that?"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":254,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Made moot by the use of list_t/list_node_t"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":299,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Is it worth clarifying that this just creates the tables, and does *not* install/link any PTEs? I\u0027m just thinking some documentation of separation of concerns might be good."},{"file":"usr/src/uts/i86pc/os/gipt.c","line":299,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":30,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Why not a list_node_t for prev/next?"},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":30,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It would quadruple the storage requirements for giptm_hash (requiring list_t[]), otherwise it would be fine, given that gipt_t fits in a cache line regardless."},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":30,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Ugh, of course, yeah. I tried to think of an alternative that still works OK, but it really seems like what you have is best."},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":30,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Except for very sparse maps, the giptm_hash storage is relatively small when compared to the gipt_t needs, so I\u0027m not totally opposed to using the list_t stuff here."},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":30,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Switching to list_t/list_node_t"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":15,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":451,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":34,"deletions":-565},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":340,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":914,"sizeDeletions":-566},{"number":"6","revision":"efc56d292f2669dc5f77b7ecd48af75cdd4590af","parents":["4014b5dddd3d82d5c801ad28807ad911d324ca51"],"ref":"refs/changes/16/5216/6","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549061843,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":454,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-567},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":334,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":917,"sizeDeletions":-570},{"number":"7","revision":"8bb7735015c9ab434f33e63ce6b16fbfff79246e","parents":["1678a6d4908c55f0db8485ea4211312a3e143e60"],"ref":"refs/changes/16/5216/7","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549061878,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549284231,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"comments":[{"file":"usr/src/uts/i86pc/os/gipt.c","line":27,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"A page table tree\" ? I\u0027m not sure how best to say this"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":27,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":34,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Could I get a brief couple of sentences on what gipt_t and gipt_map_t are"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":34,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027ve added more detail here.  I\u0027m still mulling over how to expand on all of it."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":454,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-567},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":334,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":72,"deletions":0}],"sizeInsertions":917,"sizeDeletions":-570},{"number":"8","revision":"ce9d9d7bfcf32f4af51e89536859b61747fbfbc7","parents":["1678a6d4908c55f0db8485ea4211312a3e143e60"],"ref":"refs/changes/16/5216/8","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549327297,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":79,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Pure opinion, but I\u0027d prefer PTET_LINK or PTET_TABLE_LINK ?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":79,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Good suggestion.  I like PTET_LINK much more."},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":191,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"re-write these, :224 etc in terms of ept_pte_type?"},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","line":191,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Given that we already have the convenience macros, I\u0027m inclined to leave them as-is."},{"file":"usr/src/uts/i86pc/os/gipt.c","line":359,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: you shouldn\u0027t need these comments"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":359,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Something something, old habits.  Fixed."},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":45,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"\"emit a PTE\""},{"file":"usr/src/uts/i86pc/sys/gipt.h","line":45,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-567},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":568,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":985,"sizeDeletions":-570},{"number":"9","revision":"d705b86c78af0567ac0583bfcdc2cbd4276310f4","parents":["1678a6d4908c55f0db8485ea4211312a3e143e60"],"ref":"refs/changes/16/5216/9","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549381081,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549381770,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"comments":[{"file":"usr/src/uts/i86pc/os/gipt.c","line":391,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"still have this last NOTREACHED"},{"file":"usr/src/uts/i86pc/os/gipt.c","line":391,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Cleaned up this one and a few others lingering in vmm"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-567},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":567,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":984,"sizeDeletions":-570},{"number":"10","revision":"dfe634ff22d07a9cf9c77f3d4d29def0b7e1bebe","parents":["1678a6d4908c55f0db8485ea4211312a3e143e60"],"ref":"refs/changes/16/5216/10","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549381966,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549383097,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"11","revision":"a5fd7d91a534dd01f84e80146253a604694a92fd","parents":["1678a6d4908c55f0db8485ea4211312a3e143e60"],"ref":"refs/changes/16/5216/11","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549395194,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"12","revision":"8f43d1ecefa2a7582c5636f91cb3c7a8dca337d0","parents":["5b248548c9ca0108aa36e7e3db7fbc46077bcf4b"],"ref":"refs/changes/16/5216/12","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549395441,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"13","revision":"ab606a7eb31ca76b20aa61b904c277e0f5a8f32c","parents":["7a899a42e86d8d3e6d7d3eaf31bcacc6411fbb74"],"ref":"refs/changes/16/5216/13","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549569890,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"14","revision":"f6a99732a10e3d68f3f39a1ba27a5634e4123a52","parents":["7a899a42e86d8d3e6d7d3eaf31bcacc6411fbb74"],"ref":"refs/changes/16/5216/14","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1549569993,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"15","revision":"341f09f2fe3124085b1efe5cc2b9dc22cb6c7bfa","parents":["a34efbb67708deaa7bfc683cfc95bc54c769d912"],"ref":"refs/changes/16/5216/15","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550091574,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"16","revision":"13a94ea852325b4a3e9719b5daf4d2d46ec28247","parents":["efef2829b4493d5511868a931e798241ea514f3b"],"ref":"refs/changes/16/5216/16","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550158023,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573},{"number":"17","revision":"c8b89b2e0ef5e796d5ea1ee45802f7ebc39545f4","parents":["75994c2981d7df79f8f235e44058f1c127265cf4"],"ref":"refs/changes/16/5216/17","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1550158068,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"SUBM","value":"1","grantedOn":1550158095,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549541635,"by":{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549406402,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"usr/src/uts/i86pc/Makefile.files","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/i86pc/io/vmm/vm/vm_glue.h","type":"MODIFIED","insertions":16,"deletions":-2},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_ept.c","type":"ADDED","insertions":268,"deletions":0},{"file":"usr/src/uts/i86pc/io/vmm/vmm_sol_vm.c","type":"MODIFIED","insertions":38,"deletions":-570},{"file":"usr/src/uts/i86pc/os/gipt.c","type":"ADDED","insertions":566,"deletions":0},{"file":"usr/src/uts/i86pc/sys/gipt.h","type":"ADDED","insertions":92,"deletions":0}],"sizeInsertions":983,"sizeDeletions":-573}],"allReviewers":[{"name":"Hans Rosenfeld","email":"hans.rosenfeld@joyent.com","username":"hrosenfeld"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}