{"project":"joyent/sdc-net-agent","branch":"master","topic":"RFD 28","id":"I3b82caf881c602ae45bd2d6fd006a7b6a3b55826","number":"3965","subject":"TRITON-387 net-agent should update VMs based on changes within NAPI TRITON-444 Use ESLint in sdc-net-agent Reviewed by: Mike Zeller \u003cmike.zeller@joyent.com\u003e Reviewed by: Jason King \u003cjason.king@joyent.com\u003e Reviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e Revi","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/3965","commitMessage":"TRITON-387 net-agent should update VMs based on changes within NAPI\nTRITON-444 Use ESLint in sdc-net-agent\nReviewed by: Mike Zeller \u003cmike.zeller@joyent.com\u003e\nReviewed by: Jason King \u003cjason.king@joyent.com\u003e\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\nReviewed by: Dave Eddy \u003cdave.eddy@joyent.com\u003e\nApproved by: Dave Eddy \u003cdave.eddy@joyent.com\u003e\n","createdOn":1526529542,"lastUpdated":1530556139,"open":false,"status":"MERGED","comments":[{"timestamp":1526529542,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1526529583,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526529660,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1526529701,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1526582481,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2:\n\n(12 comments)\n\nPass-0 comments.  I will need at least one more pass.\n\nAlso, you\u0027re adding ESLINT which seems highly sensible, but would that require a separate bugid?  (I\u0027m not requesting you take ESLINT as a distinct commit, just a distinct bug....)"},{"timestamp":1526660208,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\n(3 comments)\n\nRound 0"},{"timestamp":1527281642,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1527281661,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n /tmp/repo/build/node/bin/node node_modules/.bin/eslint   bin/net-agent.js lib/server-fsm.js lib/common.js lib/vm.js lib/net-fsm.js lib/net-agent.js lib/aggr-fsm.js lib/nic-fsm.js lib/index.js lib/inst-fsm.js\n \n /tmp/repo/lib/aggr-fsm.js\n   79:1  error  Expected a \u0027*\u0027 at the start of this line  multiline-comment-style\n \n âœ– 1 problem (1 error, 0 warnings)\n   1 error, 0 warnings potentially fixable with the `--fix` option.\n \n tools/mk/Makefile.targ:201: recipe for target \u0027check-eslint\u0027 failed\n gmake: *** [check-eslint] Error 1"},{"timestamp":1527281770,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4."},{"timestamp":1527281811,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527281824,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2:\n\n(13 comments)"},{"timestamp":1527625912,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 4:\n\n(1 comment)\n\nIncremental 2-\u003e4 looks okay, modulo one copyright nit.  Need to do another full pass."},{"timestamp":1527627535,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 5."},{"timestamp":1527627578,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(1 comment)"},{"timestamp":1527627581,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1527627805,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1527627842,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6:\n\n\u003e Also, you\u0027re adding ESLINT which seems highly sensible, but would that require a separate bugid? \n\nDone. Added TRITON-444 to the commit message."},{"timestamp":1527631095,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 4:\n\n(7 comments)"},{"timestamp":1527693801,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 6: Code-Review+1\n\n(3 comments)\n\nThe code itself looks good to me.  Do you have any testing notes you can put in the ticket?"},{"timestamp":1527693935,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1528309512,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 6: Code-Review+1\n\n(2 comments)\n\nNits... all in comments too."},{"timestamp":1528756319,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 7."},{"timestamp":1528756373,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528756376,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 7:\n\n(2 comments)"},{"timestamp":1528757461,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 8."},{"timestamp":1528757502,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528765355,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 8: Code-Review+1"},{"timestamp":1528774531,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 8: Code-Review+1"},{"timestamp":1529022887,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 9: Commit message was updated."},{"timestamp":1529439061,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 9: Code-Review+1 Integration-Approval+1\n\nLGTM. Built and tested the latest changes on emy-12 (smartos-live, vm-agent, vmapi, and cloudapi test suites) all working as expected."},{"timestamp":1529534559,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 10."},{"timestamp":1529534600,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 10: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529609740,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 10: Code-Review+1\n\n(1 comment)\n\nCode itself looks good to me.  Let me know if you think this will be the final review or if you have other changes planned.  Also, I can test this on emy-12 if you would like if you need more hands on testing."},{"timestamp":1529948968,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 11."},{"timestamp":1529949009,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 11: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1529951444,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 11: Code-Review+1"},{"timestamp":1529955142,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 11: Code-Review+1"},{"timestamp":1530036321,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 11: Code-Review+1 Integration-Approval+1"},{"timestamp":1530204123,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 11: Code-Review+1"},{"timestamp":1530205709,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 12."},{"timestamp":1530205758,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 12: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1530205865,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 12: Code-Review+1\n\nIncremental 11-\u003e12 looks good too."},{"timestamp":1530205896,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 12: Code-Review+1"},{"timestamp":1530242283,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 12: Code-Review+1 Integration-Approval+1"},{"timestamp":1530242723,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"},{"timestamp":1530556139,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Topic set to RFD 28"}],"currentPatchSet":{"number":"12","revision":"3b82caf881c602ae45bd2d6fd006a7b6a3b55826","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/12","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1530205709,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530205758,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530205865,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530205896,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530242283,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530242283,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"SUBM","value":"1","grantedOn":1530242723,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":45,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":350,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":230,"deletions":-487},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":693,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"DELETED","insertions":0,"deletions":-387},{"file":"lib/watcher-fsm.js","type":"ADDED","insertions":303,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2856,"sizeDeletions":-1247},"patchSets":[{"number":"1","revision":"d36b5756dc5dbe87aae48362412131d5337abd8f","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1526529542,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526529583,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":32,"deletions":-87},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":437,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":429,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":294,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":608,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":19,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2552,"sizeDeletions":-982},{"number":"2","revision":"d2aea8cbcc628c915bcd1ddc516fdfd921fb8e50","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1526529660,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1526529701,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":".gitmodules","line":3,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Speaking of which, why not this one as well?"},{"file":".gitmodules","line":3,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"There isn\u0027t a joyent/restdown repo, just this one."},{"file":".gitmodules","line":6,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Wow, I didn\u0027t know we had someone\u0027s-home-repo in a public one.  Good catch."},{"file":".gitmodules","line":6,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"The repos used to be under dap\u0027s account, but he transferred them to the joyent org several months ago."},{"file":"bin/net-agent.js","line":8,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Update?"},{"file":"bin/net-agent.js","line":8,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"bin/net-agent.js","line":58,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"In other reviews, I\u0027ve seen a stated preference against anonymous functions (I think mostly around debugging).  Would it be better to give this a name?"},{"file":"bin/net-agent.js","line":58,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/aggr-fsm.js","line":12,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"If you can draw the state machine, I might be able to ASCII-fy it for a block-comment."},{"file":"lib/aggr-fsm.js","line":12,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/index.js","line":8,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Update?"},{"file":"lib/index.js","line":8,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/inst-fsm.js","line":18,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Same here w.r.t. the state diagram."},{"file":"lib/net-agent.js","line":270,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Showstopper for this fix?  Or more of a TODO?"},{"file":"lib/net-agent.js","line":270,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"This is more of a TODO. I\u0027ll rephrase this. Basically the logic in lib/vm.js could stand to be improved, but that can be done as a separate ticket."},{"file":"lib/net-agent.js","line":342,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"We don\u0027t have to worry about the moral equivalent of a double-free here, do we?"},{"file":"lib/net-agent.js","line":342,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"No. Deleting an already deleted NIC returns 404, which both VMAPI and net-agent handle.\n\nVMAPI and net-agent do both today have a problem where if one deletes a NIC, and then a new VM gets given the same MAC address, then the other component could delete the new NIC from NAPI. These changes take care of fixing this within net-agent by using Etags to conditionally delete."},{"file":"lib/net-agent.js","line":350,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"You should note here that a native zone admin who uses route(1M), even with -p, will not have their changes reflected here.  (Or am I wrong?)"},{"file":"lib/net-agent.js","line":350,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/net-fsm.js","line":29,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"attached_networks would go in that list later, right?"},{"file":"lib/net-fsm.js","line":29,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Maybe, depending on how it gets implemented. I was thinking that adding new networks to \"attached_networks\" would insert new fields into \"routes\" so that VMAPI and net-agent don\u0027t have to do the network resolution and merging themselves."},{"file":"lib/net-fsm.js","line":44,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Same here about if I see a drawing of the state machine..."},{"file":"lib/nic-fsm.js","line":19,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"And here..."},{"file":"lib/nic-fsm.js","line":19,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/nic-fsm.js","line":44,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Does this include the future where a NIC can have more than one address?  Or does that future now have to alter here as well?"},{"file":"lib/nic-fsm.js","line":44,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"That will require altering here, to figure out how things get mapped onto the local \"ips\" array and the remote \"addresses\"."},{"file":"lib/server-fsm.js","line":207,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"This would also happen for \"create-vlan\", \"create-iptun\", and \"create-overlay\" too, I\u0027d imagine.  Perhaps `dladm create-*` ?"},{"file":"lib/server-fsm.js","line":207,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":32,"deletions":-87},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":437,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":2,"deletions":0},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":429,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":294,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":608,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2551,"sizeDeletions":-982},{"number":"3","revision":"778a8793abed78714c2307f5e5925c1e7a07fedd","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527281642,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1527281661,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":32,"deletions":-87},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":427,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":301,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":678,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2722,"sizeDeletions":-983},{"number":"4","revision":"9918a458967fad72990e190d8b90c1322eb7add0","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527281770,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527281811,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/net-agent.js","line":8,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Still looks like 2016."},{"file":"bin/net-agent.js","line":8,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Oops. Now it\u0027s 2018."},{"file":"bin/net-agent.js","line":8,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"2018"},{"file":"lib/aggr-fsm.js","line":241,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"worth having S.validTransitions here?"},{"file":"lib/common.js","line":18,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"assert.uuid and assert.string"},{"file":"lib/inst-fsm.js","line":58,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"nit: state diagram like the one in aggr-fsm"},{"file":"lib/net-agent.js","line":270,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Worth nothing that in the vminfod world the zoneevent watcher tries to use vmamd events from vminfod.  If that\u0027s not available it falls back to the current behavior.  That said, I don\u0027t think Dave has added that logic to net-agent like he has done for some of the other agents.  I know he mentioned he has plans to do so."},{"file":"lib/net-agent.js","line":270,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"I do have plans for adding it to this agent, but because of the size of *this* review specifically I think it makes the most sense to wait until this is in.  `zoneevent` will use `vminfod` under-the-hood if it is available, but it still won\u0027t emit a \"ready\" event or anything like that.\n\nFor net-agent I would copy something like is already in vm-agent, where `vmadm events` will be used and a \"ready\" event is emitted when the watcher is established.  see: https://github.com/joyent/sdc-vm-agent/blob/master/lib/watchers/vmadm-events-watcher.js."},{"file":"lib/net-agent.js","line":345,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"For my own knowledge, what happens if an operator destroys a VM with vmadm.  net-agent will cleanup the NIC, but will something like vm-agent clean up the entry in vmapi?"},{"file":"lib/nic-fsm.js","line":184,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"add S.validTransitions"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":32,"deletions":-87},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":531,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":427,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":301,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":678,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2721,"sizeDeletions":-983},{"number":"5","revision":"c8f049b8372b63a1cdeb097bdcd7819974fa7946","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/5","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527627535,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527627581,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":531,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":427,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":301,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":678,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2722,"sizeDeletions":-984},{"number":"6","revision":"229ec05bc13b5a7413125a8afa8d657ccde84d85","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/6","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1527627805,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1527627581,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1527693801,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528309512,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"lib/aggr-fsm.js","line":74,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Missing arrows here?!"},{"file":"lib/aggr-fsm.js","line":74,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"lib/aggr-fsm.js","line":509,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: assert optionalString on etag"},{"file":"lib/aggr-fsm.js","line":526,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"nit: can this be assert.uuid?"},{"file":"lib/common.js","line":19,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"assert cn_uuid and name"},{"file":"lib/nic-fsm.js","line":134,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Same nit here, missing arrows."},{"file":"lib/nic-fsm.js","line":134,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":531,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":427,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":301,"deletions":-482},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":678,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2722,"sizeDeletions":-984},{"number":"7","revision":"2ee06f35799d0adb80ea161d4b04d931380acbdd","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/7","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1528756319,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528756373,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":531,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":431,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":300,"deletions":-488},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":665,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2712,"sizeDeletions":-990},{"number":"8","revision":"7c7561cac61dfe4d6020f9253e60c46a849b25cc","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/8","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1528757461,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528757502,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528774531,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528765355,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":434,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":300,"deletions":-488},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":666,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2717,"sizeDeletions":-990},{"number":"9","revision":"d699c93643855d04ef5c2b8e1bcd90aac062b368","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/9","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529022887,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528757502,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529439061,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1529439061,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528774531,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528765355,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":41,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":434,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":300,"deletions":-488},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":666,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"MODIFIED","insertions":41,"deletions":-129},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2717,"sizeDeletions":-990},{"number":"10","revision":"10a08246da65d4f09f611c5742f338b5e340ee86","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/10","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529534559,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529534600,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529609740,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"comments":[{"file":"lib/watcher-fsm.js","line":172,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"+1. I\u0027m already envisioning its implementation using this mooremachine style.  once this CR lands I\u0027m going to implement this."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":45,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":350,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":230,"deletions":-487},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":688,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"DELETED","insertions":0,"deletions":-387},{"file":"lib/watcher-fsm.js","type":"ADDED","insertions":300,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2848,"sizeDeletions":-1247},{"number":"11","revision":"3f079e15b5f8d331e4594002ac44cab5e2496c33","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/11","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1529948968,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1529949009,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530036321,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530036321,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530204123,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529951444,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1529955142,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":45,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":350,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":230,"deletions":-487},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":688,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"DELETED","insertions":0,"deletions":-387},{"file":"lib/watcher-fsm.js","type":"ADDED","insertions":303,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2851,"sizeDeletions":-1247},{"number":"12","revision":"3b82caf881c602ae45bd2d6fd006a7b6a3b55826","parents":["34536e85ac8d27fa08afd553751ff0434e5bb056"],"ref":"refs/changes/65/3965/12","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1530205709,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"SUBM","value":"1","grantedOn":1530242723,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1530205758,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530242283,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1530242283,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530205896,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1530205865,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":13,"deletions":0},{"file":".eslintrc","type":"ADDED","insertions":26,"deletions":0},{"file":".gitignore","type":"MODIFIED","insertions":1,"deletions":0},{"file":".gitmodules","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"bin/net-agent.js","type":"MODIFIED","insertions":33,"deletions":-88},{"file":"deps/javascriptlint","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"deps/jsstyle","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"lib/aggr-fsm.js","type":"ADDED","insertions":532,"deletions":0},{"file":"lib/common.js","type":"ADDED","insertions":45,"deletions":0},{"file":"lib/index.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/inst-fsm.js","type":"ADDED","insertions":350,"deletions":0},{"file":"lib/napi-client.js","type":"DELETED","insertions":0,"deletions":-240},{"file":"lib/net-agent.js","type":"MODIFIED","insertions":230,"deletions":-487},{"file":"lib/net-fsm.js","type":"ADDED","insertions":145,"deletions":0},{"file":"lib/nic-fsm.js","type":"ADDED","insertions":693,"deletions":0},{"file":"lib/server-fsm.js","type":"ADDED","insertions":293,"deletions":0},{"file":"lib/vm.js","type":"DELETED","insertions":0,"deletions":-387},{"file":"lib/watcher-fsm.js","type":"ADDED","insertions":303,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":18,"deletions":-12},{"file":"sapi_manifests/net-agent/template","type":"MODIFIED","insertions":23,"deletions":-2},{"file":"tools/jsl.node.conf","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"tools/mk/Makefile.defs","type":"MODIFIED","insertions":56,"deletions":-2},{"file":"tools/mk/Makefile.deps","type":"MODIFIED","insertions":36,"deletions":-1},{"file":"tools/mk/Makefile.node.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.node.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.node_prebuilt.defs","type":"MODIFIED","insertions":11,"deletions":-5},{"file":"tools/mk/Makefile.smf.targ","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"tools/mk/Makefile.targ","type":"MODIFIED","insertions":37,"deletions":-9}],"sizeInsertions":2856,"sizeDeletions":-1247}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}