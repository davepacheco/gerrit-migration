{"project":"joyent/illumos-joyent","branch":"master","id":"I80d05a8fa70bf4144668abbb3396a67e01ba6e71","number":"5425","subject":"OS-7498 __ctype_mask[EOF] has been working by accident OS-7511 undefined behavior in lx_cap_update_priv() turns gcc7 demonic OS-7517 -faggressive-loop-optimizations is too aggressive OS-7518 array over-read in has_saved_fp() OS-7535 allow platform builds ","owner":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"url":"https://cr.joyent.us/5425","commitMessage":"OS-7498 __ctype_mask[EOF] has been working by accident\nOS-7511 undefined behavior in lx_cap_update_priv() turns gcc7 demonic\nOS-7517 -faggressive-loop-optimizations is too aggressive\nOS-7518 array over-read in has_saved_fp()\nOS-7535 allow platform builds on base-64 image\nOS-7536 stop shipping poold(1M) and its cohorts\nReviewed by: Robert Mustacchi \u003crm@joyent.com\u003e\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1548377105,"lastUpdated":1549394849,"open":false,"status":"MERGED","comments":[{"timestamp":1548377105,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Uploaded patch set 1."},{"timestamp":1548379408,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 1:\n\n(1 comment)\n\nIn general, this looks good. Thanks."},{"timestamp":1548415961,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(2 comments)\n\nWe still need to worry about C outside of illumos-joyent don\u0027t we? While some of it is probably GCC7-audited, I bet e.g. openssl-1 isn\u0027t. And we have a bunch of smartos-live source too.\n\nRe: pools: poold should actually only be needed for dynamic pools. In theory we could still deliver stuff for pools, just not have a range of CPUs. However doesn\u0027t seem a problem to get rid of both."},{"timestamp":1548716779,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Uploaded patch set 2."},{"timestamp":1548716863,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1548754529,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1549316188,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1549316241,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Uploaded patch set 3."},{"timestamp":1549320040,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1549385230,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1549386260,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 4: Patch Set 3 was rebased"},{"timestamp":1549388514,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1549394835,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1549394849,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Bryan Cantrill"}],"currentPatchSet":{"number":"5","revision":"5b248548c9ca0108aa36e7e3db7fbc46077bcf4b","parents":["fc7d1728f1b98070dfbbebfbb53b62279b33cfe2"],"ref":"refs/changes/25/5425/5","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1549394835,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549320040,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549385230,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549388514,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1549394849,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":15,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-24},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":66,"sizeDeletions":-61},"patchSets":[{"number":"1","revision":"ef59dbf3ab49479b02034a41155760784113213a","parents":["ce6a7649078ae9f0ae246da1fffb1343093388f2"],"ref":"refs/changes/25/5425/1","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1548377105,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"REWORK","comments":[{"file":"manifest","line":9955,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"is there a specific reason to still deliver the directory?"},{"file":"manifest","line":9955,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Definitely not; deleted it. Thanks!"},{"file":"usr/src/tools/smatch/Makefile","line":31,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Probably worth a comment as to why this is going -m64 so we can better handle that versus upstream."},{"file":"usr/src/tools/smatch/Makefile","line":31,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Added!"},{"file":"usr/src/tools/smatch/Makefile","line":41,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"do we need this line still then?"},{"file":"usr/src/tools/smatch/Makefile","line":41,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Yes -- added a comment explaining why"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-23},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":55,"sizeDeletions":-60},{"number":"2","revision":"2a191d9bec2fea1edeb2ebef31322d460f2fc823","parents":["5e68991d1f557ace62cb01ef7bcc9d481c3e387e"],"ref":"refs/changes/25/5425/2","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1548716779,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/tools/smatch/Makefile","line":50,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Nit: s/to be set// ?"},{"file":"usr/src/tools/smatch/Makefile","line":50,"reviewer":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"message":"Fixed -- thanks!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-24},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":66,"sizeDeletions":-61},{"number":"3","revision":"80d05a8fa70bf4144668abbb3396a67e01ba6e71","parents":["b156585baf970b2e42dc1e9dc920784b85983ab1"],"ref":"refs/changes/25/5425/3","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1549316241,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549385230,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549320040,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-24},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":66,"sizeDeletions":-61},{"number":"4","revision":"487a816e019d5485b931c28fb27d9c2aa3510a4e","parents":["fc7d1728f1b98070dfbbebfbb53b62279b33cfe2"],"ref":"refs/changes/25/5425/4","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1549386260,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549385230,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549388514,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549320040,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-24},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":66,"sizeDeletions":-61},{"number":"5","revision":"5b248548c9ca0108aa36e7e3db7fbc46077bcf4b","parents":["fc7d1728f1b98070dfbbebfbb53b62279b33cfe2"],"ref":"refs/changes/25/5425/5","uploader":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"createdOn":1549394835,"author":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549385230,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1549388514,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1549394849,"by":{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1549320040,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":15,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":0,"deletions":-24},{"file":"usr/src/Makefile.master","type":"MODIFIED","insertions":13,"deletions":0},{"file":"usr/src/cmd/Makefile","type":"MODIFIED","insertions":1,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/common/capabilities.c","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/lib/libc/port/locale/table.c","type":"MODIFIED","insertions":21,"deletions":-17},{"file":"usr/src/lib/libsaveargs/amd64/saveargs.c","type":"MODIFIED","insertions":5,"deletions":-2},{"file":"usr/src/tools/ctf/Makefile.ctf","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"usr/src/tools/ctf/cvt/Makefile.com","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/tools/mandoc/Makefile","type":"MODIFIED","insertions":6,"deletions":-9},{"file":"usr/src/tools/smatch/Makefile","type":"MODIFIED","insertions":13,"deletions":-1},{"file":"usr/src/uts/Makefile.uts","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":66,"sizeDeletions":-61}],"allReviewers":[{"name":"Jonathan Perkin","email":"jperkin@joyent.com","username":"jperkin"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Bryan Cantrill","email":"bryan@joyent.com","username":"bcantrill"}]}