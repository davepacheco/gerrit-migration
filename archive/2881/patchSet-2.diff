commit d553c2734cd9f40cfb218ca0b55c8f106b146c2f
Author: Jan Wyszynski <jan.wyszynski@joyent.com>
Date:   2017-11-01T20:22:54+00:00 (1 year, 11 months ago)
    
    MANTA-2412 Allow addition of content-disposition header to manta objects

diff --git a/lib/common.js b/lib/common.js
index 5688a80..dee9334 100644
--- a/lib/common.js
+++ b/lib/common.js
@@ -219,6 +219,7 @@ function createMetadata(req, type, cb) {
         break;
 
     case 'object':
+        md.contentDisposition = req.header('content-disposition');
         md.contentLength = req._size !== undefined ?
             req._size : prev.contentLength;
         md.contentMD5 = req._contentMD5 || prev.contentMD5;
diff --git a/lib/obj.js b/lib/obj.js
index 23082b5..01710dd 100644
--- a/lib/obj.js
+++ b/lib/obj.js
@@ -708,6 +708,7 @@ function streamFromSharks(req, res, next) {
     if (md.contentLength === 0 || req.method === 'HEAD') {
         log.debug('streamFromSharks: HEAD || zero-byte object');
         res.header('Durability-Level', req.metadata.sharks.length);
+        res.header('Content-Disposition', req.metadata.contentDisposition);
         res.header('Content-Length', md.contentLength);
         res.header('Content-MD5', md.contentMD5);
         res.header('Content-Type', md.contentType);
@@ -731,6 +732,7 @@ function streamFromSharks(req, res, next) {
             res.header('Content-MD5', md.contentMD5);
         }
 
+        res.header('Content-Disposition', req.metadata.contentDisposition);
         res.header('Content-Length', sh['content-length']);
         res.header('Durability-Level', req.metadata.sharks.length);
 
diff --git a/package.json b/package.json
index 16192a4..cc66b97 100644
--- a/package.json
+++ b/package.json
@@ -26,7 +26,7 @@
         "kang": "1.1.0",
         "keep-alive-agent": "0.0.1",
         "keyapi": "git+https://github.com/joyent/keyapi.git#e14b3d58",
-        "libmanta": "git+https://github.com/joyent/node-libmanta.git#master",
+        "libmanta": "file:../node-libmanta",
         "libuuid": "0.1.2",
         "lru-cache": "2.3.1",
         "lstream": "0.0.4",
