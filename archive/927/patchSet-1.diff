commit 2a1311a8f8e753ad3df8305cc8f157f40d0d5b96 (refs/changes/27/927/1)
Author: Cody Peter Mello <cody.mello@joyent.com>
Date:   2016-11-21T18:55:42+00:00 (2 years, 11 months ago)
    
    MORAY-350 Moray throws ReferenceError: InternalError is not defined

diff --git a/test/sql.test.js b/test/sql.test.js
index c94c051..1a844fa 100644
--- a/test/sql.test.js
+++ b/test/sql.test.js
@@ -5,12 +5,13 @@
  */
 
 /*
- * Copyright (c) 2014, Joyent, Inc.
+ * Copyright 2016, Joyent, Inc.
  */
 
 var tape = require('tape');
 var util = require('util');
 var uuid = require('libuuid').create;
+var VError = require('verror');
 
 var helper = require('./helper.js');
 
@@ -85,7 +86,9 @@ test('sql - fail', function (t) {
     sql = 'BOGUS QUERY;';
     q = c.sql(sql, [], {});
     q.once('error', function (err) {
-        t.ok(err);
+        t.ok(err, 'error returned');
+        t.ok(VError.hasCauseWithName(err, 'InternalError'),
+            'InternalError returned');
         t.end();
     });
 });
