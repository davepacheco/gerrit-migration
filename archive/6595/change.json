{"project":"joyent/moray","branch":"master","id":"I186946bd6617fd7d13df537475c0b8da1498d282","number":"6595","subject":"MORAY-479 Need documentation on filters MORAY-498 Document causes of \"deadlock detected\" errors MORAY-499 Document how to query range types Reviewed by: Alex Wilson \u003calex.wilson@joyent.com\u003e Reviewed by: Kody Kantor \u003ckody.kantor@joyent.com\u003e Approved by: Ko","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/6595","commitMessage":"MORAY-479 Need documentation on filters\nMORAY-498 Document causes of \"deadlock detected\" errors\nMORAY-499 Document how to query range types\nReviewed by: Alex Wilson \u003calex.wilson@joyent.com\u003e\nReviewed by: Kody Kantor \u003ckody.kantor@joyent.com\u003e\nApproved by: Kody Kantor \u003ckody.kantor@joyent.com\u003e\n","createdOn":1562881566,"lastUpdated":1562896742,"open":false,"status":"MERGED","comments":[{"timestamp":1562881566,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1562881620,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562881810,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 2."},{"timestamp":1562881859,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562882493,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(5 comments)"},{"timestamp":1562883169,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 2:\n\n(1 comment)\n\nLooks good to me. I can +1 when Alex\u0027s comments are resolved."},{"timestamp":1562888687,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 3."},{"timestamp":1562888745,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562888761,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(6 comments)"},{"timestamp":1562891261,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1\n\n(2 comments)"},{"timestamp":1562891274,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3: -Integration-Approval"},{"timestamp":1562891585,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1562891608,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1562896733,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1562896742,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"4","revision":"186946bd6617fd7d13df537475c0b8da1498d282","parents":["5ed0bf26be077a7690823715852f8b396ce9da37"],"ref":"refs/changes/95/6595/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1562896733,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562888745,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891261,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891585,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562891608,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"SUBM","value":"1","grantedOn":1562896742,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":244,"deletions":-6}],"sizeInsertions":244,"sizeDeletions":-6},"patchSets":[{"number":"1","revision":"d301feeca6edaea3b133c3a4a01fc59607fe754a","parents":["5ed0bf26be077a7690823715852f8b396ce9da37"],"ref":"refs/changes/95/6595/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1562881566,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562881620,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":234,"deletions":-6}],"sizeInsertions":234,"sizeDeletions":-6},{"number":"2","revision":"3d5c8240227df4fc087a00bd452ccc5922af3363","parents":["5ed0bf26be077a7690823715852f8b396ce9da37"],"ref":"refs/changes/95/6595/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1562881810,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562881859,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"docs/index.md","line":95,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Prefix and suffix substring matching also works, right? Is it worth mentioning that? Reading this I kind of get the impression that maybe only true substring matches work with * on both sides"},{"file":"docs/index.md","line":95,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve refactored this to include multiple examples. Let me know if it needs more clarification."},{"file":"docs/index.md","line":99,"reviewer":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},"message":"Do you think it\u0027s worth explaining how this behaves for the non-numeric types? Exercise left to the reader?"},{"file":"docs/index.md","line":99,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I\u0027ve added a paragraph below here about comparisons. I\u0027ve only described strings, since it\u0027s the one I suspect people are most likely to use."},{"file":"docs/index.md","line":139,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"I\u0027m a bit confused by this dot point. wouldn\u0027t zero objects only be returned in the case where there were no matching objects in the bucket, still? It\u0027s just that the query sent to *postgres* might match some objects, since it didn\u0027t get sent the entire filter that we asked moray for?"},{"file":"docs/index.md","line":139,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"The problem is that Moray sends a LIMIT with the query, and there might be matching objects past the returned rows. If you send a query like:\n\n    (\u0026(indexedAndAlwaysTrue\u003dtrue)(nonindexedAndUsuallyTrue\u003dfalse))\n\nAnd the first 1000 rows have nonindexedAndUsuallyTrue\u003dtrue, then you won\u0027t see the false ones.\n\nI\u0027ve rewritten this bullet point. Let me know if it\u0027s clearer now."},{"file":"docs/index.md","line":139,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"That\u0027s great, thanks."},{"file":"docs/index.md","line":145,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Maybe make this `\"true\"`"},{"file":"docs/index.md","line":145,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"},{"file":"docs/index.md","line":814,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Why is this needed?"},{"file":"docs/index.md","line":814,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"I added a link to this section above."},{"file":"docs/index.md","line":814,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Sometimes I hate markdown"},{"file":"docs/index.md","line":1274,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"s/a/an"},{"file":"docs/index.md","line":1274,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":234,"deletions":-6}],"sizeInsertions":234,"sizeDeletions":-6},{"number":"3","revision":"1ac27c19b3b8dbb8c3b039936b34da39788f2a45","parents":["5ed0bf26be077a7690823715852f8b396ce9da37"],"ref":"refs/changes/95/6595/3","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1562888687,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891261,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562888745,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891585,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562891608,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":244,"deletions":-6}],"sizeInsertions":244,"sizeDeletions":-6},{"number":"4","revision":"186946bd6617fd7d13df537475c0b8da1498d282","parents":["5ed0bf26be077a7690823715852f8b396ce9da37"],"ref":"refs/changes/95/6595/4","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1562896733,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1562896742,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891261,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562888745,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562891585,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562891608,"by":{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":12,"deletions":0},{"file":"docs/index.md","type":"MODIFIED","insertions":244,"deletions":-6}],"sizeInsertions":244,"sizeDeletions":-6}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},{"name":"Kody A Kantor","email":"kody.kantor@joyent.com","username":"KodyKantor"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}