commit e0aca749db2f0c15a1a0cbc67ad9c5beef5f620a (refs/changes/75/2775/7)
Author: Tim Kordas <tim.kordas@joyent.com>
Date:   2017-10-17T16:46:38-07:00 (2 years ago)
    
    joyent/node-cueball#132 Expose counters and simple metrics from CueBallConnectionPool
    Reviewed by: Cody Peter Mello <cody.mello@joyent.com>

diff --git a/lib/pool.js b/lib/pool.js
index 84cab63..e72d0b9 100644
--- a/lib/pool.js
+++ b/lib/pool.js
@@ -729,6 +729,26 @@ CueBallConnectionPool.prototype.printConnections = function () {
 	console.log('dead:', self.p_dead);
 };
 
+CueBallConnectionPool.prototype.getStats = function () {
+	var self = this;
+
+	// Get a snapshot of current counter values.
+	var counters = {};
+	Object.keys(this.p_counters).forEach(function (k) {
+		counters[k] = self.p_counters[k];
+	});
+
+	var stats = {
+		'counters': counters,
+		'totalConnections': Object.keys(self.p_connections).length,
+		'idleConnections': self.p_idleq.length,
+		'pendingConnections': self.p_initq.length,
+		'waiterCount': self.p_waiters.length
+	};
+
+	return (stats);
+};
+
 CueBallConnectionPool.prototype.claim = function (options, cb) {
 	var self = this;
 	var done = false;
