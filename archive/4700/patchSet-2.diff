From 6bc698e53de1a7071e8d2375c97d441bf5d3af80 Mon Sep 17 00:00:00 2001
From: Dave Eddy <dave@daveeddy.com>
Date: Thu, 16 Aug 2018 17:33:44 -0400
Subject: [PATCH] joyent/node-manta#303 mfind should probably require at least
 one path argument

---
 bin/mfind          |  7 ++-----
 test/mfind.test.js | 12 +++++++++++-
 2 files changed, 13 insertions(+), 6 deletions(-)

diff --git a/bin/mfind b/bin/mfind
index 820582b..6d27942 100755
--- a/bin/mfind
+++ b/bin/mfind
@@ -104,11 +104,7 @@ function parseCmdOptions(opts, parser) {
         opts.name = new RegExp(opts.name);
     }
 
-    if (!opts._args.length) {
-        opts.paths = ['/' + opts.account + '/stor'];
-    } else {
-        opts.paths = opts._args;
-    }
+    opts.paths = opts._args;
 
     return (opts);
 }
@@ -156,6 +152,7 @@ function printEntry(opts, obj) {
         }
     });
 
+    assert(options.paths.length >= 1, 'no paths specified');
     options.paths.forEach(function (p) {
         barrier.start(p);
         client.ftw(p, options, function (err, res) {
diff --git a/test/mfind.test.js b/test/mfind.test.js
index bc77413..45fbc6d 100644
--- a/test/mfind.test.js
+++ b/test/mfind.test.js
@@ -1,5 +1,5 @@
 /*
- * Copyright 2016 Joyent, Inc.
+ * Copyright 2018 Joyent, Inc.
  */
 
 /*
@@ -111,6 +111,16 @@ test('check if operator (mfind forbidden)', function (t) {
     });
 });
 
+test('mfind (no arguments)', function (t) {
+    forkExecWait({
+        argv: [MFIND]
+    }, function (err, info) {
+        t.ok(err, 'mfind should fail');
+        t.ok(/^path required/m.test(info.stderr), 'path required in stderr');
+        t.done();
+    });
+});
+
 test('mfind TESTDIR', function (t) {
     forkExecWait({
         argv: [MFIND, TESTDIR]
-- 
2.21.0

