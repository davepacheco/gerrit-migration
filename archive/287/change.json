{"project":"joyent/illumos-joyent","branch":"master","id":"I533b6005f11009bfbddd0c485c45a745d6ca290f","number":"287","subject":"OS-5583 lxbrand convert lseek to IKE Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Approved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/287","commitMessage":"OS-5583 lxbrand convert lseek to IKE\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nApproved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\n","createdOn":1471041706,"lastUpdated":1471636911,"open":false,"status":"MERGED","comments":[{"timestamp":1471041706,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1471266230,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1471269585,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1471270962,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1: Code-Review+1 Integration-Approval+1"},{"timestamp":1471634057,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 2: Patch Set 1 was rebased."},{"timestamp":1471636898,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1471636911,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"3","revision":"533b6005f11009bfbddd0c485c45a745d6ca290f","parents":["926f7c1c9f70982389660a5240eabff26fec931b"],"ref":"refs/changes/87/287/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1471636898,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1471636911,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/lx/lx_brand/common/file.c","type":"MODIFIED","insertions":0,"deletions":-57},{"file":"usr/src/lib/brand/lx/lx_brand/common/lx_brand.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/sys/lx_syscall.h","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/os/lx_syscall.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/sys/lx_syscalls.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":91,"sizeDeletions":-65},"patchSets":[{"number":"1","revision":"966568b574fc9662a54a7ef8f94358869398a18a","parents":["333026562aa4d5d93c8d84f6f6301ffeb83d8e06"],"ref":"refs/changes/87/287/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1471041706,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"comments":[{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":35,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"The old user-land code did some extra validation on the whence argument since illumos accepts input that is an error on Linux. Is there a reason you dropped that check? Same comment applies to the other calls below."},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":35,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I verified that the possible values for WHENCE in Linux all mapped to ones which are valid on illumos.  SEEK_DATA and SEEK_HOLE are the two which we\u0027ll additionally support via LX."},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":55,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I don\u0027t understand what you mean by \"bound to the 64-bit boundary\"."},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":55,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"What I meant: llseek32 allows the seek operation to succeed even when the ending f_offset value exceeds OFF32_MAX"},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":60,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Does llseek32 actually return overflow here since you are passing 0 for the high word?"},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","line":60,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"It could if a large relative seek was performed on an FD which was already positioned at a high offset."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/lx/lx_brand/common/file.c","type":"MODIFIED","insertions":0,"deletions":-57},{"file":"usr/src/lib/brand/lx/lx_brand/common/lx_brand.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/sys/lx_syscall.h","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/os/lx_syscall.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/sys/lx_syscalls.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":91,"sizeDeletions":-65},{"number":"2","revision":"ae3671942a2e15895bfc336a50588df293bdee5a","parents":["926f7c1c9f70982389660a5240eabff26fec931b"],"ref":"refs/changes/87/287/2","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1471634057,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/lib/brand/lx/lx_brand/common/file.c","type":"MODIFIED","insertions":0,"deletions":-57},{"file":"usr/src/lib/brand/lx/lx_brand/common/lx_brand.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/sys/lx_syscall.h","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/os/lx_syscall.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/sys/lx_syscalls.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":91,"sizeDeletions":-65},{"number":"3","revision":"533b6005f11009bfbddd0c485c45a745d6ca290f","parents":["926f7c1c9f70982389660a5240eabff26fec931b"],"ref":"refs/changes/87/287/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1471636898,"author":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1471270962,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1471636911,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/lx/lx_brand/common/file.c","type":"MODIFIED","insertions":0,"deletions":-57},{"file":"usr/src/lib/brand/lx/lx_brand/common/lx_brand.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/lib/brand/lx/lx_brand/sys/lx_syscall.h","type":"MODIFIED","insertions":0,"deletions":-2},{"file":"usr/src/uts/common/brand/lx/os/lx_syscall.c","type":"MODIFIED","insertions":3,"deletions":-3},{"file":"usr/src/uts/common/brand/lx/sys/lx_syscalls.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/common/brand/lx/syscall/lx_lseek.c","type":"ADDED","insertions":81,"deletions":0},{"file":"usr/src/uts/intel/Makefile.files","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":91,"sizeDeletions":-65}],"allReviewers":[{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}