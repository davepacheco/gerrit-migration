{"project":"joyent/sdc-headnode","branch":"master","id":"Iac8b852e77915f667457754f647cabce67b1ad2e","number":"6639","subject":"TRITON-1828 drop firmware-tools and \"headnode-joyent\" flavour headnode build Reviewed by: Tim Foster \u003ctim.foster@joyent.com\u003e Reviewed by: John Levon \u003cjohn.levon@joyent.com\u003e Approved by: Tim Foster \u003ctim.foster@joyent.com\u003e","owner":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"url":"https://cr.joyent.us/6639","commitMessage":"TRITON-1828 drop firmware-tools and \"headnode-joyent\" flavour headnode build\nReviewed by: Tim Foster \u003ctim.foster@joyent.com\u003e\nReviewed by: John Levon \u003cjohn.levon@joyent.com\u003e\nApproved by: Tim Foster \u003ctim.foster@joyent.com\u003e\n","createdOn":1563909574,"lastUpdated":1564155547,"open":false,"status":"MERGED","comments":[{"timestamp":1563909574,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 1."},{"timestamp":1563909575,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 8d0651af2fa1f7a19a20682fb2d089c2695344db\n    \n    do it"},{"timestamp":1563909678,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1563961569,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 1:\n\n(7 comments)\n\nThis looks good. Just a few documentation nits, and an opportunity to clean up some remaining MG references while we\u0027re here. If you\u0027d prefer me to file a new bug for that, I\u0027m happy to do so.\n\nI had one question in bin/reflash that seems a bit weird."},{"timestamp":1563967670,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1563969611,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(5 comments)"},{"timestamp":1564077144,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(1 comment)\n\nI\u0027d prefer to do the other clean up changes (MG and removing that unused \"plat_suf\" var) to a separate commit to keep this one a clearer diff. I can open that separately."},{"timestamp":1564077153,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 2."},{"timestamp":1564077154,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit a292fba2820bb9e4a6af8781c1a4dfece6c09815\n    \n    review feedback"},{"timestamp":1564077215,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\nTRITON-1839 added for the MG cruft."},{"timestamp":1564077256,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1564077257,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 3."},{"timestamp":1564077258,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit c157b70c190197b1c175092724000784a7a7c08e\n    \n    review feedback"},{"timestamp":1564077356,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1564133694,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1564140596,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1564150354,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1564155382,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1564155446,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5: Patch Set 4 was rebased"},{"timestamp":1564155449,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Trent Mick"},{"timestamp":1564155547,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"5","revision":"6b0610e2af43b0ddf89f6d559c3128ff046d66bd","parents":["8357d3662047df0005f1648c152c8433b56d3d51"],"ref":"refs/changes/39/6639/5","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1564155446,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1564077356,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564133694,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564140596,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1564150354,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"SUBM","value":"1","grantedOn":1564155449,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":8,"deletions":-26},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":35,"sizeDeletions":-106},"patchSets":[{"number":"1","revision":"b48cbe93c207315faa5991cea05d835f5d02e24b","parents":["574c7dc388c521d310519f81b14c3f73c49c93f9"],"ref":"refs/changes/39/6639/1","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1563909574,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1563909678,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"Makefile","line":16,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"I\u0027d modify this comment to say something like:\n\n---\nThe headnode build has the following variants, declared by the $(HEADNODE_VARIANT) macro:  \n\n\u0027debug\u0027       use a debug platform image\n\nNote, only a single variant is supported at the moment, but we intentionally separate $(DEBUG_BUILD) from $(HEADNODE_VARIANT) to allow future variants to also produce debug build flavours.\n---\n\nhmm.. reading that back, it sounds pretty clunky, perhaps you can come up with better wording?"},{"file":"Makefile","line":16,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"How about:\n\n```\nWe build with non-debug platform bits, unless HEADNODE_VARIANT is set to \u0027debug\u0027\n```\n\nI don\u0027t think we need to go further into detail of DEBUG_BUILD, at least if/until it becomes directly relevant again."},{"file":"README.md","line":133,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"If we are cleaning up MG, here\u0027s another set."},{"file":"README.md","line":192,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"While we\u0027re here, could we reword this stale MG reference as:\n\n---\nIf `\"bits-dir\"` is used, either through `\"source\"` for a specific zone for via the `\"override-all-sources\"` top-level key, the `SOURCE_BITS_DIR` environment variable must contain the path of a Triton release engineering bits directory. See the [Triton release engineering documentation](https://github.com/joyent/triton/blob/master/docs/developer-guide/release-engineering.md#bits-directory-structure) for details. Note that this is expected to be a filesystem directory path, not a Manta path.\n---\n\nI\u0027m not sure whether that last sentence is superfluous given the first two sentences leading up to this section, we might be able to drop it."},{"file":"README.md","line":201,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"ditto"},{"file":"README.md","line":228,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"I\u0027d drop this, and just say\n\n---\nThese files are generally also the output of Manta or Triton component builds and are obtained either from Manta (by default) or a directory pointed to by `SOURCE_BITS_DIR`.\n---"},{"file":"README.md","line":250,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Sorry, more clean-up:\n\n---\nNote that `\"jobname\"` is used during the download to name the component because it is different from the short name of the file artefact itself, `\"agents\"`.\n---"},{"file":"README.md","line":273,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"maybe \"/mymantauser/stor/builds\" is now a more useful example."},{"file":"README.md","line":298,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"More MG cleanup. Perhaps something like:\n\n---\nThese build artefacts include the branch name in their file and directory names.\n---"},{"file":"README.md","line":499,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Time to remove this too."},{"file":"bin/build-tar-image","line":222,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"optional \"while you\u0027re here\": this is not used"},{"file":"bin/reflash","line":369,"reviewer":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},"message":"Where does \u0027get_build_spec_var\u0027 come from, and how come we use this here rather than \u0027build_spec\u0027, which we have everywhere else?"},{"file":"bin/reflash","line":369,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Looks like this needs updating for your commit 1e0a1e095f9ba8c2376502f169fe2fcac4ca3686"},{"file":"bin/reflash","line":369,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Ah... this \"reflash\" diverged from the copy in globe-theatre.git in that commit. Thanks."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":6,"deletions":-23},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":33,"sizeDeletions":-103},{"number":"2","revision":"8749291dae4536e44a137234e8db172874603bbb","parents":["574c7dc388c521d310519f81b14c3f73c49c93f9"],"ref":"refs/changes/39/6639/2","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1564077153,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1564077256,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":8,"deletions":-26},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":35,"sizeDeletions":-106},{"number":"3","revision":"97ea4f2b05ebb066edde98ce6e685026eed9a033","parents":["574c7dc388c521d310519f81b14c3f73c49c93f9"],"ref":"refs/changes/39/6639/3","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1564077257,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1564077356,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564140596,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564133694,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1564150354,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":8,"deletions":-26},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":35,"sizeDeletions":-106},{"number":"4","revision":"ac8b852e77915f667457754f647cabce67b1ad2e","parents":["574c7dc388c521d310519f81b14c3f73c49c93f9"],"ref":"refs/changes/39/6639/4","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1564155382,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1564077356,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564140596,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564133694,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1564150354,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":8,"deletions":-26},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":35,"sizeDeletions":-106},{"number":"5","revision":"6b0610e2af43b0ddf89f6d559c3128ff046d66bd","parents":["8357d3662047df0005f1648c152c8433b56d3d51"],"ref":"refs/changes/39/6639/5","uploader":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"createdOn":1564155446,"author":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1564077356,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1564155449,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564140596,"by":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1564133694,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1564150354,"by":{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":8,"deletions":-26},{"file":"README.md","type":"MODIFIED","insertions":21,"deletions":-23},{"file":"bin/build-tar-image","type":"MODIFIED","insertions":1,"deletions":-22},{"file":"bin/reflash","type":"MODIFIED","insertions":4,"deletions":-19},{"file":"build.spec","type":"MODIFIED","insertions":0,"deletions":-13},{"file":"buildtools/novus/cmd/checker.js","type":"MODIFIED","insertions":1,"deletions":-3}],"sizeInsertions":35,"sizeDeletions":-106}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Tim Foster","email":"tim.foster@joyent.com","username":"timfoster"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}]}