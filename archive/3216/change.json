{"project":"joyent/sdc-scripts","branch":"master","id":"I131d8cebad66c219f36a63e47d21d7840c478ed7","number":"3216","subject":"TOOLS-1974 sdc-scripts refactor sdc_common_setup Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/3216","commitMessage":"TOOLS-1974 sdc-scripts refactor sdc_common_setup\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1516034604,"lastUpdated":1516130318,"open":false,"status":"MERGED","comments":[{"timestamp":1516034604,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1516034610,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit f23cb760fd0f1d5b8a38cb0ca987bffef9f380bd\n    \n    TOOLS-1974 sdc-scripts update sdc_common_setup to allow creation of additional sapi instances"},{"timestamp":1516034690,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nTrent, mind to take a look so I can update SAPI-294 to use the new sdc-scripts commit?"},{"timestamp":1516046208,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1516109815,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1516109821,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 7d8e30611c9095ba027eba3950a1e1b8c0b1502e\n    \n    TOOLS-1974 sdc-scripts update sdc_common_setup to allow creation of additional sapi instances"},{"timestamp":1516109845,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\n(2 comments)\n\nSorry, I forgot to removed that check before I put the code into the sdc-scripts function. Removed now."},{"timestamp":1516126792,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\nDiscussed in chat... this patch might be unnecessary. Pedro is going to test again."},{"timestamp":1516129476,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1516129481,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit fde71562d094ac003f9cc94270b73c0451eac4b4\n    \n    TOOLS-1974 sdc-scripts update sdc_common_setup to allow creation of additional sapi instances"},{"timestamp":1516129688,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4: Commit message was updated."},{"timestamp":1516129900,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1516130017,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 5."},{"timestamp":1516130023,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit 191def5e92e3f64e20e7ebe8a6fc02f4ee3d2796\n    \n    TOOLS-1974 sdc-scripts update sdc_common_setup to allow creation of additional sapi instances"},{"timestamp":1516130034,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\n(1 comment)\n\nSure we can"},{"timestamp":1516130116,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1516130306,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 6: Commit message was updated."},{"timestamp":1516130318,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"6","revision":"131d8cebad66c219f36a63e47d21d7840c478ed7","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516130306,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1516130318,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-14}],"sizeInsertions":11,"sizeDeletions":-14},"patchSets":[{"number":"1","revision":"3bf45c97c69119ada8ce93df8336f0ea31ffc578","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516034604,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","comments":[{"file":"lib/util.sh","line":702,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: indentation"},{"file":"lib/util.sh","line":702,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/util.sh","line":705,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Q1: Sorry if I am missing something obvious. I don\u0027t understand why we want to run setup_config_agent and the others only if `svcs ... config-agent` fails?\n\n\nQ2: nit: Using non-zero exit value and testing for that will get in the way of possibly using `set -o errexit` in sdc-sapi.git:boot/setup.sh in the future, right?"},{"file":"lib/util.sh","line":705,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"My bad, added this check before I moved the code within the function (due to something else) and forgot to remove. Forget about it now, removed."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":13,"deletions":-3}],"sizeInsertions":13,"sizeDeletions":-3},{"number":"2","revision":"9a9da0f732005c2f954678aa8ab52241cd3e7cb4","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516109815,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-4}],"sizeInsertions":11,"sizeDeletions":-4},{"number":"3","revision":"881a86befe229d670749dd13b0f6878793524648","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516129476,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-14}],"sizeInsertions":11,"sizeDeletions":-14},{"number":"4","revision":"d463aec174a6e98982729051e20281113df87d90","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516129688,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","comments":[{"file":"lib/util.sh","line":704,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Can we append: `\u003e\u00262` here?"},{"file":"lib/util.sh","line":704,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-14}],"sizeInsertions":11,"sizeDeletions":-14},{"number":"5","revision":"5647084396815eed78b57f51ffacc7098e822c87","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516130017,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-14}],"sizeInsertions":11,"sizeDeletions":-14},{"number":"6","revision":"131d8cebad66c219f36a63e47d21d7840c478ed7","parents":["d01c308f63ec6044092b40973e51a9afe110a8dd"],"ref":"refs/changes/16/3216/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1516130306,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1516130116,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1516130318,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/util.sh","type":"MODIFIED","insertions":11,"deletions":-14}],"sizeInsertions":11,"sizeDeletions":-14}],"allReviewers":[{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}