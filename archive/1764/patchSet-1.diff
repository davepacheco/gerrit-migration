From 822cbcacc6839af73a842cda363979a33e40343a Mon Sep 17 00:00:00 2001
From: Orlando Vazquez <ovazquez@gmail.com>
Date: Fri, 7 Apr 2017 03:01:30 -0700
Subject: [PATCH] CNAPI-704 Current nodeunit version doesn't emit "# tests"
 details, test/runtests script shoudn't try to use it

---
 package.json  |  2 +-
 test/runtests | 29 +----------------------------
 2 files changed, 2 insertions(+), 29 deletions(-)

diff --git a/package.json b/package.json
index 58be23f..37e6a7d 100644
--- a/package.json
+++ b/package.json
@@ -16,7 +16,7 @@
     "jsprim": "1.3.1",
     "moray": "2.0.1",
     "libuuid": "0.2.1",
-    "nodeunit": "0.10.2",
+    "nodeunit": "0.11.0",
     "once": "1.4.0",
     "restify": "4.3.0",
     "restify-validator": "0.3.1",
diff --git a/test/runtests b/test/runtests
index ff8ffdb..b40513b 100755
--- a/test/runtests
+++ b/test/runtests
@@ -123,31 +123,4 @@ if [[ -n "$opt_test_pattern" ]]; then
     echo "# Running filtered set of test files: $test_files"
 fi
 PATH=${TOP}/build/node/bin node ./node_modules/.bin/nodeunit --reporter ${opt_reporter} \
-    $test_files --output $OUTPUT_DIR
-
-
-
-#---- summary
-
-echo ""
-echo "# test results:"
-
-end_time=$(date +%s)
-elapsed=$((${end_time} - ${start_time}))
-
-#tests=$(grep "^# tests [0-9]" $OUTPUT_DIR/*.xml | cut -d ' ' -f3 | xargs | tr ' ' '+' | bc)
-#passed=$(grep "^# pass  [0-9]" $OUTPUT_DIR/*.xml | tr -s ' ' | cut -d ' ' -f3 | xargs | tr ' ' '+' | bc)
-#[[ -z ${tests} ]] && tests=0
-#[[ -z ${passed} ]] && passed=0
-#fail=$((${tests} - ${passed}))
-
-echo "# Completed in ${elapsed} seconds."
-#echo -e "# \033[32mPASS: ${passed} / ${tests}\033[39m"
-#if [[ ${fail} -gt 0 ]]; then
-#    echo -e "# \033[31mFAIL: ${fail} / ${tests}\033[39m"
-#fi
-echo ""
-
-if [[ ${tests} != ${passed} ]]; then
-    exit 1
-fi
+    $test_files | tee $OUTPUT_DIR/${NAME}.tap
-- 
2.21.0

