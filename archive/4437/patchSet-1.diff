From 2f432304f93b84438af182af675e90066a8ec411 Mon Sep 17 00:00:00 2001
From: Jason King <jason.king@joyent.com>
Date: Tue, 26 Jun 2018 13:32:56 -0500
Subject: [PATCH] fix DEBUG build

---
 usr/src/lib/varpd/svp/common/libvarpd_svp.c           | 1 -
 usr/src/lib/varpd/svp/common/libvarpd_svp_conn.c      | 1 -
 usr/src/lib/varpd/svp/common/libvarpd_svp_shootdown.c | 2 --
 usr/src/uts/common/io/overlay/overlay_target.c        | 5 +++--
 4 files changed, 3 insertions(+), 6 deletions(-)

diff --git a/usr/src/lib/varpd/svp/common/libvarpd_svp.c b/usr/src/lib/varpd/svp/common/libvarpd_svp.c
index 2ad883a15b..3c4c8d3231 100644
--- a/usr/src/lib/varpd/svp/common/libvarpd_svp.c
+++ b/usr/src/lib/varpd/svp/common/libvarpd_svp.c
@@ -445,7 +445,6 @@ svp_vl3_lookup_cb(svp_t *svp, svp_status_t status, const uint8_t *vl2mac,
 	/* Initialize address-holders to 0 for comparisons-to-zeroes later. */
 	overlay_target_point_t point = { 0 };
 	svp_lookup_t *svl = arg;
-	uint8_t nexthop_mac[6] = { 0, 0, 0, 0, 0, 0 };
 
 	assert(svp != NULL);
 	assert(svl != NULL);
diff --git a/usr/src/lib/varpd/svp/common/libvarpd_svp_conn.c b/usr/src/lib/varpd/svp/common/libvarpd_svp_conn.c
index b5fdbf12ef..3655db0ea5 100644
--- a/usr/src/lib/varpd/svp/common/libvarpd_svp_conn.c
+++ b/usr/src/lib/varpd/svp/common/libvarpd_svp_conn.c
@@ -348,7 +348,6 @@ static svp_conn_act_t
 svp_conn_poll_connect(port_event_t *pe, svp_conn_t *scp)
 {
 	int ret;
-	svp_conn_error_t version_error;
 
 	if (pe != NULL) {
 		int err;
diff --git a/usr/src/lib/varpd/svp/common/libvarpd_svp_shootdown.c b/usr/src/lib/varpd/svp/common/libvarpd_svp_shootdown.c
index 43ef7381f6..eacc927b4f 100644
--- a/usr/src/lib/varpd/svp/common/libvarpd_svp_shootdown.c
+++ b/usr/src/lib/varpd/svp/common/libvarpd_svp_shootdown.c
@@ -201,8 +201,6 @@ svp_shootdown_logr_iter(svp_remote_t *srp, void *buf, size_t len,
 	int ret;
 	off_t cboff = 0;
 	uint32_t *typep, type;
-	svp_log_vl2_t *svl2;
-	svp_log_vl3_t *svl3;
 
 	/* Adjust for initial status word */
 	assert(len >= sizeof (uint32_t));
diff --git a/usr/src/uts/common/io/overlay/overlay_target.c b/usr/src/uts/common/io/overlay/overlay_target.c
index b27c72dbe7..98fe2b4e54 100644
--- a/usr/src/uts/common/io/overlay/overlay_target.c
+++ b/usr/src/uts/common/io/overlay/overlay_target.c
@@ -226,7 +226,7 @@ overlay_target_entry_l2sarc_dtor(void *arg)
 	overlay_target_t *ott = ote->ote_ott;
 
 	ASSERT(MUTEX_HELD(&ott->ott_lock));
-	ASSERT3S((ote->ote_flags & OVERLAY_FLAG_F_VL3), ==, 0);
+	ASSERT3S((ote->ote_flags & OVERLAY_ENTRY_F_VL3), ==, 0);
 
 	avl_remove(&ott->ott_u.ott_dyn.ott_tree, ote);
 	overlay_target_entry_dtor(ote);
@@ -239,7 +239,8 @@ overlay_target_entry_l3sarc_dtor(void *arg)
 	overlay_target_t *ott = ote->ote_ott;
 
 	ASSERT(MUTEX_HELD(&ott->ott_lock));
-	ASSERT3S((ote->ote_flags & OVERLAY_FLAG_F_VL3), ==, OVERLAY_FLAG_F_VL3);
+	ASSERT3S((ote->ote_flags & OVERLAY_ENTRY_F_VL3), ==,
+	    OVERLAY_ENTRY_F_VL3);
 
 	avl_remove(&ott->ott_u.ott_dyn.ott_l3tree, ote);
 	overlay_target_entry_dtor(ote);
-- 
2.21.0

