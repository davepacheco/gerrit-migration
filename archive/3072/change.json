{"project":"joyent/sdc-config-agent","branch":"master","id":"I128599628ba9c9adc4cad2b877f430ce4cc518f6","number":"3072","subject":"AGENT-1086 Want to support *_rackN nic_tag suffixes in config-agent AGENT-1090 agent.js modeline conflicts with jsstyle options Reviewed by: Cody Mello \u003ccody.mello@joyent.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"url":"https://cr.joyent.us/3072","commitMessage":"AGENT-1086 Want to support *_rackN nic_tag suffixes in config-agent\nAGENT-1090 agent.js modeline conflicts with jsstyle options\nReviewed by: Cody Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1512759788,"lastUpdated":1513705837,"open":false,"status":"MERGED","comments":[{"timestamp":1512759788,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 1."},{"timestamp":1512761607,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\nThis looks good. Can you put some notes on how this was tested in the JIRA ticket?"},{"timestamp":1512763091,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1512769854,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513636073,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1513638959,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 2."},{"timestamp":1513638984,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513639231,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1513639316,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1513639324,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Patch Set 3:\n\n(4 comments)\n\nmade changes"},{"timestamp":1513697966,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 4."},{"timestamp":1513698026,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1513698254,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4:\n\nRui,\n\nThe ticket says \u0027-\u0027 (hyphen), but the code say \u0027_\u0027 (underscore)."},{"timestamp":1513699373,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Patch Set 4:\n\nI\u0027ve updated the ticket description.  napi doesn\u0027t like nictags with \u0027-\u0027s \n\n[root@headnode (Ruidc) ~]# sdc-napi /nic_tags -X POST -d \u0027{\"name\": \"manta-rack22\"}\u0027\nHTTP/1.1 422 Unprocessable Entity\nContent-Type: application/json\nContent-Length: 176\nDate: Tue, 19 Dec 2017 15:32:09 GMT\nServer: SmartDataCenter Networking API\nx-request-id: 481a06c6-3c37-4b87-abc3-50cb378823e6\nx-response-time: 4\nx-server-name: 8cc6d0db-6a7f-4c07-beb2-17282bdea9f5\nConnection: keep-alive\n\n{\n  \"code\": \"InvalidParameters\",\n  \"message\": \"Invalid parameters\",\n  \"errors\": [\n    {\n      \"field\": \"name\",\n      \"code\": \"InvalidParameter\",\n      \"message\": \"must only contain numbers, letters and underscores\"\n    }\n  ]\n}"},{"timestamp":1513702975,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1513703084,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1513703289,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 6: Patch Set 5 was rebased."},{"timestamp":1513703314,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6:\n\n\"make check\" passed ok"},{"timestamp":1513703370,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 7: Patch Set 6 was rebased."},{"timestamp":1513703394,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7:\n\n\"make check\" passed ok"},{"timestamp":1513703663,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"Uploaded patch set 8: Commit message was updated."},{"timestamp":1513705837,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Rui"}],"currentPatchSet":{"number":"8","revision":"128599628ba9c9adc4cad2b877f430ce4cc518f6","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/8","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513703663,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1513705837,"by":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"b48bd2935205ec61eef79346dfdadddd57a8978a","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/1","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1512759788,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512763091,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512769854,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"agent.js","line":157,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"nit: Perhaps use `\u003cname\u003e_RACK\u003cnum\u003e` instead of `XXX_RACK##`? I\u0027m trying to avoid \"XXX\" in commited code as that is used by some eslint rules as a warning for incomplete code."},{"file":"agent.js","line":161,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Do we need both \u0027-\u0027 and \u0027_\u0027? If not (I assume manta only proposes to use one or the other) it would be better to only support one. We can add features later, but it is harder to remove features."},{"file":"agent.js","line":165,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Can we bump the minor version in package.json and add a CHANGES.md entry?"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":11,"sizeDeletions":-1},{"number":"2","revision":"8d49193a53b01dd058d1e64ef2768123ee233c97","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/2","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513638959,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513638984,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"CHANGES.md","line":8,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"added"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"3","revision":"e6405632aafaa732f337c2102679dbd36a750878","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/3","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513639231,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513638984,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513639316,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513639316,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"agent.js","line":157,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"changed to \u0027-\u0027 only"},{"file":"agent.js","line":161,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"changed to \u0027-\u0027 only"},{"file":"agent.js","line":162,"reviewer":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"message":"changed to \u0027-\u0027 only"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"4","revision":"f38940b356409bbb5f59e9168311762e3e7d0be3","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/4","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513697966,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"5","revision":"108fa13d5f980867b1c9de8d3bf864f1f671eb2b","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/5","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513702975,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"6","revision":"82f34f69a3d5a14d4430ef482fea21ffefa07ec5","parents":["63e3751dc98a198d4dd6aa2e1570caa1d578318f"],"ref":"refs/changes/72/3072/6","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513703289,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"7","revision":"cec831b1b26047e51bfb7a906d96ea826c8360ab","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/7","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513703370,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1},{"number":"8","revision":"128599628ba9c9adc4cad2b877f430ce4cc518f6","parents":["89c93cceda8e8eead9871f1def1585e986ae57bb"],"ref":"refs/changes/72/3072/8","uploader":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"createdOn":1513703663,"author":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1513698026,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1513703084,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1513705837,"by":{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":6,"deletions":0},{"file":"Makefile","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"agent.js","type":"MODIFIED","insertions":10,"deletions":0}],"sizeInsertions":17,"sizeDeletions":-1}],"allReviewers":[{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Rui Loura","email":"rui@joyent.com","username":"rjloura"}]}