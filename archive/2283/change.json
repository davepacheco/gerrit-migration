{"project":"joyent/illumos-joyent","branch":"master","id":"Iad734d51547cf4bbcdc0baaef0bf8e9297afabb4","number":"2283","subject":"OS-6254 pfiles does not properly identify PF_KEY or PF_POLICY Reviewed by: Mike Zeller \u003cmike.zeller@joyent.com\u003e Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: Robert Mustacchi \u003crm@joyent.com\u003e","owner":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"url":"https://cr.joyent.us/2283","commitMessage":"OS-6254 pfiles does not properly identify PF_KEY or PF_POLICY\nReviewed by: Mike Zeller \u003cmike.zeller@joyent.com\u003e\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: Robert Mustacchi \u003crm@joyent.com\u003e\n","createdOn":1501083872,"lastUpdated":1501097056,"open":false,"status":"MERGED","comments":[{"timestamp":1501083872,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Uploaded patch set 1."},{"timestamp":1501084318,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Uploaded patch set 2."},{"timestamp":1501085976,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1501089335,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1501091423,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Uploaded patch set 3."},{"timestamp":1501091652,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1501092419,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1501092950,"reviewer":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1501093510,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 3:\n\nTested by:\n\n1.) \"pfiles `pgrep iked`\" on a system running IKE.\n\n2.) pfiles on an ipsecconf(1M) process suspended using truss at its first PF_POLICY write.  \"truss -Twrite ipsecconf -qF\""},{"timestamp":1501096006,"reviewer":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},"message":"Patch Set 3: Integration-Approval+1"},{"timestamp":1501096456,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1501097056,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dan McDonald"}],"currentPatchSet":{"number":"4","revision":"ad734d51547cf4bbcdc0baaef0bf8e9297afabb4","parents":["2cef0f4f832be76da8fd4a96be43201caaa88ed1"],"ref":"refs/changes/83/2283/4","uploader":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"createdOn":1501096456,"author":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092419,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092950,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1501096006,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"SUBM","value":"1","grantedOn":1501097056,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/ptools/pfiles/pfiles.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/inet/ip/keysock.c","type":"MODIFIED","insertions":91,"deletions":0},{"file":"usr/src/uts/common/inet/ip/spdsock.c","type":"MODIFIED","insertions":15,"deletions":0},{"file":"usr/src/uts/common/inet/ipsec_impl.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/sparc/ml/modstubs.s","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":119,"sizeDeletions":-5},"patchSets":[{"number":"1","revision":"e6579f449f0122d1b968d1b1ceb6ccc420c495a0","parents":["2cef0f4f832be76da8fd4a96be43201caaa88ed1"],"ref":"refs/changes/83/2283/1","uploader":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"createdOn":1501083872,"author":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/inet/ip/keysock.c","line":904,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Make this const?"},{"file":"usr/src/uts/common/inet/ip/keysock.c","line":904,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Good idea!"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/ptools/pfiles/pfiles.c","type":"MODIFIED","insertions":2,"deletions":0},{"file":"usr/src/uts/common/inet/ip/keysock.c","type":"MODIFIED","insertions":88,"deletions":0},{"file":"usr/src/uts/common/inet/ip/spdsock.c","type":"MODIFIED","insertions":14,"deletions":0},{"file":"usr/src/uts/common/inet/ipsec_impl.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/uts/sparc/ml/modstubs.s","type":"MODIFIED","insertions":1,"deletions":0}],"sizeInsertions":109,"sizeDeletions":0},{"number":"2","revision":"352931f9fe70a80f93221fb30886335690ce3fa6","parents":["2cef0f4f832be76da8fd4a96be43201caaa88ed1"],"ref":"refs/changes/83/2283/2","uploader":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"createdOn":1501084318,"author":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501085976,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"comments":[{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","line":536,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Nix the trailing table while we\u0027re here?"},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","line":536,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Yes, multiple places too.  Fixed."},{"file":"usr/src/uts/sparc/ml/modstubs.s","line":25,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"nit: Is it convention to reorder the copyright lines?"},{"file":"usr/src/uts/sparc/ml/modstubs.s","line":25,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"I prefer most-recent at the bottom.  The whole chronlological thing.  I thought upstream liked this too."},{"file":"usr/src/uts/sparc/ml/modstubs.s","line":25,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"I\u0027ve always updated in place.  I don\u0027t care either way, just that we establish a standard."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/ptools/pfiles/pfiles.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/inet/ip/keysock.c","type":"MODIFIED","insertions":91,"deletions":0},{"file":"usr/src/uts/common/inet/ip/spdsock.c","type":"MODIFIED","insertions":15,"deletions":0},{"file":"usr/src/uts/common/inet/ipsec_impl.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/uts/sparc/ml/modstubs.s","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":117,"sizeDeletions":-3},{"number":"3","revision":"0cf93ac1065e99c63418239788d004736d86ed3d","parents":["2cef0f4f832be76da8fd4a96be43201caaa88ed1"],"ref":"refs/changes/83/2283/3","uploader":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"createdOn":1501091423,"author":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1501096006,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092419,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092950,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/cmd/ptools/pfiles/pfiles.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/inet/ip/keysock.c","type":"MODIFIED","insertions":91,"deletions":0},{"file":"usr/src/uts/common/inet/ip/spdsock.c","type":"MODIFIED","insertions":15,"deletions":0},{"file":"usr/src/uts/common/inet/ipsec_impl.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/sparc/ml/modstubs.s","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":119,"sizeDeletions":-5},{"number":"4","revision":"ad734d51547cf4bbcdc0baaef0bf8e9297afabb4","parents":["2cef0f4f832be76da8fd4a96be43201caaa88ed1"],"ref":"refs/changes/83/2283/4","uploader":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"createdOn":1501096456,"author":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1501096006,"by":{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092419,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1501092950,"by":{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"}},{"type":"SUBM","value":"1","grantedOn":1501097056,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"usr/src/cmd/ptools/pfiles/pfiles.c","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"usr/src/uts/common/inet/ip/keysock.c","type":"MODIFIED","insertions":91,"deletions":0},{"file":"usr/src/uts/common/inet/ip/spdsock.c","type":"MODIFIED","insertions":15,"deletions":0},{"file":"usr/src/uts/common/inet/ipsec_impl.h","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/uts/intel/ia32/ml/modstubs.s","type":"MODIFIED","insertions":4,"deletions":-3},{"file":"usr/src/uts/sparc/ml/modstubs.s","type":"MODIFIED","insertions":2,"deletions":-1}],"sizeInsertions":119,"sizeDeletions":-5}],"allReviewers":[{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},{"name":"Robert Mustacchi","email":"rm+illumos@fingolfin.org","username":"rmustacc"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Michael Zeller","email":"mike.zeller@joyent.com","username":"papertigers"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}]}