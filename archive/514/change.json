{"project":"joyent/moray","branch":"master","id":"I8fcb08877f43a79aae16b79536f10c568166aaa2","number":"514","subject":"MORAY-359 Moray doesn\u0027t handle queries that contain escaped backslashes properly Reviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e Approved by: David Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"url":"https://cr.joyent.us/514","commitMessage":"MORAY-359 Moray doesn\u0027t handle queries that contain escaped backslashes properly\nReviewed by: Patrick Mooney \u003cpatrick.mooney@joyent.com\u003e\nApproved by: David Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1474481472,"lastUpdated":1474510861,"open":false,"status":"MERGED","comments":[{"timestamp":1474481472,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Uploaded patch set 1."},{"timestamp":1474481511,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1474481817,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 1: Code-Review+1"},{"timestamp":1474501312,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1: Code-Review+1\n\nIt looks like there are no breaking changes in node-ldap-filter through 0.2.4, but I can\u0027t tell for sure.  Did you check that?\n\nWas this particular issue a known bug fixed in the newer ldap-filter, or did that just happen to fix it?"},{"timestamp":1474501363,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\nAlso: how did ldap-filter parse it incorrectly before?  (I\u0027m wondering if it\u0027s possible for this change to break any programs that are working by accident.)"},{"timestamp":1474503504,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n@dap There was only a change in .matches() behaviour when the filter is \u0027(\u0026)\u0027, but that was it. I made a fix for ldap-filter to handle this case, and Patrick reviewed it and released 0.2.4 with it.\n\nPreviously, Moray was interpreting queries like:\n\n(|(fromtagkeys\u003d\\\\\\\\)(totagkeys\u003d\\\\\\\\))\n\nAs a search of fromtagkeys for the value \"\\\\)(totagkeys\u003d\\\\\". I took a look for JavaScript files that contained the sequence \"\\\\)\", and didn\u0027t find anything relevant. If anyone\u0027s affected by this, I imagine that it\u0027s by feeding input to an API with a \u0027\\\u0027 or two at the end."},{"timestamp":1474503631,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\nTo be clearer: there were other changes between 0.2.0 and 0.2.3, but they were of the code cleanup/better assertions variety."},{"timestamp":1474505408,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1:\n\nHaving done a little testing with my dev manta: it appears that objects with trailing \u0027\\\u0027 characters work fine, but directories with trailing \u0027\\\u0027 characters cannot be listed (listing them produces no results, though the result-size header indicates that there are objects there).  Other operations (inserting objects into that directory and even fetching them out) work.\n\nIt seems like this is already broken for Manta, and this change should fix it."},{"timestamp":1474510791,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 1: Integration-Approval+1"},{"timestamp":1474510831,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 2: Commit message was updated."},{"timestamp":1474510861,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Cody Peter Mello"}],"currentPatchSet":{"number":"2","revision":"061fcfb46bf354a818f10db1bb0e2f02042dfe8a","parents":["47d94a5db982dc9bc3f4ae213d263fcca480b2c4"],"ref":"refs/changes/14/514/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1474510831,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474481511,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474481817,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474501312,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1474510791,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1474510861,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"8fcb08877f43a79aae16b79536f10c568166aaa2","parents":["47d94a5db982dc9bc3f4ae213d263fcca480b2c4"],"ref":"refs/changes/14/514/1","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1474481472,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474501312,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1474510791,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474481511,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474481817,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1},{"number":"2","revision":"061fcfb46bf354a818f10db1bb0e2f02042dfe8a","parents":["47d94a5db982dc9bc3f4ae213d263fcca480b2c4"],"ref":"refs/changes/14/514/2","uploader":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"createdOn":1474510831,"author":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474501312,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1474510791,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1474510861,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1474481511,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1474481817,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":1,"sizeDeletions":-1}],"allReviewers":[{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}]}