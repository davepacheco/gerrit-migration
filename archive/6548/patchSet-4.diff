commit 07cfb885e779efe5444b802b675c27f72607e0fa
Author: Orlando Vazquez <ovazquez@gmail.com>
Date:   2019-07-16T17:21:32+00:00 (3 months ago)
    
    OS-7666 vminfod times out while starting with thousands of snapshots

diff --git a/src/vm/node_modules/vmload/vmload-datasets.js b/src/vm/node_modules/vmload/vmload-datasets.js
index 05505eeb..cfe6b320 100644
--- a/src/vm/node_modules/vmload/vmload-datasets.js
+++ b/src/vm/node_modules/vmload/vmload-datasets.js
@@ -298,13 +298,14 @@ function getDatasets(obj, options, callback)
     if (obj.zonepath) {
         assert.strictEqual(obj.zonepath[0], '/');
         parents.push(obj.zonepath.slice(1));
-
+        _options.depth = 1;
     } else {
         /*
          * If we don't have one we're listing all VMs and need to fetch
          * everything anyway.
          */
         listEverything = true;
+        _options.depth = 2;
     }
 
     if (obj.datasets) {
