{"project":"joyent/node-cueball","branch":"master","id":"Ia4561daca65c2b3e9ed65a0f15d92f29054f9927","number":"2307","subject":"joyent/node-cueball#116 timeout on SRV should avoid triggering fallback to A/AAAA joyent/node-cueball#115 handle REFUSED responses as name not known Reviewed by: David Pacheco \u003cdap@joyent.com\u003e Reviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e Approved","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/2307","commitMessage":"joyent/node-cueball#116 timeout on SRV should avoid triggering fallback to A/AAAA\njoyent/node-cueball#115 handle REFUSED responses as name not known\nReviewed by: David Pacheco \u003cdap@joyent.com\u003e\nReviewed by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\nApproved by: Cody Peter Mello \u003ccody.mello@joyent.com\u003e\n","createdOn":1501537973,"lastUpdated":1512159410,"open":false,"status":"MERGED","comments":[{"timestamp":1501537973,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1501538044,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1501806143,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2: Patch Set 1 was rebased"},{"timestamp":1501806209,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2:\n\n\"make check\" passed ok"},{"timestamp":1502380502,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1502410989,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 3."},{"timestamp":1502410992,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1502411065,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504044968,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1504640118,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1504640130,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1504640188,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1504643917,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4: Code-Review+1\n\nThanks!"},{"timestamp":1512077665,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 5."},{"timestamp":1512077714,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1512089455,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 6."},{"timestamp":1512089503,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1512149316,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Code-Review+1"},{"timestamp":1512151482,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1512159348,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 7: Commit message was updated."},{"timestamp":1512159358,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 8: Patch Set 7 was rebased"},{"timestamp":1512159386,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"},{"timestamp":1512159410,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8:\n\n\"make check\" passed ok"}],"currentPatchSet":{"number":"8","revision":"b495369a9b0505ecade444018e0903d61702b4f9","parents":["8574f7bd18bc27548cda625829dc5fe35c9f4acb"],"ref":"refs/changes/07/2307/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1512159358,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512089503,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512149316,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151482,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1512159386,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":126,"sizeDeletions":-15},"patchSets":[{"number":"1","revision":"499056915afe4b6b4a192087fee4c09e2adaff13","parents":["2d796ab60cbe60b4cb0fecf4e2c6714571a9c121"],"ref":"refs/changes/07/2307/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1501537973,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1501538044,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":68,"deletions":-15}],"sizeInsertions":68,"sizeDeletions":-15},{"number":"2","revision":"2dc84ef54f3307dc6bc8eae147f5b6ff8fc6489e","parents":["2fdc1dbb5fbca529b44f030b6811517d86425d6c"],"ref":"refs/changes/07/2307/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1501806143,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1501538044,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/resolver.js","line":523,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Should be \"minutes\"?"},{"file":"lib/resolver.js","line":523,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/resolver.js","line":547,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"It looks like \"state_srv_error\" checks self.r_srvRetry.count (at lines 558-559), not self.r_retry.count.  Is that expected?  It seems like this will not prevent us from retrying REFUSED."},{"file":"lib/resolver.js","line":547,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"},{"file":"lib/resolver.js","line":581,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"When do we ever fall back to AAAA/A records after this change?"},{"file":"lib/resolver.js","line":581,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Yes, when we got either a NOTIMP, NXDOMAIN, or NODATA response code from our nameservers."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":68,"deletions":-15}],"sizeInsertions":68,"sizeDeletions":-15},{"number":"3","revision":"b0955a5c121e7e5f6eed27c2402e07018328847f","parents":["2e0129e3078a5de417b0763dbbd2f80c343927c6"],"ref":"refs/changes/07/2307/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1502410989,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504044968,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1502411065,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/resolver.js","line":313,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"It would be really nice to have explanations of what these fields mean."},{"file":"lib/resolver.js","line":313,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":68,"deletions":-15}],"sizeInsertions":68,"sizeDeletions":-15},{"number":"4","revision":"3c004342688abc98ede2eeb97b04cb6e1bc0f0ff","parents":["8be0307c79347f99cef63c26d6b93e423856b88b"],"ref":"refs/changes/07/2307/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1504640118,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1504643917,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1504640188,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":119,"sizeDeletions":-15},{"number":"5","revision":"3149b7349dcc95c7b1399640c42a3d074962e1a8","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/07/2307/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1512077665,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512077714,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":126,"sizeDeletions":-15},{"number":"6","revision":"a4561daca65c2b3e9ed65a0f15d92f29054f9927","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/07/2307/6","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1512089455,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512149316,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151482,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512089503,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":126,"sizeDeletions":-15},{"number":"7","revision":"d7deacf9f2c016084f724cb9b2f8a7d28ebf7488","parents":["52a666d7cb490595c1c13e687bb5802274467163"],"ref":"refs/changes/07/2307/7","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1512159348,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512149316,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151482,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512089503,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":126,"sizeDeletions":-15},{"number":"8","revision":"b495369a9b0505ecade444018e0903d61702b4f9","parents":["8574f7bd18bc27548cda625829dc5fe35c9f4acb"],"ref":"refs/changes/07/2307/8","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1512159358,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1512149316,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1512151482,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"SUBM","value":"1","grantedOn":1512159386,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1512089503,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":11,"deletions":0},{"file":"CHANGES.adoc","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/resolver.js","type":"MODIFIED","insertions":119,"deletions":-15}],"sizeInsertions":126,"sizeDeletions":-15}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}