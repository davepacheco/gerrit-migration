{"project":"joyent/smartos-live","branch":"master","id":"I47c8d48c0ff4e89136990052262d3ef4f34e1e91","number":"5231","subject":"OS-7439 vmadm coredumps when attempting to unset certain zone properties Reviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e Approved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e","owner":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"url":"https://cr.joyent.us/5231","commitMessage":"OS-7439 vmadm coredumps when attempting to unset certain zone properties\nReviewed by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\nApproved by: Mike Gerdts \u003cmike.gerdts@joyent.com\u003e\n","createdOn":1544561919,"lastUpdated":1546017155,"open":false,"status":"MERGED","comments":[{"timestamp":1544561919,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 1."},{"timestamp":1544561923,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 83c68712390cbd4c98ac6c09dcec550d9616dc94\n    \n    initial commit"},{"timestamp":1544561976,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1544624040,"reviewer":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},"message":"Patch Set 1: Code-Review+1\n\nCode looks ok to me, I am not to familier with the testing framework though."},{"timestamp":1545342748,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1545895276,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1545895290,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 2."},{"timestamp":1545895293,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit 8bc82eb74a173f295519d185e8775122c1fdceee\n    \n    review based on mgerdts"},{"timestamp":1545895301,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1545895304,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit b0893dd69066d56d5fc2d136a131a6496f6cb85a\n    \n    review based on mgerdts\n    \n    commit 3a8a9b5200f35530e7b96200c43e57a75ff77d34\n    \n    initial commit"},{"timestamp":1545895341,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545919916,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1545947161,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1545947194,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Patch Set 4:\n\nPatchset 3 was built and tested on COAL - all tests passing!"},{"timestamp":1545948273,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1546017138,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1546017155,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Dave Eddy"}],"currentPatchSet":{"number":"5","revision":"47c8d48c0ff4e89136990052262d3ef4f34e1e91","parents":["dc37bb94858cf303642eaade6f761f5972faad00"],"ref":"refs/changes/31/5231/5","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1546017138,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545895341,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545919916,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545948273,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"SUBM","value":"1","grantedOn":1546017155,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":52,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":96,"sizeDeletions":-29},"patchSets":[{"number":"1","revision":"2d2446bc91ecc5113d7059d37464be9f7c735443","parents":["c7af5452c268ca85c6ee82b7b2ec2761732fbf9f"],"ref":"refs/changes/31/5231/1","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1544561919,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1544561976,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1544624040,"by":{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"}}],"comments":[{"file":"src/vm/node_modules/VM.js","line":6557,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems odd to me to have some strings and some objects.  Is there any reason to not just do this for each one that is currently a string?\n\ncpu_shares: {prop: \u0027cpu-shares\u0027},\n\nThat would allow removal of 6593 - 6596."},{"file":"src/vm/node_modules/VM.js","line":6557,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"ah, that\u0027s way nicer!\n\nFor some reason I thought our `make check` would break on this, but it turns out it\u0027s totally fine."},{"file":"src/vm/node_modules/VM.js","line":6604,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It seems the \"can we skip a bunch of work\" check belongs at the top of the loop.  All of the work above seems to be checking for errors in propertyMap, which is important for test but probably ok if we skip at runtime when there\u0027s no relevant payload."},{"file":"src/vm/node_modules/VM.js","line":6604,"reviewer":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"message":"+1 good catch."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":57,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":101,"sizeDeletions":-29},{"number":"2","revision":"c68ede0f6c858c23375f02e1291d4ad6fd541853","parents":["dc37bb94858cf303642eaade6f761f5972faad00"],"ref":"refs/changes/31/5231/2","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1545895290,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545895341,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":52,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":96,"sizeDeletions":-29},{"number":"3","revision":"0c1401d32c28fdb437b09d95b2e263dd1ae91ab9","parents":["dc37bb94858cf303642eaade6f761f5972faad00"],"ref":"refs/changes/31/5231/3","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1545895301,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545919916,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":52,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":96,"sizeDeletions":-29},{"number":"4","revision":"db382dd48a00d3050fc80794ff21175cf0526f31","parents":["dc37bb94858cf303642eaade6f761f5972faad00"],"ref":"refs/changes/31/5231/4","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1545947161,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545895341,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545919916,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545948273,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":52,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":96,"sizeDeletions":-29},{"number":"5","revision":"47c8d48c0ff4e89136990052262d3ef4f34e1e91","parents":["dc37bb94858cf303642eaade6f761f5972faad00"],"ref":"refs/changes/31/5231/5","uploader":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"createdOn":1546017138,"author":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545895341,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1546017155,"by":{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1545919916,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1545948273,"by":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"src/vm/node_modules/VM.js","type":"MODIFIED","insertions":52,"deletions":-29},{"file":"src/vm/tests/test-update.js","type":"MODIFIED","insertions":44,"deletions":0}],"sizeInsertions":96,"sizeDeletions":-29}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Jorge Schrauwen","email":"sjorge@blackdot.be","username":"sjorge"},{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"Dave Eddy","email":"dave.eddy@joyent.com","username":"bahamas10"}]}