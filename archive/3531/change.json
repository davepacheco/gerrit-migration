{"project":"joyent/illumos-joyent","branch":"master","id":"Ic34f7c2c834dc5a9b871356c0f85214dc25c5881","number":"3531","subject":"OS-6669 create bhyve brand Reviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e Reviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e Approved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e","owner":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"url":"https://cr.joyent.us/3531","commitMessage":"OS-6669 create bhyve brand\nReviewed by: Dan McDonald \u003cdanmcd@joyent.com\u003e\nReviewed by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\nApproved by: Jerry Jelinek \u003cjerry.jelinek@joyent.com\u003e\n","createdOn":1520007796,"lastUpdated":1520027453,"open":false,"status":"MERGED","comments":[{"timestamp":1520007796,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 1."},{"timestamp":1520008802,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1520008932,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\nOne overall question:  Is this brand self-contained enough to upstream w/o too much effort?  There\u0027s no wrong answer, but I\u0027d like to know what your gut feeling is.  I know, e.g., the OmniOSce folks are keeping up here."},{"timestamp":1520010218,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\nNote to reviewers... There is a lot of really gross stuff in the way that the brand abuses attr resources and is intertwined with vmadm.  This is consistent with other brands created by Joyent and is (hopefully) the subject of cleanup work that will allow us to upstream this work."},{"timestamp":1520011284,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Patch Set 1:\n\n(10 comments)"},{"timestamp":1520015585,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 1:\n\n(13 comments)\n\nTo address Dan\u0027s overall question.   As I said in my earlier comment, there is some unfortunate layer violations between SmartOS-specific tools and this brand (and all other brands we use).  That certainly has to be worked out before upstreaming this.  The way that attr resources are abused for core features of the brand is unacceptable, IMHO.  If I were reviewing an illumos change where someone tried to do something similar, I\u0027d vote -1.  I can hold my nose at abusing attr\u0027s in this way for forks (e.g. SmartOS) but not in the main repo."},{"timestamp":1520016328,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1520020012,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Uploaded patch set 2."},{"timestamp":1520020191,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Patch Set 2:\n\n(1 comment)"},{"timestamp":1520020512,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 2: Code-Review+1"},{"timestamp":1520020792,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 3."},{"timestamp":1520021054,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 3: Code-Review+1"},{"timestamp":1520022454,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 4."},{"timestamp":1520023090,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1520025078,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Patch Set 4:\n\nDEBUG build of the updated wad ran clean, as did the creation of a live image (to test the manifest changes)"},{"timestamp":1520026359,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 4: Code-Review+1\n\n(4 comments)\n\nNo showstoppers in here, just two nits and two if-you-have-cycles-for-it comment suggestions."},{"timestamp":1520027408,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1520027436,"reviewer":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1520027453,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Patrick Mooney"}],"currentPatchSet":{"number":"5","revision":"c34f7c2c834dc5a9b871356c0f85214dc25c5881","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1520027436,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520023090,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520026359,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1520027408,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1520027453,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1194,"sizeDeletions":-28},"patchSets":[{"number":"1","revision":"0fa59f1f2ba1ea3ea2f0ce6681a7b1ca38eb37dc","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/1","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1520007796,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","comments":[{"file":"manifest","line":5103,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"This file is not being delivered yet in the manifest from any previous commit. I also am not sure it needs to be in /usr/sbin/amd64 in the first place. I think we should just deliver this as a file in the brand directory."},{"file":"manifest","line":5103,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"The bhyve program can be run standalone.  It should be in /usr/sbin.\n\nThe $ISA directory is another question.  See comments in $SRC/cmd/bhyve/Makefile*."},{"file":"manifest","line":5103,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"I think its ok for us to install bhyve in /usr/sbin for upstreaming, but I pretty strongly disagree that it should be in /usr/sbin on smartos. That doesn\u0027t align at all with how we build the system or intend it to be used. Take qemu as an example from the kvm brand, we don\u0027t deliver that anyplace in the normal path."},{"file":"manifest","line":5103,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"Discussion on MM settled on /usr/sbin/bhyve, but that will be in a later push.  The zhyve link is being removed for now, will appear in the final push that activates all the new bits."},{"file":"manifest","line":5103,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"The ONLY reason I can see this being in usr/sbin is if there are some FreeBSD-derived tools that assume this is in the path.  Otherwise, I\u0027m with Jerry on this."},{"file":"usr/src/cmd/bhyve/Makefile","line":36,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Why are we delivering bhyve as an isaexec file in /usr/sbin? This seems unnecessary."},{"file":"usr/src/cmd/bhyve/Makefile","line":36,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This was done by an earlier change - the pluribus import, I think.  I had planned on changing this with a follow-on bug (OS-6726) once we were merged with EOF of 32-bit kernel via the merge to master.  Then delivering 64-bit executables outside of $ISA directories is no longer controversial."},{"file":"usr/src/cmd/bhyve/Makefile","line":38,"reviewer":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},"message":"Why is bhyve in /usr/sbin/amd64?"},{"file":"usr/src/cmd/bhyve/Makefile","line":38,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"See previous comment."},{"file":"usr/src/cmd/bhyve/smbiostbl.c","line":839,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"any reason this can\u0027t be const char *"},{"file":"usr/src/cmd/bhyve/smbiostbl.c","line":839,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fix"},{"file":"usr/src/cmd/bhyve/smbiostbl.c","line":863,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: strtol() returns long not int"},{"file":"usr/src/cmd/bhyve/smbiostbl.c","line":863,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fix"},{"file":"usr/src/cmd/bhyve/smbiostbl.h","line":27,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"joyent copyright?"},{"file":"usr/src/cmd/bhyve/smbiostbl.h","line":27,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"will fix in next round."},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","line":21,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"nit: you can remove all mention of OBJS, and the build rules, and get the same effect without any temporary .o being built."},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","line":21,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"ok"},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","line":35,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"install should depend on $(PROGS) too"},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"ok"},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","line":8,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"Mike\u0027s docs mentioned com2 defaulted to a com2 socket file. Coming later or no longer true?"},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","line":8,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"This is specific to SmartOS and is handled by VM.js, called from vmadm and/or vmadmd."},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","line":44,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"does something insist this have a value?"},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","line":44,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"No.  Aspirational, I guess.  Clobbering."},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","line":35,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"stale comment and presumably mount too?"},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","line":35,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"No, dlmgmtd in the global zone does whacky crap.\n\n[root@emy-17 /root]# cd /zones/$(vm u1)/root\n[root@emy-17 /zones/1d5b8e7c-c004-4f69-bf0c-c98918e35bd5/root]# find etc/svc/volatile/\netc/svc/volatile/\netc/svc/volatile/dladm\netc/svc/volatile/dladm/dlmgmt_door"},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","line":39,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"OK for now but shouldn\u0027t this really get thinned out later? Every one a potential escape vector..."},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","line":39,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"I\u0027ve opened OS-6728 to track this."},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","line":15,"reviewer":{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},"message":"update year (maybe?)"},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","line":15,"reviewer":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"message":"It is an exact copy of the same file from the kvm brand."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":29,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":10,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":1,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":48,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1197,"sizeDeletions":-28},{"number":"2","revision":"62e94a65c0b11e69e03bfa2fc8fa5aba693f3df5","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/2","uploader":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"createdOn":1520020012,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520020512,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":29,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":3,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1193,"sizeDeletions":-28},{"number":"3","revision":"d3e6c18210c255d1f553742d75705b35be9ee5e5","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/3","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1520020792,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520021054,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":29,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":43,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1195,"sizeDeletions":-28},{"number":"4","revision":"18399a102d1d7dee8de485fc078e8ad98bcb43f3","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/4","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1520022454,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520023090,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1520027408,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520026359,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"comments":[{"file":"usr/src/cmd/bhyve/smbiostbl.c","line":898,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Small comment:\n\n  /* \"buf\" has been consumed amongst the smbios_type1_strings. */"},{"file":"usr/src/cmd/bhyve/zhyve.c","line":16,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"A small theory statement?  Is \"zhyve\" a wrapper to bhyve that allows it to be the primary zone process?"},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","line":99,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"If you don\u0027t need a netstack for this zone, lose all of this, save perhaps dld.  I\u0027m now aware of OS-6728, though.  This is not a blocker."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":29,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1194,"sizeDeletions":-28},{"number":"5","revision":"c34f7c2c834dc5a9b871356c0f85214dc25c5881","parents":["7bb94c96d6b670e5ac129648edfd9d3734953514"],"ref":"refs/changes/31/3531/5","uploader":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"},"createdOn":1520027436,"author":{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520023090,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1520027408,"by":{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"}},{"type":"SUBM","value":"1","grantedOn":1520027453,"by":{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1520026359,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":10,"deletions":0},{"file":"manifest","type":"MODIFIED","insertions":9,"deletions":0},{"file":"usr/src/Targetdirs","type":"MODIFIED","insertions":14,"deletions":-11},{"file":"usr/src/cmd/bhyve/Makefile","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/Makefile.com","type":"MODIFIED","insertions":7,"deletions":-3},{"file":"usr/src/cmd/bhyve/bhyverun.c","type":"MODIFIED","insertions":13,"deletions":-2},{"file":"usr/src/cmd/bhyve/smbiostbl.c","type":"MODIFIED","insertions":78,"deletions":0},{"file":"usr/src/cmd/bhyve/smbiostbl.h","type":"MODIFIED","insertions":5,"deletions":0},{"file":"usr/src/cmd/bhyve/zhyve.c","type":"ADDED","insertions":170,"deletions":0},{"file":"usr/src/cmd/zoneadmd/zoneadmd.c","type":"MODIFIED","insertions":4,"deletions":0},{"file":"usr/src/lib/brand/Makefile","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"usr/src/lib/brand/bhyve/Makefile","type":"ADDED","insertions":32,"deletions":0},{"file":"usr/src/lib/brand/bhyve/Makefile.bhyve","type":"ADDED","insertions":17,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/Makefile","type":"ADDED","insertions":42,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/SYSbhyve.xml","type":"ADDED","insertions":9,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/attach","type":"ADDED","insertions":26,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/boot.c","type":"ADDED","insertions":487,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/config.xml","type":"ADDED","insertions":70,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/detach","type":"ADDED","insertions":19,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/platform.xml","type":"ADDED","insertions":142,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/statechange","type":"ADDED","insertions":18,"deletions":0},{"file":"usr/src/lib/brand/bhyve/zone/uninstall","type":"ADDED","insertions":23,"deletions":0},{"file":"usr/src/lib/libvmmapi/common/vmmapi.c","type":"MODIFIED","insertions":0,"deletions":-8}],"sizeInsertions":1194,"sizeDeletions":-28}],"allReviewers":[{"name":"Mike Gerdts","email":"mike.gerdts@joyent.com","username":"mgerdts"},{"name":"John Levon","email":"john.levon@joyent.com","username":"johnlevon"},{"name":"Jerry Jelinek","email":"jerry.jelinek@joyent.com","username":"jjelinek"},{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Patrick Mooney","email":"pmooney@pfmooney.com","username":"pfmooney"}]}