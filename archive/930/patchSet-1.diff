From 0066660cccbcfe9d0840acdd73cd42e4ed4373ae Mon Sep 17 00:00:00 2001
From: Brian Bennett <brian.bennett@joyent.com>
Date: Mon, 21 Nov 2016 15:28:58 -0800
Subject: [PATCH] OS-5812 curl update breaks breaks smartdc/init

---
 overlay/generic/lib/svc/method/smartdc-init | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
 mode change 100644 => 100755 overlay/generic/lib/svc/method/smartdc-init

diff --git a/overlay/generic/lib/svc/method/smartdc-init b/overlay/generic/lib/svc/method/smartdc-init
old mode 100644
new mode 100755
index c7cd77a1..139f9be2
--- a/overlay/generic/lib/svc/method/smartdc-init
+++ b/overlay/generic/lib/svc/method/smartdc-init
@@ -186,7 +186,7 @@ install_agents7()
 
     rm -f /var/tmp/agents_latest.sh
     curl -k -o /var/tmp/agents_latest.sh \
-        -s $CONFIG_assets_admin_ip:/extra/agents/latest
+        -s "http://${CONFIG_assets_admin_ip}/extra/agents/latest"
 
     [[ ! -f /var/tmp/agents_latest.sh ]] && return 1
     (cd /var/tmp; bash /var/tmp/agents_latest.sh)
@@ -282,7 +282,7 @@ install_config()
     load_sdc_config
 
     curl -k -o /tmp/node.config --silent \
-	$CONFIG_assets_admin_ip:/extra/joysetup/node.config
+        "https://${CONFIG_assets_admin_ip}/extra/joysetup/node.config"
 
     [[ ! -f /tmp/node.config ]] && return 0
     grep datacenter_name /tmp/node.config >/dev/null 2>&1
@@ -313,7 +313,7 @@ update_local_key()
     [ $nkeys -ne 1 ] && return
 
     curl -k -o /var/tmp/cnkey.tgz -f -s \
-        $CONFIG_assets_admin_ip:/extra/usbkey/cnkey.tgz
+        "http://${CONFIG_assets_admin_ip}/extra/usbkey/cnkey.tgz"
     [ ! -f /var/tmp/cnkey.tgz ] && return
 
     local console=$(bootparams | grep ^console= | cut -d= -f2)
-- 
2.21.0

