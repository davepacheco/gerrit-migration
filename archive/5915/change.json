{"project":"joyent/sdc-cnapi","branch":"master","id":"Idbd1df6c3e81c62d2e1999f5686c6db0202e8743","number":"5915","subject":"TRITON-1322 last_heartbeat disappeared when using ServerList (include missing patchset, add tests) Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/5915","commitMessage":"TRITON-1322 last_heartbeat disappeared when using ServerList (include missing patchset, add tests)\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1552970640,"lastUpdated":1552973456,"open":false,"status":"MERGED","comments":[{"timestamp":1552970640,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1552970641,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit c61607fe6309f54ea76924f0e6692e0296f702f4\n    \n    add new test case to catch when last_heartbeat goes missing.\n    \n    commit b0817f13273a59dacfae347655d16b66238a3786\n    \n    include patchset that got lost from CR 5912, fixes existing tests."},{"timestamp":1552970671,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1552970686,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2: Commit message was updated."},{"timestamp":1552972731,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1552973260,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 3."},{"timestamp":1552973262,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 3893873008a23693365cefe38efaf0ed56743a3c\n    \n    updates based on CR feedback"},{"timestamp":1552973293,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1552973399,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1 Integration-Approval+1"},{"timestamp":1552973413,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 4: Commit message was updated."},{"timestamp":1552973456,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"4","revision":"dbd1df6c3e81c62d2e1999f5686c6db0202e8743","parents":["e0efcc444167a5b0cb0d048a2478f7c718b9145e"],"ref":"refs/changes/15/5915/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1552973413,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552973293,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1552973456,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"test/test-servers.js","type":"MODIFIED","insertions":77,"deletions":0}],"sizeInsertions":87,"sizeDeletions":-2},"patchSets":[{"number":"1","revision":"fddd25235f493eee23f2157d68b739b31283c893","parents":["e0efcc444167a5b0cb0d048a2478f7c718b9145e"],"ref":"refs/changes/15/5915/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1552970640,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552970671,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"test/test-servers.js","type":"MODIFIED","insertions":75,"deletions":0}],"sizeInsertions":85,"sizeDeletions":-2},{"number":"2","revision":"612b38844da25c6a50fd7dfce35a9076ca911828","parents":["e0efcc444167a5b0cb0d048a2478f7c718b9145e"],"ref":"refs/changes/15/5915/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1552970686,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552970671,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"test/test-servers.js","line":657,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Drop this test? So we don\u0027t make extras\u003dlast_heartbeat somewhat more officially supported?"},{"file":"test/test-servers.js","line":661,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Could clarify that the bug is that *any* value passed to \"?extras\u003d...\" results in `extras.last_heartbeat \u003d\u003d true`, rather than it being something specific about \"?extras\u003dstatus\"."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"test/test-servers.js","type":"MODIFIED","insertions":75,"deletions":0}],"sizeInsertions":85,"sizeDeletions":-2},{"number":"3","revision":"4b97190482ec9d23a9b7130fa25024035edd3cda","parents":["e0efcc444167a5b0cb0d048a2478f7c718b9145e"],"ref":"refs/changes/15/5915/3","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1552973260,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552973293,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"test/test-servers.js","type":"MODIFIED","insertions":77,"deletions":0}],"sizeInsertions":87,"sizeDeletions":-2},{"number":"4","revision":"dbd1df6c3e81c62d2e1999f5686c6db0202e8743","parents":["e0efcc444167a5b0cb0d048a2478f7c718b9145e"],"ref":"refs/changes/15/5915/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1552973413,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1552973293,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1552973399,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1552973456,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/models/server.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/model/test-model-server.js","type":"MODIFIED","insertions":6,"deletions":0},{"file":"test/test-servers.js","type":"MODIFIED","insertions":77,"deletions":0}],"sizeInsertions":87,"sizeDeletions":-2}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}