{"project":"joyent/sdcadm","branch":"master","id":"I09a6a8757e372323de717dd63d13e12049950839","number":"4179","subject":"TOOLS-1776 \u0027sdcadm health\u0027 can exit 0 when there are service errors Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/4179","commitMessage":"TOOLS-1776 \u0027sdcadm health\u0027 can exit 0 when there are service errors\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1528742418,"lastUpdated":1528878777,"open":false,"status":"MERGED","comments":[{"timestamp":1528742418,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1528742424,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit 9a0870da2731377a15a700e380403144f689639f\n    \n    TOOLS-1776 \u0027sdcadm health\u0027 can exit 0 when there are service errors"},{"timestamp":1528742453,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528742623,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nTrent, mind to take a look? It\u0027s the sdcadm\u0027s cmdln related stuff we commented about earlier today."},{"timestamp":1528756411,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 1: Code-Review+1\n\n(2 comments)"},{"timestamp":1528790087,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1528790092,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit f51cc154bb663f438aac3212caf56487efd23da4\n    \n    TOOLS-1776 \u0027sdcadm health\u0027 can exit 0 when there are service errors"},{"timestamp":1528790124,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1528790129,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\n(2 comments)\n\nDone as suggested!"},{"timestamp":1528829273,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2: Code-Review+1 Integration-Approval+1"},{"timestamp":1528878764,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3: Commit message was updated."},{"timestamp":1528878777,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"3","revision":"09a6a8757e372323de717dd63d13e12049950839","parents":["9e72efaa9aa51aaadf4162b68d5c119ac2acbc95"],"ref":"refs/changes/79/4179/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528878764,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528790124,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1528878777,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/cli/do_check_health.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/check-health.test.js","type":"MODIFIED","insertions":21,"deletions":-4}],"sizeInsertions":47,"sizeDeletions":-11},"patchSets":[{"number":"1","revision":"f48d10e4a50187327b4e0438b6d4b79bb4a94a6c","parents":["af67a0208c78bf5cda3d81ddf067135b8277eaf7"],"ref":"refs/changes/79/4179/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528742418,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528742453,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528756411,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"lib/cli/do_check_health.js","line":187,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"It is a nit, but I think it would be slightly cleaner as follows to show that it is just that one attribute of the error that can differ:\n\n```\ncallback(new VError(\n    {\n        info: {\n            showErr: (!opts.json \u0026\u0026 !opts.quiet)\n        }\n    },\n    \u0027Some instances appear unhealthy\u0027));\n```"},{"file":"lib/cli/do_check_health.js","line":187,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/cli/index.js","line":212,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps add a section to the top-comment in lib/errors.js about specially-handled VError info fields?"},{"file":"lib/cli/index.js","line":212,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Sounds good, yeah"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/cli/do_check_health.js","type":"MODIFIED","insertions":17,"deletions":-5},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"test/check-health.test.js","type":"MODIFIED","insertions":21,"deletions":-4}],"sizeInsertions":46,"sizeDeletions":-10},{"number":"2","revision":"a917d8c009227bb42822b2934e5b5982bbdc5e9d","parents":["9e72efaa9aa51aaadf4162b68d5c119ac2acbc95"],"ref":"refs/changes/79/4179/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528790087,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528790124,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/cli/do_check_health.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/check-health.test.js","type":"MODIFIED","insertions":21,"deletions":-4}],"sizeInsertions":47,"sizeDeletions":-11},{"number":"3","revision":"09a6a8757e372323de717dd63d13e12049950839","parents":["9e72efaa9aa51aaadf4162b68d5c119ac2acbc95"],"ref":"refs/changes/79/4179/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1528878764,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1528790124,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1528829273,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1528878777,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/cli/do_check_health.js","type":"MODIFIED","insertions":13,"deletions":-6},{"file":"lib/cli/index.js","type":"MODIFIED","insertions":8,"deletions":-1},{"file":"lib/errors.js","type":"MODIFIED","insertions":5,"deletions":0},{"file":"test/check-health.test.js","type":"MODIFIED","insertions":21,"deletions":-4}],"sizeInsertions":47,"sizeDeletions":-11}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}