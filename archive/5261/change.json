{"project":"joyent/node-sshpk-agent","branch":"master","id":"I0cea188156fd62de3172ee3f3675900ed861ccd3","number":"5261","subject":"joyent/node-sshpk-agent#18 want commandline tool for debugging Reviewed by: Isaac Davis \u003cisaac.davis@joyent.com\u003e","owner":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"url":"https://cr.joyent.us/5261","commitMessage":"joyent/node-sshpk-agent#18 want commandline tool for debugging\nReviewed by: Isaac Davis \u003cisaac.davis@joyent.com\u003e\n","createdOn":1545094491,"lastUpdated":1562890980,"open":false,"status":"MERGED","comments":[{"timestamp":1545094491,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 1."},{"timestamp":1545094633,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1545430840,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 1:\n\n(12 comments)"},{"timestamp":1562888599,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 2."},{"timestamp":1562888624,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n deps/javascriptlint/build/install/jsl --nologo --nosummary --conf\u003dtools/jsl.node.conf lib/index.js lib/client-fsm.js lib/errors.js lib/protocol-streams.js lib/protocol.js lib/client.js lib/ssh-buffer.js\n /tmp/repo/lib/index.js\n /tmp/repo/lib/client-fsm.js\n /tmp/repo/lib/errors.js\n /tmp/repo/lib/protocol-streams.js\n /tmp/repo/lib/protocol.js\n /tmp/repo/lib/client.js\n /tmp/repo/lib/ssh-buffer.js\n deps/jsstyle/jsstyle -f tools/jsstyle.conf lib/index.js lib/client-fsm.js lib/errors.js lib/protocol-streams.js lib/protocol.js lib/client.js lib/ssh-buffer.js\n Unescaped left brace in regex is illegal here in regex; marked by \u003c-- HERE in m/\\S{ \u003c-- HERE / at deps/jsstyle/jsstyle line 666.\n gmake: *** [tools/mk/Makefile.targ:183: check-jsstyle] Error 255"},{"timestamp":1562889341,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 3: Patch Set 2 was rebased"},{"timestamp":1562889367,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562889739,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Uploaded patch set 4."},{"timestamp":1562889765,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1562890851,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1562890978,"reviewer":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"message":"Patch Set 5: Commit message was updated."},{"timestamp":1562890980,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Alex Wilson"}],"currentPatchSet":{"number":"5","revision":"7185a28ac0cc4961be37589132a218cb2c9ebb36","parents":["55a291295799e13b9995f9f8ee3fac562ac91482"],"ref":"refs/changes/61/5261/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1562890978,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562889765,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"SUBM","value":"1","grantedOn":1562890980,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":407,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":415,"sizeDeletions":-1},"patchSets":[{"number":"1","revision":"3625a65e4dd6c2f43cc4a98317b874bfe962b390","parents":["6db0534885976a31d54dfbf4e9a90f288a9d7f87"],"ref":"refs/changes/61/5261/1","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1545094491,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1545094633,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"bin/sshpk-agent","line":4,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"This shouldn\u0027t say \"All rights reserved.\"\n\nPer RFD 104, the canonical form is:\n\n\u003e Copyright (c) 2018, Joyent, Inc."},{"file":"bin/sshpk-agent","line":14,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Nit: I tend to like to alphabetize and to separate local modules from npm modules."},{"file":"bin/sshpk-agent","line":84,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"This code is repeated pretty much verbatim in the list() function below. Might be worth factoring out - though it\u0027s small."},{"file":"bin/sshpk-agent","line":96,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Why do we exit 2 as opposed to 1 here? This might be a convention I\u0027m not aware of - but if not, we should probably document what the different nonzero codes mean for this program."},{"file":"bin/sshpk-agent","line":205,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Would be good to leave a comment explaining logic and maybe also make some of these numbers constants."},{"file":"bin/sshpk-agent","line":227,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Same here - the whole benchmark subcommand needs comments explaining what\u0027s going on."},{"file":"bin/sshpk-agent","line":241,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"You should add an error check to ensure that these options are present for this command."},{"file":"bin/sshpk-agent","line":245,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Maybe make this a named constant"},{"file":"bin/sshpk-agent","line":247,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Would be nice to have a comment explaining what this is doing."},{"file":"bin/sshpk-agent","line":251,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Should this be stdout?"},{"file":"bin/sshpk-agent","line":290,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"Does it make sense to use ifError() here?"},{"file":"bin/sshpk-agent","line":342,"reviewer":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},"message":"The key shows up in this error message as \"(unnamed)\", which is a little confusing to the user. Not sure if there\u0027s anything to be done about this.\n\nFor example:\n\n```\nS root@buildzone: ~/git-sand/node-sshpk-agent - 3625a65\n\u003e ./bin/sshpk-agent --subject-key\u003d1 list\nerror: VError: failed to parse subject-key option: Failed to parse (unnamed) as a valid auto format key: Index out of range\n```"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":348,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":355,"sizeDeletions":0},{"number":"2","revision":"24c7ed9903bf057a8c8ce3caa0a38924c4022ecf","parents":["69533a4cdb80216b3963448cc87d68573135eee0"],"ref":"refs/changes/61/5261/2","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1562888599,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1562888624,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":407,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":414,"sizeDeletions":0},{"number":"3","revision":"463ce5eb57cfdec74ba5f71efb7e1535f037b5ad","parents":["55a291295799e13b9995f9f8ee3fac562ac91482"],"ref":"refs/changes/61/5261/3","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1562889341,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"TRIVIAL_REBASE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562889367,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":407,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":7,"deletions":0}],"sizeInsertions":414,"sizeDeletions":0},{"number":"4","revision":"0cea188156fd62de3172ee3f3675900ed861ccd3","parents":["55a291295799e13b9995f9f8ee3fac562ac91482"],"ref":"refs/changes/61/5261/4","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1562889739,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562889765,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":407,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":415,"sizeDeletions":-1},{"number":"5","revision":"7185a28ac0cc4961be37589132a218cb2c9ebb36","parents":["55a291295799e13b9995f9f8ee3fac562ac91482"],"ref":"refs/changes/61/5261/5","uploader":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"createdOn":1562890978,"author":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"SUBM","value":"1","grantedOn":1562890980,"by":{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1562889765,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1562890851,"by":{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"bin/sshpk-agent","type":"ADDED","insertions":407,"deletions":0},{"file":"package.json","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":415,"sizeDeletions":-1}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Isaac Davis","email":"isaac.davis@joyent.com","username":"isaacdavis"},{"name":"Alex Wilson","email":"alex@cooperi.net","username":"arekinath"}]}