commit 41c175281a972b09248aaf422177923782aba666 (refs/changes/82/782/2)
Author: Richard Bradley <richard.bradley@joyent.com>
Date:   2016-10-26T12:33:57+01:00 (2 years, 11 months ago)
    
    MANTA-2799 "manta-adm update" should fail when given non-existent service

diff --git a/lib/adm.js b/lib/adm.js
index 94e2b1a..2ac22d7 100644
--- a/lib/adm.js
+++ b/lib/adm.js
@@ -1383,6 +1383,11 @@ maAdm.prototype.generatePlan = function (callback, service, noreprovision)
 	assert.ok(this.ma_instances_wanted !== null);
 	assert.ok(this.ma_plan === null);
 
+	if (service && !svcs.serviceNameIsValid(service)) {
+		callback(new VError('unrecognized service: "%s"', service));
+		return;
+	}
+
 	var cnid, dcnconf, svcconfig, svcid, svcname, actual;
 	var svcname2uuids = {};
 	var usedany = false;
