{"project":"joyent/illumos-joyent","branch":"vpc","id":"I374fef1d1cbbeb67f2b4be78eb52753baa00d5d4","number":"4500","subject":"Delete VL3 entry on target DROP response","owner":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"url":"https://cr.joyent.us/4500","commitMessage":"Delete VL3 entry on target DROP response\n","createdOn":1531182214,"lastUpdated":1531252232,"open":false,"status":"MERGED","comments":[{"timestamp":1531182214,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 1."},{"timestamp":1531182904,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1531183131,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1531183223,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1531183285,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 1:\n\n(1 comment)"},{"timestamp":1531184898,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 2."},{"timestamp":1531186226,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 2:\n\n(1 comment)\n\nOne wording nit, and one bigger question:\n\nI can\u0027t remember, but can outstanding requests get timed out?  If so, who does the sarc_rele then?"},{"timestamp":1531231217,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 3."},{"timestamp":1531232665,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Patch Set 2:\n\nNo -- currently there is nothing on the kernel side to time out requests."},{"timestamp":1531233860,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 3: Code-Review+1\n\nOnce I get OS-7069 under control, I\u0027ll try this."},{"timestamp":1531244261,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 4."},{"timestamp":1531250439,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Uploaded patch set 5."},{"timestamp":1531250552,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5:\n\nTesting now, but so far so good."},{"timestamp":1531252197,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1531252232,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jason King"}],"currentPatchSet":{"number":"5","revision":"374fef1d1cbbeb67f2b4be78eb52753baa00d5d4","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531250439,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531252197,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531252197,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"SUBM","value":"1","grantedOn":1531252232,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":95,"deletions":-18},{"file":"usr/src/uts/common/io/overlay/sarc.c","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":103,"sizeDeletions":-19},"patchSets":[{"number":"1","revision":"5ee645afc2e71f60232d581c419f500898091bea","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/1","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531182214,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/overlay/overlay_target.c","line":1501,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Don\u0027t you need to hold ott_lock before calling this?  If I\u0027m right, you\u0027ll need a different goto target.  Or maybe you just need to hold the mutex and jump instead of hold/rele/then-remove ?"},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","line":1501,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"Hrm.. you\u0027re right.  What probably needs to happen is we need to take a reference when the requests is queued -- since the code in master never actually deletes entries except w/ explicit operator intervention I think it was able to get away without worrying about it."},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","line":1501,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"Oh no did I open a larger can of worms?"},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","line":1501,"reviewer":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"message":"I think so, but probably one that needed to be opened."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":37,"deletions":-7}],"sizeInsertions":37,"sizeDeletions":-7},{"number":"2","revision":"e88a8b72f544333b1ea2c12f6a0a4574c9437e6c","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/2","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531184898,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","comments":[{"file":"usr/src/uts/common/io/overlay/overlay_target.c","line":372,"reviewer":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},"message":"its own *additional* hold"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":95,"deletions":-18}],"sizeInsertions":95,"sizeDeletions":-18},{"number":"3","revision":"01d67383201962bcf8f86ca5626a52b2dcf5c040","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/3","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531231217,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531233860,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":95,"deletions":-18}],"sizeInsertions":95,"sizeDeletions":-18},{"number":"4","revision":"ff6ac730d830393efb981876a31ada3fff924c4f","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/4","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531244261,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":95,"deletions":-18},{"file":"usr/src/uts/common/io/overlay/sarc.c","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":96,"sizeDeletions":-19},{"number":"5","revision":"374fef1d1cbbeb67f2b4be78eb52753baa00d5d4","parents":["f352384164a8d0892c44590bd4b26562c68faee3"],"ref":"refs/changes/00/4500/5","uploader":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"createdOn":1531250439,"author":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"SUBM","value":"1","grantedOn":1531252232,"by":{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1531252197,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1531252197,"by":{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"usr/src/uts/common/io/overlay/overlay_target.c","type":"MODIFIED","insertions":95,"deletions":-18},{"file":"usr/src/uts/common/io/overlay/sarc.c","type":"MODIFIED","insertions":8,"deletions":-1}],"sizeInsertions":103,"sizeDeletions":-19}],"allReviewers":[{"name":"Dan McDonald","email":"danmcd@joyent.com","username":"danmcd"},{"name":"Jason King","email":"jason.king@joyent.com","username":"jasonbking"}]}