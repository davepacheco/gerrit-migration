{"project":"joyent/node-triton","branch":"master","id":"I26b97b5bedd64dbce51cf470af3c8fdff3cda57c","number":"3383","subject":"TRITON-124 add node-triton support for bhyve Reviewed by: Trent Mick \u003ctrentm@gmail.com\u003e Approved by: Trent Mick \u003ctrentm@gmail.com\u003e","owner":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"url":"https://cr.joyent.us/3383","commitMessage":"TRITON-124 add node-triton support for bhyve\nReviewed by: Trent Mick \u003ctrentm@gmail.com\u003e\nApproved by: Trent Mick \u003ctrentm@gmail.com\u003e\n","createdOn":1518812376,"lastUpdated":1519164361,"open":false,"status":"MERGED","comments":[{"timestamp":1518812376,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 1."},{"timestamp":1518812377,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit dd932fc8c8c6983dd8a91b3d4d51ac9f1bef0ae3\n    \n    support for bhyve brand"},{"timestamp":1518812585,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 2."},{"timestamp":1518812586,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit d716705ea5f81b892cdd93fddf787a5196d3d50c\n    \n    support for bhyve brand"},{"timestamp":1518813258,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1518820120,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 3."},{"timestamp":1518820121,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit 37f14d90322d161f76c2c4467cd274e9b3b89228\n    \n    address CR comments"},{"timestamp":1518820172,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 2:\n\n(3 comments)"},{"timestamp":1518821303,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 3: Code-Review+1\n\nLGTM. Waiting for the test you said is coming."},{"timestamp":1518847849,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 4."},{"timestamp":1518847850,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit 61b26a14aea2f04045010c43d9ee5d91b887ec78\n    \n    add test"},{"timestamp":1519083148,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing-1\n\n\"make check\" exited with status 2\n\n fatal: ref HEAD is not a symbolic ref\n fatal: No tags can describe \u00271dad88ef1cdba88672bf7084537ed0673cbfdb64\u0027.\n Try --always, or create some tags.\n version is: 5.7.1\n [[ `cat package.json | json version` \u003d\u003d `grep \u0027^## \u0027 CHANGES.md | head -2 | tail -1 | awk \u0027{print $2}\u0027` ]]\n Makefile:53: recipe for target \u0027versioncheck\u0027 failed\n gmake: *** [versioncheck] Error 1"},{"timestamp":1519083280,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 4: Code-Review+1 Integration-Approval+1"},{"timestamp":1519083298,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1519083306,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1519084564,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3:\n\n\"make check\" passed ok"},{"timestamp":1519084735,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing-1\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1519085055,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4:\n\n(1 comment)\n\n\"make check\" exited with status 2"},{"timestamp":1519090123,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Uploaded patch set 5."},{"timestamp":1519090124,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit cdf79c9d6fe5c4bd13bdb230e5abad49abb92cc9\n    \n    hopefully fix \u0027make check\u0027"},{"timestamp":1519090157,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1519146765,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Patch Set 5: Code-Review+1 Integration-Approval+1"},{"timestamp":1519164361,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Josh Wilsdon"}],"currentPatchSet":{"number":"5","revision":"26b97b5bedd64dbce51cf470af3c8fdff3cda57c","parents":["3f243f8c8f4bb8622f99566af23e4da919aadba0"],"ref":"refs/changes/83/3383/5","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1519090123,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1519090157,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519146765,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519146765,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1519164361,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/config.json.sample","type":"MODIFIED","insertions":11,"deletions":0},{"file":"test/integration/cli-instance-create-bhyve.test.js","type":"ADDED","insertions":92,"deletions":0},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":75,"deletions":-1}],"sizeInsertions":205,"sizeDeletions":-7},"patchSets":[{"number":"1","revision":"1dad88ef1cdba88672bf7084537ed0673cbfdb64","parents":["e7c02436dfcb282a9139121cd8c59d097b5181c9"],"ref":"refs/changes/83/3383/1","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1518812376,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1519083148,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":19,"sizeDeletions":-6},{"number":"2","revision":"ec0df71a95e73c70d42f7275dd06d929af2007b1","parents":["3f243f8c8f4bb8622f99566af23e4da919aadba0"],"ref":"refs/changes/83/3383/2","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1518812585,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1519083298,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"CHANGES.md","line":11,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Perhaps add:\n\n```\n- [TRITON-124] add node-triton support for bhyve. This adds a `triton instance create --brand\u003dbhyve ...` option that can be used for zvol images that support it. Note that BHYVE support is alpha in TritonDC -- most datacenters won\u0027t yet support it.\n\n```"},{"file":"CHANGES.md","line":11,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Done"},{"file":"lib/do_instance/do_create.js","line":502,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"I think the average user won\u0027t have a clue on this one. :) I on\u0027t know if we have public docs for what \"brand\" means to the user.  Fine to leave this as is here tho."},{"file":"lib/do_instance/do_create.js","line":502,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Ok, I added a comment that hopefully makes it clear most people don\u0027t need this."},{"file":"lib/do_instance/do_list.js","line":155,"reviewer":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},"message":"Move this up to before the \u0027D\u0027 flag to be in alpha order, as you have in do_fwrule/do_instances.js"},{"file":"lib/do_instance/do_list.js","line":155,"reviewer":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":4,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":10,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":23,"sizeDeletions":-6},{"number":"3","revision":"66accc06ae8d203154c3f7bc742541c91c05dd69","parents":["3f243f8c8f4bb8622f99566af23e4da919aadba0"],"ref":"refs/changes/83/3383/3","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1518820120,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1519083306,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1518821303,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1}],"sizeInsertions":27,"sizeDeletions":-6},{"number":"4","revision":"f9ccdc294e0fc5c3c7f9eaf3b6e1697fb6c7bee0","parents":["3f243f8c8f4bb8622f99566af23e4da919aadba0"],"ref":"refs/changes/83/3383/4","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1518847849,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"-1","grantedOn":1519084735,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519083280,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519083280,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}}],"comments":[{"file":"test/integration/helpers.js","line":334,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"line \u003e 80 characters"},{"file":"test/integration/helpers.js","line":334,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"line \u003e 80 characters"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/config.json.sample","type":"MODIFIED","insertions":11,"deletions":0},{"file":"test/integration/cli-instance-create-bhyve.test.js","type":"ADDED","insertions":92,"deletions":0},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":74,"deletions":-1}],"sizeInsertions":204,"sizeDeletions":-7},{"number":"5","revision":"26b97b5bedd64dbce51cf470af3c8fdff3cda57c","parents":["3f243f8c8f4bb8622f99566af23e4da919aadba0"],"ref":"refs/changes/83/3383/5","uploader":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"createdOn":1519090123,"author":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1519090157,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1519146765,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1519146765,"by":{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"}},{"type":"SUBM","value":"1","grantedOn":1519164361,"by":{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"CHANGES.md","type":"MODIFIED","insertions":7,"deletions":0},{"file":"lib/do_fwrule/do_instances.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_create.js","type":"MODIFIED","insertions":11,"deletions":-1},{"file":"lib/do_instance/do_list.js","type":"MODIFIED","insertions":3,"deletions":-1},{"file":"lib/do_instance/do_snapshot/do_create.js","type":"MODIFIED","insertions":2,"deletions":-2},{"file":"package.json","type":"MODIFIED","insertions":1,"deletions":-1},{"file":"test/config.json.sample","type":"MODIFIED","insertions":11,"deletions":0},{"file":"test/integration/cli-instance-create-bhyve.test.js","type":"ADDED","insertions":92,"deletions":0},{"file":"test/integration/helpers.js","type":"MODIFIED","insertions":75,"deletions":-1}],"sizeInsertions":205,"sizeDeletions":-7}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Trent Mick","email":"trentm@gmail.com","username":"trentm"},{"name":"Josh Wilsdon","email":"josh@wilsdon.ca","username":"joshwilsdon"}]}