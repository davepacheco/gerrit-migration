{"project":"joyent/sdc-papi","branch":"master","id":"I8f97ada4957686a467037b0dbe17b9261dc7b23e","number":"2727","subject":"PAPI-143 Moray buckets need to be reindexed after schema updates Reviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e Approved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e","owner":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"url":"https://cr.joyent.us/2727","commitMessage":"PAPI-143 Moray buckets need to be reindexed after schema updates\nReviewed by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\nApproved by: Marsell Kukuljevic \u003cmarsell@joyent.com\u003e\n","createdOn":1507220811,"lastUpdated":1509523488,"open":false,"status":"MERGED","comments":[{"timestamp":1507220811,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 1."},{"timestamp":1507220817,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 1:\n\nNew commits:\n    \n    commit b7963e0f99e39ae570a639e8ac88c25afd765b56\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507220846,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507236828,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 1:\n\n(2 comments)"},{"timestamp":1507241660,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 1:\n\n(3 comments)"},{"timestamp":1507299761,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 2."},{"timestamp":1507299767,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 2:\n\nNew commits:\n    \n    commit cbb0651373010159afb681a753dcbcc59c11f087\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507299793,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507299876,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 3."},{"timestamp":1507299882,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\nNew commits:\n    \n    commit aa9251bf018120fb314a10a76bbc521993441429\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507299914,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507299941,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 3:\n\n(5 comments)\n\nDone with all the suggested changes folks! Thanks for the quick review!"},{"timestamp":1507309028,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1507314592,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 3: Code-Review+1\n\n(1 comment)"},{"timestamp":1507559774,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 4."},{"timestamp":1507559779,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 4:\n\nNew commits:\n    \n    commit ea276347a1164d1be00492fb06943ba04374c340\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507559805,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507560090,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 5."},{"timestamp":1507560095,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\nNew commits:\n    \n    commit b974048e9239bd29e5223d53147b5f02a194e9c9\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507560115,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 5: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507560372,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 5:\n\n(2 comments)\n\nMind to take another look folks?"},{"timestamp":1507573740,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 5:\n\n(2 comments)"},{"timestamp":1507648663,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 6."},{"timestamp":1507648669,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6:\n\nNew commits:\n    \n    commit 4061b62c22258e9a8953c10e82075adf3ad093d5\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1507648692,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 6: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1507648828,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6:\n\n(2 comments)\n\nDone with Cody\u0027s fix for the reindex attempt counter. Not sure about what to do if reindexing failed after these attempts: exit or not the process, or just leave it to ops reviewing Amon alarms?"},{"timestamp":1507655287,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Patch Set 6: Code-Review+1\n\n(1 comment)"},{"timestamp":1507669986,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6:\n\nWhen I said that Triton retries few places, I mean that we should be retrying _more_, but in a much more disciplined matter (backoff, idempotency, codel/adaptive-FIFO on the other end, etc) It was a general comment, not specific to this issue. Just to be clear about that.\n\nI think we have a problem in this scenario, because we\u0027re conflating connection issues with other errors. If we have other unexpected errors, we want to flake out so a human can take a look.\n\nBut what about connection issues? Do we really want to die after five attempts? I think this is a mistake, because if a parent service goes offline temporarily, it means that the child service (PAPI) goes offline too... and stays offline, even when the parent service returns.\n\nIf we want to build a system that is robust at scale, the main reason for my comment about engdoc guidelines on retries, we probably need to distinguish between things that should automatically heal and those that shouldn\u0027t. A service going away and returning definitely falls in the \"automatic\" camp, IMHO; imagine the chaos if that wasn\u0027t so.\n\nI\u0027m fine with the MAX_REINDEX_ATTEMPS thing, but only if it distinguishes between connection errors and other errors.\n\nAnd we really need some engdoc guidelines here. Some aspects of robustness -- idempotency -- have pretty deep implications."},{"timestamp":1508086428,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 6:\n\n(1 comment)\n\nI agree Marsell. I\u0027d say left it as it\u0027s now, and just add the aforementioned Amon probes for log.fatal calls so we don\u0027t bother ops with a lot of logging and just bug them when we are really interested into human intervention.\n\nRegarding general purpose guidelines about how/when to retry or give up and exit, I agree too. Maybe it\u0027ll be worth reviewing what we\u0027re currently doing and try to get some initial approach to discuss from there? \n\n\u003e When I said that Triton retries few places, I mean that we should\n \u003e be retrying _more_, but in a much more disciplined matter (backoff,\n \u003e idempotency, codel/adaptive-FIFO on the other end, etc) It was a\n \u003e general comment, not specific to this issue. Just to be clear about\n \u003e that.\n \u003e \n \u003e I think we have a problem in this scenario, because we\u0027re\n \u003e conflating connection issues with other errors. If we have other\n \u003e unexpected errors, we want to flake out so a human can take a look.\n \u003e \n \u003e But what about connection issues? Do we really want to die after\n \u003e five attempts? I think this is a mistake, because if a parent\n \u003e service goes offline temporarily, it means that the child service\n \u003e (PAPI) goes offline too... and stays offline, even when the parent\n \u003e service returns.\n \u003e \n \u003e If we want to build a system that is robust at scale, the main\n \u003e reason for my comment about engdoc guidelines on retries, we\n \u003e probably need to distinguish between things that should\n \u003e automatically heal and those that shouldn\u0027t. A service going away\n \u003e and returning definitely falls in the \"automatic\" camp, IMHO;\n \u003e imagine the chaos if that wasn\u0027t so.\n \u003e \n \u003e I\u0027m fine with the MAX_REINDEX_ATTEMPS thing, but only if it\n \u003e distinguishes between connection errors and other errors.\n \u003e \n \u003e And we really need some engdoc guidelines here. Some aspects of\n \u003e robustness -- idempotency -- have pretty deep implications."},{"timestamp":1509039016,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 6: Integration-Approval+1"},{"timestamp":1509118444,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 7."},{"timestamp":1509118449,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 7:\n\nNew commits:\n    \n    commit cccc9a1d92ed9c9d861eda581585ea443c155967\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1509118469,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 7: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1509135640,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 7:\n\n(1 comment)"},{"timestamp":1509375055,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 8."},{"timestamp":1509375060,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 8:\n\nNew commits:\n    \n    commit a2276890c80584133a95a05d50e011f3b21a9118\n    \n    PAPI-143 Moray buckets need to be reindexed after schema updates"},{"timestamp":1509375080,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 8: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1509375101,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Patch Set 8:\n\n(1 comment)\n\nDone with the typo you found Marsell!"},{"timestamp":1509479032,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Patch Set 8: Code-Review+1 Integration-Approval+1"},{"timestamp":1509523457,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Uploaded patch set 9: Commit message was updated."},{"timestamp":1509523488,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Pedro Palazón Candel"}],"currentPatchSet":{"number":"9","revision":"8f97ada4957686a467037b0dbe17b9261dc7b23e","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/9","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1509523457,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509375080,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"SUBM","value":"1","grantedOn":1509523488,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":44,"deletions":-3}],"sizeInsertions":44,"sizeDeletions":-3},"patchSets":[{"number":"1","revision":"9e122da3f77dec2c4c59a0dca4ecb77168fa1671","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/1","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507220811,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507220846,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/backend.js","line":92,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Unimportant, but if you add \"bucket\" as an arg, you could move this function to a higher scope (and thus less indentation)."},{"file":"lib/backend.js","line":92,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Moved up, still within the scope of Backend constructor so the only argument I need to add is a callback for when we\u0027re done."},{"file":"lib/backend.js","line":97,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Can we also add \"bucket: bucket\" to this object?"},{"file":"lib/backend.js","line":97,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Of course!"},{"file":"lib/backend.js","line":107,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Can we add a log statement after here, like:\n\n    log.info({\n        bucket: bucket,\n        results: reindexRes\n    }, \u0027reindexed %d rows\u0027, reindexRes.processed);"},{"file":"lib/backend.js","line":107,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/backend.js","line":110,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I suspect this might be unnecessary? If so, you could remove the rowsToReindex var and hardcode in MAX_ROWS_TO_REINDEX to backend.reindexObjects().\n\nThe reason I ask is because the first iteration of reindexObjects(rowsToReindex) will always be MAX_ROWS_TO_REINDEX even if there were less than 100 rows in total.\n\nSo either we have a bug here (rowsToReindex() blows up on first iteration when dealing with less than 100 rows), or the rowsToReindex var is unnecessary."},{"file":"lib/backend.js","line":110,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Yeah, we can just call reindexObjects() repeatedly with MAX_ROWS_TO_REINDEX until 0 have been processed. The remaining value is really just for informational purposes."},{"file":"lib/backend.js","line":110,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"},{"file":"lib/backend.js","line":110,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":26,"deletions":-2}],"sizeInsertions":26,"sizeDeletions":-2},{"number":"2","revision":"59bda25b1374a4728bc1914b328abcca5bab7fd1","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/2","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507299761,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507299793,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":24,"deletions":-2}],"sizeInsertions":24,"sizeDeletions":-2},{"number":"3","revision":"f3809a18cf52480d169e8e33e4cb4de7a1bba7c5","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/3","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507299876,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507299914,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507314592,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"comments":[{"file":"lib/backend.js","line":71,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"The one thing I\u0027m uncertain of is whether we should error out here, or try again. When .init() gets called, the callback doesn\u0027t check for any errors or act on them. We could update that function to act on the error, but I think that the best thing to do here is probably to retry after several seconds if there\u0027s an error. Thoughts?"},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"I wish we had an engdoc guideline about retrying. We retry few things in Triton, and that will become a real problem as we scale up."},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Yes, Indeed. The bucket creation callback is being called \"ad-infinitum\" if the execution isn\u0027t a success. I\u0027m wondering if we shouldn\u0027t just fail that one too after 5 attempts or some similar number. Otherwise it\u0027ll be trying to run the function forever and, on this case, I think we could get immediate attention from ops if we just put the service in maintenance after exiting throwing an exception."},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I\u0027ve added a maximum of 5 retries to this process. I think that from here we should just give up and let the existing Amon probes watching for error objects to notify ops about the existence of issues with the service."},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"Should we make the .init() caller check for an error and call process.exit(1)/throw the error then?"},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"I think that if PAPI can still work w/o some fields reindexed, we shouldn\u0027t. But if that\u0027s not possible, we should definitely consider exiting the process. Thoughts?"},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"That\u0027s fair. Maybe it shouldn\u0027t exit then. Does the PAPI Amon probe just look for all error logs?"},{"file":"lib/backend.js","line":71,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Just checked and PAPI hasn\u0027t got any Amon Probe associated with it. Wondering it should be worth adding the log.fatal at least. Thoughts? Maybe as a separated issue, if fits better."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":29,"deletions":-2}],"sizeInsertions":29,"sizeDeletions":-2},{"number":"4","revision":"a4cd9b05c2a9d78d3e78581a13d5ed890bc85efb","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/4","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507559774,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507559805,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":8,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":37,"deletions":-3}],"sizeInsertions":37,"sizeDeletions":-3},{"number":"5","revision":"26c397c356f3ea1108bdc61a3a057328caa115cc","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/5","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507560090,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507560115,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/backend.js","line":68,"reviewer":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},"message":"We should increment this inside the conditional. If we have to reindex more than 500 objects, then this would be increased past 5, and then hitting a single error would cause us to fail."},{"file":"lib/backend.js","line":68,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Done"}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":39,"deletions":-3}],"sizeInsertions":39,"sizeDeletions":-3},{"number":"6","revision":"c0ff9cf6b68016f498a2aa4e8d7d1bb346f3dcf2","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/6","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1507648663,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1507655287,"by":{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1507648692,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509039016,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":39,"deletions":-3}],"sizeInsertions":39,"sizeDeletions":-3},{"number":"7","revision":"cd80942e0af292564b6f397b8e3469010cd9028e","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/7","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1509118444,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509118469,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/backend.js","line":137,"reviewer":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},"message":"Shouldn\u0027t this be \"reindexErr\"?"},{"file":"lib/backend.js","line":137,"reviewer":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"message":"Geez! Very true! fixed."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":44,"deletions":-3}],"sizeInsertions":44,"sizeDeletions":-3},{"number":"8","revision":"d32b42854017c746566e71d18a778109b16dc6d9","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/8","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1509375055,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509375080,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":44,"deletions":-3}],"sizeInsertions":44,"sizeDeletions":-3},{"number":"9","revision":"8f97ada4957686a467037b0dbe17b9261dc7b23e","parents":["1aed1e2d5a641603c6a37bb96873418f339bf60e"],"ref":"refs/changes/27/2727/9","uploader":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"createdOn":1509523457,"author":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1509375080,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1509523488,"by":{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1509479032,"by":{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/backend.js","type":"MODIFIED","insertions":44,"deletions":-3}],"sizeInsertions":44,"sizeDeletions":-3}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"Marsell Kukuljevic","email":"marsell@joyent.com","username":"marsell"},{"name":"Cody Peter Mello","email":"melloc@writev.io","username":"melloc"},{"name":"Pedro Palazón Candel","email":"pedro@joyent.com","username":"kusor"}]}