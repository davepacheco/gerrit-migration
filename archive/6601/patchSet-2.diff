commit 8887095d7413f4b9941f27093cefea2625d67b35
Author: Todd Whiteman <todd.whiteman@joyent.com>
Date:   2019-07-25T13:10:24-07:00 (2 months ago)
    
    TRITON-1813 non-integer 'refreservation' values confound sdc-migrate
    Reviewed by: Mike Gerdts <mike.gerdts@joyent.com>
    Approved by: Pedro Palaz√≥n Candel <pedro@joyent.com>

diff --git a/lib/workflows/vm-migration/begin.js b/lib/workflows/vm-migration/begin.js
index 249d60c..1efe85b 100644
--- a/lib/workflows/vm-migration/begin.js
+++ b/lib/workflows/vm-migration/begin.js
@@ -259,6 +259,13 @@ function createProvisionPayload(job, cb) {
                 delete disk.refreservation;
             }
 
+            // Bhyve refreservations should not be set (they are set
+            // automagically during vmadm create).
+            if (disk.refreservation && disk.size &&
+                    vmPayload.brand === 'bhyve') {
+                delete disk.refreservation;
+            }
+
             // You cannot specify a path for a disk unless you set nocreate=true
             if (disk.path && !disk.nocreate) {
                 // XXX: TODO: Could this cause a change to the resulting disk
diff --git a/package.json b/package.json
index 2bfc24b..edc6f64 100644
--- a/package.json
+++ b/package.json
@@ -1,7 +1,7 @@
 {
   "name": "vmapi",
   "description": "VMs API",
-  "version": "9.8.13",
+  "version": "9.8.14",
   "author": "Joyent (joyent.com)",
   "private": true,
   "dependencies": {
