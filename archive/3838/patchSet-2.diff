commit 8e0d61021fb9b8d6ac088ea4b7499a05baab32e5 (refs/changes/38/3838/2)
Author: Jerry Jelinek <jerry.jelinek@joyent.com>
Date:   2018-04-18T16:27:31+00:00 (1 year, 6 months ago)
    
    OS-6898 vforked child java process in infinite segv loop

diff --git a/usr/src/lib/brand/lx/lx_brand/common/clone.c b/usr/src/lib/brand/lx/lx_brand/common/clone.c
index 109baf3d0a..b540d5a55e 100644
--- a/usr/src/lib/brand/lx/lx_brand/common/clone.c
+++ b/usr/src/lib/brand/lx/lx_brand/common/clone.c
@@ -556,6 +556,11 @@ lx_clone(uintptr_t p1, uintptr_t p2, uintptr_t p3, uintptr_t p4, uintptr_t p5)
 				LX_REG(&vforkuc, REG_SP) = (uintptr_t)cldstk;
 			}
 
+			/*
+			 * Re-enable signal delivery in the child process.
+			 */
+			lx_unblock_all_signals();
+
 			/*
 			 * Stop for ptrace if required.
 			 */
