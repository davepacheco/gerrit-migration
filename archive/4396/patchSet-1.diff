From b39684f1ddf96d91f364f2b5bc8b1606dd456749 Mon Sep 17 00:00:00 2001
From: Trent Mick <trentm@gmail.com>
Date: Wed, 20 Jun 2018 14:10:35 -0700
Subject: [PATCH] TRITON-531 sdcadm checkIfTmpVMHasErrors calls back with a
 string instead of an Error instance

---
 lib/procedures/shared.js | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/lib/procedures/shared.js b/lib/procedures/shared.js
index f20c70b..3d1dc85 100644
--- a/lib/procedures/shared.js
+++ b/lib/procedures/shared.js
@@ -614,15 +614,17 @@ function checkIfTmpVMHasErrors(arg, next) {
                 next(err);
                 return;
             }
-            var errs = stdout.trim();
-            if (errs) {
+            var errOutput = stdout.trim();
+            if (errOutput) {
                 if (counter < limit) {
                     setTimeout(_checkIfItHasErrors, 5000);
                     return;
                 } else {
                     progress('Timeout (5m) waiting for %s to be up',
                             arg.tmpUUID);
-                    next(errs);
+                    next(new errors.InternalError({
+                        message: errOutput
+                    }));
                     return;
                 }
             }
-- 
2.21.0

