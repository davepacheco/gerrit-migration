commit f9f567c0fe1f11be64834b6baeb5789c1a9d4d56 (refs/changes/65/5565/5)
Author: Marsell Kukuljevic <marsell@joyent.com>
Date:   2019-02-25T15:06:00+01:00 (8 months ago)
    
    TRITON-1213 VM resize fails when tmpfs is 0 and no tmpfs set in package

diff --git a/src/vm/node_modules/VM.js b/src/vm/node_modules/VM.js
index 683fa2fe..bbda875b 100644
--- a/src/vm/node_modules/VM.js
+++ b/src/vm/node_modules/VM.js
@@ -16604,6 +16604,11 @@ exports.update = function (uuid, payload, options, callback)
                                 return;
                             }
 
+                            var tmpfs = Number(vmobj.tmpfs);
+                            if (newkey === 'tmpfs' && tmpfs === 0) {
+                                return;
+                            }
+
                             switch (vmobj.brand) {
                             case 'kvm':
                                 v += KVM_MEM_OVERHEAD;
