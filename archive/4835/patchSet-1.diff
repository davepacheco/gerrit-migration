commit 071fd39fa1bc92ef9cb82479419a1739f7f1962b (refs/changes/35/4835/1)
Author: Mike Zeller <mike@mikezeller.net>
Date:   2018-09-13T17:31:53+00:00 (1 year, 1 month ago)
    
    OS-7243 libvarpd_c_destroy gets away with pointer murder

diff --git a/usr/src/lib/varpd/libvarpd/common/libvarpd_client.c b/usr/src/lib/varpd/libvarpd/common/libvarpd_client.c
index b0fa907386..260bbb6e92 100644
--- a/usr/src/lib/varpd/libvarpd/common/libvarpd_client.c
+++ b/usr/src/lib/varpd/libvarpd/common/libvarpd_client.c
@@ -10,7 +10,7 @@
  */
 
 /*
- * Copyright 2015 Joyent, Inc.
+ * Copyright 2018 Joyent, Inc.
  */
 
 /*
@@ -113,7 +113,7 @@ libvarpd_c_destroy(varpd_client_handle_t *chp)
 		libvarpd_panic("failed to close door fd %d: %d",
 		    client->vcl_doorfd, errno);
 
-	umem_free(chp, sizeof (varpd_client_handle_t *));
+	umem_free(chp, sizeof (varpd_client_t));
 }
 
 int
