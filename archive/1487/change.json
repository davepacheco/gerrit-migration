{"project":"joyent/manta-muskie","branch":"master","id":"Ic1fa87f715c9b01afbf1a5c6e9fe9e7052c8a674","number":"1487","subject":"MANTA-3150 muskie logging about shards is sometimes incorrect, and could also be more useful Reviewed by: Dave Pacheco \u003cdap@joyent.com\u003e Approved by: Dave Pacheco \u003cdap@joyent.com\u003e","owner":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"url":"https://cr.joyent.us/1487","commitMessage":"MANTA-3150 muskie logging about shards is sometimes incorrect, and could also be more useful\nReviewed by: Dave Pacheco \u003cdap@joyent.com\u003e\nApproved by: Dave Pacheco \u003cdap@joyent.com\u003e\n","createdOn":1486690677,"lastUpdated":1487015675,"open":false,"status":"MERGED","comments":[{"timestamp":1486690677,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 1."},{"timestamp":1486690719,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 1: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486690836,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 2."},{"timestamp":1486690862,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 2: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1486754412,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 2:\n\n(2 comments)"},{"timestamp":1487004430,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 3."},{"timestamp":1487004451,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 3:\n\n(2 comments)"},{"timestamp":1487004462,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 3: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487013060,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 3:\n\n(1 comment)"},{"timestamp":1487013907,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 4."},{"timestamp":1487013917,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Patch Set 4:\n\n(1 comment)"},{"timestamp":1487013944,"reviewer":{"name":"Joyent Automation","username":"joyent-automation"},"message":"Patch Set 4: CI-Testing+1\n\n\"make check\" passed ok"},{"timestamp":1487014623,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4: Code-Review+1"},{"timestamp":1487015468,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Patch Set 4: Integration-Approval+1"},{"timestamp":1487015655,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Uploaded patch set 5: Commit message was updated."},{"timestamp":1487015675,"reviewer":{"name":"Gerrit Code Review","email":"no-reply@cr.joyent.us"},"message":"Change has been successfully merged by Jordan Hendricks"}],"currentPatchSet":{"number":"5","revision":"c1fa87f715c9b01afbf1a5c6e9fe9e7052c8a674","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/5","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1487015655,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487013944,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487014623,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487015468,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"SUBM","value":"1","grantedOn":1487015675,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":25,"deletions":-7}],"sizeInsertions":27,"sizeDeletions":-8},"patchSets":[{"number":"1","revision":"e48385ff1bc4f66ace9b9a3f4bccf374fc0df00d","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/1","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1486690677,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486690719,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":17,"deletions":-7}],"sizeInsertions":19,"sizeDeletions":-8},{"number":"2","revision":"c52e691c9c0e2876e29c795a46dca9439e07b516","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/2","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1486690836,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1486690862,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"comments":[{"file":"lib/common.js","line":376,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Should this say: \"an entry\u0027s metadata and its parent\u0027s metadata, if necessary\"?  Or is it always an object here?"},{"file":"lib/common.js","line":376,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Done"},{"file":"lib/common.js","line":466,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"Should this be called baseShard too?"},{"file":"lib/common.js","line":466,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"I thought it might be less confusing to readers to name this something more in line with the code here, and transform it into a name that makes more sense for a reader of muskie logs in the audit code. For now, I\u0027ve changed this to \"entryShard\". If you think it\u0027s less confusing to call it baseShard here, then we can do that instead."},{"file":"lib/common.js","line":466,"reviewer":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},"message":"I like that terminology (\"entry\" and \"parent\").  I think that\u0027s clearer for log readers, too.  What do you think about updating the log fields too?"},{"file":"lib/common.js","line":466,"reviewer":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"message":"Sure, that\u0027s fine with me."}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":24,"deletions":-7}],"sizeInsertions":26,"sizeDeletions":-8},{"number":"3","revision":"8a36b3d0924e1e1706a52524794f05fb7486b07a","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/3","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1487004430,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487004462,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":25,"deletions":-7}],"sizeInsertions":27,"sizeDeletions":-8},{"number":"4","revision":"b52b692c7a13eee37ef80b4d9876c20cf00ebbb8","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/4","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1487013907,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"REWORK","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487014623,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487015468,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487013944,"by":{"name":"Joyent Automation","username":"joyent-automation"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":7,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":25,"deletions":-7}],"sizeInsertions":27,"sizeDeletions":-8},{"number":"5","revision":"c1fa87f715c9b01afbf1a5c6e9fe9e7052c8a674","parents":["7b4a35e739ba05cc274d5a435ff0a521e8d9c09a"],"ref":"refs/changes/87/1487/5","uploader":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"createdOn":1487015655,"author":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"},"isDraft":false,"kind":"NO_CODE_CHANGE","approvals":[{"type":"Code-Review","description":"Code-Review","value":"1","grantedOn":1487014623,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"Integration-Approval","description":"Integration-Approval","value":"1","grantedOn":1487015468,"by":{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"}},{"type":"CI-Testing","description":"CI-Testing","value":"1","grantedOn":1487013944,"by":{"name":"Joyent Automation","username":"joyent-automation"}},{"type":"SUBM","value":"1","grantedOn":1487015675,"by":{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED","insertions":9,"deletions":0},{"file":"lib/audit.js","type":"MODIFIED","insertions":2,"deletions":-1},{"file":"lib/common.js","type":"MODIFIED","insertions":25,"deletions":-7}],"sizeInsertions":27,"sizeDeletions":-8}],"allReviewers":[{"name":"Joyent Automation","username":"joyent-automation"},{"name":"David Pacheco","email":"dap@joyent.com","username":"davepacheco"},{"name":"Jordan Hendricks","email":"jordan.hendricks@joyent.com","username":"jordanhendricks"}]}