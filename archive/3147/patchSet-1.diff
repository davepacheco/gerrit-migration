commit 0f291e5154ba22ce22936d35d81f35e597960c27 (refs/changes/47/3147/1)
Author: Brian Bennett <brian.bennett@joyent.com>
Date:   2018-01-02T12:41:44-08:00 (1 year, 9 months ago)
    
    joyent/manta-thoth#167 thoth should be easier to use from the headnode

diff --git a/bin/sdc-thoth-install b/bin/sdc-thoth-install
index 15858eb..9b937a0 100755
--- a/bin/sdc-thoth-install
+++ b/bin/sdc-thoth-install
@@ -179,21 +179,21 @@ cat > "$runthoth" <<"EOF"
 # actually start uploading.
 #
 
-if [[ $LOGNAME == thoth ]]
+if [[ $LOGNAME == thoth ]]; then
     thoth_home=$HOME
 else
     thoth_home=$(getent passwd thoth | awk -F: '{print $6}')
 fi
 source "${thoth_home:?}/.bashrc"
 
-[[ -z $thoth_home ]]; then
+if [[ -z $thoth_home ]]; then
     printf 'Unable to find thoth $HOME.\n'
     printf 'Is thoth set up properly?\n'
     exit 1
 fi
 
 log=$(date +log/%Y/%m/%d/%H/%M/sdc-thoth.out)
-mkdir -p "${HOME}/$(dirname $log)
+mkdir -p "${HOME}/$(dirname $log)"
 sdc-thoth --dry-run > "$log"
 
 mlog="/${MANTA_USER}/stor/thoth/logs/${THOTH_UUID}/${log}"
@@ -202,7 +202,7 @@ mput -f "$log" "$mlog"
 EOF
 
 chmod +x $runthoth
-ln -s /opt/custom/thoth/bin/run-thoth ../home/thoth/run-thoth
+ln -s ../home/thoth/run-thoth /opt/custom/thoth/bin/run-thoth
 
 cat > $thothwrapper <<EOF
 #!/bin/bash
